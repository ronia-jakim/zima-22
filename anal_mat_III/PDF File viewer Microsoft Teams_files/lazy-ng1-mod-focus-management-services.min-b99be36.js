webpackJsonp([38],{2956:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2957)},2957:function(e,t,i){"use strict";var n=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=i(2958),r=function(e){function t(t){var i=e.call(this,t)||this;return i.orchestrationService=t,i.initializeOnAppLaunchAndReinit(),i}return n(t,e),t.$inject=["orchestrationService"],t.prototype.initializeOnAppLaunchAndReinit=function(e){},t.prototype.cleanupOnAppTeardown=function(e){},t.prototype.mtmaTelemetryIdentifier=function(){return"FocusManagementService"},t.prototype.createTabster=function(e){var t=o.createTabster(e);return o.getInternal(t).stopObserver(),t},t.prototype.getObservedElement=function(e){return o.getObservedElement(e)},t.prototype.getCrossOrigin=function(e){return o.getCrossOrigin(e)},t.prototype.setTabsterAttribute=function(e,t,i){return o.setTabsterAttribute(e,t,i)},t.prototype.disposeTabster=function(e){o.disposeTabster(e)},t}(teamspace.services.MTMABase);t.FocusManagementService=r,angular.module("teamspace.focusManagementService",["teamspace.orchestrationService"]).service("focusManagementService",r)},2958:function(e,t,i){"use strict";function n(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ue(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function o(e,t,i,n){function o(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,r){function s(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){e.done?i(e.value):o(e.value).then(s,a)}u((n=n.apply(e,t||[])).next())})}function r(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){u.label=i[1];break}if(6===i[0]&&u.label<s[1]){u.label=s[1],s=i;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(i);break}s[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function s(e){var t=e.HTMLElement,i=t.prototype.focus,n=!1;return t.prototype.focus=function(){n=!0},e.document.createElement("button").focus(),t.prototype.focus=i,n}function a(e){var t=e.focus;t.__keyborgNativeFocus?t.__keyborgNativeFocus.call(e):e.focus()}function u(e){function t(){var e=i.__keyborgData;return e&&(e.lastFocusedProgrammatically=new de(this)),n.apply(this,arguments)}var i=e;he||(he=s(i));var n=i.HTMLElement.prototype.focus;if(!n.__keyborgNativeFocus){i.HTMLElement.prototype.focus=t;var o=i.__keyborgData={focusInHandler:function(e){var t,i=e.target;if(i){var n=document.createEvent("HTMLEvents");n.initEvent(fe,!0,!0);var r={relatedTarget:e.relatedTarget||void 0};(he||o.lastFocusedProgrammatically)&&(r.isFocusedProgrammatically=i===(null===(t=o.lastFocusedProgrammatically)||void 0===t?void 0:t.deref()),o.lastFocusedProgrammatically=void 0),n.details=r,i.dispatchEvent(n)}}};i.document.addEventListener("focusin",i.__keyborgData.focusInHandler,!0),t.__keyborgNativeFocus=n}}function c(e){var t=e,i=t.HTMLElement.prototype,n=i.focus.__keyborgNativeFocus,o=t.__keyborgData;o&&(t.document.removeEventListener("focusin",o.focusInHandler,!0),delete t.__keyborgData),n&&(i.focus=n)}function l(e){return ge.create(e)}function d(e){ge.dispose(e)}function f(e,t){var i;return null===(i=e.storageEntry(t))||void 0===i?void 0:i.tabster}function h(e,t,i){var n,o,r,s=i||e._noop?void 0:t.getAttribute(we),a=e,u=a.storageEntry(t);if(s){if(s===(null===(n=null===u||void 0===u?void 0:u.attr)||void 0===n?void 0:n.string))return;try{var c=JSON.parse(s);if("object"!=typeof c)throw new Error("Value is not a JSON object, got '"+s+"'.");r={string:s,object:c}}catch(e){}}else if(!u)return;u||(u=e.storageEntry(t,!0)),u.tabster||(u.tabster={});for(var l=u.tabster||{},d=(null===(o=u.attr)||void 0===o?void 0:o.object)||{},f=(null===r||void 0===r?void 0:r.object)||{},h=0,_=Object.keys(d);h<_.length;h++)if(!f[y=_[h]]){if("root"===y){var v=l[y];v&&a.updateRoot(v,!0)}else if("modalizer"===y){var p=l.modalizer;a.updateModalizer&&p&&a.updateModalizer(p,!0)}switch(y){case"deloser":case"root":case"groupper":case"modalizer":case"mover":var m=l[y];m&&(m.dispose(),delete l[y]);break;case"observed":delete l[y],a.updateObserved&&a.updateObserved(t);break;case"focusable":case"outline":case"uncontrolled":delete l[y]}}for(var b=0,g=Object.keys(f);b<g.length;b++){var y=g[b];switch(y){case"deloser":l.deloser?l.deloser.setProps(f.deloser):a.createDeloser&&(l.deloser=a.createDeloser(a,t,f.deloser));break;case"root":l.root?l.root.setProps(f.root):l.root=a.createRoot(a,t,f.root),a.updateRoot(l.root);break;case"modalizer":l.modalizer?l.modalizer.setProps(f.modalizer):a.createModalizer&&(l.modalizer=a.createModalizer(a,t,f.modalizer));break;case"focusable":l.focusable=f.focusable;break;case"groupper":l.groupper?l.groupper.setProps(f.groupper):a.createGroupper&&(l.groupper=a.createGroupper(a,t,f.groupper));break;case"mover":l.mover?l.mover.setProps(f.mover):a.createMover&&(l.mover=a.createMover(a,t,f.mover));break;case"observed":a.updateObserved&&(l.observed=f.observed,a.updateObserved(t));break;case"uncontrolled":l.uncontrolled=f.uncontrolled;break;case"outline":a.outline&&(l.outline=f.outline);break;default:console.error("Unknown key '"+y+"' in data-tabster attribute value.")}}r?u.attr=r:(0===Object.keys(l).length&&(delete u.tabster,delete u.attr),a.storageEntry(t,!1))}function _(e,t,i,n){var o=e.storageEntry(t,!0);if(!o.aug){if(void 0===n)return;o.aug={}}if(void 0===n){if(i in o.aug){var r=o.aug[i];delete o.aug[i],null===r?t.removeAttribute(i):t.setAttribute(i,r)}}else i in o.aug||(o.aug[i]=t.getAttribute(i)),null===n?t.removeAttribute(i):t.setAttribute(i,n);void 0===n&&0===Object.keys(o.aug).length&&(delete o.aug,e.storageEntry(t,!1))}function v(e){var t=e(),i=t.__tabsterInstanceContext;return i||(i={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=i),i}function p(e){var t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}function m(e){var t=e.__tabsterInstanceContext;return new((null===t||void 0===t?void 0:t.basics.WeakMap)||WeakMap)}function b(e,t){var i=v(e);i.fakeWeakRefs=i.fakeWeakRefs.filter(function(e){return!Pe.cleanup(e,t)})}function g(e){var t=v(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=x(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout(function(){t.fakeWeakRefsTimer=void 0,b(e),g(e)},12e4))}function y(e){var t=v(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}function w(e,t,i){if(t.nodeType===Node.ELEMENT_NODE){var n=ye?i:{acceptNode:i};return e.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,n,!1)}}function T(e,t){var i=t.__tabsterCacheId,n=v(e),o=i?n.containerBoundingRectCache[i]:void 0;if(o)return o.rect;var r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new Ne;var s=0,a=0,u=r.clientWidth,c=r.clientHeight;if(t!==r){var l=t.getBoundingClientRect();s=Math.max(s,l.left),a=Math.max(a,l.top),u=Math.min(u,l.right),c=Math.min(c,l.bottom)}var d=new Ne(s<u?s:-1,a<c?a:-1,s<u?u-s:0,a<c?c-a:0);return i||(i="r-"+ ++n.lastContainerBoundingRectCacheId,t.__tabsterCacheId=i),n.containerBoundingRectCache[i]={rect:d,element:t},n.containerBoundingRectCacheTimer||(n.containerBoundingRectCacheTimer=window.setTimeout(function(){n.containerBoundingRectCacheTimer=void 0;for(var e=0,t=Object.keys(n.containerBoundingRectCache);e<t.length;e++){var i=t[e];delete n.containerBoundingRectCache[i].element.__tabsterCacheId}n.containerBoundingRectCache={}},50)),d}function E(e,t){var i=D(t);if(i){var n=T(e,i),o=t.getBoundingClientRect();return o.top>=n.top&&o.bottom<=n.bottom}return!1}function F(e,t,i){void 0===i&&(i=0);var n=D(t);if(n){var o=T(e,n),r=t.getBoundingClientRect();return r.left>o.right||r.top>o.bottom||r.bottom<o.top||r.right<o.left?Ie.Invisible:r.top+i>=o.top&&r.top<=o.bottom&&r.bottom>=o.top&&r.bottom-i<=o.bottom&&r.left+i>=o.left&&r.left<=o.right&&r.right>=o.left&&r.right-i<=o.right?Ie.Visible:Ie.PartiallyVisible}return Ie.Invisible}function I(e,t,i){var n=D(t);if(n){var o=T(e,n),r=t.getBoundingClientRect();n.scrollTop+=i?r.top-o.top:r.bottom-o.bottom}}function D(e){var t=e.ownerDocument;if(t){for(var i=e.parentElement;i;i=i.parentElement)if(i.scrollWidth>i.clientWidth||i.scrollHeight>i.clientHeight)return i;return t.documentElement}return null}function k(e){e.__shouldIgnoreFocus=!0}function C(e){return!!e.__shouldIgnoreFocus}function O(e){var t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(n=0;n<t.length;n++)t[n]=4294967295*Math.random();for(var i=[],n=0;n<t.length;n++)i.push(t[n].toString(36));return i.push("|"),i.push((++Ae).toString(36)),i.push("|"),i.push(Date.now().toString(36)),i.join("")}function R(e,t){var i=v(e),n=t.__tabsterElementUID;return n||(n=t.__tabsterElementUID=O(e())),!i.elementByUId[n]&&M(t.ownerDocument,t)&&(i.elementByUId[n]=new xe(e,t)),n}function N(e){var t=e.__tabsterCrossOriginWindowUID;return t||(t=e.__tabsterCrossOriginWindowUID=O(e)),t}function A(e,t){for(var i=v(e),n=0,o=Object.keys(i.elementByUId);n<o.length;n++){var r=o[n],s=i.elementByUId[r],a=s&&s.get();a&&t&&!t.contains(a)||delete i.elementByUId[r]}}function M(e,t){var i;return!!(null===(i=null===e||void 0===e?void 0:e.body)||void 0===i?void 0:i.contains(t))}function U(e,t){var i=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return i&&i.call(e,t)}function P(e){var t=v(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}function x(e){return e.basics.WeakRef}function S(e,t){var i,n=v(function(){return e});(i="Promise")in t&&(n.basics[i]=t[i]),(i="WeakRef")in t&&(n.basics[i]=t[i]),(i="WeakMap")in t&&(n.basics[i]=t[i])}function L(e){for(var t=null,i=e.lastElementChild;i;i=i.lastElementChild)t=i;return t}function z(e,t,i){var n=document.createEvent("HTMLEvents");return n.initEvent(t,!0,!0),n.details=i,e.dispatchEvent(n),!n.defaultPrevented}function W(e,t,i){var n=[],o=/(:|\.|\[|\]|,|=|@)/g;e.id&&n.push("#"+e.id.replace(o,"\\$1")),!1!==t&&e.className&&e.className.split(" ").forEach(function(e){(e=e.trim())&&n.push("."+e.replace(o,"\\$1"))});var r,s=0;if(!1!==i&&0===n.length){for(r=e;r;)s++,r=r.previousElementSibling;n.unshift(":nth-child("+s+")")}return n.unshift(e.tagName.toLowerCase()),n.join("")}function V(e){if(M(e.ownerDocument,e)){for(var t=[W(e)],i=e.parentElement;i;){var n="BODY"===i.tagName;if(t.unshift(W(i,!1,!n)),n)break;i=i.parentElement}return t.join(" ")}}function B(e,t,i){var n=i.getElement();if(n){var o=R(e,n);return t.deloserByUId[o]||(t.deloserByUId[o]=i),o}}function j(e,t,i,n){function o(t,i){s||(s=v(a).elementByUId),r(t,i);var n=w(e,t,function(e){return r(e,i)});if(n)for(;n.nextNode(););}function r(e,n){var o,r;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;var u=e.__tabsterElementUID;return u&&(n?delete s[u]:null!==(o=(r=s)[u])&&void 0!==o||(r[u]=new xe(a,e))),(f(t,e)||e.hasAttribute(we))&&i(t,e,n),NodeFilter.FILTER_SKIP}if("undefined"==typeof MutationObserver)return function(){};var s,a=t.getWindow,u=new MutationObserver(function(e){for(var n=0,r=e;n<r.length;n++){var s=r[n],a=s.target,u=s.removedNodes,c=s.addedNodes;if("attributes"===s.type)s.attributeName===we&&i(t,a);else{for(l=0;l<u.length;l++)o(u[l],!0);for(var l=0;l<c.length;l++)o(c[l])}}});return n&&o(a().document.body),u.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[we]}),function(){u.disconnect()}}function K(e,t){var i=e.createElement("style");return i.type="text/css",i.appendChild(e.createTextNode(H(t))),e.head.appendChild(i),i}function H(e){return"\n."+e.areaClass+" *, ."+e.areaClass+" *:focus {\noutline: none !important;\n}\n\n."+e.outlineClass+" {\ndisplay: none;\nposition: absolute;\nwidth: 0;\nheight: 0;\nleft: 0;\ntop: 0;\nz-index: "+e.zIndex+";\n}\n\n."+e.outlineClass+"."+e.outlineClass+"_visible {\ndisplay: block;\n}\n\n."+e.outlineClass+"__left,\n."+e.outlineClass+"__top,\n."+e.outlineClass+"__right,\n."+e.outlineClass+"__bottom {\nposition: absolute;\nbackground: inherit;\n}"}function G(e){Nt.forceCleanup(e)}function q(e,t){var i=re(e);if(i)return i;var n=new Nt(e,t);return e.__tabsterInstance=n,n}function J(e){var t=e;if(!t.groupper){var i=new mt(e,t.getWindow);t.groupper=i,t.createGroupper=mt.createGroupper,t.groupperDispose=function(){mt.dispose(i)}}return t.groupper}function X(e){var t=e;if(!t.mover){var i=new Ft(e,t.getWindow);t.mover=i,t.createMover=Ft.createMover,t.moverDispose=function(){Ft.dispose(i)}}return t.mover}function Y(e){var t=e;if(!t.outline){var i=new Ot(e);t.outline=i,t.outlineDispose=function(){Ot.dispose(i)}}return t.outline}function $(e,t){var i=e;if(!i.deloser){var n=new Je(e,t);i.deloser=n,i.createDeloser=Je.createDeloser,i.deloserDispose=function(){Je.dispose(n)}}return i.deloser}function Q(e){var t=e;if(!t.modalizer){var i=new yt(e);t.modalizer=i,t.createModalizer=yt.createModalizer,t.updateModalizer=function(e,i){yt.updateModalizer(t,e,i)},t.modalizerDispose=function(){yt.dispose(i)}}return t.modalizer}function Z(e){var t=e;if(!t.observedElement){var i=new It(e);t.observedElement=i,t.updateObserved=i.onObservedElementUpdate,t.observedElementDispose=function(){It.dispose(i)}}return t.observedElement}function ee(e){var t=e;if(!t.crossOrigin){$(e),Q(e),X(e),J(e),Y(e),Z(e);var i=new dt(e);t.crossOrigin=i,t.crossOriginDispose=function(){dt.dispose(i)}}return t.crossOrigin}function te(e){return e.internal}function ie(e){Nt.dispose(e)}function ne(e,t){var i,n=JSON.stringify(e);return!0===t?n:(i={},i[we]=n,i)}function oe(e,t,i){var n;if(i){var o=e.getAttribute(we);if(o)try{n=JSON.parse(o)}catch(e){}}i&&n||(n={});for(var r=0,s=Object.keys(t);r<s.length;r++){var a=s[r],u=t[a];u?n[a]=u:delete n[a]}Object.keys(n).length>0?e.setAttribute(we,ne(n,!0)):e.removeAttribute(we)}function re(e){return e.__tabsterInstance}function se(e,t){var i=e;if(i._noop!==t){i._noop=t;var n=function(e){return e.getAttribute?((f(i,e)||e.hasAttribute(we))&&h(i,e),NodeFilter.FILTER_SKIP):NodeFilter.FILTER_SKIP},o=i.getWindow().document,r=o.body;n(r);var s=w(o,r,n);if(s)for(;s.nextNode(););}}function ae(e){return e._noop}Object.defineProperty(t,"__esModule",{value:!0});var ue=function(e,t){return(ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},ce=function(){return(ce=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)},le=(Object.create,Object.create,"undefined"!=typeof WeakRef),de=function(){function e(e){le?this._weakRef=new WeakRef(e):this._instance=e}return e.prototype.deref=function(){var e,t,i,n;return this._weakRef?(n=null===(e=this._weakRef)||void 0===e?void 0:e.deref())||delete this._weakRef:(null===(i=null===(t=n=this._instance)||void 0===t?void 0:t.isDisposed)||void 0===i?void 0:i.call(t))&&delete this._instance,n},e}(),fe="keyborg:focusin",he=!1,_e=9,ve=27,pe=0,me=new(function(){function e(){this.__keyborgCoreRefs={},this._isNavigatingWithKeyboard=!1}return e.prototype.add=function(e){var t=e.id;t in this.__keyborgCoreRefs||(this.__keyborgCoreRefs[t]=new de(e))},e.prototype.remove=function(e){delete this.__keyborgCoreRefs[e],0===Object.keys(this.__keyborgCoreRefs).length&&(this._isNavigatingWithKeyboard=!1)},e.prototype.setVal=function(e){if(this._isNavigatingWithKeyboard!==e){this._isNavigatingWithKeyboard=e;for(var t=0,i=Object.keys(this.__keyborgCoreRefs);t<i.length;t++){var n=i[t],o=this.__keyborgCoreRefs[n].deref();o?o.update(e):this.remove(n)}}},e.prototype.getVal=function(){return this._isNavigatingWithKeyboard},e}()),be=function(){function e(e){var t=this;this._isMouseUsed=!1,this._onFocusIn=function(e){if(t._isMouseUsed)t._isMouseUsed=!1;else if(!me.getVal()){var i=e.details;i.relatedTarget&&(i.isFocusedProgrammatically||void 0===i.isFocusedProgrammatically||me.setVal(!0))}},this._onMouseDown=function(e){0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||(t._isMouseUsed=!0,me.setVal(!1))},this._onKeyDown=function(e){var i=me.getVal();i||e.keyCode!==_e?i&&e.keyCode===ve&&t._scheduleDismiss():me.setVal(!0)},this.id="c"+ ++pe,this._win=e;var i=e.document;i.addEventListener(fe,this._onFocusIn,!0),i.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),u(e),me.add(this)}return e.prototype.dispose=function(){var e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),c(e);var t=e.document;t.removeEventListener(fe,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),delete this._win,me.remove(this.id)}},e.prototype.isDisposed=function(){return!!this._win},e.prototype.update=function(e){var t,i,n=null===(i=null===(t=this._win)||void 0===t?void 0:t.__keyborg)||void 0===i?void 0:i.refs;if(n)for(var o=0,r=Object.keys(n);o<r.length;o++){var s=r[o];ge.update(n[s],e)}},e.prototype._scheduleDismiss=function(){var e=this,t=this._win;if(t){this._dismissTimer&&(t.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);var i=t.document.activeElement;this._dismissTimer=t.setTimeout(function(){e._dismissTimer=void 0;var n=t.document.activeElement;i&&n&&i===n&&me.setVal(!1)},500)}},e}(),ge=function(){function e(e){var t;this._cb=[],this._id="k"+ ++pe,this._win=e;var i=e.__keyborg;i?(this._core=i.core,i.refs[this._id]=this):(this._core=new be(e),e.__keyborg={core:this._core,refs:(t={},t[this._id]=this,t)})}return e.create=function(t){return new e(t)},e.dispose=function(e){e.dispose()},e.update=function(e,t){e._cb.forEach(function(e){return e(t)})},e.prototype.dispose=function(){var e,t=null===(e=this._win)||void 0===e?void 0:e.__keyborg;(null===t||void 0===t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win},e.prototype.isNavigatingWithKeyboard=function(){return me.getVal()},e.prototype.subscribe=function(e){this._cb.push(e)},e.prototype.unsubscribe=function(e){var t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)},e.prototype.setVal=function(e){me.setVal(e)},e}();i.d(t,"Types",function(){return Ce}),i.d(t,"createTabster",function(){return q}),i.d(t,"disposeTabster",function(){return ie}),i.d(t,"forceCleanup",function(){return G}),i.d(t,"getCrossOrigin",function(){return ee}),i.d(t,"getCurrentTabster",function(){return re}),i.d(t,"getDeloser",function(){return $}),i.d(t,"getGroupper",function(){return J}),i.d(t,"getInternal",function(){return te}),i.d(t,"getModalizer",function(){return Q}),i.d(t,"getMover",function(){return X}),i.d(t,"getObservedElement",function(){return Z}),i.d(t,"getOutline",function(){return Y}),i.d(t,"getTabsterAttribute",function(){return ne}),i.d(t,"isNoOp",function(){return ae}),i.d(t,"makeNoOp",function(){return se}),i.d(t,"overrideBasics",function(){return S}),i.d(t,"setTabsterAttribute",function(){return oe});var ye,we="data-tabster",Te="data-tabster-dummy",Ee={Any:0,Accessible:1,Focusable:2},Fe={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},Ie={Invisible:0,PartiallyVisible:1,Visible:2},De={Both:0,Vertical:1,Horizontal:2,Grid:3},ke={Unlimited:0,Limited:1,LimitedTrapFocus:2},Ce={__proto__:null,TabsterAttributeName:we,TabsterDummyInputAttributeName:Te,DeloserEventName:"tabster:deloser",ModalizerEventName:"tabster:modalizer",MoverEventName:"tabster:mover",ObservedElementAccesibilities:Ee,RestoreFocusOrders:Fe,Visibilities:Ie,MoverDirections:De,GroupperTabbabilities:ke},Oe=function(){function e(){this._callbacks=[]}return e.prototype.dispose=function(){this._callbacks=[],delete this._val},e.prototype.subscribe=function(e){this._callbacks.indexOf(e)<0&&this._callbacks.push(e)},e.prototype.unsubscribe=function(e){var t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)},e.prototype.setVal=function(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))},e.prototype.getVal=function(){return this._val},e.prototype.trigger=function(e,t){this._callCallbacks(e,t)},e.prototype._callCallbacks=function(e,t){this._callbacks.forEach(function(i){return i(e,t)})},e}(),Re=function(e){function t(t){var i=e.call(this)||this;return i._onChange=function(e){i.setVal(e,void 0)},i._keyborg=l(t()),i._keyborg.subscribe(i._onChange),i}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),d(this._keyborg),delete this._keyborg)},t.dispose=function(e){e.dispose()},t.setVal=function(e,t){var i;null===(i=e._keyborg)||void 0===i||i.setVal(t)},t.prototype.isNavigatingWithKeyboard=function(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())},t}(Oe),Ne="undefined"!=typeof DOMRect?DOMRect:function(){return function(e,t,i,n){this.left=e||0,this.top=t||0,this.right=(e||0)+(i||0),this.bottom=(t||0)+(n||0)}}(),Ae=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),ye=!1}catch(e){ye=!0}var Me,Ue,Pe=function(){function e(e){this._target=e}return e.prototype.deref=function(){return this._target},e.cleanup=function(e,t){return!e._target||!(!t&&M(e._target.ownerDocument,e._target))&&(delete e._target,!0)},e}(),xe=function(){function e(e,t,i){var n,o=v(e);o.WeakRef?n=new o.WeakRef(t):(n=new Pe(t),o.fakeWeakRefs.push(n)),this._ref=n,this._data=i}return e.prototype.get=function(){var e,t=this._ref;return t&&((e=t.deref())||delete this._ref),e},e.prototype.getData=function(){return this._data},e}(),Se=0,Le=function(){function e(e,t,i){var n=e.getWindow;this._tabster=e,this._element=new xe(n,t),this._props=ce({},i),this.id="i"+ ++Se}return e.prototype.getElement=function(){return this._element.get()},e.prototype.getProps=function(){return this._props},e.prototype.setProps=function(e){this._props=ce({},e)},e}(),ze=function(){function e(e,t,i,n,o){var r=this;this._focusIn=function(e){r._onFocusIn&&r.input&&r._onFocusIn(r.input,r.props)},this._focusOut=function(e){r._onFocusOut&&r.input&&r._onFocusOut(r.input,r.props),r._isPhantom&&r.dispose()};var s=e().document.createElement("div");s.tabIndex=0,s.setAttribute("role","none"),s.setAttribute(Te,""),s.setAttribute("aria-hidden","true");var a=s.style;a.position="fixed",a.width=a.height="1px",a.left=a.top="-100500px",a.opacity="0",a.zIndex="-1",k(s),this.input=s,this._isPhantom=t,this._onFocusIn=i,this._onFocusOut=n,this.props=o,s.addEventListener("focusin",this._focusIn),s.addEventListener("focusout",this._focusOut)}return e.prototype.dispose=function(){var e,t=this.input;t&&(delete this._onFocusIn,delete this._onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),null===(e=t.parentElement)||void 0===e||e.removeChild(t))},e}(),We=function(e){function t(t,i,n,o){var r=e.call(this,t,i,o)||this;r._onFocus=function(e){if(e){var t=Ve.getTabsterContext(r._tabster,e);if(!t||t.uncontrolled)return void r._setDummyInputsActive(!1)}r._setDummyInputsActive(!0)},r._onDummyInputFocus=function(e,t){if(t.shouldMoveOut);else{Re.setVal(r._tabster.keyboardNavigation,!0),r._forgetFocusedGrouppers();var i=r._element.get();if(i&&(t.isFirst?r._tabster.focusedElement.focusFirst({container:i}):r._tabster.focusedElement.focusLast({container:i})))return;e.blur()}},r._onDummyInputBlur=function(e,t){t.shouldMoveOut=!1};var s=t.getWindow;return r.uid=R(s,i),r._forgetFocusedGrouppers=n,r._dummyInputFirst=new ze(s,!1,r._onDummyInputFocus,r._onDummyInputBlur,{isFirst:!0,isActive:!0}),r._dummyInputLast=new ze(s,!1,r._onDummyInputFocus,r._onDummyInputBlur,{isFirst:!1,isActive:!0}),r._add(),r._addDummyInputs(),t.focusedElement.subscribe(r._onFocus),r._observeMutations(i),r}return n(t,e),t.prototype.dispose=function(){this._tabster.focusedElement.unsubscribe(this._onFocus),this._unobserve&&(this._unobserve(),this._unobserve=void 0),this._remove();var e=this._dummyInputFirst;e&&(e.dispose(),delete this._dummyInputFirst);var t=this._dummyInputLast;t&&(t.dispose(),delete this._dummyInputLast),this._forgetFocusedGrouppers=function(){}},t.prototype.moveOutWithDefaultAction=function(e){var t=this._dummyInputFirst,i=this._dummyInputLast;(null===t||void 0===t?void 0:t.input)&&(null===i||void 0===i?void 0:i.input)&&(e?(t.props.shouldMoveOut=!0,a(t.input)):(i.props.shouldMoveOut=!0,a(i.input)))},t.prototype._observeMutations=function(e){var t=this;if(!this._unobserve&&"undefined"!=typeof MutationObserver){var i=new MutationObserver(function(e){t._addDummyInputs()});i.observe(e,{childList:!0}),this._unobserve=function(){i.disconnect()}}},t.prototype._setDummyInputsActive=function(e){for(var t=0,i=[this._dummyInputFirst,this._dummyInputLast];t<i.length;t++){var n=i[t];n&&n.props.isActive!==e&&n.input&&(n.input.tabIndex=e?0:-1,n.props.isActive=e)}},t.prototype._add=function(){},t.prototype._remove=function(){this._removeDummyInputs()},t.prototype._addDummyInputs=function(){var e,t,i=this._element.get(),n=null===(e=this._dummyInputFirst)||void 0===e?void 0:e.input,o=null===(t=this._dummyInputLast)||void 0===t?void 0:t.input;if(i&&n&&o){i.lastElementChild!==o&&i.appendChild(o);var r=i.firstElementChild;r&&r!==n&&i.insertBefore(n,r)}},t.prototype._removeDummyInputs=function(){var e,t,i=null===(e=this._dummyInputFirst)||void 0===e?void 0:e.input,n=null===(t=this._dummyInputLast)||void 0===t?void 0:t.input;(null===i||void 0===i?void 0:i.parentElement)&&i.parentElement.removeChild(i),(null===n||void 0===n?void 0:n.parentElement)&&n.parentElement.removeChild(n)},t}(Le),Ve=function(){function e(e,t,i){var n=this;this.rootById={},this._init=function(){n._initTimer=void 0},this._tabster=e,this._win=e.getWindow,this._forgetFocusedGrouppers=t,this._initTimer=this._win().setTimeout(this._init,0),this._autoRoot=i}return e.prototype.dispose=function(){var e=this._win();this._autoRootInstance&&(this._autoRootInstance.dispose(),delete this._autoRootInstance,delete this._autoRoot),this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._forgetFocusedGrouppers=function(){},this.rootById={}},e.dispose=function(e){e.dispose()},e.getRootByUId=function(e,t){var i=e().__tabsterInstance;return i&&i.root.rootById[t]},e.getTabsterContext=function(e,t,i){var n;if(void 0===i&&(i={}),t.ownerDocument){for(var o,r,s,a,u,c,l,d=i.checkRtl,h=t;h&&(!o||d);){var _=f(e,h);if(d&&void 0===c){var v=h.dir;v&&(c="rtl"===v.toLowerCase())}if(_){_.uncontrolled&&(l=h);var p=_.groupper,m=_.mover;!s&&p&&(s=p),!a&&m&&(a=m,u=!!s),!r&&_.modalizer&&(r=_.modalizer),_.root&&(o=_.root),h=h.parentElement}else h=h.parentElement}if(!o){var b=e.root,g=b._autoRoot;if(g&&!b._autoRootInstance){var y=null===(n=t.ownerDocument)||void 0===n?void 0:n.body;y&&(b._autoRootInstance=new We(b._tabster,y,b._forgetFocusedGrouppers,g))}o=b._autoRootInstance}return o?{root:o,modalizer:r,groupper:s,mover:a,isGroupperFirst:u,isRtl:d?!!c:void 0,uncontrolled:l}:void 0}},e.onRoot=function(e,t,i){i?delete e.rootById[t.uid]:e.rootById[t.uid]=t},e.createRoot=function(e,t,i){return new We(e,t,e.root._forgetFocusedGrouppers,i)},e}(),Be=function(){return function(){}}(),je=function(e){function t(t,i){var n=e.call(this)||this;return n.uid=i.uid,n._tabster=t,n._deloser=i,n}return n(t,e),t.prototype.belongsTo=function(e){return e===this._deloser},t.prototype.unshift=function(e){this._deloser.unshift(e)},t.prototype.focusAvailable=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){return e=this._deloser.findAvailable(),[2,!!e&&this._tabster.focusedElement.focus(e)]})})},t.prototype.resetFocus=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){return e=this._tabster.getWindow,[2,P(e).resolve(this._deloser.resetFocus())]})})},t}(Be),Ke=function(){function e(e,t){this._history=[],this._tabster=e,this.rootUId=t}return e.prototype.getLength=function(){return this._history.length},e.prototype.removeDeloser=function(e){this._history=this._history.filter(function(t){return!t.belongsTo(e)})},e.prototype.hasDeloser=function(e){return this._history.some(function(t){return t.belongsTo(e)})},e}(),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.unshiftToDeloser=function(e,t){for(var i,n=0;n<this._history.length;n++)if(this._history[n].belongsTo(e)){i=this._history[n],this._history.splice(n,1);break}i||(i=new je(this._tabster,e)),i.unshift(t),this._history.unshift(i),this._history.splice(10,this._history.length-10)},t.prototype.focusAvailable=function(e){return o(this,void 0,void 0,function(){var t,i,n,o,s;return r(this,function(r){switch(r.label){case 0:t=!!e,i=0,n=this._history,r.label=1;case 1:return i<n.length?(o=n[i],e&&o.belongsTo(e)&&(t=!1),(s=!t)?[4,o.focusAvailable()]:[3,3]):[3,5];case 2:s=r.sent(),r.label=3;case 3:if(s)return[2,!0];r.label=4;case 4:return i++,[3,1];case 5:return[2,!1]}})})},t.prototype.resetFocus=function(e){return o(this,void 0,void 0,function(){var t,i,n,o,s,a,u,c;return r(this,function(r){switch(r.label){case 0:for(t=!!e,i={},n=0,o=this._history;n<o.length;n++)s=o[n],e&&s.belongsTo(e)&&(t=!1),t||i[s.uid]||(i[s.uid]=s);a=0,u=Object.keys(i),r.label=1;case 1:return a<u.length?(c=u[a],[4,i[c].resetFocus()]):[3,4];case 2:if(r.sent())return[2,!0];r.label=3;case 3:return a++,[3,1];case 4:return[2,!1]}})})},t}(Ke),Ge=function(){function e(e){this._history=[],this._tabster=e}return e.prototype.dispose=function(){this._history=[]},e.prototype.process=function(e){var t,i=this,n=Ve.getTabsterContext(this._tabster,e),o=n&&n.root.uid,r=Je.getDeloser(this._tabster,e);if(o&&r){var s=this.make(o,function(){return new He(i._tabster,o)});return n&&n.modalizer&&(null===(t=n.modalizer)||void 0===t||!t.isActive())||s.unshiftToDeloser(r,e),r}},e.prototype.make=function(e,t){for(var i,n=0;n<this._history.length;n++){var o=this._history[n];if(o.rootUId===e){i=o,this._history.splice(n,1);break}}return i||(i=t()),this._history.unshift(i),this._history.splice(10,this._history.length-10),i},e.prototype.removeDeloser=function(e){this._history.forEach(function(t){t.removeDeloser(e)}),this._history=this._history.filter(function(e){return e.getLength()>0})},e.prototype.focusAvailable=function(e){return o(this,void 0,void 0,function(){var t,i,n,o,s;return r(this,function(r){switch(r.label){case 0:t=!!e,i=0,n=this._history,r.label=1;case 1:return i<n.length?(o=n[i],e&&o.hasDeloser(e)&&(t=!1),(s=!t)?[4,o.focusAvailable(e)]:[3,3]):[3,5];case 2:s=r.sent(),r.label=3;case 3:if(s)return[2,!0];r.label=4;case 4:return i++,[3,1];case 5:return[2,!1]}})})},e.prototype.resetFocus=function(e){return o(this,void 0,void 0,function(){var t,i,n,o,s;return r(this,function(r){switch(r.label){case 0:t=!!e,i=0,n=this._history,r.label=1;case 1:return i<n.length?(o=n[i],e&&o.hasDeloser(e)&&(t=!1),(s=!t)?[4,o.resetFocus(e)]:[3,3]):[3,5];case 2:s=r.sent(),r.label=3;case 3:if(s)return[2,!0];r.label=4;case 4:return i++,[3,1];case 5:return[2,!1]}})})},e}(),qe=function(e){function t(t,i,n,o){var r=e.call(this,t,i,o)||this;return r._isActive=!1,r._history=[[]],r._snapshotIndex=0,r.isActive=function(){return r._isActive},r.setSnapshot=function(e){r._snapshotIndex=e,r._history.length>e+1&&r._history.splice(e+1,r._history.length-e-1),r._history[e]||(r._history[e]=[])},r.focusFirst=function(){var e=r._element.get();return!!e&&r._tabster.focusedElement.focusFirst({container:e})},r.focusDefault=function(){var e=r._element.get();return!!e&&r._tabster.focusedElement.focusDefault(e)},r.resetFocus=function(){var e=r._element.get();return!!e&&r._tabster.focusedElement.resetFocus(e)},r.clearHistory=function(e){var t=r._element.get();r._history[r._snapshotIndex]=t?r._history[r._snapshotIndex].filter(function(i){var n=i.get();return!(!n||!e)&&t.contains(n)}):[]},r.uid=R(t.getWindow,i),r._onDispose=n,r}return n(t,e),t.prototype.dispose=function(){this._remove(),this._onDispose(this),this._isActive=!1,this._snapshotIndex=0,this._props={},this._history=[]},t.prototype.setActive=function(e){this._isActive=e},t.prototype.getActions=function(){return{focusDefault:this.focusDefault,focusFirst:this.focusFirst,resetFocus:this.resetFocus,clearHistory:this.clearHistory,setSnapshot:this.setSnapshot,isActive:this.isActive}},t.prototype.unshift=function(e){var t=this._history[this._snapshotIndex];for((t=this._history[this._snapshotIndex]=t.filter(function(t){var i=t.get();return i&&i!==e})).unshift(new xe(this._tabster.getWindow,e,V(e)));t.length>10;)t.pop()},t.prototype.findAvailable=function(){var e=this._element.get();if(!e||!this._tabster.focusable.isVisible(e))return null;var t=this._props.restoreFocusOrder,i=null,n=Ve.getTabsterContext(this._tabster,e);if(!n)return null;var o=n.root,r=o.getElement();if(!r)return null;if(void 0===t&&(t=o.getProps().restoreFocusOrder),t===Fe.RootDefault&&(i=this._tabster.focusable.findDefault({container:r})),i||t!==Fe.RootFirst||(i=this._findFirst(r)),i)return i;var s=this._findInHistory(),a=this._tabster.focusable.findDefault({container:e}),u=this._findFirst(e);return s&&t===Fe.History?s:a&&t===Fe.DeloserDefault?a:u&&t===Fe.DeloserFirst?u:a||s||u||null},t.prototype.customFocusLostHandler=function(e){return z(e,"tabster:deloser",this.getActions())},t.prototype._findInHistory=function(){var e=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(var t=0;t<e.length;t++){var i=e[t],n=i.get(),o=this._element.get();if(n&&o&&o.contains(n)){if(this._tabster.focusable.isFocusable(n))return n}else if(!this._props.noSelectorCheck){var r=i.getData();if(r&&o){var s=void 0;try{s=o.ownerDocument.querySelectorAll(r)}catch(n){continue}for(var a=0;a<s.length;a++){var u=s[a];if(u&&this._tabster.focusable.isFocusable(u))return u}}}}return null},t.prototype._findFirst=function(e){if(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()){var t=this._tabster.focusable.findFirst({container:e});if(t)return t}return null},t.prototype._remove=function(){},t}(Le),Je=function(){function e(e,t){var i=this;this._inDeloser=!1,this._isRestoringFocus=!1,this._isPaused=!1,this._init=function(){i._initTimer=void 0,i._tabster.focusedElement.subscribe(i._onFocus)},this._onFocus=function(e){if(i._restoreFocusTimer&&(i._win().clearTimeout(i._restoreFocusTimer),i._restoreFocusTimer=void 0),e){var t=i._history.process(e);t?i._activate(t):i._deactivate()}else i._scheduleRestoreFocus()},this._onDeloserDispose=function(e){i._history.removeDeloser(e),e.isActive()&&i._scheduleRestoreFocus()},this._tabster=e,this._win=e.getWindow,this._history=new Ge(e),this._initTimer=this._win().setTimeout(this._init,0);var n=null===t||void 0===t?void 0:t.autoDeloser;n&&(this._autoDeloser=n)}return e.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._restoreFocusTimer&&(e.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._tabster.focusedElement.unsubscribe(this._onFocus),this._history.dispose(),delete this._curDeloser},e.dispose=function(e){e.dispose()},e.prototype.getActions=function(e){for(var t=e;t;t=t.parentElement){var i=f(this._tabster,t);if(i&&i.deloser)return i.deloser.getActions()}},e.prototype.pause=function(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)},e.prototype.resume=function(e){this._isPaused=!1,e&&this._scheduleRestoreFocus()},e.prototype._activate=function(e){var t=this._curDeloser;t!==e&&(this._inDeloser=!0,null===t||void 0===t||t.setActive(!1),e.setActive(!0),this._curDeloser=e)},e.prototype._deactivate=function(){var e;this._inDeloser=!1,null===(e=this._curDeloser)||void 0===e||e.setActive(!1),this._curDeloser=void 0},e.prototype._scheduleRestoreFocus=function(e){var t=this;if(!this._isPaused&&!this._isRestoringFocus){var i=function(){return o(t,void 0,void 0,function(){var t,i,n;return r(this,function(o){switch(o.label){case 0:if(this._restoreFocusTimer=void 0,t=this._tabster.focusedElement.getLastFocusedElement(),!e&&(this._isRestoringFocus||!this._inDeloser||(null===t||void 0===t?void 0:t.offsetParent)))return[2];if(i=this._curDeloser){if(t&&i.customFocusLostHandler(t))return[2];if((n=i.findAvailable())&&this._tabster.focusedElement.focus(n))return[2]}return this._deactivate(),this._isRestoringFocus=!0,[4,this._history.focusAvailable(null)];case 1:return o.sent()?[3,3]:[4,this._history.resetFocus(null)];case 2:o.sent(),o.label=3;case 3:return this._isRestoringFocus=!1,[2]}})})};e?i():this._restoreFocusTimer=this._win().setTimeout(i,100)}},e.getDeloser=function(e,t){for(var i,n=t;n;n=n.parentElement){var o=f(e,n);if(o&&o.deloser)return o.deloser}var r=e,s=r.deloser&&r.deloser;if(s){if(s._autoDeloserInstance)return s._autoDeloserInstance;var a=s._autoDeloser;if(!s._autoDeloserInstance&&a){var u=null===(i=t.ownerDocument)||void 0===i?void 0:i.body;u&&(s._autoDeloserInstance=new qe(r,u,r.deloser._onDeloserDispose,a))}return s._autoDeloserInstance}},e.getHistory=function(e){return e._history},e.forceRestoreFocus=function(e){e._scheduleRestoreFocus(!0)},e.createDeloser=function(e,t,i){var n,o=new qe(e,t,e.deloser._onDeloserDispose,i);return t.contains(null!==(n=e.focusedElement.getFocusedElement())&&void 0!==n?n:null)&&e.deloser._activate(o),o},e}(),Xe="up",Ye={Bootstrap:1,FocusElement:2,State:3,GetElement:4,RestoreFocusInDeloser:5,Ping:6},$e=function(e){function t(t,i,n){var o=e.call(this)||this;return o._deloser=i,o._transactions=n,o}return n(t,e),t.prototype.belongsTo=function(e){return e.deloserUId===this._deloser.deloserUId},t.prototype.focusAvailable=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){return e=ce(ce({},this._deloser),{reset:!1}),[2,this._transactions.beginTransaction(rt,e).then(function(e){return!!e})]})})},t.prototype.resetFocus=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){return e=ce(ce({},this._deloser),{reset:!0}),[2,this._transactions.beginTransaction(rt,e).then(function(e){return!!e})]})})},t}(Be),Qe=function(e){function t(t,i,n){var o=e.call(this,t,i)||this;return o._transactions=n,o}return n(t,e),t.prototype.unshift=function(e){for(var t,i=0;i<this._history.length;i++)if(this._history[i].belongsTo(e)){t=this._history[i],this._history.splice(i,1);break}t||(t=new $e(this._tabster,e,this._transactions)),this._history.unshift(t),this._history.splice(10,this._history.length-10)},t.prototype.focusAvailable=function(){return o(this,void 0,void 0,function(){var e,t,i;return r(this,function(n){switch(n.label){case 0:e=0,t=this._history,n.label=1;case 1:return e<t.length?(i=t[e],[4,i.focusAvailable()]):[3,4];case 2:if(n.sent())return[2,!0];n.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}})})},t.prototype.resetFocus=function(){return o(this,void 0,void 0,function(){var e,t,i;return r(this,function(n){switch(n.label){case 0:e=0,t=this._history,n.label=1;case 1:return e<t.length?(i=t[e],[4,i.resetFocus()]):[3,4];case 2:if(n.sent())return[2,!0];n.label=3;case 3:return e++,[3,1];case 4:return[2,!1]}})})},t}(Ke),Ze=function(){function e(e,t,i,n,o,r,s,a){var u,c=this;this._inProgress={},this._isDone=!1,this._isSelfResponding=!1,this._sentCount=0,this.tabster=e,this.owner=t,this.ownerId=N(t()),this.id=O(t()),this.beginData=n,this._knownTargets=i,this._sentTo=r||(u={},u[this.ownerId]=!0,u),this.targetId=s,this.sendUp=a,this.timeout=o,this._promise=new(P(t))(function(e,t){c._resolve=e,c._reject=t})}return e.prototype.getTargets=function(e){var t,i,n;return this.targetId===Xe?this.sendUp?(t={},t[Xe]={send:this.sendUp},t):null:this.targetId?e[this.targetId]?(i={},i[this.targetId]={send:e[this.targetId].send},i):null:0===Object.keys(e).length&&this.sendUp?(n={},n[Xe]={send:this.sendUp},n):Object.keys(e).length>0?e:null},e.prototype.begin=function(e){var t=this,i=this.getTargets(this._knownTargets),n=ce({},this._sentTo);if(i)for(var o=0,r=Object.keys(i);o<r.length;o++)n[c=r[o]]=!0;var s={transaction:this.id,type:this.type,isResponse:!1,timestamp:Date.now(),owner:this.ownerId,sentto:n,timeout:this.timeout,beginData:this.beginData};if(this.targetId&&(s.target=this.targetId),e&&(this._isSelfResponding=!0,e(s).then(function(e){t._isSelfResponding=!1,void 0!==e&&(t.endData||(t.endData=e)),(t.endData||0===t._sentCount)&&t.end()})),i)for(var a=0,u=Object.keys(i);a<u.length;a++){var c=u[a];c in this._sentTo||this._send(i[c].send,c,s)}return 0!==this._sentCount||this._isSelfResponding||this.end(),this._promise},e.prototype._send=function(e,t,i){void 0===this._inProgress[t]&&(this._inProgress[t]=!0,this._sentCount++,e(i))},e.prototype.end=function(e){this._isDone||(this._isDone=!0,void 0===this.endData&&e?this._reject&&this._reject(e):this._resolve&&this._resolve(this.endData))},e.prototype.onResponse=function(e){var t=e.endData;void 0===t||this.endData||(this.endData=t);var i=e.target===Xe?Xe:e.owner;this._inProgress[i]&&(this._inProgress[i]=!1,this._sentCount--,(this.endData||0===this._sentCount&&!this._isSelfResponding)&&this.end())},e}(),et=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.Bootstrap,t}return n(t,e),t.shouldForward=function(){return!1},t.makeResponse=function(e){return o(this,void 0,void 0,function(){return r(this,function(t){return[2,{isNavigatingWithKeyboard:e.keyboardNavigation.isNavigatingWithKeyboard()}]})})},t}(Ze),tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.FocusElement,t}return n(t,e),t.shouldForward=function(e,t,i){var n=ot.findElement(e,i,t.beginData);return!n||!e.focusable.isFocusable(n)},t.makeResponse=function(e,t,i,n,s,a){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return n=ot.findElement(e,i,t.beginData),(o=!!n&&e.focusedElement.focus(n))?[3,2]:[4,a];case 1:o=!!r.sent(),r.label=2;case 2:return[2,o]}})})},t.shouldSelfRespond=function(){return!0},t}(Ze),it={Focused:1,Blurred:2,Observed:3,DeadWindow:4,KeyboardNavigation:5,Outline:6},nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.State,t}return n(t,e),t.shouldSelfRespond=function(e,t){return t.state!==it.DeadWindow&&t.state!==it.KeyboardNavigation},t.makeResponse=function(e,i,n,s,a,u,c){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){if(n=i.timestamp,o=i.beginData,n&&o)switch(o.state){case it.Focused:return[2,t._makeFocusedResponse(e,n,o,a,c)];case it.Blurred:return[2,t._makeBlurredResponse(e,n,o,a.ctx)];case it.Observed:return[2,t._makeObservedResponse(e,o)];case it.DeadWindow:return[2,t._makeDeadWindowResponse(e,o,a,u)];case it.KeyboardNavigation:return[2,t._makeKeyboardNavigationResponse(e,a.ctx,o.isNavigatingWithKeyboard)];case it.Outline:return[2,t._makeOutlineResponse(e,a.ctx,o.outline)]}return[2,!0]})})},t.createElement=function(e,t){return t.uid?new ut(e,t.uid,t.ownerUId,t.id,t.rootUId,t.observedName,t.observedDetails):null},t._makeFocusedResponse=function(e,i,n,s,a){return o(this,void 0,void 0,function(){var o,u,c,l,d;return r(this,function(r){return o=t.createElement(e,n),n&&n.ownerUId&&o&&(s.ctx.focusOwner=n.ownerUId,s.ctx.focusOwnerTimestamp=i,!a&&n.rootUId&&n.deloserUId&&(u=e.deloser)&&(c=Je.getHistory(u),l={ownerUId:n.ownerUId,deloserUId:n.deloserUId,rootUId:n.rootUId},(d=c.make(n.rootUId,function(){return new Qe(e,l.rootUId,s)})).unshift(l)),ct.setVal(e.crossOrigin.focusedElement,o,{isFocusedProgrammatically:n.isFocusedProgrammatically})),[2,!0]})})},t._makeBlurredResponse=function(e,t,i,n){return o(this,void 0,void 0,function(){return r(this,function(o){return i&&(i.ownerUId===n.focusOwner||i.force)&&(!n.focusOwnerTimestamp||n.focusOwnerTimestamp<t)&&ct.setVal(e.crossOrigin.focusedElement,void 0,{}),[2,!0]})})},t._makeObservedResponse=function(e,i){return o(this,void 0,void 0,function(){var n,o;return r(this,function(r){return n=i.observedName,o=t.createElement(e,i),n&&o&&lt.trigger(e.crossOrigin.observedElement,o,{name:n,details:i.observedDetails}),[2,!0]})})},t._makeDeadWindowResponse=function(e,t,i,n){return o(this,void 0,void 0,function(){var o;return r(this,function(r){return(o=t&&t.ownerUId)&&i.removeTarget(o),[2,n.then(function(){if(o===i.ctx.focusOwner){var t=e.deloser;t&&Je.forceRestoreFocus(t)}return!0})]})})},t._makeKeyboardNavigationResponse=function(e,t,i){return o(this,void 0,void 0,function(){return r(this,function(n){return void 0!==i&&e.keyboardNavigation.isNavigatingWithKeyboard()!==i&&(t.ignoreKeyboardNavigationStateUpdate=!0,Re.setVal(e.keyboardNavigation,i),t.ignoreKeyboardNavigationStateUpdate=!1),[2,!0]})})},t._makeOutlineResponse=function(e,t,i){return o(this,void 0,void 0,function(){return r(this,function(n){return t.origOutlineSetup&&t.origOutlineSetup.call(e.outline,i),[2,!0]})})},t}(Ze),ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.GetElement,t}return n(t,e),t.findElement=function(e,t,i){var n;if(i&&(!i.ownerId||i.ownerId===N(t())))if(i.id){if((n=t().document.getElementById(i.id))&&i.rootId){var o=Ve.getTabsterContext(e,n);if(!o||o.root.uid!==i.rootId)return null}}else if(i.uid){var r=v(t).elementByUId[i.uid];n=r&&r.get()}else i.observedName&&(n=e.observedElement.getElement(i.observedName));return n||null},t.getElementData=function(e,t,i,n,o){var r=Je.getDeloser(e,t),s=Ve.getTabsterContext(e,t),a=f(e,t),u=a&&a.observed;return{uid:R(i,t),ownerUId:o,id:t.id||void 0,rootUId:s?s.root.uid:void 0,deloserUId:r?B(i,n,r):void 0,observedName:u&&u.name,observedDetails:u&&u.details}},t.makeResponse=function(e,i,n,s,a,u){return o(this,void 0,void 0,function(){var o,c,l,d,f,h,_;return r(this,function(r){switch(r.label){case 0:return void 0===(o=i.beginData)?c=e.focusedElement.getFocusedElement():o&&(c=t.findElement(e,n,o)||void 0),c||!o?[3,2]:(d=o.observedName,f=i.timeout,h=o.accessibility,d&&f?[4,new(P(n))(function(t,i){var n=!1,o=!1,r=!1;e.observedElement.waitElement(d,f,h).result.then(function(e){n=!0,r||!e&&!o||(r=!0,t({element:e}))}),u.then(function(e){o=!0,r||!e&&!n||(r=!0,t({crossOrigin:e}))})})]:[3,2]);case 1:(_=r.sent()).element?c=_.element:_.crossOrigin&&(l=_.crossOrigin),r.label=2;case 2:return[2,c?t.getElementData(e,c,n,a.ctx,s):l]}})})},t.shouldSelfRespond=function(){return!0},t}(Ze),rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.RestoreFocusInDeloser,t}return n(t,e),t.makeResponse=function(e,t,i,n,s,a){return o(this,void 0,void 0,function(){var i,n,o,u,c,l;return r(this,function(r){switch(r.label){case 0:return[4,a];case 1:return i=r.sent(),n=!i&&t.beginData,o=n&&n.deloserUId,u=o&&s.ctx.deloserByUId[o],c=e.deloser,n&&u&&c?(l=Je.getHistory(c),[2,n.reset?l.resetFocus(u):l.focusAvailable(u)]):[2,!!i]}})})},t}(Ze),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Ye.Ping,t}return n(t,e),t.shouldForward=function(){return!1},t.makeResponse=function(){return o(this,void 0,void 0,function(){return r(this,function(e){return[2,!0]})})},t}(Ze),at=function(){function e(e,t,i){var n=this;this._knownTargets={},this._transactions={},this._isDefaultSendUp=!1,this.isSetUp=!1,this._onMessage=function(e){if(e.data.owner!==n._ownerUId&&n._tabster){var t,i=e.data;if(i&&(t=i.transaction)&&i.type&&i.timestamp&&i.owner&&i.sentto){var o=n._knownTargets[i.owner];if(!o&&e.send&&i.owner!==n._ownerUId&&(o=n._knownTargets[i.owner]={send:e.send}),o&&(o.last=Date.now()),i.isResponse){var r=n._transactions[t];r&&r.transaction&&r.transaction.type===i.type&&r.transaction.onResponse(i)}else{var s=n._getTransactionClass(i.type),a=n.forwardTransaction(i);s&&e.send&&s.makeResponse(n._tabster,i,n._owner,n._ownerUId,n,a,!1).then(function(t){var o={transaction:i.transaction,type:i.type,isResponse:!0,timestamp:Date.now(),owner:n._ownerUId,timeout:i.timeout,sentto:{},target:i.target===Xe?Xe:i.owner,endData:t};e.send(o)})}}}},this._onPageHide=function(){n._dead()},this._onBrowserMessage=function(e){if(e.source!==n._owner()){try{n._onMessage({data:JSON.parse(e.data),send:function(t){e.source&&e.source.postMessage&&e.source.postMessage(JSON.stringify(t),"*")}})}catch(e){}}},this._tabster=e,this._owner=t,this._ownerUId=N(t()),this.ctx=i}return e.prototype.setup=function(e){return this.isSetUp||(this.isSetUp=!0,this.setSendUp(e),this._owner().addEventListener("pagehide",this._onPageHide),this._ping()),this._onMessage},e.prototype.setSendUp=function(e){if(!this.isSetUp)throw new Error("CrossOrigin is not set up.");this.sendUp=e||void 0;var t=this._owner();return void 0===e?this._isDefaultSendUp||t.document&&(this._isDefaultSendUp=!0,t.parent&&t.parent!==t&&t.parent.postMessage&&(this.sendUp=function(e){t.parent.postMessage(JSON.stringify(e),"*")}),t.addEventListener("message",this._onBrowserMessage)):this._isDefaultSendUp&&(t.removeEventListener("message",this._onBrowserMessage),this._isDefaultSendUp=!1),this._onMessage},e.prototype.dispose=function(){return o(this,void 0,void 0,function(){var e,t,i,n,o;return r(this,function(r){switch(r.label){case 0:return e=this._owner(),this._pingTimer&&(e.clearTimeout(this._pingTimer),this._pingTimer=void 0),e.removeEventListener("message",this._onBrowserMessage),e.removeEventListener("pagehide",this._onPageHide),[4,this._dead()];case 1:for(r.sent(),delete this._deadPromise,t=0,i=Object.keys(this._transactions);t<i.length;t++)n=i[t],(o=this._transactions[n]).timer&&(e.clearTimeout(o.timer),delete o.timer),o.transaction.end();return this._knownTargets={},delete this.sendUp,[2]}})})},e.prototype.beginTransaction=function(e,t,i,n,o,r){var s=this;if(!this._owner)return P(this._owner).reject();var a,u=new e(this._tabster,this._owner,this._knownTargets,t,i,n,o,this.sendUp);return e.shouldSelfRespond&&e.shouldSelfRespond(this._tabster,t,this._owner,this._ownerUId)&&(a=function(t){return e.makeResponse(s._tabster,t,s._owner,s._ownerUId,s,P(s._owner).resolve(void 0),!0)}),this._beginTransaction(u,i,a,r)},e.prototype.removeTarget=function(e){delete this._knownTargets[e]},e.prototype._beginTransaction=function(e,t,i,n){var o=this,r=this._owner(),s={transaction:e,timer:r.setTimeout(function(){delete s.timer,e.end("Cross origin transaction timed out.")},1500+(t||0))};this._transactions[e.id]=s;var a=e.begin(i);return a.catch(function(){}).finally(function(){s.timer&&r.clearTimeout(s.timer),delete o._transactions[e.id]}),a.then(function(e){return e},n?void 0:function(){})},e.prototype.forwardTransaction=function(e){var t=this._owner,i=e.target;if(i===this._ownerUId)return P(t).resolve();var n=this._getTransactionClass(e.type);if(n){if(void 0===n.shouldForward||n.shouldForward(this._tabster,e,t,this._ownerUId)){var o=e.sentto;return i===Xe&&(i=void 0,o[this._ownerUId]=!0),delete o[Xe],this._beginTransaction(new n(this._tabster,t,this._knownTargets,e.beginData,e.timeout,o,i,this.sendUp),e.timeout)}return P(t).resolve()}return P(t).reject("Unknown transaction type "+e.type)},e.prototype._getTransactionClass=function(e){switch(e){case Ye.Bootstrap:return et;case Ye.FocusElement:return tt;case Ye.State:return nt;case Ye.GetElement:return ot;case Ye.RestoreFocusInDeloser:return rt;case Ye.Ping:return st;default:return null}},e.prototype._dead=function(){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this._deadPromise||this.ctx.focusOwner!==this._ownerUId||(this._deadPromise=this.beginTransaction(nt,{ownerUId:this._ownerUId,state:it.DeadWindow})),this._deadPromise?[4,this._deadPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._ping=function(){return o(this,void 0,void 0,function(){var e,t,i,n,o,s=this;return r(this,function(r){switch(r.label){case 0:return this._pingTimer?[2]:(t=Date.now(),i=Object.keys(this._knownTargets).filter(function(e){return t-(s._knownTargets[e].last||0)>3e3}),this.sendUp&&i.push(Xe),i.length?[4,P(this._owner).all(i.map(function(t){return s.beginTransaction(st,void 0,void 0,void 0,t,!0).then(function(){return!0},function(){return t!==Xe&&(e||(e={}),e[t]=!0,delete s._knownTargets[t]),!1})}))]:[3,2]);case 1:r.sent(),r.label=2;case 2:return e?[4,this.beginTransaction(ot,void 0)]:[3,5];case 3:return!(n=r.sent())&&this.ctx.focusOwner&&this.ctx.focusOwner in e?[4,this.beginTransaction(nt,{ownerUId:this._ownerUId,state:it.Blurred,force:!0})]:[3,5];case 4:r.sent(),(o=this._tabster.deloser)&&Je.forceRestoreFocus(o),r.label=5;case 5:return this._pingTimer=this._owner().setTimeout(function(){s._pingTimer=void 0,s._ping()},3e3),[2]}})})},e}(),ut=function(){function e(e,t,i,n,o,r,s){this._tabster=e,this.uid=t,this.ownerId=i,this.id=n,this.rootId=o,this.observedName=r,this.observedDetails=s}return e.prototype.focus=function(e,t){return this._tabster.crossOrigin.focusedElement.focus(this,e,t)},e}(),ct=function(e){function t(t){var i=e.call(this)||this;return i._transactions=t,i}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.dispose=function(e){e.dispose()},t.prototype.focus=function(e,t,i){return o(this,void 0,void 0,function(){return r(this,function(n){return[2,this._focus({uid:e.uid,id:e.id,rootId:e.rootId,ownerId:e.ownerId,observedName:e.observedName},t,i)]})})},t.prototype.focusById=function(e,t,i,n){return o(this,void 0,void 0,function(){return r(this,function(o){return[2,this._focus({id:e,rootId:t},i,n)]})})},t.prototype.focusByObservedName=function(e,t,i,n,s){return o(this,void 0,void 0,function(){return r(this,function(o){return[2,this._focus({observedName:e,rootId:i},n,s,t)]})})},t.prototype._focus=function(e,t,i,n){return o(this,void 0,void 0,function(){return r(this,function(o){return[2,this._transactions.beginTransaction(tt,ce(ce({},e),{noFocusedProgrammaticallyFlag:t,noAccessibleCheck:i}),n).then(function(e){return!!e})]})})},t.setVal=function(e,t,i){e.setVal(t,i)},t}(Oe),lt=function(e){function t(t,i){var n=e.call(this)||this;return n._lastRequestFocusId=0,n._tabster=t,n._transactions=i,n}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.dispose=function(e){e.dispose()},t.prototype.getElement=function(e,t){return o(this,void 0,void 0,function(){return r(this,function(i){return[2,this.waitElement(e,0,t)]})})},t.prototype.waitElement=function(e,t,i){return o(this,void 0,void 0,function(){var n=this;return r(this,function(o){return[2,this._transactions.beginTransaction(ot,{observedName:e,accessibility:i},t).then(function(e){return e?nt.createElement(n._tabster,e):null})]})})},t.prototype.requestFocus=function(e,t){return o(this,void 0,void 0,function(){var i,n=this;return r(this,function(o){return i=++this._lastRequestFocusId,[2,this.waitElement(e,t,Ee.Focusable).then(function(e){return!(n._lastRequestFocusId!==i||!e)&&n._tabster.crossOrigin.focusedElement.focus(e,!0)})]})})},t.trigger=function(e,t,i){e.trigger(t,i)},t}(Oe),dt=function(){function e(e){var t=this;this._init=function(){t._initTimer=void 0;var e=t._tabster;e.keyboardNavigation.subscribe(t._onKeyboardNavigationStateChanged),e.focusedElement.subscribe(t._onFocus),e.observedElement.subscribe(t._onObserved),t._ctx.origOutlineSetup||(t._ctx.origOutlineSetup=e.outline.setup,e.outline.setup=t._outlineSetup),t._transactions.beginTransaction(et,void 0,void 0,void 0,Xe).then(function(e){e&&t._tabster.keyboardNavigation.isNavigatingWithKeyboard()!==e.isNavigatingWithKeyboard&&(t._ctx.ignoreKeyboardNavigationStateUpdate=!0,Re.setVal(t._tabster.keyboardNavigation,e.isNavigatingWithKeyboard),t._ctx.ignoreKeyboardNavigationStateUpdate=!1)})},this._onKeyboardNavigationStateChanged=function(e){t._ctx.ignoreKeyboardNavigationStateUpdate||t._transactions.beginTransaction(nt,{state:it.KeyboardNavigation,ownerUId:N(t._win()),isNavigatingWithKeyboard:e})},this._onFocus=function(e,i){var n=t._win(),o=N(n);t._blurTimer&&(n.clearTimeout(t._blurTimer),t._blurTimer=void 0),e?t._transactions.beginTransaction(nt,ce(ce({},ot.getElementData(t._tabster,e,t._win,t._ctx,o)),{state:it.Focused})):t._blurTimer=n.setTimeout(function(){t._blurTimer=void 0,t._ctx.focusOwner&&t._ctx.focusOwner===o&&t._transactions.beginTransaction(ot,void 0).then(function(e){e||t._ctx.focusOwner!==o||t._transactions.beginTransaction(nt,{ownerUId:o,state:it.Blurred,force:!1})})},0)},this._onObserved=function(e,i){var n=ot.getElementData(t._tabster,e,t._win,t._ctx,N(t._win()));n.state=it.Observed,n.observedName=i.name,n.observedDetails=i.details,t._transactions.beginTransaction(nt,n)},this._outlineSetup=function(e){t._transactions.beginTransaction(nt,{state:it.Outline,ownerUId:N(t._win()),outline:e})},this._tabster=e,this._win=e.getWindow,this._ctx={ignoreKeyboardNavigationStateUpdate:!1,deloserByUId:{}},this._transactions=new at(e,this._win,this._ctx),this.focusedElement=new ct(this._transactions),this.observedElement=new lt(e,this._transactions)}return e.prototype.setup=function(e){return this.isSetUp()?this._transactions.setSendUp(e):(this._initTimer=this._win().setTimeout(this._init,0),this._transactions.setup(e))},e.prototype.isSetUp=function(){return this._transactions.isSetUp},e.prototype.dispose=function(){var e;this._initTimer&&(this._win().clearTimeout(this._initTimer),this._initTimer=void 0);var t=this._tabster;t.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),t.focusedElement.unsubscribe(this._onFocus),null===(e=t.observedElement)||void 0===e||e.unsubscribe(this._onObserved),this._transactions.dispose(),ct.dispose(this.focusedElement),lt.dispose(this.observedElement),this._ctx.deloserByUId={}},e.dispose=function(e){e.dispose()},e}(),ft=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]"].join(", "),ht=function(){function e(e,t){this._tabster=e,this._win=t}return e.prototype.dispose=function(){},e.dispose=function(e){e.dispose()},e.prototype._getBody=function(){var e=this._tabster.focusedElement.getLastFocusedElement();return e&&e.ownerDocument?e.ownerDocument.body:this._win().document.body},e.prototype.getProps=function(e){var t=f(this._tabster,e);return t&&t.focusable||{}},e.prototype.isFocusable=function(e,t,i,n){return!(!U(e,ft)||!t&&-1===e.tabIndex)&&((i||this.isVisible(e))&&(n||this.isAccessible(e)))},e.prototype.isVisible=function(e){if(!e.ownerDocument)return!1;if(null===e.offsetParent&&e.ownerDocument.body!==e)return!1;var t=e.ownerDocument.defaultView;if(!t)return!1;var i=e.ownerDocument.body.getBoundingClientRect();return(0!==i.width||0!==i.height)&&"hidden"!==t.getComputedStyle(e).visibility},e.prototype.isAccessible=function(e){for(var t,i=e;i;i=i.parentElement){var n=f(this._tabster,i);if(this._isHidden(i))return!1;if(!(null===(t=null===n||void 0===n?void 0:n.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(i))return!1}return!0},e.prototype._isDisabled=function(e){return e.hasAttribute("disabled")},e.prototype._isHidden=function(e){var t=e.getAttribute("aria-hidden");return!(!t||"true"!==t.toLowerCase())},e.prototype.findFirst=function(e){return this.findElement(ce({container:this._getBody()},e))},e.prototype.findLast=function(e){return this.findElement(ce({container:this._getBody(),prev:!0},e))},e.prototype.findNext=function(e){return this.findElement(ce({container:this._getBody()},e))},e.prototype.findPrev=function(e){return this.findElement(ce({container:this._getBody(),prev:!0},e))},e.prototype.findDefault=function(e){var t=this;return this.findElement(ce(ce({},e),{acceptCondition:function(i){return t._tabster.focusable.isFocusable(i,e.includeProgrammaticallyFocusable)&&!!t.getProps(i).isDefault}}))||null},e.prototype.findAll=function(e){var t=this,i=e.container,n=e.acceptCondition,o=e.includeProgrammaticallyFocusable,r=e.ignoreGroupper,s=e.ignoreUncontrolled,a=e.ignoreAccessibiliy,u=e.skipDefaultCheck,c={container:i,from:null,isForward:!0,acceptCondition:function(e){var i,r=!1;return(i=!!u||t._tabster.focusable.isFocusable(e,o))&&(r=!n||n(e)),i&&r},includeProgrammaticallyFocusable:o,ignoreGroupper:r,ignoreUncontrolled:s,ignoreAccessibiliy:a,grouppers:{}},l=w(i.ownerDocument,i,function(e){return t._acceptElement(e,c)}),d=null===l||void 0===l?void 0:l.filter;if(!l||!d)return[];for(var f,h=[];f=l.nextNode();)h.push(f);return h},e.prototype.findElement=function(e){var t=this,i=e.container,n=e.currentElement,o=void 0===n?null:n,r=e.includeProgrammaticallyFocusable,s=e.ignoreGroupper,a=e.ignoreUncontrolled,u=e.ignoreAccessibiliy,c=e.prev,l=e.onUncontrolled,d=e.acceptCondition;if(!i)return null;if(!i.ownerDocument||o&&i!==o&&!i.contains(o))return null;d||(d=function(e){return t._tabster.focusable.isFocusable(e,r,u,u)});var f={container:i,from:o,isForward:!c,acceptCondition:d,includeProgrammaticallyFocusable:r,ignoreGroupper:s,ignoreUncontrolled:a,ignoreAccessibiliy:u,grouppers:{}},h=w(i.ownerDocument,i,function(e){return t._acceptElement(e,f)});if(!h)return null;if(o)h.currentNode=o;else if(c){var _=L(i);if(!_)return null;if(this._acceptElement(_,f)===NodeFilter.FILTER_ACCEPT)return _;h.currentNode=_}var v=c?h.previousNode():h.nextNode(),p=f.nextUncontrolled;return p&&(v=v?void 0:null,l&&l(p)),f.found?f.foundElement:v},e.prototype._acceptElement=function(e,t){if(e===t.container)return NodeFilter.FILTER_SKIP;if(t.found)return NodeFilter.FILTER_ACCEPT;var i=Ve.getTabsterContext(this._tabster,e);if(!i)return NodeFilter.FILTER_SKIP;if(t.ignoreUncontrolled){if(C(e))return NodeFilter.FILTER_SKIP}else if(i.groupper)t.nextGroupper=i.groupper.getElement();else if(i.mover)t.nextMover=i.mover.getElement();else if(i.uncontrolled&&!t.nextUncontrolled&&!i.groupper&&!i.mover)return t.nextUncontrolled=i.uncontrolled,NodeFilter.FILTER_REJECT;if("IFRAME"===e.tagName)return NodeFilter.FILTER_ACCEPT;if(!t.ignoreAccessibiliy&&!this.isAccessible(e))return NodeFilter.FILTER_REJECT;if(!t.ignoreGroupper){var n=void 0,o=void 0;n=i.groupper,o=i.mover;var r=i.isGroupperFirst;if(n&&r?o=void 0:o&&!r&&(n=void 0),n&&void 0!==(s=n.acceptElement(e,t)))return s;if(o){var s=o.acceptElement(e,t);if(void 0!==s)return s}}return t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},e}(),_t={Tab:9,Enter:13,Esc:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40},vt=function(e){function t(i,n){var o=e.call(this)||this;return o._init=function(){o._initTimer=void 0;var e=o._win();e.document.addEventListener(fe,o._onFocusIn,!0),e.document.addEventListener("focusout",o._onFocusOut,!0),e.addEventListener("keydown",o._onKeyDown,!0)},o._onFocusIn=function(e){o._setFocusedElement(e.target,e.details.relatedTarget||void 0,e.details.isFocusedProgrammatically)},o._onFocusOut=function(e){o._setFocusedElement(void 0,e.relatedTarget||void 0)},o._onKeyDown=function(e){var i;if(e.keyCode===_t.Tab){var n=o.getVal();if(n&&n.ownerDocument&&"true"!==n.contentEditable){var r=Ve.getTabsterContext(o._tabster,n,{checkRtl:!0});if(r){var s=e.shiftKey,u=t.findNextTabbable(o._tabster,r,n,s);if(u){var c=u.uncontrolled;if(c)r.uncontrolled||o._moveToUncontrolled(c,s);else{var l=u.element;if(r.modalizer){var d=l&&Ve.getTabsterContext(o._tabster,l);if((!d||r.root.uid!==d.root.uid||!(null===(i=d.modalizer)||void 0===i?void 0:i.isActive()))&&r.modalizer.onBeforeFocusOut())return void e.preventDefault()}l?"IFRAME"!==l.tagName&&(e.preventDefault(),a(l)):r.root.moveOutWithDefaultAction(s)}}}}}},o._validateFocusedElement=function(e){},o._tabster=i,o._win=n,o._initTimer=n().setTimeout(o._init,0),o}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this);var i=this._win();this._initTimer&&(i.clearTimeout(this._initTimer),this._initTimer=void 0),i.document.removeEventListener(fe,this._onFocusIn,!0),i.document.removeEventListener("focusout",this._onFocusOut,!0),i.removeEventListener("keydown",this._onKeyDown,!0),delete t._lastResetElement,delete this._nextVal,delete this._lastVal},t.dispose=function(e){e.dispose()},t.forgetMemorized=function(e,i){var n,o,r=t._lastResetElement,s=r&&r.get();s&&i.contains(s)&&delete t._lastResetElement,(s=null===(o=null===(n=e._nextVal)||void 0===n?void 0:n.element)||void 0===o?void 0:o.get())&&i.contains(s)&&delete e._nextVal,(s=(r=e._lastVal)&&r.get())&&i.contains(s)&&delete e._lastVal},t.prototype.getFocusedElement=function(){return this.getVal()},t.prototype.getLastFocusedElement=function(){var e,t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!M(t.ownerDocument,t))&&(this._lastVal=t=void 0),t},t.prototype.focus=function(e,t,i){return!!this._tabster.focusable.isFocusable(e,t,!1,i)&&(e.focus(),!0)},t.prototype.focusDefault=function(e){var t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)},t.prototype.focusFirst=function(e){var i,n=e.container;if(n){var o=Ve.getTabsterContext(this._tabster,n,{checkRtl:!0});if(o){var r=t.findNextTabbable(this._tabster,o,n);r&&!r.uncontrolled&&(i=r.element)}}return i||(i=this._tabster.focusable.findFirst(e))||(i=this._tabster.focusable.findFirst(ce(ce({},e),{ignoreUncontrolled:!0,ignoreAccessibiliy:!0}))),!!i&&(this.focus(i,!1,!0),!0)},t.prototype.focusLast=function(e){var i,n=e.container;if(n){var o=Ve.getTabsterContext(this._tabster,n,{checkRtl:!0});if(o){var r=t.findNextTabbable(this._tabster,o,L(n),!0);r&&!r.uncontrolled&&(i=r.element)}}return i||(i=this._tabster.focusable.findLast(e))||(i=this._tabster.focusable.findLast(ce(ce({},e),{ignoreUncontrolled:!0,ignoreAccessibiliy:!0}))),!!i&&(this.focus(i,!1,!0),!0)},t.prototype.resetFocus=function(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{var i=e.getAttribute("tabindex"),n=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),t._lastResetElement=new xe(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",i),this._setOrRemoveAttribute(e,"aria-hidden",n)}return!0},t.prototype._setOrRemoveAttribute=function(e,t,i){null===i?e.removeAttribute(t):e.setAttribute(t,i)},t.prototype._setFocusedElement=function(e,i,n){var o;if(!this._tabster._noop){var r={relatedTarget:i};if(e){var s=null===(o=t._lastResetElement)||void 0===o?void 0:o.get();if(t._lastResetElement=void 0,s===e||C(e))return;r.isFocusedProgrammatically=n}var a=this._nextVal={element:e?new xe(this._win,e):void 0,details:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===a&&this.setVal(e,r),this._nextVal=void 0}},t.prototype.setVal=function(t,i){e.prototype.setVal.call(this,t,i),t&&(this._lastVal=new xe(this._win,t))},t.findNextTabbable=function(e,t,i,n){var o,r=null;if(i)o=i;else{var s=t.root.getElement();if(!s)return null;o=L(s)||s}if(t.groupper&&t.mover)t.isGroupperFirst?null===(r=t.groupper.findNextTabbable(o,n))&&(r=t.mover.findNextTabbable(o,n)):null===(r=t.mover.findNextTabbable(o,n))&&(r=t.groupper.findNextTabbable(o,n));else if(t.groupper)r=t.groupper.findNextTabbable(o,n);else if(t.mover)r=t.mover.findNextTabbable(o,n);else{var a,u=function(e){a=e};r={element:n?e.focusable.findPrev({currentElement:o,onUncontrolled:u}):e.focusable.findNext({currentElement:o,onUncontrolled:u}),uncontrolled:a}}return r},t.prototype._moveToUncontrolled=function(e,t){var i=new ze(this._win,!0,function(){},function(){},void 0).input;if(i){var n=e.parentElement;n&&(n.insertBefore(i,t?e.nextElementSibling:e),a(i))}},t}(Oe),pt=function(e){function t(t,i,n){var o=e.call(this,t,i,n)||this;return o._shouldTabInside=!1,o.makeTabbable(!1),o}return n(t,e),t.prototype.dispose=function(){this._element.get();delete this._first},t.prototype.findNextTabbable=function(e,t){var i=this.getElement();if(!i||!i.contains(e))return null;var n,o=this._tabster,r=null,s=function(e){n=e};if(this._shouldTabInside){var a=this.getFirst();if(a){var u=t?a:L(a),c=void 0;(c=u?(t?o.focusable.findPrev({container:i,currentElement:u,ignoreUncontrolled:!0}):o.focusable.findNext({container:i,currentElement:u,ignoreUncontrolled:!0}))?i:a:i)&&(r=t?o.focusable.findPrev({container:c,currentElement:e,onUncontrolled:s}):o.focusable.findNext({container:c,currentElement:e,onUncontrolled:s}),n||r||this._props.tabbability!==ke.LimitedTrapFocus||(r=t?o.focusable.findLast({container:c}):o.focusable.findFirst({container:c})))}}if(null===r){var l=i.parentElement;if(l){var d=Ve.getTabsterContext(o,l);if(d)return vt.findNextTabbable(o,d,e,t)}}return{element:r,uncontrolled:n}},t.prototype.makeTabbable=function(e){this._shouldTabInside=e},t.prototype.shouldTabInside=function(){return this._shouldTabInside},t.prototype.isActive=function(){for(var e,t=this.getElement()||null,i=!0,n=null===t||void 0===t?void 0:t.parentElement;n;n=n.parentElement){var o=null===(e=f(this._tabster,n))||void 0===e?void 0:e.groupper;o&&(o._shouldTabInside||(i=!1))}return i?!!this._props.tabbability&&this._shouldTabInside:void 0},t.prototype.getFirst=function(){var e,t,i=this.getElement();return i&&((t=null===(e=this._first)||void 0===e?void 0:e.get())||(t=(this._tabster.focusable.isFocusable(i)?i:this._tabster.focusable.findFirst({container:i,ignoreUncontrolled:!0}))||void 0)),t},t.prototype.setFirst=function(e){e?this._first=new xe(this._tabster.getWindow,e):delete this._first},t.prototype.acceptElement=function(e,t){var i=t.grouppers,n=t.container,o=i[this.id];if(!o){var r=this.isActive(),s=this.getElement();if(s){var a=s!==n&&n.contains(s);if(o=i[this.id]={isInside:a,isActive:r},a&&!0!==r){var u=this.getFirst();if(u&&t.acceptCondition(u)){var c=this._tabster.focusedElement.getFocusedElement();o.first=u,c&&this.setFirst(s.contains(c)?void 0:u)}}}}if(o.isInside){if(void 0===o.isActive)return NodeFilter.FILTER_REJECT;if(!1===o.isActive)return o.first===e?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},t}(Le),mt=function(){function e(e,t){var i=this;this._current={},this._init=function(){i._initTimer=void 0;var e=i._win();i._tabster.focusedElement.subscribe(i._onFocus),e.document.addEventListener("mousedown",i._onMouseDown,!0),e.addEventListener("keydown",i._onKeyDown,!0)},this._onFocus=function(e){e&&i._updateCurrent(e,!1,!0)},this._onMouseDown=function(e){e.target&&i._updateCurrent(e.target,!0)},this._onKeyDown=function(e){var t,n;if(e.keyCode===_t.Enter||e.keyCode===_t.Esc){var o=i._tabster.focusedElement.getFocusedElement();if(o){var r=null===(t=Ve.getTabsterContext(i._tabster,o))||void 0===t?void 0:t.groupper;if(r){var s=void 0;if(e.keyCode===_t.Enter){var u=r.getFirst();if(u!==o||r.isActive())return;(s=i._tabster.focusable.findFirst({container:u,ignoreGroupper:!0}))&&i._updateCurrent(s)}else if(e.keyCode===_t.Esc)for(var c=o;c;c=c.parentElement){var l=null===(n=f(i._tabster,c))||void 0===n?void 0:n.groupper;if(l&&(l.isActive()||!l.getProps().tabbability)&&(l.makeTabbable(!1),s=l.getFirst()))break}s&&(e.preventDefault(),a(s))}}}},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0)}return e.prototype.dispose=function(){var e=this._win();this._current={},this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0)},e.dispose=function(e){e.dispose()},e.prototype.forgetCurrentGrouppers=function(){this._current={}},e.prototype._updateCurrent=function(e,t,i){for(var n,o={},r=!0,s=e;s;s=s.parentElement)(l=null===(n=f(this._tabster,s))||void 0===n?void 0:n.groupper)&&(o[l.id]=!0,!r||!i||l.shouldTabInside()||l.getProps().tabbability&&(s===e||!this._tabster.focusable.isFocusable(s)&&e===l.getFirst())||(r=!1),!t&&r||(this._current[l.id]=l,l.makeTabbable(!0)),r=!1);for(var a=0,u=Object.keys(this._current);a<u.length;a++){var c=u[a],l=this._current[c];l.id in o||(l.makeTabbable(!1),l.setFirst(void 0),delete this._current[c])}},e.createGroupper=function(e,t,i){return new pt(e,t,i)},e}(),bt=0,gt=function(e){function t(t,i,n,o){var r=e.call(this,t,i,o)||this;r._isFocused=!1,r.internalId="ml"+ ++bt,r.userId=o.id,r._onDispose=n;var s=i.parentElement;return r._modalizerParent=s?new xe(t.getWindow,s):null,r._setAccessibilityProps(),r}return n(t,e),t.prototype.setProps=function(e){e.id&&(this.userId=e.id),this._props=ce({},e),this._setAccessibilityProps()},t.prototype.dispose=function(){this._onDispose(this),this._remove()},t.prototype.setActive=function(e){var t,i,n,o=this;if(e!==this._isActive){this._isActive=e;var r=(null===(t=this._element.get())||void 0===t?void 0:t.ownerDocument)||(null===(n=null===(i=this._modalizerParent)||void 0===i?void 0:i.get())||void 0===n?void 0:n.ownerDocument);r||(r=this._tabster.getWindow().document);var s=w(r,r.body,function(t){var i;if(o._props.isOthersAccessible)return NodeFilter.FILTER_REJECT;var n=o._element.get(),r=null===(i=o._modalizerParent)||void 0===i?void 0:i.get(),s=n===t,a=!!t.contains(n||null),u=!!t.contains(r||null);if(s)return NodeFilter.FILTER_REJECT;if(a||u)return NodeFilter.FILTER_SKIP;_(o._tabster,t,"aria-hidden",e?"true":void 0);var c=n!==(null===n||void 0===n?void 0:n.ownerDocument.body)&&(null===n||void 0===n?void 0:n.ownerDocument.body.contains(n));return r!==(null===r||void 0===r?void 0:r.ownerDocument.body)&&(null===r||void 0===r?void 0:r.ownerDocument.body.contains(r))||c?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP});if(s)for(;s.nextNode(););}},t.prototype.isActive=function(){return!!this._isActive},t.prototype.contains=function(e){var t;return!!(null===(t=this.getElement())||void 0===t?void 0:t.contains(e))},t.prototype.onBeforeFocusOut=function(){var e=this.getElement();return!!e&&!z(e,"tabster:modalizer",{eventName:"beforefocusout"})},t.prototype._remove=function(){},t.prototype._setAccessibilityProps=function(){},t}(Le),yt=function(){function e(e){var t=this;this._init=function(){t._initTimer=void 0,t._tabster.focusedElement.subscribe(t._onFocus)},this._onModalizerDispose=function(e){e.setActive(!1),t._curModalizer===e&&(t._curModalizer=void 0),delete t._modalizers[e.userId]},this.updateModalizer=function(e,i){i&&(e.isActive()&&e.setActive(!1),delete t._modalizers[e.userId],t._curModalizer===e&&(t._curModalizer=void 0))},this._onFocus=function(e,i){var n,o,r,s=e&&Ve.getTabsterContext(t._tabster,e);if(s&&e){t._focusOutTimer&&(t._win().clearTimeout(t._focusOutTimer),t._focusOutTimer=void 0);var a=null===s||void 0===s?void 0:s.modalizer;if(a!==t._curModalizer)if(i.isFocusedProgrammatically&&!(null===(n=t._curModalizer)||void 0===n?void 0:n.contains(e)))null===(o=t._curModalizer)||void 0===o||o.setActive(!1),t._curModalizer=void 0,a&&(t._curModalizer=a,t._curModalizer.setActive(!0));else if(!(null===(r=t._curModalizer)||void 0===r?void 0:r.getProps().isOthersAccessible)){var u=t._win();u.clearTimeout(t._restoreModalizerFocusTimer),t._restoreModalizerFocusTimer=u.setTimeout(function(){return t._restoreModalizerFocus(e)},100)}}},this._tabster=e,this._win=e.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._modalizers={}}return e.prototype.dispose=function(){var e=this,t=this._win();this._initTimer&&(t.clearTimeout(this._initTimer),this._initTimer=void 0),t.clearTimeout(this._restoreModalizerFocusTimer),t.clearTimeout(this._focusOutTimer),Object.keys(this._modalizers).forEach(function(t){e._modalizers[t]&&(e._modalizers[t].dispose(),delete e._modalizers[t])}),this._tabster.focusedElement.unsubscribe(this._onFocus),delete this._curModalizer},e.dispose=function(e){e.dispose()},e.prototype.focus=function(e,t,i){var n=Ve.getTabsterContext(this._tabster,e);if(n&&n.modalizer){this._curModalizer=n.modalizer,this._curModalizer.setActive(!0);var o=this._curModalizer.getProps(),r=this._curModalizer.getElement();if(r){if(void 0===t&&(t=o.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:r}))return!0;if(void 0===i&&(i=o.isNoFocusDefault),!i&&this._tabster.focusedElement.focusDefault(r))return!0;this._tabster.focusedElement.resetFocus(r)}}return!1},e.prototype.getActiveModalizer=function(){return this._curModalizer},e.updateModalizer=function(e,t,i){if(i&&e.modalizer){var n=e.modalizer;t.isActive()&&t.setActive(!1),delete n._modalizers[t.userId],n._curModalizer===t&&(n._curModalizer=void 0)}},e.prototype._restoreModalizerFocus=function(e){if((null===e||void 0===e?void 0:e.ownerDocument)&&this._curModalizer){var t=this._tabster.focusable.findFirst({container:this._curModalizer.getElement()});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&!(t=this._tabster.focusable.findLast({container:e.ownerDocument.body})))throw new Error("Something went wrong.");this._tabster.focusedElement.focus(t)}else e.blur()}},e.createModalizer=function(e,t,i){var n,o=e.modalizer,r=new gt(e,t,o._onModalizerDispose,i);if(o._modalizers[i.id]=r,t.contains(null!==(n=e.focusedElement.getFocusedElement())&&void 0!==n?n:null)){var s=o._curModalizer;s&&s.setActive(!1),o._curModalizer=r,o._curModalizer.setActive(!0)}return r},e}(),wt=["input","textarea","*[contenteditable]"].join(", "),Tt=200,Et=function(e){function t(i,n,o){var r=e.call(this,i,n,o)||this;return r._visible={},r._prevVisible={},r._hasFullyVisible=!1,r._focusables={},r._domChanged=function(){var e;r._domChangedTimer=void 0;var t=r.getElement();if(t){for(var i=r._tabster.focusable.findAll({container:t}),n={},o=r._focusables,s=0;s<i.length;s++){var a=i[s],u=o[d=R(r._win,a)];u||(u=new xe(r._win,a)),n[d]=u}for(var c=0,l=Object.keys(o);c<l.length;c++){var d=l[c];if(!(d in n)){var f=o[d].get();delete o[d],delete r._visible[d],f&&(null===(e=r._current)||void 0===e?void 0:e.get())===f&&r.setCurrent(void 0)}}r._focusables=n,r._updateVisible(!0)}},t._movers[r.id]=r,r._win=i.getWindow,(r._props.trackState||r._props.visibilityAware)&&(r._observeState(),r._domChangedTimer=i.getWindow().setTimeout(r._domChanged,0)),r}return n(t,e),t.prototype.dispose=function(){this._focusables={},this._unobserve&&(this._unobserve(),this._unobserve=void 0);var e=this._win();this._updateVisibleTimer&&(e.clearTimeout(this._updateVisibleTimer),this._updateVisibleTimer=void 0),this._domChangedTimer&&(e.clearTimeout(this._domChangedTimer),this._domChangedTimer=void 0),this._onChangeTimer&&(e.clearTimeout(this._onChangeTimer),this._onChangeTimer=void 0),delete t._movers[this.id]},t.prototype.setCurrent=function(e){return this._current=e?new xe(this._win,e):void 0,(this._props.trackState||this._props.visibilityAware)&&this._processOnChange(),!1},t.prototype.getCurrent=function(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null},t.prototype.findNextTabbable=function(e,t){var i=this.getElement();if(!i||!i.contains(e))return null;var n,o=this._tabster,r=o.focusable,s=null,a=function(e){n=e};if(this._props.tabbable&&(s=t?r.findPrev({currentElement:e,container:i,onUncontrolled:a}):r.findNext({currentElement:e,container:i,onUncontrolled:a})),null===s){var u=i.parentElement;if(u){var c=Ve.getTabsterContext(o,u);if(c){var l=(t?i:r.findLast({container:i}))||i;return vt.findNextTabbable(o,c,l,t)}}}return{element:s,uncontrolled:n}},t.prototype.acceptElement=function(e,t){var i,n,o=this._props,r=o.memorizeCurrent,s=o.visibilityAware;if(r||s){var a=this.getElement();if(a){if(r){var u=null===(i=this._current)||void 0===i?void 0:i.get();if(u&&t.acceptCondition(u)&&t.from&&!a.contains(t.from))return t.found=!0,t.foundElement=u,NodeFilter.FILTER_ACCEPT}if(s&&!a.contains(t.from)){var c=Object.keys(this._visible),l=void 0;t.isForward||c.reverse();for(var d=0,f=c;d<f.length;d++){var h=f[d],_=this._visible[h];if((_===Ie.Visible||_===Ie.PartiallyVisible&&(s===Ie.PartiallyVisible||!this._hasFullyVisible))&&(l=null===(n=this._focusables[h])||void 0===n?void 0:n.get())&&t.acceptCondition(l))return t.found=!0,t.foundElement=l,NodeFilter.FILTER_ACCEPT}}}}},t.prototype._observeState=function(){var e=this,t=this.getElement();if(!this._unobserve&&t&&"undefined"!=typeof MutationObserver){var i=new MutationObserver(function(t){var i=e._win();e._domChangedTimer&&i.clearTimeout(e._domChangedTimer),e._domChangedTimer=i.setTimeout(e._domChanged,0)});i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=function(){i.disconnect()}}},t.prototype.forceUpdate=function(){this._processOnChange(!0)},t.prototype._processOnChange=function(e){var t=this;if(!this._onChangeTimer||e){var i=function(){t._onChangeTimer=void 0;var e=[];if(t._current!==t._prevCurrent&&(e.push(t._current),e.push(t._prevCurrent),t._prevCurrent=t._current),t._visible!==t._prevVisible){t._hasFullyVisible=!1;for(var i=0,n=Object.keys(t._visible);i<n.length;i++){var o=n[i],r=t._visible[o];r!==t._prevVisible[o]&&e.push(t._focusables[o]),r===Ie.Visible&&(t._hasFullyVisible=!0)}for(var s=0,a=Object.keys(t._prevVisible);s<a.length;s++){o=a[s];t._visible[o]!==t._prevVisible[o]&&e.push(t._focusables[o])}t._prevVisible=t._visible}for(var u={},c=0,l=e;c<l.length;c++){var d=l[c],f=null===d||void 0===d?void 0:d.get();if((o=f&&R(t._win,f))&&!u[o]&&(u[o]=!0,t._focusables[o])){var h=t._props;if(f&&(void 0!==h.visibilityAware||h.trackState)){var _=t.getState(f);_&&z(f,"tabster:mover",_)}}}};this._onChangeTimer&&this._win().clearTimeout(this._onChangeTimer),e?i():this._onChangeTimer=this._win().setTimeout(i,0)}},t.prototype.getState=function(e){var t=R(this._win,e);if(t in this._visible){var i=this._visible[t]||Ie.Invisible;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:i}}},t.prototype._updateVisible=function(e){var t,i=this,n=this._element.get();if(!this._updateVisibleTimer&&n){if(e)for(var o=n.parentElement;o;o=o.parentElement){var r=null===(t=f(this._tabster,o))||void 0===t?void 0:t.mover;r&&r._updateVisible(!1)}this._updateVisibleTimer=this._win().setTimeout(function(){i._updateVisibleTimer=void 0;for(var e=!1,t={},n=0,o=Object.keys(i._focusables);n<o.length;n++){var r=o[n],s=i._focusables[r].get(),a=s?F(i._win,s,10):Ie.Invisible,u=i._visible[r]||Ie.Invisible;a!==Ie.Invisible&&(t[r]=a),u!==a&&(e=!0)}e&&(i._prevVisible=i._visible,i._visible=t,i._processOnChange())},0)}},t.updateVisible=function(e){for(var i={},n=0,o=e;n<o.length;n++)for(var r=o[n],s=0,a=Object.keys(t._movers);s<a.length;s++){var u=a[s],c=t._movers[u],l=c.getElement();l&&r.contains(l)&&(i[c.id]=c)}for(var d=0,f=Object.keys(i);d<f.length;d++)i[u=f[d]]._updateVisible(!1)},t._movers={},t}(Le),Ft=function(){function e(e,t){var i=this;this._scrollTargets=[],this._init=function(){i._initTimer=void 0;var e=i._win();e.addEventListener("scroll",i._onScroll,!0),e.addEventListener("keydown",i._onKeyDown,!0)},this._onFocus=function(e){for(var t,n=e;n;n=n.parentElement){var o=null===(t=f(i._tabster,n))||void 0===t?void 0:t.mover;if(o){o.setCurrent(e);break}}},this._onScroll=function(e){for(var t=!1,n=0,o=i._scrollTargets;n<o.length;n++)if(o[n]===e.target){t=!0;break}!t&&e.target.contains&&i._scrollTargets.push(e.target);var r=i._win();i._scrollTimer&&r.clearTimeout(i._scrollTimer),i._scrollTimer=r.setTimeout(function(){i._scrollTimer=void 0,Et.updateVisible(i._scrollTargets),i._scrollTargets=[]},Tt)},this._onKeyDown=function(e){var t=e.keyCode;switch(t){case _t.Down:case _t.Right:case _t.Up:case _t.Left:case _t.PageDown:case _t.PageUp:case _t.Home:case _t.End:break;default:return}if(!e.shiftKey){var n=i._tabster,o=n.focusedElement.getFocusedElement();if(o&&!i._isIgnoredInput(o,t)){var r=Ve.getTabsterContext(n,o,{checkRtl:!0});if(r&&r.mover&&!(r.isGroupperFirst&&r.groupper&&r.groupper.isActive())){var s=r.mover,u=s.getElement();if(u){var c,l=n.focusable,d=s.getProps(),f=d.direction||De.Both,h=f===De.Both,_=h||f===De.Vertical,v=h||f===De.Horizontal,p=f===De.Grid,m=d.cyclic;if(!d.disableHomeEndKeys||t!==_t.Home&&t!==_t.End){if(r.isRtl&&(t===_t.Right?t=_t.Left:t===_t.Left&&(t=_t.Right)),t===_t.Down&&_||t===_t.Right&&v)!(c=l.findNext({currentElement:o,container:u}))&&m&&(c=l.findFirst({container:u}));else if(t===_t.Up&&_||t===_t.Left&&v)!(c=l.findPrev({currentElement:o,container:u}))&&m&&(c=l.findLast({container:u}));else if(t===_t.Home)c=l.findFirst({container:u});else if(t===_t.End)c=l.findLast({container:u});else if(t===_t.PageUp){for(var b=l.findPrev({currentElement:o,container:u}),g=null;b;)g=b,b=E(i._win,b)?l.findPrev({currentElement:b,container:u}):null;(c=g)&&I(i._win,c,!1)}else if(t===_t.PageDown){for(var y=l.findNext({currentElement:o,container:u}),w=null;y;)w=y,y=E(i._win,y)?l.findNext({currentElement:y,container:u}):null;(c=w)&&I(i._win,c,!0)}else if(p){for(var T=o.getBoundingClientRect(),F=void 0,D=void 0,k=t===_t.Down||t===_t.Right?"findNext":"findPrev",C=l[k]({currentElement:o,container:u});C;C=l[k]({currentElement:C,container:u})){var O=C.getBoundingClientRect();if(t===_t.Up){if(O.top<T.top){if(void 0===D)D=O.top;else if(O.top<D)break;if(O.left<T.left){c||(c=C);break}c=C}}else if(t===_t.Down){if(O.top>T.top){if(void 0===D)D=O.top;else if(O.top>D)break;if(O.left>T.left){c||(c=C);break}c=C}}else if(t===_t.Left||t===_t.Right){c=C;break}F=C}c||(c=F)}c&&(e.preventDefault(),e.stopImmediatePropagation(),a(c))}}}}}},this._tabster=e,this._win=t,this._initTimer=t().setTimeout(this._init,0),e.focusedElement.subscribe(this._onFocus)}return e.prototype.dispose=function(){var e=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._scrollTimer&&(e.clearTimeout(this._scrollTimer),this._scrollTimer=void 0),e.removeEventListener("scroll",this._onScroll,!0),this._scrollTargets=[],e.removeEventListener("keydown",this._onKeyDown,!0)},e.dispose=function(e){e.dispose()},e.prototype._isIgnoredInput=function(e,t){if(U(e,wt)&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName)){var i=e.selectionStart||0;if(i!==(e.selectionEnd||0))return!0;if(i>0&&(t===_t.Left||t===_t.Up||t===_t.Home))return!0;if(i<(e.value||"").length&&(t===_t.Right||t===_t.Down||t===_t.End))return!0}return!1},e.createMover=function(e,t,i){return new Et(e,t,i)},e}(),It=function(e){function t(t){var i=e.call(this)||this;return i._waiting={},i._lastRequestFocusId=0,i._observedById={},i._observedByName={},i._currentRequestTimestamp=0,i._init=function(){i._initTimer=void 0,i._tabster.focusedElement.subscribe(i._onFocus)},i._onFocus=function(e){if(e){var t=i._currentRequest;if(t){Date.now()-i._currentRequestTimestamp>=300&&(delete i._currentRequest,t.cancel())}}},i.onObservedElementUpdate=function(e){var t,n=null===(t=f(i._tabster,e))||void 0===t?void 0:t.observed,o=R(i._win,e),r=i._observedById[o];if(n&&M(e.ownerDocument,e)){r||(r=i._observedById[o]={element:new xe(i._win,e)});var s=n.name;if(s!==(u=r.prevName)){if(u){var a=i._observedByName[u];a&&a[o]&&(Object.keys(a).length>1?delete a[o]:delete i._observedByName[u])}r.prevName=s}(c=i._observedByName[s])||(c=i._observedByName[s]={}),c[o]=r,i._waitConditional(s)}else if(r){var u=r.prevName;if(u){var c=i._observedByName[u];c&&c[o]&&(Object.keys(c).length>1?delete c[o]:delete i._observedByName[u])}delete i._observedById[o]}},i._tabster=t,i._win=t.getWindow,i._initTimer=i._win().setTimeout(i._init,0),i}return n(t,e),t.prototype.dispose=function(){var e=this._win();this._initTimer&&(e.clearTimeout(this._initTimer),this._initTimer=void 0),this._tabster.focusedElement.unsubscribe(this._onFocus);for(var t=0,i=Object.keys(this._waiting);t<i.length;t++){var n=i[t];this._rejectWaiting(n)}this._observedById={},this._observedByName={}},t.prototype._rejectWaiting=function(e,t){var i=this._waiting[e];if(i){var n=this._win();i.timer&&n.clearTimeout(i.timer),i.conditionTimer&&n.clearTimeout(i.conditionTimer),!t&&i.reject?i.reject():t&&i.resolve&&i.resolve(null),delete this._waiting[e]}},t.dispose=function(e){e.dispose()},t.prototype.getElement=function(e,t){var i=this._observedByName[e];if(i)for(var n=0,o=Object.keys(i);n<o.length;n++){var r=o[n],s=i[r].element.get()||null;return s?(t===Ee.Accessible&&!this._tabster.focusable.isAccessible(s)||t===Ee.Focusable&&!this._tabster.focusable.isFocusable(s,!0))&&(s=null):(delete i[r],delete this._observedById[r]),s}return null},t.prototype.waitElement=function(e,t,i){var n=this,o=this.getElement(e,i);if(o)return{result:P(this._win).resolve(o),cancel:function(){}};var r,s=(r=i===Ee.Accessible?"a":i===Ee.Focusable?"f":"_")+e,a=this._waiting[s];if(a&&a.request)return a.request;a=this._waiting[s]={timer:this._win().setTimeout(function(){a.conditionTimer&&n._win().clearTimeout(a.conditionTimer),delete n._waiting[s],a.resolve&&a.resolve(null)},t)};var u=new(P(this._win))(function(e,t){a.resolve=e,a.reject=t});return a.request={result:u,cancel:function(){n._rejectWaiting(s,!0)}},i&&this.getElement(e)&&this._waitConditional(e),a.request},t.prototype.requestFocus=function(e,t){var i=this,n=++this._lastRequestFocusId,o=this._currentRequest;o&&o.cancel();var r=this.waitElement(e,t,Ee.Focusable);return this._currentRequest=r,this._currentRequestTimestamp=Date.now(),r.result.finally(function(){i._currentRequest===r&&delete i._currentRequest}),{result:r.result.then(function(e){return!(i._lastRequestFocusId!==n||!e)&&i._tabster.focusedElement.focus(e,!0)}),cancel:function(){r.cancel()}}},t.prototype._waitConditional=function(e){var t=this,i="_"+e,n="a"+e,o="f"+e,r=this._waiting[i],s=this._waiting[n],a=this._waiting[o],u=this._win(),c=function(i,n,o,r){var s,a=null===(s=f(t._tabster,i))||void 0===s?void 0:s.observed;a&&a.name===e&&(o.timer&&u.clearTimeout(o.timer),delete t._waiting[n],o.resolve&&o.resolve(i),t.trigger(i,{name:e,details:a.details,accessibility:r}))};if(r){var l=this.getElement(e);l&&M(l.ownerDocument,l)&&c(l,i,r,Ee.Any)}if(s&&!s.conditionTimer){!function i(){var o=t.getElement(e);o&&M(o.ownerDocument,o)&&t._tabster.focusable.isAccessible(o)?c(o,n,s,Ee.Accessible):s.conditionTimer=u.setTimeout(i,100)}()}if(a&&!a.conditionTimer){!function i(){var n=t.getElement(e);n&&M(n.ownerDocument,n)&&t._tabster.focusable.isFocusable(n,!0)?c(n,o,a,Ee.Focusable):a.conditionTimer=u.setTimeout(i,100)}()}},t}(Oe),Dt={areaClass:"tabster-focus-outline-area",outlineClass:"tabster-focus-outline",outlineColor:"#ff4500",outlineWidth:2,zIndex:2147483647},kt=Dt;"undefined"!=typeof document&&("onfullscreenchange"in document?(Me="fullscreenchange",Ue="fullscreenElement"):"onwebkitfullscreenchange"in document?(Me="webkitfullscreenchange",Ue="webkitFullscreenElement"):"onmozfullscreenchange"in document?(Me="mozfullscreenchange",Ue="mozFullScreenElement"):"onmsfullscreenchange"in document&&(Me="msfullscreenchange",Ue="msFullscreenElement"));var Ct=function(){function e(e,t,i,n){this.left=e,this.top=t,this.right=i,this.bottom=n}return e.prototype.equalsTo=function(e){return this.left===e.left&&this.top===e.top&&this.right===e.right&&this.bottom===e.bottom},e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e}(),Ot=function(){function e(t){var i=this;this._isVisible=!1,this._allOutlineElements=[],this._init=function(){i._initTimer=void 0,i._tabster.keyboardNavigation.subscribe(i._onKeyboardNavigationStateChanged),i._tabster.focusedElement.subscribe(i._onFocus);var e=i._win();e.addEventListener("scroll",i._onScroll,!0),Me&&e.document.addEventListener(Me,i._onFullScreenChanged)},this._onFullScreenChanged=function(e){if(Ue&&e.target){var t=e.target.body||e.target,n=i._getDOM(t);if(t.ownerDocument&&n){var o=t.ownerDocument[Ue];o?(o.appendChild(n.container),i._fullScreenElement=o):(t.ownerDocument.body.appendChild(n.container),i._fullScreenElement=void 0)}}},this._onKeyboardNavigationStateChanged=function(){i._onFocus(i._tabster.focusedElement.getFocusedElement())},this._onFocus=function(e){!i._updateElement(e)&&i._isVisible&&i._setVisibility(!1)},this._onScroll=function(t){i._outlinedElement&&e._isParentChild(t.target,i._outlinedElement)&&(i._curPos=void 0,i._setOutlinePosition())},this._tabster=t,this._win=t.getWindow,this._initTimer=this._win().setTimeout(this._init,0)}return e.prototype.setup=function(e){kt=ce(ce({},kt),e);var t=this._win();t.__tabsterOutline||(t.__tabsterOutline={}),t.__tabsterOutline.style||(t.__tabsterOutline.style=K(t.document,kt)),e&&e.areaClass?t.document.body.classList.remove(Dt.areaClass):t.document.body.classList.add(Dt.areaClass)},e.prototype.dispose=function(){var e=this,t=this._win();this._initTimer&&(t.clearTimeout(this._initTimer),this._initTimer=void 0),this._updateTimer&&(t.clearTimeout(this._updateTimer),this._updateTimer=void 0),this._tabster.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),this._tabster.focusedElement.unsubscribe(this._onFocus),t.removeEventListener("scroll",this._onScroll,!0),Me&&t.document.removeEventListener(Me,this._onFullScreenChanged),this._allOutlineElements.forEach(function(t){return e._removeDOM(t.container)}),this._allOutlineElements=[],delete this._outlinedElement,delete this._curPos,delete this._curOutlineElements,delete this._fullScreenElement},e.dispose=function(e){e.dispose()},e.prototype._shouldShowCustomOutline=function(e){var t=f(this._tabster,e);if(t&&t.outline&&t.outline.isIgnored)return!1;for(var i=e;i;i=i.parentElement)if(i.classList&&i.classList.contains(kt.areaClass))return!0;return!1},e.prototype._updateElement=function(e){if(this._outlinedElement=void 0,this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._curPos=void 0,!this._tabster.keyboardNavigation.isNavigatingWithKeyboard())return!1;if(e){if("INPUT"===e.tagName){if(!(e.type in{button:!0,checkbox:!0,file:!0,image:!0,radio:!0,range:!0,reset:!0,submit:!0}))return!1}else if("TEXTAREA"===e.tagName||"true"===e.contentEditable||"IFRAME"===e.tagName)return!1;return!!this._shouldShowCustomOutline(e)&&(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&(this._outlinedElement=e,this._updateOutline()),!0)}return!1},e.prototype._updateOutline=function(){var e=this;this._setOutlinePosition(),this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._outlinedElement&&(this._updateTimer=this._win().setTimeout(function(){e._updateTimer=void 0,e._updateOutline()},30))},e.prototype._setVisibility=function(e){this._isVisible=e,this._curOutlineElements&&(e?this._curOutlineElements.container.classList.add(kt.outlineClass+"_visible"):(this._curOutlineElements.container.classList.remove(kt.outlineClass+"_visible"),this._curPos=void 0))},e.prototype._setOutlinePosition=function(){if(this._outlinedElement){var e=T(this._win,this._outlinedElement),t=new Ct(e.left,e.top,e.right,e.bottom);if(!this._curPos||!t.equalsTo(this._curPos)){var i=this._getDOM(this._outlinedElement),n=this._outlinedElement.ownerDocument&&this._outlinedElement.ownerDocument.defaultView;if(i&&n){this._curOutlineElements!==i&&(this._setVisibility(!1),this._curOutlineElements=i),this._curPos=t;var o=t.clone(),r=!1,s=!1,a=i.container,u=a&&a.ownerDocument&&a.ownerDocument.scrollingElement;if(u){for(var c=this._outlinedElement.parentElement;c&&c!==this._fullScreenElement;c=c.parentElement){e=T(this._win,c);var l=c.ownerDocument&&c.ownerDocument.defaultView;if(!l)return;var d=l.getComputedStyle(c),f=d.position;"absolute"===f?r=!0:"fixed"!==f&&"sticky"!==f||(s=!0),"visible"!==d.overflow&&((r||s)&&"hidden"!==d.overflow||(e.left>o.left&&(o.left=e.left),e.top>o.top&&(o.top=e.top),e.right<o.right&&(o.right=e.right),e.bottom<o.bottom&&(o.bottom=e.bottom)))}var h=T(this._win,u),_=h.left+h.right,v=h.top+h.bottom,p=kt.outlineWidth;o.left=o.left>p?o.left-p:0,o.top=o.top>p?o.top-p:0,o.right=o.right<_-p?o.right+p:_,o.bottom=o.bottom<v-p?o.bottom+p:v;var m=o.right-o.left,b=o.bottom-o.top;if(m>2*p&&b>2*p){var g=i.left,y=i.top,w=i.right,E=i.bottom,F=this._fullScreenElement||s?0:n.pageXOffset,I=this._fullScreenElement||s?0:n.pageYOffset;a.style.position=s?"fixed":"absolute",a.style.background=kt.outlineColor,g.style.width=w.style.width=y.style.height=E.style.height=kt.outlineWidth+"px",g.style.left=y.style.left=E.style.left=o.left+F+"px",w.style.left=o.left+F+m-p+"px",g.style.top=w.style.top=y.style.top=o.top+I+"px",E.style.top=o.top+I+b-p+"px",g.style.height=w.style.height=b+"px",y.style.width=E.style.width=m+"px",this._setVisibility(!0)}else this._setVisibility(!1)}}}}},e.prototype._getDOM=function(e){var t=e.ownerDocument,i=t&&t.defaultView;if(t&&i&&i.__tabsterOutline){if(i.__tabsterOutline.style||(i.__tabsterOutline.style=K(t,kt)),!i.__tabsterOutline.elements){var n={container:t.createElement("div"),left:t.createElement("div"),top:t.createElement("div"),right:t.createElement("div"),bottom:t.createElement("div")};n.container.className=kt.outlineClass,n.left.className=kt.outlineClass+"__left",n.top.className=kt.outlineClass+"__top",n.right.className=kt.outlineClass+"__right",n.bottom.className=kt.outlineClass+"__bottom",n.container.appendChild(n.left),n.container.appendChild(n.top),n.container.appendChild(n.right),n.container.appendChild(n.bottom),t.body.appendChild(n.container),i.__tabsterOutline.elements=n,this._allOutlineElements.push(n)}return i.__tabsterOutline.elements}},e.prototype._removeDOM=function(e){var t=e.ownerDocument&&e.ownerDocument.defaultView,i=t&&t.__tabsterOutline;if(i){i.style&&i.style.parentNode&&(i.style.parentNode.removeChild(i.style),delete i.style);var n=i&&i.elements;n&&(n.container.parentNode&&n.container.parentNode.removeChild(n.container),delete i.elements)}},e._isParentChild=function(e,t){return t===e||!!(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_CONTAINED_BY)},e}(),Rt=function(){return function(e){}}(),Nt=function(){function e(e,t){var i=this;this._forgetMemorizedElements=[],this._version="1.0.1",this._noop=!1,this.getWindow=function(){if(!i._win)throw new Error("Using disposed Tabster.");return i._win},this._storage=m(e),this._win=e;var n=this.getWindow;this.keyboardNavigation=new Re(n),this.focusedElement=new vt(this,n),this.focusable=new ht(this,n),this.root=new Ve(this,function(){var e;null===(e=i.groupper)||void 0===e||e.forgetCurrentGrouppers()},null===t||void 0===t?void 0:t.autoRoot),this.createRoot=Ve.createRoot,this.updateRoot=function(e,t){Ve.onRoot(i.root,e,t)},this.uncontrolled=new Rt(this),this.internal={stopObserver:function(){i._unobserve&&(i._unobserve(),delete i._unobserve)},resumeObserver:function(e){if(!i._unobserve){var t=n().document;i._unobserve=j(t,i,h,e)}}},this.internal.resumeObserver(!1),g(n)}return e.prototype.dispose=function(){this.internal.stopObserver();var e=this._win;this._forgetMemorizedElements=[],e&&this._forgetMemorizedTimer&&(e.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer);for(var t={outlineDispose:["outline"],crossOriginDispose:["crossOrigin"],deloserDispose:["deloser","createDeloser"],groupperDispose:["groupper","createGroupper"],moverDispose:["mover","createMover"],modalizerDispose:["modalizer","createModalizer","updateModalizer"],observedElementDispose:["observedElement","updateObserved"]},i=0,n=Object.keys(t);i<n.length;i++){var o=n[i],r=this[o];if(r){r();for(var s=0,a=t[o];s<a.length;s++){var u=a[s];this[u]&&delete this[u]}delete this[o]}}Re.dispose(this.keyboardNavigation),ht.dispose(this.focusable),vt.dispose(this.focusedElement),Ve.dispose(this.root),y(this.getWindow),A(this.getWindow),this._storage=new WeakMap,e&&(p(e),delete e.__tabsterInstance,delete this._win)},e.dispose=function(e){e.dispose()},e.prototype.storageEntry=function(e,t){var i=this._storage,n=i.get(e);return n?!1===t&&0===Object.keys(n).length&&i.delete(e):!0===t&&(n={},i.set(e,n)),n},e.forceCleanup=function(e){e._win&&(e._forgetMemorizedElements.push(e._win.document.body),e._forgetMemorizedTimer||(e._forgetMemorizedTimer=e._win.setTimeout(function(){delete e._forgetMemorizedTimer;for(var t=e._forgetMemorizedElements.shift();t;t=e._forgetMemorizedElements.shift())A(e.getWindow,t),vt.forgetMemorized(e.focusedElement,t)},0),b(e.getWindow,!0)))},e}()}},[2956]);
//# sourceMappingURL=[[staticsPath]]/hashed/lazy-ng1-mod-focus-management-services.min-c542f45.js.map