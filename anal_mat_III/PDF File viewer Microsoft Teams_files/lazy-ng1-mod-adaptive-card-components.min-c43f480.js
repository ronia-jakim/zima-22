webpackJsonp([7],{145:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.HostCapabilities=void 0;var r=n(49),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._capabilities={},t}return i(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var i in t){var o=t[i];if("string"==typeof o)if("*"===o)this.addCapability(i,"*");else{var a=r.Version.parse(o,n);(null===a||void 0===a?void 0:a.isValid)&&this.addCapability(i,a)}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);for(var i in this._capabilities)t[i]=this._capabilities[i]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(r.SerializableObject);t.HostCapabilities=o},146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalRegistry=t.CardObjectRegistry=t.ElementSingletonBehavior=void 0;var i,r=n(49);!function(e){e[e.Only=0]="Only",e[e.Allowed=1]="Allowed",e[e.NotAllowed=2]="NotAllowed"}(i=t.ElementSingletonBehavior||(t.ElementSingletonBehavior={}));var o=function(){function e(){this._items={}}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){for(var t=0,n=Object.keys(this._items);t<n.length;t++){var i=n[t],r=this._items[i];e.register(r.typeName,r.objectType,r.schemaVersion,r.singletonBehavior)}},e.prototype.register=function(e,t,n,o){void 0===n&&(n=r.Versions.v1_0),void 0===o&&(o=i.NotAllowed);var a=this.findByName(e);void 0!==a?a.objectType=t:a={typeName:e,objectType:t,schemaVersion:n,singletonBehavior:o},this._items[e]=a},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.createInstance=function(e,t){var n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map(function(e){return t._items[e]})[e]},e}();t.CardObjectRegistry=o;var a=function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new o,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new o,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new o,e.defaultActions=new o,e}();t.GlobalRegistry=a},147:function(e,t,n){"use strict";function i(e){var t,n,i="undefined"==typeof window?"":null!==(n=null===(t=window.trustedTypes)||void 0===t?void 0:t.emptyHTML)&&void 0!==n?n:"";e.innerHTML=i}function r(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var i=document.createElement("div");i.className=e.makeCssClassName("ac-"+(n===m.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),i.setAttribute("aria-hidden","true");var r=t.lineColor?b.stringToCssColor(t.lineColor):"";return n===m.Orientation.Horizontal?t.lineThickness?(i.style.paddingTop=t.spacing/2+"px",i.style.marginBottom=t.spacing/2+"px",i.style.borderBottom=t.lineThickness+"px solid "+r):i.style.height=t.spacing+"px":t.lineThickness?(i.style.paddingLeft=t.spacing/2+"px",i.style.marginRight=t.spacing/2+"px",i.style.borderRight=t.lineThickness+"px solid "+r):i.style.width=t.spacing+"px",i.style.overflow="hidden",i.style.flex="0 0 auto",i}}function o(e){var t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:Oe.onImageLoaded;n&&n(e)}function a(e,t,n){var i=e.getRootElement(),r=i&&i.onAnchorClicked?i.onAnchorClicked:Oe.onAnchorClicked;return void 0!==r&&r(e,t,n)}function s(e){var t=e.parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:Oe.onExecuteAction;e.prepareForExecution()&&n&&n(e)}function l(e,t){var n=e.parent?e.parent.getRootElement():void 0,i=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:Oe.onInlineCardExpanded;i&&i(e,t)}function c(e){var t=e.getRootElement(),n=t&&t.onInputValueChanged?t.onInputValueChanged:Oe.onInputValueChanged;n&&n(e)}function p(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var i=n,r=i&&i.onElementVisibilityChanged?i.onElementVisibilityChanged:Oe.onElementVisibilityChanged;void 0!==r&&r(e)}function u(e,t){var n=e.parent?e.parent.getRootElement():void 0,i=n&&n.onDisplayOverflowActionMenu?n.onDisplayOverflowActionMenu:Oe.onDisplayOverflowActionMenu;return void 0!==i&&i(e.getActions(),t)}function d(e,t){var n=e.parent?e.parent.getRootElement():void 0,i=n&&n.onRenderOverflowActions?n.onRenderOverflowActions:Oe.onRenderOverflowActions;return void 0!==i&&i(e.getActions(),t)}var h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),f=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},y=this&&this.__awaiter||function(e,t,n,i){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):r(e.value).then(a,s)}l((i=i.apply(e,t||[])).next())})},g=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.ContainerBase=t.StylableCardElementContainer=t.ContainerStyleProperty=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.YouTubePlayer=t.DailymotionPlayer=t.VimeoPlayer=t.IFrameMediaMediaPlayer=t.CustomMediaPlayer=t.HTML5MediaPlayer=t.MediaPlayer=t.MediaSource=t.CaptionSource=t.ContentSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=t.renderSeparation=void 0,t.SerializationContext=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=void 0;var m=n(37),v=n(43),b=n(48),C=n(97),S=n(2830),A=n(328),_=n(49),w=n(146),P=n(57),E=n(2831);t.renderSeparation=r;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._truncatedDueToOverflow=!1,t}return h(t,e),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){v.GlobalSettings.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.updateRenderedElementVisibility(),this._renderedElement&&p(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",e.toString())},enumerable:!1,configurable:!0}),t.prototype.internalRenderSeparator=function(){var e=r(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(v.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation===m.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e},t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(e?this._renderedElement.style.display=e:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":e?this._separatorElement.style.display=e:this._separatorElement.style.removeProperty("display"))},t.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,p(this,!1))},t.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,p(this,!1))},t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},t.prototype.resetOverflow=function(){var e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),e},t.prototype.getDefaultSerializationContext=function(){return new Ve},t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition(),t=b.stringToCssColor(e.foregroundColors.default.subtle),n=document.createElement("div");return n.style.border="1px dashed "+t,n.style.padding="4px",n.style.minHeight="32px",n.style.fontSize="10px",t&&(n.style.color=t),n.innerText="Empty "+this.getJsonTypeName(),n},t.prototype.adjustRenderedElementSize=function(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto"},t.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===m.Orientation.Horizontal)if(v.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new v.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=function(){return new v.PaddingDefinition},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return m.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return m.ContainerStyle.Default},enumerable:!1,configurable:!0}),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n||new Ve)},t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getForbiddenActionTypes=function(){return[]},t.prototype.getImmediateSurroundingPadding=function(e,t,n,i,r){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),this.parent){var o=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),s=i&&this.parent.isBottomElement(this),l=r&&this.parent.isLeftMostElement(this),c=this.parent.getEffectivePadding();c&&(o&&c.top!==m.Spacing.None&&(e.top=c.top,o=!1),a&&c.right!==m.Spacing.None&&(e.right=c.right,a=!1),s&&c.bottom!==m.Spacing.None&&(e.bottom=c.bottom,s=!1),l&&c.left!==m.Spacing.None&&(e.left=c.left,l=!1)),(o||a||s||l)&&this.parent.getImmediateSurroundingPadding(e,o,a,s,l)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(P.Strings.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.remove=function(){return!!(this.parent&&this.parent instanceof L)&&this.parent.removeItem(this)},t.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this.getRootElement().updateActionsEnabledState(),this._renderedElement},t.prototype.updateLayout=function(e){void 0===e&&(e=!0),this.updateRenderedElementVisibility(),this.applyPadding()},t.prototype.updateActionsEnabledState=function(){for(var e=0,t=this.getRootElement().getAllActions();e<t.length;e++)t[e].updateEnabledState()},t.prototype.indexOf=function(e){return-1},t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof Oe&&e.designMode},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"===this._renderedElement.style.visibility},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof Ae)return e;e=e.parent}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():m.HorizontalAlignment.Left},Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:C.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.prototype.getElementSingletonBehavior=function(){return w.ElementSingletonBehavior.NotAllowed},t.langProperty=new _.StringProperty(_.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),t.isVisibleProperty=new _.BoolProperty(_.Versions.v1_2,"isVisible",!0),t.separatorProperty=new _.BoolProperty(_.Versions.v1_0,"separator",!1),t.heightProperty=new _.ValueSetProperty(_.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new _.EnumProperty(_.Versions.v1_0,"horizontalAlignment",m.HorizontalAlignment),t.spacingProperty=new _.EnumProperty(_.Versions.v1_0,"spacing",m.Spacing,m.Spacing.Default),f([(0,_.property)(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),f([(0,_.property)(t.spacingProperty)],t.prototype,"spacing",void 0),f([(0,_.property)(t.separatorProperty)],t.prototype,"separator",void 0),f([(0,_.property)(t.heightProperty)],t.prototype,"height",void 0),f([(0,_.property)(t.langProperty)],t.prototype,"lang",null),f([(0,_.property)(t.isVisibleProperty)],t.prototype,"isVisible",null),t}(A.CardObject);t.CardElement=x;var I=function(e){function t(t,n,i){void 0===i&&(i=[]);var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r.forbiddenActionTypes=i,r}return h(t,e),t.prototype.parse=function(e,t,n){var i=e;return n.parseAction(i,t[this.name],this.forbiddenActionTypes,i.isDesignMode())},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):void 0,void 0,!0)},t}(_.PropertyDefinition);t.ActionProperty=I;var T=function(e){function t(t){var n=e.call(this)||this;return n.ariaHidden=!1,t&&(n.text=t),n}return h(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.effectiveSize){case m.TextSize.Small:return e.fontSizes.small;case m.TextSize.Medium:return e.fontSizes.medium;case m.TextSize.Large:return e.fontSizes.large;case m.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.getColorDefinition=function(e,t){switch(t){case m.TextColor.Accent:return e.accent;case m.TextColor.Dark:return e.dark;case m.TextColor.Light:return e.light;case m.TextColor.Good:return e.good;case m.TextColor.Warning:return e.warning;case m.TextColor.Attention:return e.attention;default:return e.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);t.fontFamily&&(e.style.fontFamily=t.fontFamily);var n;switch(this.effectiveSize){case m.TextSize.Small:n=t.fontSizes.small;break;case m.TextSize.Medium:n=t.fontSizes.medium;break;case m.TextSize.Large:n=t.fontSizes.large;break;case m.TextSize.ExtraLarge:n=t.fontSizes.extraLarge;break;default:n=t.fontSizes.default}e.style.fontSize=n+"px";var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),r=b.stringToCssColor(this.effectiveIsSubtle?i.subtle:i.default);r&&(e.style.color=r);var o;switch(this.effectiveWeight){case m.TextWeight.Lighter:o=t.fontWeights.lighter;break;case m.TextWeight.Bolder:o=t.fontWeights.bolder;break;default:o=t.fontWeights.default}e.style.fontWeight=o.toString(),this.ariaHidden&&e.setAttribute("aria-hidden","true")},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),t.textProperty=new _.StringProperty(_.Versions.v1_0,"text",!0),t.sizeProperty=new _.EnumProperty(_.Versions.v1_0,"size",m.TextSize),t.weightProperty=new _.EnumProperty(_.Versions.v1_0,"weight",m.TextWeight),t.colorProperty=new _.EnumProperty(_.Versions.v1_0,"color",m.TextColor),t.isSubtleProperty=new _.BoolProperty(_.Versions.v1_0,"isSubtle"),t.fontTypeProperty=new _.EnumProperty(_.Versions.v1_2,"fontType",m.FontType),t.selectActionProperty=new I(_.Versions.v1_1,"selectAction",["Action.ShowCard"]),f([(0,_.property)(t.sizeProperty)],t.prototype,"size",void 0),f([(0,_.property)(t.weightProperty)],t.prototype,"weight",void 0),f([(0,_.property)(t.colorProperty)],t.prototype,"color",void 0),f([(0,_.property)(t.fontTypeProperty)],t.prototype,"fontType",void 0),f([(0,_.property)(t.isSubtleProperty)],t.prototype,"isSubtle",void 0),f([(0,_.property)(t.textProperty)],t.prototype,"text",null),f([(0,_.property)(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(x);t.BaseTextBlock=T;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!1,t._treatAsPlainText=!0,t.useMarkdown=!0,t}h(t,e),t.prototype.restoreOriginalContent=function(){var e,n;if(void 0!==this.renderedElement){this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px");var i=null!==(n=null===(e=t._ttRoundtripPolicy)||void 0===e?void 0:e.createHTML(this._originalInnerHtml))&&void 0!==n?n:this._originalInnerHtml;this.renderedElement.innerHTML=i}},t.prototype.truncateIfSupported=function(e){if(void 0!==this.renderedElement){var t=this.renderedElement.children,n=!t.length;if(n||1===t.length&&"p"===t[0].tagName.toLowerCase()&&!t[0].children.length){var i=n?this.renderedElement:t[0];return b.truncateText(i,e,this._computedLineHeight),!0}}return!1},t.prototype.setText=function(t){e.prototype.setText.call(this,t),this._processedText=void 0},t.prototype.internalRender=function(){var e,n,i=this;if(this._processedText=void 0,this.text){var r=this.preProcessPropertyValue(T.textProperty),o=this.hostConfig,s=void 0;if(this.forElementId){var l=document.createElement("label");l.htmlFor=this.forElementId,s=l}else s=document.createElement("div");if(s.classList.add(o.makeCssClassName("ac-textBlock")),s.style.overflow="hidden",this.applyStylesTo(s),"heading"===this.style){s.setAttribute("role","heading");var c=this.hostConfig.textBlock.headingLevel;void 0!==c&&c>0&&s.setAttribute("aria-level",c.toString())}if(this.selectAction&&o.supportsInteractivity&&(s.onclick=function(e){i.selectAction&&i.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,i.selectAction.execute())},this.selectAction.setupElementForAccessibility(s),this.selectAction.isEffectivelyEnabled()&&s.classList.add(o.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;var p=S.formatText(this.lang,r);if(this.useMarkdown&&p){v.GlobalSettings.allowMarkForTextHighlighting&&(p=p.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var u=Oe.applyMarkdown(p);if(u.didProcess&&u.outputHtml){if(this._processedText=u.outputHtml,this._treatAsPlainText=!1,v.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var d="",h=this.getEffectiveStyleDefinition();h.highlightBackgroundColor&&(d+="background-color: "+h.highlightBackgroundColor+";"),h.highlightForegroundColor&&(d+="color: "+h.highlightForegroundColor+";"),d&&(d='style="'+d+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+d+">").replace(/\/==\//g,"</mark>")}}else this._processedText=p,this._treatAsPlainText=!0}else this._processedText=p,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText)s.innerText=this._processedText;else{var f=null!==(n=null===(e=t._ttMarkdownPolicy)||void 0===e?void 0:e.createHTML(this._processedText))&&void 0!==n?n:this._processedText;s.innerHTML=f}if(s.firstElementChild instanceof HTMLElement){var y=s.firstElementChild;y.style.marginTop="0px",y.style.width="100%",this.wrap||(y.style.overflow="hidden",y.style.textOverflow="ellipsis")}s.lastElementChild instanceof HTMLElement&&(s.lastElementChild.style.marginBottom="0px");for(var g=s.getElementsByTagName("a"),m=0,C=Array.from(g);m<C.length;m++)!function(e){e.classList.add(o.makeCssClassName("ac-anchor")),e.target="_blank",e.onclick=function(t){a(i,e,t)&&(t.preventDefault(),t.cancelBubble=!0)},e.oncontextmenu=function(t){return!a(i,e,t)||(t.preventDefault(),t.cancelBubble=!0,!1)}}(C[m]);return this.wrap?(s.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(s.style.overflow="hidden",b.isInternetExplorer()||!v.GlobalSettings.useWebkitLineClamp?s.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(s.style.removeProperty("line-height"),s.style.display="-webkit-box",s.style.webkitBoxOrient="vertical",s.style.webkitLineClamp=this.maxLines.toString()))):(s.style.whiteSpace="nowrap",s.style.textOverflow="ellipsis"),(v.GlobalSettings.useAdvancedTextBlockTruncation||v.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=s.innerHTML),s}},t.prototype.truncateOverflow=function(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)},t.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),v.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}},t.prototype.applyStylesTo=function(t){switch(e.prototype.applyStylesTo.call(this,t),this.getEffectiveHorizontalAlignment()){case m.HorizontalAlignment.Center:t.style.textAlign="center";break;case m.HorizontalAlignment.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this.hostConfig.lineHeights;if(n)switch(this.effectiveSize){case m.TextSize.Small:this._computedLineHeight=n.small;break;case m.TextSize.Medium:this._computedLineHeight=n.medium;break;case m.TextSize.Large:this._computedLineHeight=n.large;break;case m.TextSize.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));t.style.lineHeight=this._computedLineHeight+"px"},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),e.prototype.updateLayout.call(this,t),v.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))};var n,i;return t.wrapProperty=new _.BoolProperty(_.Versions.v1_0,"wrap",!1),t.maxLinesProperty=new _.NumProperty(_.Versions.v1_0,"maxLines"),t.styleProperty=new _.ValueSetProperty(_.Versions.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),t._ttMarkdownPolicy="undefined"==typeof window?void 0:null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("adaptivecards#markdownPassthroughPolicy",{createHTML:function(e){return e}}),t._ttRoundtripPolicy="undefined"==typeof window?void 0:null===(i=window.trustedTypes)||void 0===i?void 0:i.createPolicy("adaptivecards#restoreContentsPolicy",{createHTML:function(e){return e}}),f([(0,_.property)(t.wrapProperty)],t.prototype,"wrap",void 0),f([(0,_.property)(t.maxLinesProperty)],t.prototype,"maxLines",void 0),f([(0,_.property)(t.styleProperty)],t.prototype,"style",void 0),t}(T);t.TextBlock=k;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t.underline=!1,t}return h(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.add(T.selectActionProperty)},t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(T.textProperty),n=this.hostConfig,i=S.formatText(this.lang,t);i||(i="");var r=document.createElement("span");if(r.classList.add(n.makeCssClassName("ac-textRun")),this.applyStylesTo(r),this.selectAction&&n.supportsInteractivity){var o=document.createElement("a");o.classList.add(n.makeCssClassName("ac-anchor"));var a=this.selectAction.getHref();o.href=a||"",o.target="_blank",o.onclick=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(o),o.innerText=i,r.appendChild(o)}else r.innerText=i;return r}},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),i=b.stringToCssColor(this.effectiveIsSubtle?n.highlightColors.subtle:n.highlightColors.default);i&&(t.style.backgroundColor=i)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new _.BoolProperty(_.Versions.v1_2,"italic",!1),t.strikethroughProperty=new _.BoolProperty(_.Versions.v1_2,"strikethrough",!1),t.highlightProperty=new _.BoolProperty(_.Versions.v1_2,"highlight",!1),t.underlineProperty=new _.BoolProperty(_.Versions.v1_3,"underline",!1),f([(0,_.property)(t.italicProperty)],t.prototype,"italic",void 0),f([(0,_.property)(t.strikethroughProperty)],t.prototype,"strikethrough",void 0),f([(0,_.property)(t.highlightProperty)],t.prototype,"highlight",void 0),f([(0,_.property)(t.underlineProperty)],t.prototype,"underline",void 0),t}(T);t.TextRun=O;var R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inlines=[],t}return h(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(P.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!==this)throw new Error(P.Strings.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))for(var i=0,r=t.inlines;i<r.length;i++){var o=r[i],a=void 0;if("string"==typeof o){var s=new O;s.text=o,a=s}else a=n.parseElement(this,o,[],!1);a&&this.internalAddInline(a,!0)}},t.prototype.internalToJSON=function(t,n){if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){for(var i=[],r=0,o=this._inlines;r<o.length;r++){var a=o[r];i.push(a.toJSON(n))}n.serializeValue(t,"inlines",i)}},t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId,e=t}else e=document.createElement("div");switch(e.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),this.getEffectiveHorizontalAlignment()){case m.HorizontalAlignment.Center:e.style.textAlign="center";break;case m.HorizontalAlignment.Right:e.style.textAlign="end";break;default:e.style.textAlign="start"}for(var n=0,i=0,r=this._inlines;i<r.length;i++){var o=r[i].render();o&&(e.appendChild(o),n++)}if(n>0)return e}},t.prototype.asString=function(){for(var e="",t=0,n=this._inlines;t<n.length;t++)e+=n[t].asString();return e},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(P.Strings.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new O(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(x);t.RichTextBlock=R;var V=function(e){function t(t,n){var i=e.call(this)||this;return i.name=t,i.value=n,i}return h(t,e),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new _.StringProperty(_.Versions.v1_0,"title"),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),f([(0,_.property)(t.titleProperty)],t.prototype,"name",void 0),f([(0,_.property)(t.valueProperty)],t.prototype,"value",void 0),t}(_.SerializableObject);t.Fact=V;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=void 0,t=this.hostConfig;if(this.facts.length>0){(e=document.createElement("table")).style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset")),e.setAttribute("role","presentation");for(var n=0;n<this.facts.length;n++){var i=document.createElement("tr");n>0&&(i.style.marginTop=t.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(r.style.maxWidth=t.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new k;o.setParent(this),o.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name,o.size=t.factSet.title.size,o.color=t.factSet.title.color,o.isSubtle=t.factSet.title.isSubtle,o.weight=t.factSet.title.weight,o.wrap=t.factSet.title.wrap,o.spacing=m.Spacing.None,b.appendChild(r,o.render()),b.appendChild(i,r),(r=document.createElement("td")).style.width="10px",b.appendChild(i,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(t.makeCssClassName("ac-fact-value")),(o=new k).setParent(this),o.text=this.facts[n].value,o.size=t.factSet.value.size,o.color=t.factSet.value.color,o.isSubtle=t.factSet.value.isSubtle,o.weight=t.factSet.value.weight,o.wrap=t.factSet.value.wrap,o.spacing=m.Spacing.None,b.appendChild(r,o.render()),b.appendChild(i,r),b.appendChild(e,i)}}return e},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_0,"facts",V),f([(0,_.property)(t.factsProperty)],t.prototype,"facts",void 0),t}(x);t.FactSet=M;var B=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.targetVersion=t,o.name=n,o.internalName=i,o.fallbackProperty=r,o}return h(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var i=void 0,r=t[this.name];if(void 0===r)return this.defaultValue;var o=!1;if("string"==typeof r){try{var a=v.SizeAndUnit.parse(r,!0);a.unit===m.SizeUnit.Pixel&&(i=a.physicalSize,o=!0)}catch(e){}!o&&this.fallbackProperty&&(o=this.fallbackProperty.isValidValue(r,n))}return o||n.logParseEvent(e,m.ValidationEvent.InvalidPropertyValue,P.Strings.errors.invalidPropertyValue(r,this.name)),i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(_.PropertyDefinition),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.size=m.Size.Auto,t.style=m.ImageStyle.Default,t}return h(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(x.heightProperty)},t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case m.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case m.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case m.Size.Stretch:e.style.width="100%";break;case m.Size.Auto:e.style.maxWidth="100%";break;case m.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case m.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case m.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight="100%"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=void 0;if(this.url){(n=document.createElement("div")).style.display="flex",n.style.alignItems="flex-start";var i=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case m.HorizontalAlignment.Center:n.style.justifyContent="center";break;case m.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}var r=document.createElement("img");r.onload=function(t){o(e)},r.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();if(e.renderedElement,n&&n.designMode){var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.backgroundColor="#EEEEEE",i.style.color="black",i.innerText=":-(",i.style.padding="10px",e.applySize(i),e.renderedElement.appendChild(i)}}o(e)},r.style.minWidth="0",r.classList.add(i.makeCssClassName("ac-image")),this.selectAction&&i.supportsInteractivity&&(r.onkeypress=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&("Enter"===t.code||"Space"===t.code)&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},r.onclick=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(r),this.selectAction.isEffectivelyEnabled()&&r.classList.add(i.makeCssClassName("ac-selectable"))),this.applySize(r),this.style===m.ImageStyle.Person&&(r.style.borderRadius="50%",r.style.backgroundPosition="50% 50%",r.style.backgroundRepeat="no-repeat");var a=b.stringToCssColor(this.backgroundColor);a&&(r.style.backgroundColor=a),r.src=this.preProcessPropertyValue(t.urlProperty);var s=this.preProcessPropertyValue(t.altTextProperty);s&&(r.alt=s),n.appendChild(r)}return n},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},t.urlProperty=new _.StringProperty(_.Versions.v1_0,"url"),t.altTextProperty=new _.StringProperty(_.Versions.v1_0,"altText"),t.backgroundColorProperty=new _.StringProperty(_.Versions.v1_1,"backgroundColor"),t.styleProperty=new _.EnumProperty(_.Versions.v1_0,"style",m.ImageStyle,m.ImageStyle.Default),t.sizeProperty=new _.EnumProperty(_.Versions.v1_0,"size",m.Size,m.Size.Auto),t.pixelWidthProperty=new B(_.Versions.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new B(_.Versions.v1_1,"height","pixelHeight",x.heightProperty),t.selectActionProperty=new I(_.Versions.v1_1,"selectAction",["Action.ShowCard"]),f([(0,_.property)(t.urlProperty)],t.prototype,"url",void 0),f([(0,_.property)(t.altTextProperty)],t.prototype,"altText",void 0),f([(0,_.property)(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0),f([(0,_.property)(t.sizeProperty)],t.prototype,"size",void 0),f([(0,_.property)(t.styleProperty)],t.prototype,"style",void 0),f([(0,_.property)(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0),f([(0,_.property)(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0),f([(0,_.property)(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(x);t.Image=D;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowVerticalOverflow=!1,t}return h(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new v.SpacingDefinition;this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.forbiddenChildElements=function(){return[]},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this);for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).releaseDOMResources()},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var i=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&i.isInteractive&&t.addFailure(this,m.ValidationEvent.InteractivityNotAllowed,P.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(i)||t.addFailure(this,m.ValidationEvent.InteractivityNotAllowed,P.Strings.errors.elementTypeNotAllowed(i.getJsonTypeName())),i.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);if(n){var i=this.hostConfig;this.allowVerticalOverflow&&(n.style.overflowX="hidden",n.style.overflowY="auto"),n&&this.isSelectable&&this._selectAction&&i.supportsInteractivity&&(n.onclick=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},n.onkeypress=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},this._selectAction.setupElementForAccessibility(n),this._selectAction.isEffectivelyEnabled()&&n.classList.add(i.makeCssClassName("ac-selectable")))}return n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++)t.push.apply(t,this.getItemAt(n).getAllInputs(e));return t},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getItemCount();n++)t.push.apply(t,this.getItemAt(n).getAllActions());return this._selectAction&&t.push(this._selectAction),t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e.push.apply(e,this.getItemAt(t).getResourceInformation());return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var i=0;i<this.getItemCount()&&!(n=this.getItemAt(i).getElementById(t));i++);return n},t.prototype.findDOMNodeOwner=function(t){for(var n,i=void 0,r=0;r<this.getItemCount();r++)if(i=this.getItemAt(r).findDOMNodeOwner(t))return i;for(r=0;r<this.getActionCount();r++)if(i=null===(n=this.getActionAt(r))||void 0===n?void 0:n.findDOMNodeOwner(t))return i;return e.prototype.findDOMNodeOwner.call(this,t)},t.selectActionProperty=new I(_.Versions.v1_1,"selectAction",["Action.ShowCard"]),f([(0,_.property)(t.selectActionProperty)],t.prototype,"_selectAction",void 0),t}(x);t.CardElementContainer=L;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._images=[],t.imageSize=m.ImageSize.Medium,t}return h(t,e),t.prototype.internalRender=function(){var e=void 0;if(this._images.length>0){(e=document.createElement("div")).style.display="flex",e.style.flexWrap="wrap";for(var t=0,n=this._images;t<n.length;t++){var i=n[t];switch(this.imageSize){case m.ImageSize.Small:i.size=m.Size.Small;break;case m.ImageSize.Large:i.size=m.Size.Large;break;default:i.size=m.Size.Medium}i.maxHeight=this.hostConfig.imageSet.maxImageHeight;var r=i.render();r&&(r.style.display="inline-flex",r.style.margin="0px",r.style.marginRight="10px",b.appendChild(e,r))}}return e},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof D){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof D?this._images.indexOf(e):-1},t.imagesProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_0,"images",D,function(e,t){t.setParent(e)}),t.imageSizeProperty=new _.EnumProperty(_.Versions.v1_0,"imageSize",m.ImageSize,m.ImageSize.Medium),f([(0,_.property)(t.imagesProperty)],t.prototype,"_images",void 0),f([(0,_.property)(t.imageSizeProperty)],t.prototype,"imageSize",void 0),t}(L);t.ImageSet=N;var F=function(e){function t(t,n){var i=e.call(this)||this;return i.url=t,i.mimeType=n,i}return h(t,e),t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.mimeTypeProperty=new _.StringProperty(_.Versions.v1_1,"mimeType"),t.urlProperty=new _.StringProperty(_.Versions.v1_1,"url"),f([(0,_.property)(t.mimeTypeProperty)],t.prototype,"mimeType",void 0),f([(0,_.property)(t.urlProperty)],t.prototype,"url",void 0),t}(_.SerializableObject);t.ContentSource=F;var H=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.label=i,r}return h(t,e),t.prototype.getSchemaKey=function(){return"CaptionSource"},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("track")).src=this.url,e.kind="captions",e.label=this.label),e},t.labelProperty=new _.StringProperty(_.Versions.v1_6,"label"),f([(0,_.property)(t.labelProperty)],t.prototype,"label",void 0),t}(F);t.CaptionSource=H;var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("source")).src=this.url,e.type=this.mimeType),e},t}(F);t.MediaSource=z;var j=function(){function e(){}return e.prototype.play=function(){},Object.defineProperty(e.prototype,"posterUrl",{get:function(){return this._posterUrl},set:function(e){this._posterUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){},enumerable:!1,configurable:!0}),e}();t.MediaPlayer=j;var $=function(e){function t(t){var n=e.call(this)||this;return n.owner=t,n._selectedSources=[],n._captionSources=[],n.processSources(),n}return h(t,e),t.prototype.processSources=function(){var e;this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;for(var n=0,i=this.owner.sources;n<i.length;n++){var r=i[n],o=r.mimeType?r.mimeType.split("/"):[];if(2===o.length){if(!this._selectedMediaType){var a=t.supportedMediaTypes.indexOf(o[0]);a>=0&&(this._selectedMediaType=t.supportedMediaTypes[a])}o[0]===this._selectedMediaType&&this._selectedSources.push(r)}}(e=this._captionSources).push.apply(e,this.owner.captionSources)},t.prototype.canPlay=function(){return this._selectedSources.length>0},t.prototype.fetchVideoDetails=function(){return y(this,void 0,void 0,function(){return g(this,function(e){return[2]})})},t.prototype.render=function(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio"),this._mediaElement.setAttribute("aria-label",this.owner.altText?this.owner.altText:P.Strings.defaults.mediaPlayerAriaLabel()),this._mediaElement.setAttribute("webkit-playsinline",""),this._mediaElement.setAttribute("playsinline",""),this._mediaElement.setAttribute("crossorigin",""),this._mediaElement.autoplay=!0,this._mediaElement.controls=!0,b.isMobileOS()&&(this._mediaElement.muted=!0),this._mediaElement.preload="none",this._mediaElement.style.width="100%";for(var e=0,t=this.owner.sources;e<t.length;e++){var n=t[e].render();b.appendChild(this._mediaElement,n)}for(var i=0,r=this.owner.captionSources;i<r.length;i++){var o=r[i];if("vtt"==o.mimeType){var a=o.render();b.appendChild(this._mediaElement,a)}}return this._mediaElement},t.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.supportedMediaTypes=["audio","video"],t}(j);t.HTML5MediaPlayer=$;var U=function(e){function t(t){return e.call(this)||this}return h(t,e),t}(j);t.CustomMediaPlayer=U;var W=function(e){function t(t,n){var i=e.call(this,t)||this;return i.iFrameTitle=n,t.length>=2&&(i._videoId=t[1]),i}return h(t,e),t.prototype.canPlay=function(){return void 0!==this._videoId},t.prototype.render=function(){var e=document.createElement("div");e.style.position="relative",e.style.width="100%",e.style.height="0",e.style.paddingBottom="56.25%";var t=document.createElement("iframe");return t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.src=this.getEmbedVideoUrl(),t.frameBorder="0",this.iFrameTitle&&(t.title=this.iFrameTitle),t.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,e.appendChild(t),e},Object.defineProperty(t.prototype,"videoId",{get:function(){return this._videoId},enumerable:!1,configurable:!0}),t}(U);t.IFrameMediaMediaPlayer=W;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.fetchVideoDetails=function(){return y(this,void 0,void 0,function(){var e,t,n;return g(this,function(i){switch(i.label){case 0:return e="https://vimeo.com/api/oembed.json?url=".concat(this.getEmbedVideoUrl()),[4,fetch(e)];case 1:return(t=i.sent()).ok?[4,t.json()]:[3,3];case 2:n=i.sent(),this.posterUrl=n.thumbnail_url,i.label=3;case 3:return[2]}})})},t.prototype.getEmbedVideoUrl=function(){return"https://player.vimeo.com/video/".concat(this.videoId,"?autoplay=1")},t}(W);t.VimeoPlayer=G;var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.fetchVideoDetails=function(){return y(this,void 0,void 0,function(){var e,t,n;return g(this,function(i){switch(i.label){case 0:return e="https://api.dailymotion.com/video/".concat(this.videoId,"?fields=thumbnail_720_url"),[4,fetch(e)];case 1:return(t=i.sent()).ok?[4,t.json()]:[3,3];case 2:n=i.sent(),this.posterUrl=n.thumbnail_720_url,i.label=3;case 3:return[2]}})})},t.prototype.getEmbedVideoUrl=function(){return"https://www.dailymotion.com/embed/video/".concat(this.videoId,"?autoplay=1")},t}(W);t.DailymotionPlayer=J;var q=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.iFrameTitle=n,t.length>=3&&void 0!==t[2]&&(i._startTimeIndex=parseInt(t[2])),i}return h(t,e),t.prototype.fetchVideoDetails=function(){return y(this,void 0,void 0,function(){return g(this,function(e){return this.posterUrl=this.videoId?"https://img.youtube.com/vi/".concat(this.videoId,"/maxresdefault.jpg"):void 0,[2]})})},t.prototype.getEmbedVideoUrl=function(){var e="https://www.youtube.com/embed/".concat(this.videoId,"?autoplay=1");return void 0!==this._startTimeIndex&&(e+="&start=".concat(this._startTimeIndex)),e},t}(W);t.YouTubePlayer=q;var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sources=[],t.captionSources=[],t}return h(t,e),t.prototype.createMediaPlayer=function(){for(var e=0,n=t.customMediaPlayers;e<n.length;e++)for(var i=n[e],r=0,o=this.sources;r<o.length;r++){var a=o[r];if(a.url)for(var s=0,l=i.urlPatterns;s<l.length;s++){var c=l[s].exec(a.url);if(null!==c)return i.createMediaPlayer(c)}}return new $(this)},t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){if(e.preventDefault(),e.cancelBubble=!0,this.renderedElement){var n=this._mediaPlayer.render();i(this.renderedElement),this.renderedElement.appendChild(n),this._mediaPlayer.play(),n.focus()}}else t.onPlay&&(e.preventDefault(),e.cancelBubble=!0,t.onPlay(this))},t.prototype.displayPoster=function(){return y(this,void 0,void 0,function(){var e,t,n,r,o,a,s,l,c=this;return g(this,function(p){return this.renderedElement&&(e=12,t=15,(n=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-poster"),n.setAttribute("role","contentinfo"),n.setAttribute("aria-label",this.altText?this.altText:P.Strings.defaults.mediaPlayerAriaLabel()),n.style.position="relative",n.style.display="flex",(r=this.poster?this.poster:this._mediaPlayer.posterUrl)||(r=this.hostConfig.media.defaultPoster),r?((o=document.createElement("img")).style.width="100%",o.style.height="100%",o.setAttribute("role","presentation"),o.onerror=function(e){o.parentNode&&o.parentNode.removeChild(o),n.classList.add("empty"),n.style.minHeight="150px"},o.src=r,n.appendChild(o)):(n.classList.add("empty"),n.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&this._mediaPlayer.canPlay()&&((a=document.createElement("div")).tabIndex=0,a.setAttribute("role","button"),a.setAttribute("aria-label",P.Strings.defaults.mediaPlayerPlayMedia()),a.className=this.hostConfig.makeCssClassName("ac-media-playButton"),a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.onclick=function(e){c.handlePlayButtonInvoke(e)},a.onkeypress=function(e){"Enter"!==e.code&&"Space"!==e.code||c.handlePlayButtonInvoke(e)},(s=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),s.style.width=e+"px",s.style.height=t+"px",s.style.borderTopWidth=t/2+"px",s.style.borderBottomWidth=t/2+"px",s.style.borderLeftWidth=e+"px",s.style.borderRightWidth="0",s.style.borderStyle="solid",s.style.borderTopColor="transparent",s.style.borderRightColor="transparent",s.style.borderBottomColor="transparent",s.style.transform="translate("+e/10+"px,0px)",a.appendChild(s),(l=document.createElement("div")).style.position="absolute",l.style.left="0",l.style.top="0",l.style.width="100%",l.style.height="100%",l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.appendChild(a),n.appendChild(l)),i(this.renderedElement),this.renderedElement.appendChild(n)),[2]})})},t.prototype.internalRender=function(){var e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),e},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);return n&&(this._mediaPlayer=this.createMediaPlayer(),this._mediaPlayer.fetchVideoDetails().then(function(){return t.displayPoster()})),n},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.displayPoster()},t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=function(){var e=[];if(this._mediaPlayer){var t=this.poster?this.poster:this.hostConfig.media.defaultPoster;t&&e.push({url:t,mimeType:"image"})}for(var n=0,i=this.sources;n<i.length;n++){var r=i[n];r.isValid()&&e.push({url:r.url,mimeType:r.mimeType})}for(var o=0,a=this.captionSources;o<a.length;o++){var s=a[o];s.isValid()&&e.push({url:s.url,mimeType:s.mimeType})}return e},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._mediaPlayer.selectedMediaType},enumerable:!1,configurable:!0}),t.customMediaPlayers=[{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?youtube.com\/watch\?(?=.*v=([\w\d-_]+))(?=(?:.*t=(\d+))?).*/gi,/^(?:https?:\/\/)?youtu.be\/([\w\d-_]+)(?:\?t=(\d+))?/gi],createMediaPlayer:function(e){return new q(e,P.Strings.defaults.youTubeVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?vimeo.com\/([\w\d-_]+).*/gi],createMediaPlayer:function(e){return new G(e,P.Strings.defaults.vimeoVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?dailymotion.com\/video\/([\w\d-_]+).*/gi],createMediaPlayer:function(e){return new J(e,P.Strings.defaults.dailymotionVideoPlayer())}}],t.sourcesProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_1,"sources",z),t.captionSourcesProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_6,"captionSources",H),t.posterProperty=new _.StringProperty(_.Versions.v1_1,"poster"),t.altTextProperty=new _.StringProperty(_.Versions.v1_1,"altText"),f([(0,_.property)(t.sourcesProperty)],t.prototype,"sources",void 0),f([(0,_.property)(t.captionSourcesProperty)],t.prototype,"captionSources",void 0),f([(0,_.property)(t.posterProperty)],t.prototype,"poster",void 0),f([(0,_.property)(t.altTextProperty)],t.prototype,"altText",void 0),t}(x);t.Media=K;var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getAllLabelIds=function(){var e=[];return this.labelledBy&&e.push(this.labelledBy),this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e},t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();e.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var t=b.generateUniqueId();if(this.label){var n=new R;n.setParent(this),n.forElementId=t;var i=new O(this.label);if(n.addInline(i),this.isRequired){i.init(e.inputs.label.requiredInputs);var r=new O(e.inputs.label.requiredInputs.suffix);r.color=e.inputs.label.requiredInputs.suffixColor,r.ariaHidden=!0,n.addInline(r)}else i.init(e.inputs.label.optionalInputs);this._renderedLabelElement=n.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=b.generateUniqueId(),this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=t,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement;this.resetDirtyState()},t.prototype.valueChanged=function(){this.getRootElement().updateActionsEnabledState(),this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),c(this)},t.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&v.GlobalSettings.displayInputValidationErrors){var e=new k;e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=e.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=b.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},t.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},t.prototype.isValid=function(){return!0},t.prototype.isDirty=function(){return this.value!==this._oldValue},t.prototype.resetDirtyState=function(){this._oldValue=this.value},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,m.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,m.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!e&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},t.prototype.render=function(){var t=e.prototype.render.call(this);return this.resetDirtyState(),t},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.labelProperty=new _.StringProperty(_.Versions.v1_3,"label",!0),t.isRequiredProperty=new _.BoolProperty(_.Versions.v1_3,"isRequired",!1),t.errorMessageProperty=new _.StringProperty(_.Versions.v1_3,"errorMessage",!0),f([(0,_.property)(t.labelProperty)],t.prototype,"label",void 0),f([(0,_.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),f([(0,_.property)(t.errorMessageProperty)],t.prototype,"errorMessage",void 0),t}(x);t.Input=Q;var X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiline=!1,t.style=m.InputTextStyle.Text,t}return h(t,e),t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto",e.tabIndex=this.isDesignMode()?-1:0,this.placeholder&&(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(e.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=function(){t.valueChanged()},e.onkeypress=function(e){e.ctrlKey&&"Enter"===e.code&&t.inlineAction&&t.inlineAction.isEffectivelyEnabled()&&t.inlineAction.execute()}},t.prototype.internalRender=function(){var e;return this.isMultiline&&this.style!==m.InputTextStyle.Password?((e=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(e.style.height="initial")):((e=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),e.type=m.InputTextStyle[this.style].toLowerCase()),this.setupInput(e),e},t.prototype.overrideInternalRender=function(){var t=this,n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var i=document.createElement("button");if(i.className=this.hostConfig.makeCssClassName(this.inlineAction.isEffectivelyEnabled()?"ac-inlineActionButton":"ac-inlineActionButton-disabled"),i.onclick=function(e){t.inlineAction&&t.inlineAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,t.inlineAction.execute())},this.inlineAction.iconUrl){i.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%",r.setAttribute("role","presentation"),r.style.display="none",r.onload=function(){r.style.removeProperty("display")},r.onerror=function(){i.removeChild(r),i.classList.remove("iconOnly"),i.classList.add("textOnly"),i.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:P.Strings.defaults.inlineActionTitle()},r.src=this.inlineAction.iconUrl,i.appendChild(r),i.title=this.inlineAction.title?this.inlineAction.title:P.Strings.defaults.inlineActionTitle()}else i.classList.add("textOnly"),i.textContent=this.inlineAction.title?this.inlineAction.title:P.Strings.defaults.inlineActionTitle();this.inlineAction.setupElementForAccessibility(i,!0),i.style.marginLeft="8px",this.inputControlContainerElement.appendChild(i)}return n},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.inlineAction&&t.push(this.inlineAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),t.maxLengthProperty=new _.NumProperty(_.Versions.v1_0,"maxLength"),t.isMultilineProperty=new _.BoolProperty(_.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new _.StringProperty(_.Versions.v1_0,"placeholder"),t.styleProperty=new _.EnumProperty(_.Versions.v1_0,"style",m.InputTextStyle,m.InputTextStyle.Text,[{value:m.InputTextStyle.Text},{value:m.InputTextStyle.Tel},{value:m.InputTextStyle.Url},{value:m.InputTextStyle.Email},{value:m.InputTextStyle.Password,targetVersion:_.Versions.v1_5}]),t.inlineActionProperty=new I(_.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new _.StringProperty(_.Versions.v1_3,"regex",!0),f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.maxLengthProperty)],t.prototype,"maxLength",void 0),f([(0,_.property)(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),f([(0,_.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),f([(0,_.property)(t.styleProperty)],t.prototype,"style",void 0),f([(0,_.property)(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),f([(0,_.property)(t.regexProperty)],t.prototype,"regex",void 0),t}(Q);t.TextInput=X;var Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}return h(t,e),t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(e+=" "+this._checkboxInputLabelElement.id),e?this._checkboxInputElement.setAttribute("aria-labelledby",e):this._checkboxInputElement.removeAttribute("aria-labelledby")}},t.prototype.internalRender=function(){var e=this,t=document.createElement("div");if(t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),t.style.width="100%",t.style.display="flex",t.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=b.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue===this.valueOn&&(this._checkboxInputElement.checked=!0),this._oldCheckboxValue=this._checkboxInputElement.checked,this._checkboxInputElement.onchange=function(){e.valueChanged()},b.appendChild(t,this._checkboxInputElement),this.title||this.isDesignMode()){var n=new k;if(n.setParent(this),n.forElementId=this._checkboxInputElement.id,n.hostConfig=this.hostConfig,n.text=this.title?this.title:this.getJsonTypeName(),n.useMarkdown=v.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,n.wrap=this.wrap,this._checkboxInputLabelElement=n.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=b.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var i=document.createElement("div");i.style.width="6px",b.appendChild(t,i),b.appendChild(t,this._checkboxInputLabelElement)}}return t},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.isDirty=function(){return!!this._checkboxInputElement&&this._checkboxInputElement.checked!==this._oldCheckboxValue},Object.defineProperty(t.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),t.titleProperty=new _.StringProperty(_.Versions.v1_0,"title"),t.valueOnProperty=new _.StringProperty(_.Versions.v1_0,"valueOn",!0,void 0,"true",function(e){return"true"}),t.valueOffProperty=new _.StringProperty(_.Versions.v1_0,"valueOff",!0,void 0,"false",function(e){return"false"}),t.wrapProperty=new _.BoolProperty(_.Versions.v1_2,"wrap",!1),f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.titleProperty)],t.prototype,"title",void 0),f([(0,_.property)(t.valueOnProperty)],t.prototype,"valueOn",void 0),f([(0,_.property)(t.valueOffProperty)],t.prototype,"valueOff",void 0),f([(0,_.property)(t.wrapProperty)],t.prototype,"wrap",void 0),t}(Q);t.ToggleInput=Y;var Z=function(e){function t(t,n){var i=e.call(this)||this;return i.title=t,i.value=n,i}return h(t,e),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new _.StringProperty(_.Versions.v1_0,"title"),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),f([(0,_.property)(t.titleProperty)],t.prototype,"title",void 0),f([(0,_.property)(t.valueProperty)],t.prototype,"value",void 0),t}(_.SerializableObject);t.Choice=Z;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiSelect=!1,t.wrap=!1,t.choices=[],t}return h(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return!this.style||"compact"===this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.getUniqueCategoryName=function(){var e="__ac-category"+t._uniqueCategoryCounter;return t._uniqueCategoryCounter++,e},t.prototype.internalApplyAriaCurrent=function(){if(this._selectElement){var e=this._selectElement.options;if(e)for(var t=0,n=Array.from(e);t<n.length;t++){var i=n[t];i.selected?i.setAttribute("aria-current","true"):i.removeAttribute("aria-current")}}},t.prototype.renderCompoundInput=function(e,t,n){var i=this,r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",e),r.style.width="100%",r.tabIndex=this.isDesignMode()?-1:0,this._toggleInputs=[],this._labels=[];for(var o=0,a=this.choices;o<a.length;o++){var s=a[o],l=document.createElement("input");l.id=b.generateUniqueId(),l.type=t,l.style.margin="0",l.style.display="inline-block",l.style.verticalAlign="middle",l.style.flex="0 0 auto",l.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&l.setAttribute("aria-required","true"),l.tabIndex=this.isDesignMode()?-1:0,s.value&&(l.value=s.value),s.title&&l.setAttribute("aria-label",s.title),n&&s.value&&n.indexOf(s.value)>=0&&(l.checked=!0),l.onchange=function(){i.valueChanged()},this._toggleInputs.push(l);var c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",b.appendChild(c,l);var p=new k;p.setParent(this),p.forElementId=l.id,p.hostConfig=this.hostConfig,p.text=s.title?s.title:"Choice "+this._toggleInputs.length,p.useMarkdown=v.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap;var u=p.render();if(this._labels.push(u),u){u.id=b.generateUniqueId(),u.style.display="inline-block",u.style.flex="1 1 auto",u.style.marginLeft="6px",u.style.verticalAlign="middle";var d=document.createElement("div");d.style.width="6px",b.appendChild(c,d),b.appendChild(c,u)}b.appendChild(r,c)}return r},t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var t=this.getAllLabelIds(),n=0;n<this._toggleInputs.length;n++){var i=t.join(" "),r=this._labels[n];r&&r.id&&(i+=" "+r.id),i?this._toggleInputs[n].setAttribute("aria-labelledby",i):this._toggleInputs[n].removeAttribute("aria-labelledby")}else e.prototype.updateInputControlAriaLabelledBy.call(this)},t.prototype.internalRender=function(){var e=this;if(this._uniqueCategoryName=t.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);if("filtered"===this.style){var n=document.createElement("div");n.style.width="100%",this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-filtered"),this._textInput.type="text",this._textInput.style.width="100%",this._textInput.oninput=function(){e.valueChanged(),e._textInput&&(e.value?(e._textInput.removeAttribute("placeholder"),e._textInput.removeAttribute("aria-label")):e.placeholder&&(e._textInput.placeholder=e.placeholder,e._textInput.setAttribute("aria-label",e.placeholder)))},this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;var i=document.createElement("datalist");i.id=b.generateUniqueId();for(var r=0,o=this.choices;r<o.length;r++){var a=o[r],s=document.createElement("option");a.title&&(s.value=a.title,s.setAttribute("aria-label",a.title)),s.tabIndex=this.isDesignMode()?-1:0,i.appendChild(s)}return this._textInput.setAttribute("list",i.id),n.append(this._textInput,i),n}this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%",this._selectElement.tabIndex=this.isDesignMode()?-1:0;var l=document.createElement("option");l.selected=!0,l.disabled=!0,l.hidden=!0,l.value="",this.placeholder&&(l.text=this.placeholder),b.appendChild(this._selectElement,l);for(var c=0,p=this.choices;c<p.length;c++){a=p[c];(s=document.createElement("option")).value=a.value,a.title&&(s.text=a.title,s.setAttribute("aria-label",a.title)),s.tabIndex=this.isDesignMode()?-1:0,a.value===this.defaultValue&&(s.selected=!0),b.appendChild(this._selectElement,s)}return this._selectElement.onchange=function(){e.internalApplyAriaCurrent(),e.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():this._textInput?this._textInput.focus():e.prototype.focus.call(this)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.choices.length&&t.addFailure(this,m.ValidationEvent.CollectionCantBeEmpty,P.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var n=0,i=this.choices;n<i.length;n++){var r=i[n];r.title&&r.value||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(this._textInput){if(""===this.value||this.value===this.placeholder)return!0;for(var t=0,n=this.choices;t<n.length;t++){var i=n[t];if(this.value===i.value)return!0}return!1}return e.prototype.isValid.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0===this._toggleInputs.length)return;for(var e="",t=0,n=this._toggleInputs;t<n.length;t++){var i=n[t];i.checked&&(""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=i.value)}return e||void 0}if(this._selectElement)return this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._textInput){for(var r=0,o=this.choices;r<o.length;r++){var a=o[r];if(a.title&&this._textInput.value===a.title)return a.value}return this._textInput.value}if(this._toggleInputs&&this._toggleInputs.length>0)for(var s=0,l=this._toggleInputs;s<l.length;s++)if((i=l[s]).checked)return i.value},enumerable:!1,configurable:!0}),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),t.choicesProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_0,"choices",Z),t.styleProperty=new _.ValueSetProperty(_.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:_.Versions.v1_5}],"compact"),t.isMultiSelectProperty=new _.BoolProperty(_.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new _.StringProperty(_.Versions.v1_0,"placeholder"),t.wrapProperty=new _.BoolProperty(_.Versions.v1_2,"wrap",!1),t._uniqueCategoryCounter=0,f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.styleProperty)],t.prototype,"style",void 0),f([(0,_.property)(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),f([(0,_.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),f([(0,_.property)(t.wrapProperty)],t.prototype,"wrap",void 0),f([(0,_.property)(t.choicesProperty)],t.prototype,"choices",void 0),t}(Q);t.ChoiceSetInput=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.internalRender=function(){var e=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=this.isDesignMode()?-1:0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){e.valueChanged()},this._numberInputElement},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var e=!0;return void 0!==this.min&&(e=e&&this.value>=this.min),void 0!==this.max&&(e=e&&this.value<=this.max),e},Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},set:function(e){e&&this._numberInputElement&&(this._numberInputElement.value=e.toString())},enumerable:!1,configurable:!0}),t.valueProperty=new _.NumProperty(_.Versions.v1_0,"value"),t.placeholderProperty=new _.StringProperty(_.Versions.v1_0,"placeholder"),t.minProperty=new _.NumProperty(_.Versions.v1_0,"min"),t.maxProperty=new _.NumProperty(_.Versions.v1_0,"max"),f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.minProperty)],t.prototype,"min",void 0),f([(0,_.property)(t.maxProperty)],t.prototype,"max",void 0),f([(0,_.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(Q);t.NumberInput=te;var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.internalRender=function(){var e=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.tabIndex=this.isDesignMode()?-1:0,this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){e.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=new Date(this.value),t=!0;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var i=new Date(this.max);t=t&&e<=i}return t},Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new _.StringProperty(_.Versions.v1_0,"value"),t.placeholderProperty=new _.StringProperty(_.Versions.v1_0,"placeholder"),t.minProperty=new _.StringProperty(_.Versions.v1_0,"min"),t.maxProperty=new _.StringProperty(_.Versions.v1_0,"max"),f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.minProperty)],t.prototype,"min",void 0),f([(0,_.property)(t.maxProperty)],t.prototype,"max",void 0),f([(0,_.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(Q);t.DateInput=ne;var ie=function(e){function t(t,n){var i=e.call(this,t,n,function(e,t,n,i){var r=n[t.name];if("string"==typeof r&&r&&/^[0-9]{2}:[0-9]{2}$/.test(r))return r},function(e,t,n,i,r){r.serializeValue(n,t.name,i)})||this;return i.targetVersion=t,i.name=n,i}return h(t,e),t}(_.CustomProperty);t.TimeProperty=ie;var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")},t.prototype.internalRender=function(){var e=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this.min&&this._timeInputElement.setAttribute("min",this.min),this.max&&this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){e.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this._timeInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=t.convertTimeStringToDate(this.value),n=!0;if(this.min){var i=t.convertTimeStringToDate(this.min);n=n&&e>=i}if(this.max){var r=t.convertTimeStringToDate(this.max);n=n&&e<=r}return n},Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new ie(_.Versions.v1_0,"value"),t.placeholderProperty=new _.StringProperty(_.Versions.v1_0,"placeholder"),t.minProperty=new ie(_.Versions.v1_0,"min"),t.maxProperty=new ie(_.Versions.v1_0,"max"),f([(0,_.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),f([(0,_.property)(t.minProperty)],t.prototype,"min",void 0),f([(0,_.property)(t.maxProperty)],t.prototype,"max",void 0),f([(0,_.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(Q);t.TimeInput=re;var oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=m.ActionStyle.Default,t.mode=m.ActionMode.Primary,t._state=0,t._isFocusable=!0,t}return h(t,e),t.prototype.renderButtonContent=function(){if(this.renderedElement){var e=this.hostConfig,t=document.createElement("div");if(t.style.overflow="hidden",t.style.textOverflow="ellipsis",e.actions.iconPlacement===m.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(t.style.whiteSpace="nowrap"),this.title&&(t.innerText=this.title),this.iconUrl){var n=document.createElement("img");n.src=this.iconUrl,n.style.width=e.actions.iconSize+"px",n.style.height=e.actions.iconSize+"px",n.style.flex="0 0 auto",e.actions.iconPlacement===m.ActionIconPlacement.AboveTitle?(this.renderedElement.classList.add("iconAbove"),this.renderedElement.style.flexDirection="column",this.title&&(n.style.marginBottom="6px")):(this.renderedElement.classList.add("iconLeft"),n.style.maxHeight="100%",this.title&&(n.style.marginRight="6px")),this.renderedElement.appendChild(n),this.renderedElement.appendChild(t)}else this.renderedElement.classList.add("noIcon"),this.renderedElement.appendChild(t)}},t.prototype.getParentContainer=function(){return this.parent instanceof Ae?this.parent:this.parent?this.parent.getParentContainer():void 0},t.prototype.isDesignMode=function(){var e=this.getRootObject();return e instanceof x&&e.isDesignMode()},t.prototype.updateCssClasses=function(){var e,t;if(this.parent&&this.renderedElement){var n=this.parent.hostConfig;this.renderedElement.className=n.makeCssClassName(this.isEffectivelyEnabled()?"ac-pushButton":"ac-pushButton-disabled");var i=this.getParentContainer();if(i){var r=i.getEffectiveStyle();r&&this.renderedElement.classList.add("style-"+r)}switch(this.renderedElement.tabIndex=!this.isDesignMode()&&this.isFocusable?0:-1,this._state){case 0:break;case 1:this.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case 2:this.renderedElement.classList.add(n.makeCssClassName("subdued"))}this.style&&this.isEffectivelyEnabled()&&(this.style===m.ActionStyle.Positive?(e=this.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive")):(t=this.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.style.toLowerCase())))}},t.prototype.getDefaultSerializationContext=function(){return new Ve},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t=[];if(e)for(var n=0,i=Object.keys(e);n<i.length;n++){var r=e[i[n]];r.validateValue()||t.push(r)}return t},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.raiseExecuteActionEvent=function(){this.onExecute&&this.onExecute(this),s(this)},t.prototype.internalAfterExecute=function(){var e=this.getRootObject();e instanceof x&&e.updateActionsEnabledState()},t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t){if(void 0===t&&(t=!1),e.tabIndex=this.isEffectivelyEnabled()&&!this.isDesignMode()?0:-1,e.setAttribute("role",this.getAriaRole()),e instanceof HTMLButtonElement&&(e.disabled=!this.isEffectivelyEnabled()),this.isEffectivelyEnabled()?(e.removeAttribute("aria-disabled"),e.classList.add(this.hostConfig.makeCssClassName("ac-selectable"))):e.setAttribute("aria-disabled","true"),this.title?(e.setAttribute("aria-label",this.title),e.title=this.title):(e.removeAttribute("aria-label"),e.removeAttribute("title")),this.tooltip){var n=t?this.title?"aria-description":"aria-label":"aria-description";e.setAttribute(n,this.tooltip),e.title=this.tooltip}},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new Ve)},t.prototype.render=function(){var e=this,t=document.createElement("button");t.type="button",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.onclick=function(t){e.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.execute())},this._renderedElement=t,this.renderButtonContent(),this.updateCssClasses(),this.setupElementForAccessibility(t)},t.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent(),this.internalAfterExecute()},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===m.ActionStyle.Positive},set:function(e){e?this.style=m.ActionStyle.Positive:this.style===m.ActionStyle.Positive&&(this.style=m.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:C.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state!==e&&(this._state=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),t.titleProperty=new _.StringProperty(_.Versions.v1_0,"title"),t.iconUrlProperty=new _.StringProperty(_.Versions.v1_1,"iconUrl"),t.styleProperty=new _.ValueSetProperty(_.Versions.v1_2,"style",[{value:m.ActionStyle.Default},{value:m.ActionStyle.Positive},{value:m.ActionStyle.Destructive}],m.ActionStyle.Default),t.modeProperty=new _.ValueSetProperty(_.Versions.v1_5,"mode",[{value:m.ActionMode.Primary},{value:m.ActionMode.Secondary}],m.ActionMode.Primary),t.tooltipProperty=new _.StringProperty(_.Versions.v1_5,"tooltip"),t.isEnabledProperty=new _.BoolProperty(_.Versions.v1_5,"isEnabled",!0),f([(0,_.property)(t.titleProperty)],t.prototype,"title",void 0),f([(0,_.property)(t.iconUrlProperty)],t.prototype,"iconUrl",void 0),f([(0,_.property)(t.styleProperty)],t.prototype,"style",void 0),f([(0,_.property)(t.modeProperty)],t.prototype,"mode",void 0),f([(0,_.property)(t.tooltipProperty)],t.prototype,"tooltip",void 0),f([(0,_.property)(t.isEnabledProperty)],t.prototype,"isEnabled",void 0),t}(A.CardObject);t.Action=oe;var ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disabledUnlessAssociatedInputsChange=!1,t._isPrepared=!1,t._areReferencedInputsDirty=!1,t}return h(t,e),t.prototype.internalGetReferencedInputs=function(){var e={};if("none"!==this.associatedInputs){for(var t=this.parent,n=[];t;)n.push.apply(n,t.getAllInputs(!1)),t=t.parent;for(var i=0,r=n;i<r.length;i++){var o=r[i];o.id&&(e[o.id]=o)}}return e},t.prototype.internalPrepareForExecution=function(e){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)for(var t=0,n=Object.keys(e);t<n.length;t++){var i=e[n[t]];i.id&&i.isSet()&&(this._processedData[i.id]="string"==typeof i.value?i.value:i.value.toString())}this._isPrepared=!0},t.prototype.internalAfterExecute=function(){v.GlobalSettings.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()},t.prototype.resetReferencedInputsDirtyState=function(){var e=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,e)for(var t=0,n=Object.keys(e);t<n.length;t++)e[n[t]].resetDirtyState()},t.prototype.updateEnabledState=function(){this._areReferencedInputsDirty=!1;var e=this.getReferencedInputs();if(e)for(var t=0,n=Object.keys(e);t<n.length;t++)if(e[n[t]].isDirty()){this._areReferencedInputsDirty=!0;break}this.updateCssClasses(),this._renderedElement&&this.setupElementForAccessibility(this._renderedElement)},t.prototype.isEffectivelyEnabled=function(){var t=e.prototype.isEffectivelyEnabled.call(this);return this.disabledUnlessAssociatedInputsChange?t&&this._areReferencedInputsDirty:t},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new _.PropertyDefinition(_.Versions.v1_0,"data"),t.associatedInputsProperty=new _.CustomProperty(_.Versions.v1_3,"associatedInputs",function(e,t,n,i){var r=n[t.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"},function(e,t,n,i,r){r.serializeValue(n,t.name,i)}),t.disabledUnlessAssociatedInputsChangeProperty=new _.BoolProperty(_.Versions.v1_6,"disabledUnlessAssociatedInputsChange",!1),f([(0,_.property)(t.dataProperty)],t.prototype,"_originalData",void 0),f([(0,_.property)(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0),f([(0,_.property)(t.disabledUnlessAssociatedInputsChangeProperty)],t.prototype,"disabledUnlessAssociatedInputsChange",void 0),t}(oe);t.SubmitActionBase=ae;var se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t}(ae);t.SubmitAction=se;var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new _.StringProperty(_.Versions.v1_4,"verb"),f([(0,_.property)(t.verbProperty)],t.prototype,"verb",void 0),t}(ae);t.ExecuteAction=le;var ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new _.StringProperty(_.Versions.v1_0,"url"),t.JsonTypeName="Action.OpenUrl",f([(0,_.property)(t.urlProperty)],t.prototype,"url",void 0),t}(oe);t.OpenUrlAction=ce;var pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return h(t,e),t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);this._renderedElement&&(e.length>0?this._renderedElement.setAttribute("aria-controls",e.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.render=function(){e.prototype.render.call(this),this.updateAriaControlsAttribute()},t.prototype.execute=function(){if(e.prototype.execute.call(this),this.parent)for(var t=0,n=Object.keys(this.targetElements);t<n.length;t++){var i=n[t],r=this.parent.getRootElement().getElementById(i);r&&("boolean"==typeof this.targetElements[i]?r.isVisible=this.targetElements[i]:r.isVisible=!r.isVisible)}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t,this.updateAriaControlsAttribute()},t.prototype.removeTargetElement=function(e){delete this.targetElements[e],this.updateAriaControlsAttribute()},t.targetElementsProperty=new _.CustomProperty(_.Versions.v1_2,"targetElements",function(e,t,n,i){var r={};if(Array.isArray(n[t.name]))for(var o=0,a=n[t.name];o<a.length;o++){var s=a[o];if("string"==typeof s)r[s]=void 0;else if("object"==typeof s){var l=s.elementId;"string"==typeof l&&(r[l]=b.parseBool(s.isVisible))}}return r},function(e,t,n,i,r){for(var o=[],a=0,s=Object.keys(i);a<s.length;a++){var l=s[a];"boolean"==typeof i[l]?o.push({elementId:l,isVisible:i[l]}):o.push(l)}r.serializeArray(n,t.name,o)},{},function(e){return{}}),t.JsonTypeName="Action.ToggleVisibility",f([(0,_.property)(t.targetElementsProperty)],t.prototype,"targetElements",void 0),t}(oe);t.ToggleVisibilityAction=pe;var ue=function(e){function t(t,n){var i=e.call(this,t,n,void 0,function(){return new v.StringWithSubstitutions})||this;return i.targetVersion=t,i.name=n,i}return h(t,e),t.prototype.parse=function(e,t,n){var i=new v.StringWithSubstitutions;return i.set(b.parseString(t[this.name])),i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n.getOriginal())},t}(_.PropertyDefinition),de=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var i=e.call(this)||this;return i.name=t,i.value=n,i}return h(t,e),t.prototype.getSchemaKey=function(){return"HttpHeader"},t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)},t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,v.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:!1,configurable:!0}),t.nameProperty=new _.StringProperty(_.Versions.v1_0,"name"),t.valueProperty=new ue(_.Versions.v1_0,"value"),f([(0,_.property)(t.nameProperty)],t.prototype,"name",void 0),f([(0,_.property)(t.valueProperty)],t.prototype,"_value",void 0),t}(_.SerializableObject);t.HttpHeader=de;var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ignoreInputValidation=!1,t}return h(t,e),t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(var n=0,i=this.headers;n<i.length;n++)i[n].getReferencedInputs(e,t);return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,v.ContentTypes.applicationXWwwFormUrlencoded);for(var t=v.ContentTypes.applicationJson,n=0,i=this.headers;n<i.length;n++){var r=i[n];r.prepareForExecution(e),r.name&&"content-type"===r.name.toLowerCase()&&(t=r.value)}this._body.substituteInputValues(e,t)}},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var n=0,i=this.headers;n<i.length;n++)i[n].name||t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.actionHttpHeadersMustHaveNameAndValue())},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!1,configurable:!0}),t.urlProperty=new ue(_.Versions.v1_0,"url"),t.bodyProperty=new ue(_.Versions.v1_0,"body"),t.methodProperty=new _.StringProperty(_.Versions.v1_0,"method"),t.headersProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_0,"headers",de),t.ignoreInputValidationProperty=new _.BoolProperty(_.Versions.v1_3,"ignoreInputValidation",!1),t.JsonTypeName="Action.Http",f([(0,_.property)(t.urlProperty)],t.prototype,"_url",void 0),f([(0,_.property)(t.bodyProperty)],t.prototype,"_body",void 0),f([(0,_.property)(t.methodProperty)],t.prototype,"method",void 0),f([(0,_.property)(t.headersProperty)],t.prototype,"headers",void 0),f([(0,_.property)(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0),t}(oe);t.HttpAction=he;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.card=new Re,t}return h(t,e),t.prototype.updateCssClasses=function(){if(e.prototype.updateCssClasses.call(this),this.renderedElement){var t=this.parent?this.parent.hostConfig:C.defaultHostConfig;this.renderedElement.classList.add(t.makeCssClassName("expandable")),this.renderedElement.setAttribute("aria-expanded",(1===this.state).toString())}},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var i=t.card;i?this.card.parse(i,n):n.logParseEvent(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===m.ShowCardActionMode.Popup&&e.prototype.raiseExecuteActionEvent.call(this)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,this.card.getAllActions()),t},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,this.card.getResourceInformation()),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.JsonTypeName="Action.ShowCard",t}(oe);t.ShowCardAction=fe;var ye=function(e){function t(t){var n=e.call(this)||this;return n._actions=t,n.title=P.Strings.defaults.overflowButtonText(),n}return h(t,e),t.prototype.getActions=function(){return this._actions},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,this._actions),t},t.prototype.getJsonTypeName=function(){return fe.JsonTypeName},t.prototype.execute=function(){var e,t=this;if(!u(this,this.renderedElement)&&this.renderedElement){var n=new E.PopupMenu;n.hostConfig=this.hostConfig;for(var i=this,r=0;r<this._actions.length;r++)!function(r){var o=new E.MenuItem(r.toString(),null!==(e=i._actions[r].title)&&void 0!==e?e:"");o.isEnabled=i._actions[r].isEnabled,o.onClick=function(){var e=t._actions[r];n.closePopup(!1),e.isEnabled&&e.execute()},n.items.add(o)}(r);n.popup(this.renderedElement)}},t.JsonTypeName="Action.Overflow",t}(oe),ge=function(){function e(e){this._items=[],this._renderedActions=[],this._owner=e}return e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e.constructor===r)return!1}return!0},e.prototype.refreshContainer=function(){if(i(this._actionCardContainer),this._actionCard){this._actionCardContainer.style.marginTop=this.renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0===t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),b.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},e.prototype.showActionCard=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.card.suppressStyle=t;var i=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=i,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),l(e,!0))},e.prototype.collapseExpandedAction=function(){for(var e=0,t=this._renderedActions;e<t.length;e++)t[e].state=0;var n=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),n&&(this.layoutChanged(),l(n,!1))},e.prototype.expandShowCardAction=function(e,t){for(var n=this,i=!1,r=0,o=this._renderedActions;r<o.length;r++){var a=o[r];this._owner.hostConfig.actions.actionsOrientation==m.Orientation.Horizontal&&i&&(a.isFocusable=!1),a!==e?a.state=2:(a.state=1,i=!0,a.renderedElement&&(a.renderedElement.onblur=function(e){for(var t=0,i=n._renderedActions;t<i.length;t++)i[t].isFocusable=!0}))}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.releaseDOMResources=function(){for(var e=0,t=this._renderedActions;e<t.length;e++)t[e].releaseDOMResources()},e.prototype.actionExecuted=function(e){e instanceof fe?e===this._expandedAction?this.collapseExpandedAction():this._owner.hostConfig.actions.showCard.actionMode===m.ShowCardActionMode.Inline&&this.expandShowCardAction(e,!0):this.collapseExpandedAction()},e.prototype.parse=function(e,t){if(this.clear(),Array.isArray(e))for(var n=0,i=e;n<i.length;n++){var r=i[n],o=[];this._owner instanceof Pe&&(o=this._owner.getForbiddenActionNames());var a=t.parseAction(this._owner,r,o,!this._owner.isDesignMode());a&&this.addAction(a)}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this._items)},e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){for(var t=void 0,n=0,i=this._items;n<i.length&&!(t=i[n].getActionById(e));n++);return t},e.prototype.validateProperties=function(e){this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,m.ValidationEvent.TooManyActions,P.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,m.ValidationEvent.InteractivityNotAllowed,P.Strings.errors.interactivityNotAllowed());for(var t=0,n=this._items;t<n.length;t++){var i=n[t];this.isActionAllowed(i)||e.addFailure(this._owner,m.ValidationEvent.ActionTypeNotAllowed,P.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName())),i.internalValidateProperties(e)}},e.prototype.render=function(e){var t=this._owner.hostConfig;if(t.supportsInteractivity){var n=document.createElement("div"),i=t.actions.maxActions?Math.min(t.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActions=[],t.actions.preExpandSingleShowCardAction&&1===i&&this._items[0]instanceof fe&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActions.push(this._items[0]);else{var r=document.createElement("div");if(r.className=t.makeCssClassName("ac-actionSet"),r.style.display="flex",e===m.Orientation.Horizontal)if(r.style.flexDirection="row",this._owner.horizontalAlignment&&t.actions.actionAlignment!==m.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case m.HorizontalAlignment.Center:r.style.justifyContent="center";break;case m.HorizontalAlignment.Right:r.style.justifyContent="flex-end";break;default:r.style.justifyContent="flex-start"}else switch(t.actions.actionAlignment){case m.ActionAlignment.Center:r.style.justifyContent="center";break;case m.ActionAlignment.Right:r.style.justifyContent="flex-end";break;default:r.style.justifyContent="flex-start"}else if(r.style.flexDirection="column",this._owner.horizontalAlignment&&t.actions.actionAlignment!==m.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case m.HorizontalAlignment.Center:r.style.alignItems="center";break;case m.HorizontalAlignment.Right:r.style.alignItems="flex-end";break;default:r.style.alignItems="flex-start"}else switch(t.actions.actionAlignment){case m.ActionAlignment.Center:r.style.alignItems="center";break;case m.ActionAlignment.Right:r.style.alignItems="flex-end";break;case m.ActionAlignment.Stretch:r.style.alignItems="stretch";break;default:r.style.alignItems="flex-start"}var o=this._items.filter(this.isActionAllowed.bind(this)),a=[],s=[];if(this._owner.isDesignMode())a=o;else{o.forEach(function(e){return e.mode===m.ActionMode.Secondary?s.push(e):a.push(e)});var l=a.splice(t.actions.maxActions);v.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu&&s.push.apply(s,l);var c=!0;if(s.length>0){this._overflowAction||(this._overflowAction=new ye(s),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this);var p=this._owner instanceof Oe&&!this._owner.parent;c=!d(this._overflowAction,p)}this._overflowAction&&c&&a.push(this._overflowAction)}for(var u=0;u<a.length;u++){var h=a[u];if(h.render(),h.renderedElement&&(t.actions.actionsOrientation===m.Orientation.Horizontal&&t.actions.actionAlignment===m.ActionAlignment.Stretch?h.renderedElement.style.flex="0 1 100%":h.renderedElement.style.flex="0 1 auto",r.appendChild(h.renderedElement),this._renderedActions.push(h),u<a.length-1&&t.actions.buttonSpacing>0)){var f=document.createElement("div");e===m.Orientation.Horizontal?(f.style.flex="0 0 auto",f.style.width=t.actions.buttonSpacing+"px"):f.style.height=t.actions.buttonSpacing+"px",b.appendChild(r,f)}}var y=document.createElement("div");y.style.overflow="hidden",y.appendChild(r),b.appendChild(n,y)}b.appendChild(n,this._actionCardContainer);for(var g=0,C=this._renderedActions;g<C.length;g++){var S=C[g];if(1===S.state){this.expandShowCardAction(S,!1);break}}return this._renderedActions.length>0?n:void 0}},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(P.Strings.errors.actionAlreadyParented());this._items.push(e),e.parent||e.setParent(this._owner),e._actionCollection=this},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction===e&&this.collapseExpandedAction();var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0),e._actionCollection=void 0;for(var n=0;n<this._renderedActions.length;n++)if(this._renderedActions[n]===e){this._renderedActions.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this._items=[],this._renderedActions=[],this._expandedAction=void 0},e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var t=[];if(e)for(var n=0,i=this._items;n<i.length;n++){var r=i[n];t.push.apply(t,r.getAllInputs())}return t},e.prototype.getResourceInformation=function(){for(var e=[],t=0,n=this._items;t<n.length;t++){var i=n[t];e.push.apply(e,i.getResourceInformation())}return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}(),me=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new ge(t),t}return h(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getActionCount();n++){var i=this.getActionAt(n);i&&t.push(i)}return t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,i=0;i<this.getActionCount();i++){var r=this.getActionAt(i);if(r&&(n=r.findDOMNodeOwner(t)))return n}return e.prototype.findDOMNodeOwner.call(this,t)},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new _.EnumProperty(_.Versions.v1_1,"orientation",m.Orientation),f([(0,_.property)(t.orientationProperty)],t.prototype,"orientation",void 0),t}(x);t.ActionSet=me;var ve=function(e){function t(t,n,i,r){var o=e.call(this,t,n,[{value:m.ContainerStyle.Default},{value:m.ContainerStyle.Emphasis},{targetVersion:_.Versions.v1_2,value:m.ContainerStyle.Accent},{targetVersion:_.Versions.v1_2,value:m.ContainerStyle.Good},{targetVersion:_.Versions.v1_2,value:m.ContainerStyle.Attention},{targetVersion:_.Versions.v1_2,value:m.ContainerStyle.Warning}],i,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=i,o.onGetInitialValue=r,o}return h(t,e),t}(_.ValueSetProperty);t.ContainerStyleProperty=ve;var be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),t.prototype.applyBorder=function(){},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=b.stringToCssColor(e.backgroundColor);t&&(this.renderedElement.style.backgroundColor=t)}}},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new v.SpacingDefinition;if(this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()){var n=new v.PaddingDefinition;this.getImmediateSurroundingPadding(n);var i=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+i.right+"px",this.renderedElement.style.marginLeft="-"+i.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+i.top+"px",this.renderedElement.style.marginBottom="-"+i.bottom+"px"),this.separatorElement&&this.separatorOrientation===m.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+i.left+"px",this.separatorElement.style.marginRight="-"+i.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===m.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},t.prototype.getHasBackground=function(e){void 0===e&&(e=!1);for(var n=this.parent;n;){var i=!1;if(i=!e&&(n instanceof Ae&&n.backgroundImage.isValid()),n instanceof t&&this.hasExplicitStyle&&(n.getEffectiveStyle()!==this.getEffectiveStyle()||i))return!0;n=n.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new v.PaddingDefinition(m.Spacing.Padding,m.Spacing.Padding,m.Spacing.Padding,m.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var i=this.getValue(t.styleProperty);void 0!==i&&(this.hostConfig.containerStyles.getStyleByName(i)||n.addFailure(this,m.ValidationEvent.InvalidPropertyValue,P.Strings.errors.invalidPropertyValue(i,"style")))},t.prototype.render=function(){var t=e.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),this.applyBorder(),t},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.styleProperty=new ve(_.Versions.v1_0,"style"),f([(0,_.property)(t.styleProperty)],t.prototype,"style",null),t}(L);t.StylableCardElementContainer=be;var Ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bleed=!1,t}return h(t,e),t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t),this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.bleedProperty=new _.BoolProperty(_.Versions.v1_2,"bleed",!1),t.minHeightProperty=new _.PixelSizeProperty(_.Versions.v1_2,"minHeight"),f([(0,_.property)(t.bleedProperty)],t.prototype,"_bleed",void 0),f([(0,_.property)(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0),t}(be);t.ContainerBase=Ce;var Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e){if(this.url&&e.renderedElement){switch(e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')",this.fillMode){case m.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case m.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case m.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case m.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat",e.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case m.HorizontalAlignment.Left:break;case m.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case m.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case m.VerticalAlignment.Top:break;case m.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case m.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!!this.url},t.urlProperty=new _.StringProperty(_.Versions.v1_0,"url"),t.fillModeProperty=new _.EnumProperty(_.Versions.v1_2,"fillMode",m.FillMode,m.FillMode.Cover),t.horizontalAlignmentProperty=new _.EnumProperty(_.Versions.v1_2,"horizontalAlignment",m.HorizontalAlignment,m.HorizontalAlignment.Left),t.verticalAlignmentProperty=new _.EnumProperty(_.Versions.v1_2,"verticalAlignment",m.VerticalAlignment,m.VerticalAlignment.Top),f([(0,_.property)(t.urlProperty)],t.prototype,"url",void 0),f([(0,_.property)(t.fillModeProperty)],t.prototype,"fillMode",void 0),f([(0,_.property)(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),f([(0,_.property)(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0),t}(_.SerializableObject);t.BackgroundImage=Se;var Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t}return h(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),t.prototype.insertItemAt=function(e,t,n){if(e.parent&&!n)throw new Error(P.Strings.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(P.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()));t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),e.prototype.applyBackground.call(this)},t.prototype.applyRTL=function(e){void 0!==this.rtl&&(e.dir=this.rtl?"rtl":"ltr")},t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig,t=document.createElement("div");switch(this.applyRTL(t),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",v.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveVerticalContentAlignment()){case m.VerticalAlignment.Center:t.style.justifyContent="center";break;case m.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(var n=0,i=this._items;n<i.length;n++){var r=i[n],o=this.isElementAllowed(r)?r.render():void 0;o&&(this._renderedItems.length>0&&r.separatorElement&&(r.separatorElement.style.flex="0 0 auto",b.appendChild(t,r.separatorElement)),b.appendChild(t,o),this._renderedItems.push(r))}else if(this.isDesignMode()){var a=this.createPlaceholderElement();a.style.width="100%",a.style.height="100%",t.appendChild(a)}return t},t.prototype.truncateOverflow=function(e){if(this.renderedElement){for(var t=this.renderedElement.offsetTop+e+1,n=function(e){var i=e.renderedElement;if(i)switch(b.getFitStatus(i,t)){case m.ContainerFitStatus.FullyInContainer:e.resetOverflow()&&n(e);break;case m.ContainerFitStatus.Overflowing:var r=t-i.offsetTop;e.handleOverflow(r);break;case m.ContainerFitStatus.FullyOutOfContainer:e.handleOverflow(0)}},i=0,r=this._items;i<r.length;i++){var o=r[i];n(o)}return!0}return!1},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++)t[e].resetOverflow()},t.prototype.getHasBackground=function(t){return void 0===t&&(t=!1),!t&&this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this,t)},t.prototype.canHostSingletons=function(){return!1},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var i=t[this.getItemsCollectionPropertyName()];if(!Array.isArray(i)&&"object"==typeof i&&this.canHostSingletons()){var r=b.parseString(i.type);if(r){var o=n.elementRegistry.findByName(r);(null===o||void 0===o?void 0:o.singletonBehavior)!==w.ElementSingletonBehavior.NotAllowed&&(c=n.parseElement(this,i,[],!this.isDesignMode(),!0))&&this.insertItemAt(c,-1,!0)}}else if(Array.isArray(i))for(var a=0,s=i;a<s.length;a++){var l=s[a],c=n.parseElement(this,l,this.forbiddenChildElements(),!this.isDesignMode());c&&this.insertItemAt(c,-1,!0)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);var i=this.getItemsCollectionPropertyName();1===this._items.length&&this._items[0].getElementSingletonBehavior()===w.ElementSingletonBehavior.Only?n.serializeValue(t,i,this._items[0].toJSON(n)):n.serializeArray(t,i,this._items)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getEffectivePadding=function(){return v.GlobalSettings.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new v.PaddingDefinition:e.prototype.getEffectivePadding.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;var e=this.getParentContainer();return e?e.getEffectiveVerticalContentAlignment():m.VerticalAlignment.Top},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible)return n}},t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){for(var t=this.isDesignMode(),n=0,i=this._items;n<i.length;n++){var r=i[n];if(r.isVisible||t)return r===e}return!1},t.prototype.isLastElement=function(e){for(var t=this.isDesignMode(),n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]===e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=function(e){this.insertItemAt(e,-1,!1)},t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)},t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var i=0,r=this._items;i<r.length&&!(n=r[i].getActionById(t));i++);return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new _.SerializableObjectProperty(_.Versions.v1_0,"backgroundImage",Se),t.verticalContentAlignmentProperty=new _.EnumProperty(_.Versions.v1_1,"verticalContentAlignment",m.VerticalAlignment),t.rtlProperty=new _.BoolProperty(_.Versions.v1_0,"rtl"),f([(0,_.property)(t.backgroundImageProperty)],t.prototype,"backgroundImage",null),f([(0,_.property)(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0),f([(0,_.property)(t.rtlProperty)],t.prototype,"rtl",void 0),t}(Ce);t.Container=Ae;var _e=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n.width="stretch",n._computedWeight=0,n.width=t,n}return h(t,e),t.prototype.adjustRenderedElementSize=function(e){this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?e.style.flex="0 1 auto":"stretch"===this.width?e.style.flex="1 1 50px":this.width instanceof v.SizeAndUnit&&(this.width.unit===m.SizeUnit.Pixel?(e.style.flex="0 0 auto",e.style.width=this.width.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return m.Orientation.Vertical},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof we)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new _.CustomProperty(_.Versions.v1_0,"width",function(e,t,n,i){var r=t.defaultValue,o=n[t.name],a=!1;if("number"!=typeof o||isNaN(o))if("auto"===o||"stretch"===o)r=o;else if("string"==typeof o)try{(r=v.SizeAndUnit.parse(o)).unit===m.SizeUnit.Pixel&&t.targetVersion.compareTo(i.targetVersion)>0&&(a=!0)}catch(e){a=!0}else a=!0;else r=new v.SizeAndUnit(o,m.SizeUnit.Weight);return a&&(i.logParseEvent(e,m.ValidationEvent.InvalidPropertyValue,P.Strings.errors.invalidColumnWidth(o)),r="auto"),r},function(e,t,n,i,r){i instanceof v.SizeAndUnit?i.unit===m.SizeUnit.Pixel?r.serializeValue(n,"width",i.physicalSize+"px"):r.serializeNumber(n,"width",i.physicalSize):r.serializeValue(n,"width",i)},"stretch"),f([(0,_.property)(t.widthProperty)],t.prototype,"width",void 0),t}(Ae);t.Column=_e;var we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return h(t,e),t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),function(e){return e&&"Column"!==e?void 0:new _e},function(e,n){t.logParseEvent(void 0,m.ValidationEvent.ElementTypeNotAllowed,P.Strings.errors.elementTypeNotAllowed(e))})},t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",v.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveHorizontalAlignment()){case m.HorizontalAlignment.Center:t.style.justifyContent="center";break;case m.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,i=0,r=this._columns;i<r.length;i++)(s=r[i]).width instanceof v.SizeAndUnit&&s.width.unit===m.SizeUnit.Weight&&(n+=s.width.physicalSize);for(var o=0,a=this._columns;o<a.length;o++){var s=a[o];if(s.width instanceof v.SizeAndUnit&&s.width.unit===m.SizeUnit.Weight&&n>0){var l=100/n*s.width.physicalSize;s._computedWeight=l}var c=s.render();c&&(this._renderedColumns.length>0&&s.separatorElement&&(s.separatorElement.style.flex="0 0 auto",b.appendChild(t,s.separatorElement)),b.appendChild(t,c),this._renderedColumns.push(s))}return this._renderedColumns.length>0?t:void 0}},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++)n[t].handleOverflow(e);return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++)t[e].resetOverflow()},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var i=t.columns;if(Array.isArray(i))for(var r=0,o=i;r<o.length;r++){var a=o[r],s=this.createColumnInstance(a,n);s&&this._columns.push(s)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,"columns",this._columns)},t.prototype.isFirstElement=function(e){for(var t=0,n=this._columns;t<n.length;t++){var i=n[t];if(i.isVisible)return i===e}return!1},t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++)if(t[e].isBleedingAtTop())return!0;return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++)if(t[e].isBleedingAtBottom())return!0;return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0,i=0,r=0,o=this._columns;r<o.length;r++){var a=o[r];"number"==typeof a.width?n++:"stretch"===a.width&&i++}n>0&&i>0&&t.addFailure(this,m.ValidationEvent.Hint,P.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},t.prototype.addColumn=function(e){if(e.parent)throw new Error(P.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof _e){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof _e?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0===this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)===this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){for(var t=void 0,n=0,i=this._columns;n<i.length&&!(t=i[n].getActionById(e));n++);return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(Ce);t.ColumnSet=we;var Pe=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new ge(t),t}return h(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.parseActions(t,n)},t.prototype.parseActions=function(e,t){this._actionCollection.parse(e.actions,t)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return n&&(b.appendChild(t,r(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},m.Orientation.Horizontal)),b.appendChild(t,n)),this.renderIfEmpty?t:t.children.length>0?t:void 0}},t.prototype.getHasExpandedAction=function(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0===this._actionCollection.getActionCount()},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&n.push.apply(n,this._actionCollection.getAllInputs(t)),n},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,this._actionCollection.getResourceInformation()),t},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getForbiddenActionNames=function(){return[]},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(Ae);t.ContainerWithActions=Pe;var Ee=function(e){function t(t,n){var i=e.call(this,t,n,void 0)||this;return i.targetVersion=t,i.name=n,i}return h(t,e),t.prototype.parse=function(e,t,n){var i=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==i){if(i instanceof le)return i;n.logParseEvent(e,m.ValidationEvent.ActionTypeNotAllowed,P.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName()))}n.logParseEvent(e,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):void 0,void 0,!0)},t}(_.PropertyDefinition);t.RefreshActionProperty=Ee;var xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new Ee(_.Versions.v1_4,"action"),t.userIdsProperty=new _.StringArrayProperty(_.Versions.v1_4,"userIds"),f([(0,_.property)(t.actionProperty)],t.prototype,"action",null),f([(0,_.property)(t.userIdsProperty)],t.prototype,"userIds",void 0),t}(_.SerializableObject);t.RefreshDefinition=xe;var Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},t.typeProperty=new _.StringProperty(_.Versions.v1_4,"type"),t.titleProperty=new _.StringProperty(_.Versions.v1_4,"title"),t.imageProperty=new _.StringProperty(_.Versions.v1_4,"image"),t.valueProperty=new _.StringProperty(_.Versions.v1_4,"value"),f([(0,_.property)(t.typeProperty)],t.prototype,"type",void 0),f([(0,_.property)(t.titleProperty)],t.prototype,"title",void 0),f([(0,_.property)(t.imageProperty)],t.prototype,"image",void 0),f([(0,_.property)(t.valueProperty)],t.prototype,"value",void 0),t}(_.SerializableObject);t.AuthCardButton=Ie;var Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},t.idProperty=new _.StringProperty(_.Versions.v1_4,"id"),t.uriProperty=new _.StringProperty(_.Versions.v1_4,"uri"),t.providerIdProperty=new _.StringProperty(_.Versions.v1_4,"providerId"),f([(0,_.property)(t.idProperty)],t.prototype,"id",void 0),f([(0,_.property)(t.uriProperty)],t.prototype,"uri",void 0),f([(0,_.property)(t.providerIdProperty)],t.prototype,"providerId",void 0),t}(_.SerializableObject);t.TokenExchangeResource=Te;var ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},t.textProperty=new _.StringProperty(_.Versions.v1_4,"text"),t.connectionNameProperty=new _.StringProperty(_.Versions.v1_4,"connectionName"),t.buttonsProperty=new _.SerializableObjectCollectionProperty(_.Versions.v1_4,"buttons",Ie),t.tokenExchangeResourceProperty=new _.SerializableObjectProperty(_.Versions.v1_4,"tokenExchangeResource",Te,!0),f([(0,_.property)(t.textProperty)],t.prototype,"text",void 0),f([(0,_.property)(t.connectionNameProperty)],t.prototype,"connectionName",void 0),f([(0,_.property)(t.buttonsProperty)],t.prototype,"buttons",void 0),f([(0,_.property)(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0),t}(_.SerializableObject);t.Authentication=ke;var Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designMode=!1,t}return h(t,e),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(P.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(P.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),t.applyMarkdown=function(e){var n={didProcess:!1};if(t.onProcessMarkdown)t.onProcessMarkdown(e,n);else if(window.markdownit){var i=window.markdownit;n.outputHtml=i().render(e),n.didProcess=!0}else t._haveWarnedAboutNoMarkdownProcessing||(console.warn(P.Strings.errors.markdownProcessingNotEnabled),t._haveWarnedAboutNoMarkdownProcessing=!0);return n},t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getDefaultSerializationContext=function(){return new Ve(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.canHostSingletons=function(){return!0},t.prototype.internalParse=function(n,i){this._fallbackCard=void 0;var r=i.parseElement(void 0,n.fallback,this.forbiddenChildElements(),!this.isDesignMode());r&&(this._fallbackCard=new t,this._fallbackCard.addItem(r)),e.prototype.internalParse.call(this,n,i)},t.prototype.internalToJSON=function(n,i){this.setValue(t.versionProperty,i.targetVersion),e.prototype.internalToJSON.call(this,n,i)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return v.GlobalSettings.useAdvancedCardBottomTruncation&&t&&t.style.removeProperty("minHeight"),t},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!0},t.prototype.getDefaultPadding=function(){return new v.PaddingDefinition(m.Spacing.Padding,m.Spacing.Padding,m.Spacing.Padding,m.Spacing.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(x.typeNameProperty)&&t.addFailure(this,m.ValidationEvent.MissingCardType,P.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,m.ValidationEvent.UnsupportedCardVersion,P.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,m.ValidationEvent.PropertyCantBeNull,P.Strings.errors.propertyMustBeSet("version"))},t.prototype.render=function(t){var n;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,n=this._fallbackCard.render()):(n=e.prototype.render.call(this))&&(n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),v.GlobalSettings.setTabIndexAtCardRoot&&(n.tabIndex=0),this.speak&&n.setAttribute("aria-label",this.speak)),t&&(b.appendChild(t,n),this.updateLayout()),n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),v.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var n=this.hostConfig.getEffectiveSpacing(m.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-n)}},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new _.CustomProperty(_.Versions.v1_0,"$schema",function(e,n,i,r){return t.schemaUrl},function(e,n,i,r,o){o.serializeValue(i,n.name,t.schemaUrl)}),t.versionProperty=new _.CustomProperty(_.Versions.v1_0,"version",function(e,t,n,i){var r=_.Version.parse(n[t.name],i);return void 0===r&&(r=_.Versions.latest,i.logParseEvent(e,m.ValidationEvent.InvalidPropertyValue,P.Strings.errors.invalidCardVersion(r.toString()))),r},function(e,t,n,i,r){void 0!==i&&r.serializeValue(n,t.name,i.toString())},_.Versions.v1_0),t.fallbackTextProperty=new _.StringProperty(_.Versions.v1_0,"fallbackText"),t.speakProperty=new _.StringProperty(_.Versions.v1_0,"speak"),t.refreshProperty=new _.SerializableObjectProperty(_.Versions.v1_4,"refresh",xe,!0),t.authenticationProperty=new _.SerializableObjectProperty(_.Versions.v1_4,"authentication",ke,!0),t._haveWarnedAboutNoMarkdownProcessing=!1,f([(0,_.property)(t.versionProperty)],t.prototype,"version",void 0),f([(0,_.property)(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0),f([(0,_.property)(t.speakProperty)],t.prototype,"speak",void 0),f([(0,_.property)(t.refreshProperty)],t.prototype,"refresh",null),f([(0,_.property)(t.authenticationProperty)],t.prototype,"authentication",void 0),t}(Pe);t.AdaptiveCard=Oe;var Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suppressStyle=!1,t}return h(t,e),t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(Oe.$schemaProperty,Oe.versionProperty)},t.prototype.getDefaultPadding=function(){return new v.PaddingDefinition(this.suppressStyle?m.Spacing.None:m.Spacing.Padding,m.Spacing.Padding,this.suppressStyle?m.Spacing.None:m.Spacing.Padding,m.Spacing.Padding)},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?m.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:m.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n&&(n.setAttribute("aria-live","polite"),n.removeAttribute("tabindex")),n},t}(Oe),Ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._forbiddenTypes=new Set,t}return h(t,e),t.prototype.internalParseCardObject=function(e,t,n,i,r,o,a){var s=this;void 0===a&&(a=!1);var l=void 0;if(t&&"object"==typeof t){var c=new Set;this._forbiddenTypes.forEach(function(e){c.add(e)}),n.forEach(function(e){s._forbiddenTypes.add(e)});var p=b.parseString(t.type),u=a&&"Carousel"===p;if(p&&this._forbiddenTypes.has(p)&&!u)o(p,m.TypeErrorType.ForbiddenType);else{var d=!1;if((l=r(p))?(l.setParent(e),l.parse(t,this),d=v.GlobalSettings.enableFallback&&i&&l.shouldFallback()):(d=v.GlobalSettings.enableFallback&&i,o(p,m.TypeErrorType.UnknownType)),d){var h=t.fallback;!h&&e&&e.setShouldFallback(!0),"string"==typeof h&&"drop"===h.toLowerCase()?l=void 0:"object"==typeof h&&(l=this.internalParseCardObject(e,h,n,!0,r,o))}}this._forbiddenTypes=c}return l},t.prototype.cardObjectParsed=function(e,t){e instanceof oe&&this.onParseAction?this.onParseAction(e,t,this):e instanceof x&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof oe?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof x)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,i,r,o,a){void 0===a&&(a=!1);var s=new Set(n),l=this.internalParseCardObject(e,t,s,i,r,o,a);return void 0!==l&&this.cardObjectParsed(l,t),l},t.prototype.parseElement=function(e,t,n,i,r){var o=this;return void 0===r&&(r=!1),this.parseCardObject(e,t,n,i,function(e){return o.elementRegistry.createInstance(e,o.targetVersion)},function(e,t){t===m.TypeErrorType.UnknownType?o.logParseEvent(void 0,m.ValidationEvent.UnknownElementType,P.Strings.errors.unknownElementType(e)):o.logParseEvent(void 0,m.ValidationEvent.ElementTypeNotAllowed,P.Strings.errors.elementTypeNotAllowed(e))},r)},t.prototype.parseAction=function(e,t,n,i){var r=this;return this.parseCardObject(e,t,n,i,function(e){return r.actionRegistry.createInstance(e,r.targetVersion)},function(e,t){t===m.TypeErrorType.UnknownType?r.logParseEvent(void 0,m.ValidationEvent.UnknownActionType,P.Strings.errors.unknownActionType(e)):r.logParseEvent(void 0,m.ValidationEvent.ActionTypeNotAllowed,P.Strings.errors.actionTypeNotAllowed(e))})},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:w.GlobalRegistry.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:w.GlobalRegistry.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t}(_.BaseSerializationContext);t.SerializationContext=Ve,w.GlobalRegistry.defaultElements.register("Container",Ae),w.GlobalRegistry.defaultElements.register("TextBlock",k),w.GlobalRegistry.defaultElements.register("RichTextBlock",R,_.Versions.v1_2),w.GlobalRegistry.defaultElements.register("TextRun",O,_.Versions.v1_2),w.GlobalRegistry.defaultElements.register("Image",D),w.GlobalRegistry.defaultElements.register("ImageSet",N),w.GlobalRegistry.defaultElements.register("Media",K,_.Versions.v1_1),w.GlobalRegistry.defaultElements.register("FactSet",M),w.GlobalRegistry.defaultElements.register("ColumnSet",we),w.GlobalRegistry.defaultElements.register("ActionSet",me,_.Versions.v1_2),w.GlobalRegistry.defaultElements.register("Input.Text",X),w.GlobalRegistry.defaultElements.register("Input.Date",ne),w.GlobalRegistry.defaultElements.register("Input.Time",re),w.GlobalRegistry.defaultElements.register("Input.Number",te),w.GlobalRegistry.defaultElements.register("Input.ChoiceSet",ee),w.GlobalRegistry.defaultElements.register("Input.Toggle",Y),w.GlobalRegistry.defaultActions.register(ce.JsonTypeName,ce),w.GlobalRegistry.defaultActions.register(se.JsonTypeName,se),w.GlobalRegistry.defaultActions.register(fe.JsonTypeName,fe),w.GlobalRegistry.defaultActions.register(pe.JsonTypeName,pe,_.Versions.v1_2),w.GlobalRegistry.defaultActions.register(le.JsonTypeName,le,_.Versions.v1_4)},148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var i=function(){function e(){}return e.keys={tab:"Tab",enter:"Enter",escape:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",delete:"Delete"},e}();t.Constants=i},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.Persona="graph.microsoft.com/user",e.PersonaSet="graph.microsoft.com/users"}(t.ComponentName||(t.ComponentName={}));!function(e){e.Compact="compact"}(t.ComponentViewType||(t.ComponentViewType={})),t.isPersonaProperties=function(e){return void 0!==e.userPrincipalName},t.isPersonaSetProperties=function(e){return void 0!==e.users}},19:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(57),t),r(n(37),t),r(n(43),t),r(n(48),t),r(n(49),t),r(n(145),t),r(n(97),t),r(n(146),t),r(n(328),t),r(n(147),t),r(n(2836),t),r(n(2837),t),r(n(329),t),r(n(2838),t)},2826:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(327),n(330),n(332),n(331),n(66),n(333),n(335),n(336),n(337),n(338),n(339),n(50)},2827:function(e,t){e.exports='<div class="ts-adaptive-card card-acc-border" ng-click="ctrl.onCardClicked()" data-tid="{{::ctrl.dateTid}}" tabindex="-1" track-click-silent="true" do-not-decorate-click-for-acc>\n\n  <div style="position:relative;">\n    <div class="loading-bar-container" ng-show="ctrl.enableACv2NewLoadingExperience && ctrl.isCardRefreshing">\n      <div class="loading-bar"></div>\n    </div>\n    \x3c!--\n      Additional layer of wrapper element for card border is required for card copy & paste\n      (If border is at the most top level, pasting would be broken in OWA)\n    --\x3e\n    <div class="card-border-placeholder">\n      <div class="card-header" ng-show="!ctrl.showHeadlessCardOverflowActions">\n        \x3c!-- App attribution --\x3e\n        <div class="card-app-attribution"></div>\n\n        <div class="card-header-buttons">\n          \x3c!-- Collapse button --\x3e\n          <button class="hide ts-sym card-collapse app-icons-fill-hover" tabindex="-1">\n            <ng-include src="\'svg/icons-collapse.html\'"></ng-include>\n          </button>\n\n          \x3c!-- Close button --\x3e\n          <button class="hide ts-sym card-close app-icons-fill-hover" tabindex="-1">\n            <ng-include src="\'svg/icons-close.html\'"></ng-include>\n          </button>\n\n          \x3c!-- Copy button --\x3e\n          <button class="hide ts-sym power-bar-card-copy app-icons-fill-hover" tabindex="-1">\n            <ng-include src="\'svg/icons-copy.html\'"></ng-include>\n          </button>\n\n          \x3c!-- Header button --\x3e\n          <button class="ts-sym card-header-button card-header app-icons-fill-hover focus-round-border" tabindex="-1" title="{{ctrl.cardHeaderTitle}}" ng-if="ctrl.showCardHeader" ng-click="ctrl.handleCardHeaderMenu($event)">\n            <ng-include src="\'svg/icons-more.html\'"></ng-include>\n          </button>\n        </div>\n      </div>\n      <div class="card-overflow-actions" ng-if="ctrl.showHeadlessCardOverflowActions">\n        <div class="card-overflow-buttons">\n          \x3c!-- Overflow action button --\x3e\n          <button class="ts-sym card-overflow-button card-overflow-actions app-icons-fill-hover focus-round-border" tabindex="-1" title="{{ctrl.cardHeaderTitle}}" ng-click="ctrl.handleHeadlessOverflowActionsMenu($event)">\n            <ng-include src="\'svg/icons-more.html\'"></ng-include>\n          </button>\n        </div>\n      </div>\n\n      \x3c!-- Adaptive card body --\x3e\n      <div class="card-body"></div>\n\n      \x3c!-- Feedback --\x3e\n      <div class="action-feedback">\n        <ng-include src="\'svg/icons-error-small.html\'" class="error-icon"></ng-include>\n        <span class="error-text feedback-text" ng-non-bindable></span>\n        <button class="ts-sym app-icons-fill-hover close-button" tabindex="-1" ng-click="ctrl.showFeedback = false">\n          <ng-include src="\'svg/icons-close.html\'"></ng-include>\n        </button>\n      </div>\n    </div>\n    <div class="ngdialog-overlay ac-overlay" ng-show="!ctrl.enableACv2NewLoadingExperience && ctrl.isCardRefreshing">\n      <busy-animation size="small" style="margin: 0;"></busy-animation>\n    </div>\n  </div>\n  \x3c!--Install consent prompt--\x3e\n  <div class="card-app-consent-prompt" data-tid="jit-consent-prompt" tabindex="0" ng-if="ctrl.showInstallConsent">\n    <div class="content">\n      <span translate-with-html-params translate-id="extension_adaptiveCard_installConsent" translate-values=\'{"appName": "{{ctrl.appName}}",\n            "appPrivacyPolicy": "<a href=\\"#\\" ng-click=\\"ctrl.openAppPrivacyUrl()\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_privacyPolicy}}\\"></span></a>",\n            "appTermsOfUse": "<a href=\\"#\\" ng-click=\\"ctrl.openAppTermsOfUseUrl()\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_termsOfUse}}\\"></span></a>",\n            "appDetailsAndPermissions": "<a href=\\"#\\" ng-click=\\"ctrl.handleAppView()\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_appPermission}}\\"></span></a>"}\'>\n      </span>\n    </div>\n  </div>\n\n  \x3c!--Add App footer message--\x3e\n  <div class="card-add-app-message" data-tid="card-footer-add-app-message" tabindex="0">\n       <div class="leftContent">\n        <ng-include class="icon info-icon" src="\'svg/icons-info.html\'"></ng-include>\n        <div class="content">\n          <span ng-if="ctrl.showAddAppMessageForButtons" translate-with-html-params translate-id="extension_adaptiveCard_addAppMessage_sourceButton" translate-values=\'{"appPrivacyPolicy": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appPrivacyUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_privacyPolicy}}\\"></span></a>",\n                "appTermsOfUse": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appTermsOfUseUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_termsOfUse}}\\"></span></a>",\n                "appDetailsAndPermissions": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appPermissionsUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_appPermission}}\\"></span></a>"}\'>\n          </span>\n          <span ng-if="ctrl.showAddAppMessageForRefresh" translate-with-html-params translate-id="extension_adaptiveCard_addAppMessage_sourceRefresh" translate-values=\'{"appPrivacyPolicy": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appPrivacyUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_privacyPolicy}}\\"></span></a>",\n                "appTermsOfUse": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appTermsOfUseUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_termsOfUse}}\\"></span></a>",\n                "appDetailsAndPermissions": "<a href=\\"javascript:void(0)\\" ng-click=\\"ctrl.handleLinkClick(ctrl.constants.bots.cards.links.appPermissionsUrl)\\"><span translate-once=\\"{{::$root.resources.strings.extension_adaptiveCard_installConsent_appPermission}}\\"></span></a>"}\'>\n          </span>\n        </div>\n      </div>\n      <div class="rightContent">\n        <button class="ts-sym add-app-button" type="button" title="{{::$root.resources.strings.extension_adaptiveCard_addAppMessage_button|translate}}" aria-label="{{::$root.resources.strings.extension_adaptiveCard_addAppMessage_button|translate}}" ng-click="ctrl.handleAddAppBtnClick()" tabindex="0">\n                {{::$root.resources.strings.extension_adaptiveCard_addAppMessage_button | translate}}\n        </button>\n        <button class="ts-sym app-icons-fill-hover close-icon" title="{{::$root.resources.strings.icons_close|translate}}" aria-label="{{::$root.resources.strings.icons_close|translate}}" tabindex="0" ng-click="ctrl.showAddAppMessage = false">\n          <ng-include src="\'svg/icons-close.html\'"></ng-include>\n        </button>\n      </div>\n  </div>\n\n   \x3c!--Sign In or SSO Consent footer message--\x3e\n   <div class="card-sign-in-message" data-tid="card-footer-sign-in-message" tabindex="0">\n        <div class="leftContent">\n          <ng-include class="icon info-icon" src="\'svg/icons-info.html\'"></ng-include>\n          <div class="content">\n            <span ng-if="ctrl.showSSOConsentMessage" translate-with-html-params translate-id="extension_adaptiveCard_ssoConsent_message">\n            </span>\n            <span ng-if="ctrl.showSignInMessageForRefresh" translate-with-html-params translate-id="extension_adaptiveCard_signConsent_refresh_message">\n            </span>\n          </div>\n        </div>\n        <div class="rightContent">\n          <button class="ts-sym sign-button" type="button" ng-if="ctrl.showSSOConsentMessage" title="{{::$root.resources.strings.extension_adaptiveCard_ssoConsent_button|translate}}" aria-label="{{::$root.resources.strings.extension_adaptiveCard_ssoConsent_button|translate}}" ng-click="ctrl.handleSignInBtnClick()" tabindex="0">\n                  {{::$root.resources.strings.extension_adaptiveCard_ssoConsent_button | translate}}\n          </button>\n          <button class="ts-sym sign-button" type="button" ng-if="ctrl.showSignInMessageForRefresh" title="{{::$root.resources.strings.extension_adaptiveCard_signConsent_refresh_button|translate}}" aria-label="{{::$root.resources.strings.extension_adaptiveCard_signConsent_refresh_button|translate}}" ng-click="ctrl.handleSignInBtnClick()" tabindex="0">\n                  {{::$root.resources.strings.extension_adaptiveCard_signConsent_refresh_button | translate}}\n          </button>\n          <button class="ts-sym app-icons-fill-hover close-icon" tabindex="0" title="{{::$root.resources.strings.icons_close|translate}}" aria-label="{{::$root.resources.strings.icons_close|translate}}" ng-click="ctrl.showSignInMessage = false">\n            <ng-include src="\'svg/icons-close.html\'"></ng-include>\n          </button>\n        </div>\n  </div>\n\n</div>'},2828:function(e,t){e.exports='<div class="card-header-menu popover minwidth-sm maxwidth-common app-default-menu" data-tid="cardHeaderMenu" ng-keydown="ctrl.handleMenuKeyDown($event)" id="cardHeaderMenu">\n     <div class="scroll-container">\n      <div class="simple-scrollbar" simple-scrollbar>\n        <div>\n          <ul acc-role="menu" class="app-default-menu-ul">\n            <li class="card-header-menu-items">\n              <button tabindex="-1" ng-if="ctrl.showRefreshButtonInCardHeader" ng-click="ctrl.handleRefreshButtonClick($event)" class="ts-sym card-header-button" title="{{::$root.resources.strings.messages_refresh|translate}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                <ng-include src="\'svg/icons-recurrence.html\'"></ng-include>\n                <span class="ts-popover-label" translate-once="{{::$root.resources.strings.messages_refresh}}"></span>\n             </button>\n              <button tabindex="-1" ng-if="!ctrl.disableCardCopy" ng-click="ctrl.handleOnCopy($event)" class="ts-sym card-header-button" title="{{::$root.resources.strings.icons_copy|translate}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                <ng-include src="\'svg/icons-copy.html\'"></ng-include>\n                <span class="ts-popover-label" translate-once="{{::$root.resources.strings.botcards_card_header_menu_copy_option}}"></span>\n             </button>\n             <button tabindex="-1" ng-click="ctrl.handleAppInstall($event)" class="ts-sym card-header-button" ng-if="ctrl.showAppDetails" title="{{::$root.resources.strings.icons_apps|translate}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n              <ng-include src="\'svg/icons-apps.html\'"></ng-include>\n              <span class="ts-popover-label" translate-once="{{::$root.resources.strings.botcards_card_header_menu_app_details_option}}"></span>\n            </button>\n            </li>\n            <li class="card-overflow-menu-items" ng-repeat="action in ctrl.overflowActions">\n              <button tabindex="-1" ng-click="action.execute()" class="ts-sym card-overflow-button" title="{{::action.title}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                <img ng-src="{{::action.iconUrl}}" class="card-overflow-icon" ng-if="::!ctrl.utilityService.useNgIncludeForIcon(action.iconUrl)"/>\n                <ng-include src="action.iconUrl" class="card-overflow-icon" ng-if="::ctrl.utilityService.useNgIncludeForIcon(action.iconUrl)"></ng-include>\n                <span class="ts-popover-label" translate-once="{{::action.title}}"></span>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n</div>'},2829:function(e,t){e.exports='<div class="card-overflow-menu popover minwidth-sm maxwidth-common app-default-menu" data-tid="cardOverflowMenu" ng-keydown="ctrl.handleMenuKeyDown($event)" id="cardOverflowMenu">\n     <div class="scroll-container">\n      <div class="simple-scrollbar" simple-scrollbar>\n        <div>\n          <ul acc-role="menu" class="app-default-menu-ul">\n              <li class="card-overflow-menu-items" ng-repeat="action in ctrl.headlessOverflowActions">\n                <button tabindex="-1" ng-click="ctrl.handleOnExecuteAction(action)" class="ts-sym card-overflow-button" title="{{::action.title}}" acc-role="menu-item focus-default" do-not-decorate-click-for-acc>\n                  <img ng-src="{{::action.iconUrl}}" class="card-overflow-icon" ng-if="::!ctrl.isPinTabAction(action)"/>\n                  <ng-include src="svg/icons-compose-extension-pin.html" class="card-overflow-icon" ng-if="::ctrl.isPinTabAction(action)"></ng-include>\n                  <span class="ts-popover-label" translate-once="{{::action.title}}"></span>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n</div>\n'},2830:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.formatText=void 0;var r=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var i=t;null!=(n=this._regularExpression.exec(t));)i=i.replace(n[0],this.internalFormat(e,n));return i}return t},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),i=void 0!==t[2]?t[2].toLowerCase():"compact";return"compact"!==i?n.toLocaleDateString(e,{day:"numeric",weekday:i,month:i,year:"numeric"}):n.toLocaleDateString()},t}(r),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(r);t.formatText=function(e,t){for(var n=t,i=0,r=[new o(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];i<r.length;i++)n=r[i].format(e,n);return n}},2831:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(2832),t),r(n(2833),t)},2832:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItem=void 0;var i=n(97),r=n(148),o=function(){function e(e,t){this._isEnabled=!0,this.key=e,this._value=t}return e.prototype.click=function(){this.isEnabled&&this.onClick&&this.onClick(this)},e.prototype.updateCssClasses=function(){if(this._element){var e=this._hostConfig?this._hostConfig:i.defaultHostConfig;this._element.className=e.makeCssClassName("ac-ctrl"),this._element.classList.add(e.makeCssClassName(this.isEnabled?"ac-ctrl-dropdown-item":"ac-ctrl-dropdown-item-disabled")),this.isEnabled||this._element.classList.add(e.makeCssClassName("ac-disabled"))}},e.prototype.toString=function(){return this.value},e.prototype.render=function(e){var t=this;return this._hostConfig=e,this._element||(this._element=document.createElement("span"),this._element.innerText=this.value,this._element.setAttribute("role","menuitem"),this.isEnabled||this._element.setAttribute("aria-disabled","true"),this._element.setAttribute("aria-current","false"),this._element.onmouseup=function(e){t.click()},this._element.onkeydown=function(e){e.key===r.Constants.keys.enter&&(e.cancelBubble=!0,t.click())},this.updateCssClasses()),this._element},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._element&&(this._element.innerText=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),e}();t.MenuItem=o},2833:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.PopupMenu=void 0;var r=n(148),o=n(2834),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=new o.Collection,t._renderedItems=[],t._selectedIndex=-1,t}return i(t,e),t.prototype.renderContent=function(){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-ctrl ac-popup"),e.setAttribute("role","listbox");for(var t=0;t<this._items.length;t++){var n=this._items.get(t).render(this.hostConfig);n.tabIndex=0,e.appendChild(n),t===this.selectedIndex&&n.focus(),this._renderedItems.push(n)}return e},t.prototype.keyDown=function(t){e.prototype.keyDown.call(this,t);var n=this._selectedIndex;switch(t.key){case r.Constants.keys.tab:this.closePopup(!0);break;case r.Constants.keys.up:n<=0?n=this._renderedItems.length-1:--n<0&&(n=this._renderedItems.length-1),this.selectedIndex=n,t.cancelBubble=!0;break;case r.Constants.keys.down:n<0?n=0:++n>=this._renderedItems.length&&(n=0),this.selectedIndex=n,t.cancelBubble=!0}},Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)},enumerable:!1,configurable:!0}),t}(n(2835).PopupControl);t.PopupMenu=a},2834:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var i=function(){function e(){this._items=[]}return e.prototype.get=function(e){return this._items[e]},e.prototype.add=function(e){this._items.push(e),this.onItemAdded&&this.onItemAdded(e)},e.prototype.remove=function(e){var t=this._items.indexOf(e);t>=0&&(this._items=this._items.splice(t,1),this.onItemRemoved&&this.onItemRemoved(e))},e.prototype.indexOf=function(e){return this._items.indexOf(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e}();t.Collection=i},2835:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupControl=void 0;var i=n(148),r=n(48),o=n(97),a=function(){function e(){this._isOpen=!1}return e.prototype.keyDown=function(e){switch(e.key){case i.Constants.keys.escape:this.closePopup(!0)}},e.prototype.render=function(e){var t=this,n=document.createElement("div");return n.tabIndex=0,n.className=this.hostConfig.makeCssClassName("ac-ctrl","ac-ctrl-popup-container"),n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.onkeydown=function(e){return t.keyDown(e),!e.cancelBubble},n.appendChild(this.renderContent()),n},e.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},e.prototype.popup=function(e){var t,n,i,o,a,s=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className=this.hostConfig.makeCssClassName("ac-ctrl-overlay"),this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(e){s.closePopup(!0)},document.body.appendChild(this._overlayElement);var l=e.getBoundingClientRect();this._popupElement=this.render(l),(t=this._popupElement.classList).remove.apply(t,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight","ac-ctrl-slideRightToLeft","ac-ctrl-slideTopToBottom","ac-ctrl-slideRightToLeft")),window.addEventListener("resize",function(e){s.closePopup(!0)});var c=e.getAttribute("aria-label");c&&this._popupElement.setAttribute("aria-label",c),this._overlayElement.appendChild(this._popupElement);var p,u=this._popupElement.getBoundingClientRect(),d=window.innerHeight-l.bottom,h=l.top,f=window.innerWidth-l.right,y=l.left,g=l.left+r.getScrollX();if(h<u.height&&d<u.height){var m=Math.min(u.height,window.innerHeight);if(this._popupElement.style.maxHeight=m+"px",p=m<u.height?r.getScrollY():r.getScrollY()+l.top+(l.height-m)/2,y<u.width&&f<u.width){var v=Math.min(u.width,window.innerWidth);this._popupElement.style.maxWidth=v+"px",g=v<u.width?r.getScrollX():r.getScrollX()+l.left+(l.width-v)/2}else f>=u.width?(g=r.getScrollX()+l.right,(n=this._popupElement.classList).add.apply(n,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight"))):(g=r.getScrollX()+l.left-u.width,(i=this._popupElement.classList).add.apply(i,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideRightToLeft")))}else d>=u.height?(p=r.getScrollY()+l.bottom,(o=this._popupElement.classList).add.apply(o,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideTopToBottom"))):(p=r.getScrollY()+l.top-u.height,(a=this._popupElement.classList).add.apply(a,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideBottomToTop"))),f<u.width&&(g=r.getScrollX()+l.right-u.width);this._popupElement.style.left=g+"px",this._popupElement.style.top=p+"px",this._popupElement.focus(),this._isOpen=!0}},e.prototype.closePopup=function(e){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,e))},Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:o.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),e}();t.PopupControl=a},2836:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Table=t.TableRow=t.TableCell=t.StylableContainer=t.TableColumnDefinition=void 0;var o=n(147),a=n(37),s=n(146),l=n(49),c=n(43),p=n(57),u=n(48),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=new c.SizeAndUnit(1,a.SizeUnit.Weight),t}return i(t,e),t.prototype.getSchemaKey=function(){return"ColumnDefinition"},t.horizontalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"horizontalCellContentAlignment",a.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"verticalCellContentAlignment",a.VerticalAlignment),t.widthProperty=new l.CustomProperty(l.Versions.v1_5,"width",function(e,t,n,i){var r=t.defaultValue,o=n[t.name],s=!1;if("number"!=typeof o||isNaN(o))if("string"==typeof o)try{r=c.SizeAndUnit.parse(o)}catch(e){s=!0}else s=!0;else r=new c.SizeAndUnit(o,a.SizeUnit.Weight);return s&&i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidColumnWidth(o)),r},function(e,t,n,i,r){i.unit===a.SizeUnit.Pixel?r.serializeValue(n,"width",i.physicalSize+"px"):r.serializeNumber(n,"width",i.physicalSize)},new c.SizeAndUnit(1,a.SizeUnit.Weight)),r([(0,l.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),r([(0,l.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),r([(0,l.property)(t.widthProperty)],t.prototype,"width",void 0),t}(l.SerializableObject);t.TableColumnDefinition=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t}return i(t,e),t.prototype.parseItem=function(e,t){var n=this;return t.parseCardObject(this,e,[],!this.isDesignMode(),function(e){return n.createItemInstance(e)},function(e,n){t.logParseEvent(void 0,a.ValidationEvent.ElementTypeNotAllowed,p.Strings.errors.elementTypeNotAllowed(e))})},t.prototype.internalAddItem=function(e){if(e.parent)throw new Error(p.Strings.errors.elementAlreadyParented());this._items.push(e),e.setParent(this)},t.prototype.internalRemoveItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.internalIndexOf=function(e){return this._items.indexOf(e)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._items=[];var i=t[this.getCollectionPropertyName()];if(Array.isArray(i))for(var r=0,o=i;r<o.length;r++){var a=o[r],s=this.parseItem(a,n);s&&this._items.push(s)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getCollectionPropertyName(),this._items)},t.prototype.removeItem=function(e){return this.internalRemoveItem(e)},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(0):void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(this.getItemCount()-1):void 0},t}(o.StylableCardElementContainer);t.StylableContainer=h;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columnIndex=-1,t._cellType="data",t}return i(t,e),t.prototype.getHasBorder=function(){return this.parentRow.parentTable.showGridLines},t.prototype.applyBorder=function(){if(this.renderedElement&&this.getHasBorder()){var e=this.hostConfig.containerStyles.getStyleByName(this.parentRow.parentTable.gridStyle);if(e.borderColor){var t=(0,u.stringToCssColor)(e.borderColor);t&&(this.renderedElement.style.borderRight="1px solid "+t,this.renderedElement.style.borderBottom="1px solid "+t)}}},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new c.PaddingDefinition(a.Spacing.Small,a.Spacing.Small,a.Spacing.Small,a.Spacing.Small):e.prototype.getDefaultPadding.call(this)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return t&&(t.setAttribute("role","data"===this.cellType?"cell":"columnheader"),t.style.minWidth="0","header"===this.cellType&&t.setAttribute("scope","col")),t},t.prototype.shouldSerialize=function(e){return!0},t.prototype.getJsonTypeName=function(){return"TableCell"},t.prototype.getEffectiveTextStyleDefinition=function(){return"header"===this.cellType?this.hostConfig.textStyles.columnHeader:e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.getEffectiveHorizontalAlignment=function(){if(void 0!==this.horizontalAlignment)return this.horizontalAlignment;if(void 0!==this.parentRow.horizontalCellContentAlignment)return this.parentRow.horizontalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).horizontalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.horizontalCellContentAlignment?this.parentRow.parentTable.horizontalCellContentAlignment:e.prototype.getEffectiveHorizontalAlignment.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;if(void 0!==this.parentRow.verticalCellContentAlignment)return this.parentRow.verticalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).verticalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.verticalCellContentAlignment?this.parentRow.parentTable.verticalCellContentAlignment:e.prototype.getEffectiveVerticalContentAlignment.call(this)},Object.defineProperty(t.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellType",{get:function(){return this._cellType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentRow",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(o.Container);t.TableCell=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getDefaultPadding=function(){return new c.PaddingDefinition(a.Spacing.None,a.Spacing.None,a.Spacing.None,a.Spacing.None)},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=(0,u.stringToCssColor)(e.backgroundColor);t&&(this.renderedElement.style.backgroundColor=t)}}},t.prototype.getCollectionPropertyName=function(){return"cells"},t.prototype.createItemInstance=function(e){return e&&"TableCell"!==e?void 0:new f},t.prototype.internalRender=function(){var e=this.getIsFirstRow(),t=this.hostConfig.table.cellSpacing,n=document.createElement("div");n.setAttribute("role","row"),n.style.display="flex",n.style.flexDirection="row";for(var i=0;i<Math.min(this.getItemCount(),this.parentTable.getColumnCount());i++){var r=this.getItemAt(i);r._columnIndex=i,r._cellType=this.parentTable.firstRowAsHeaders&&e?"header":"data";var o=r.render();if(o){var s=this.parentTable.getColumnAt(i);s.computedWidth.unit===a.SizeUnit.Pixel?o.style.flex="0 0 "+s.computedWidth.physicalSize+"px":o.style.flex="1 1 "+s.computedWidth.physicalSize+"%",i>0&&!this.parentTable.showGridLines&&t>0&&(o.style.marginLeft=t+"px"),n.appendChild(o)}}return n.children.length>0?n:void 0},t.prototype.shouldSerialize=function(e){return!0},t.prototype.addCell=function(e){this.internalAddItem(e)},t.prototype.removeCellAt=function(e){return e>=0&&e<this.getItemCount()&&this.removeItem(this.getItemAt(e))},t.prototype.indexOf=function(e){return e instanceof f?this.internalIndexOf(e):-1},t.prototype.ensureHasEnoughCells=function(e){for(;this.getItemCount()<e;)this.addCell(new f)},t.prototype.getJsonTypeName=function(){return"TableRow"},t.prototype.getIsFirstRow=function(){return this.parentTable.getItemAt(0)===this},Object.defineProperty(t.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.styleProperty=new o.ContainerStyleProperty(l.Versions.v1_5,"style"),t.horizontalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"horizontalCellContentAlignment",a.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"verticalCellContentAlignment",a.VerticalAlignment),r([(0,l.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),r([(0,l.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(h);t.TableRow=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t.firstRowAsHeaders=!0,t.showGridLines=!0,t}return i(t,e),Object.defineProperty(t.prototype,"gridStyle",{get:function(){var e=this.getValue(t.gridStyleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e},set:function(e){this.setValue(t.gridStyleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.ensureRowsHaveEnoughCells=function(){for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).ensureHasEnoughCells(this.getColumnCount())},t.prototype.removeCellsFromColumn=function(e){for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).removeCellAt(e)},t.prototype.getCollectionPropertyName=function(){return"rows"},t.prototype.createItemInstance=function(e){return e&&"TableRow"!==e?void 0:new y},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.ensureRowsHaveEnoughCells()},t.prototype.internalRender=function(){if(this.getItemCount()>0){for(var e=0,t=0,n=this._columns;t<n.length;t++)(o=n[t]).width.unit===a.SizeUnit.Weight&&(e+=o.width.physicalSize);for(var i=0,r=this._columns;i<r.length;i++){var o=r[i];o.width.unit===a.SizeUnit.Pixel?o.computedWidth=new c.SizeAndUnit(o.width.physicalSize,a.SizeUnit.Pixel):o.computedWidth=new c.SizeAndUnit(100/e*o.width.physicalSize,a.SizeUnit.Weight)}var s=document.createElement("div");if(s.setAttribute("role","table"),s.style.display="flex",s.style.flexDirection="column",this.showGridLines){var l=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(l.borderColor){var p=(0,u.stringToCssColor)(l.borderColor);p&&(s.style.borderTop="1px solid "+p,s.style.borderLeft="1px solid "+p)}}for(var d=this.hostConfig.table.cellSpacing,h=0;h<this.getItemCount();h++){var f=this.getItemAt(h).render();if(f){if(h>0&&!this.showGridLines&&d>0){var y=document.createElement("div");y.setAttribute("aria-hidden","true"),y.style.height=d+"px",s.appendChild(y)}s.appendChild(f)}}return s}},t.prototype.addColumn=function(e){this._columns.push(e),this.ensureRowsHaveEnoughCells()},t.prototype.removeColumn=function(e){var t=this._columns.indexOf(e);t>=0&&(this.removeCellsFromColumn(t),this._columns.splice(t,1))},t.prototype.getColumnCount=function(){return this._columns.length},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.addRow=function(e){this.internalAddItem(e),e.ensureHasEnoughCells(this.getColumnCount())},t.prototype.indexOf=function(e){return e instanceof y?this.internalIndexOf(e):-1},t.prototype.getJsonTypeName=function(){return"Table"},t._columnsProperty=new l.SerializableObjectCollectionProperty(l.Versions.v1_5,"columns",d),t.firstRowAsHeadersProperty=new l.BoolProperty(l.Versions.v1_5,"firstRowAsHeaders",!0),t.showGridLinesProperty=new l.BoolProperty(l.Versions.v1_5,"showGridLines",!0),t.gridStyleProperty=new o.ContainerStyleProperty(l.Versions.v1_5,"gridStyle"),t.horizontalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"horizontalCellContentAlignment",a.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new l.EnumProperty(l.Versions.v1_5,"verticalCellContentAlignment",a.VerticalAlignment),r([(0,l.property)(t._columnsProperty)],t.prototype,"_columns",void 0),r([(0,l.property)(t.firstRowAsHeadersProperty)],t.prototype,"firstRowAsHeaders",void 0),r([(0,l.property)(t.showGridLinesProperty)],t.prototype,"showGridLines",void 0),r([(0,l.property)(t.gridStyleProperty)],t.prototype,"gridStyle",null),r([(0,l.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),r([(0,l.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(h);t.Table=g,s.GlobalRegistry.defaultElements.register("Table",g,l.Versions.v1_5)},2837:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelAdapter=void 0;var i=function(){return function(){}}();t.ChannelAdapter=i},2838:function(e,t,n){"use strict";function i(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(l.GlobalSettings.applets.logEnabled)if(l.GlobalSettings.applets.onLogEvent)l.GlobalSettings.applets.onLogEvent(e,t,n);else switch(e){case a.LogLevel.Warning:console.warn(t,n);break;case a.LogLevel.Error:console.error(t,n);break;default:console.log(t,n)}}var r=this&&this.__awaiter||function(e,t,n,i){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):r(e.value).then(a,s)}l((i=i.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,o=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(e){n=[6,e],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveApplet=void 0;var a=n(37),s=n(48),l=n(43),c=n(329),p=n(57),u=n(147),d=n(49),h=function(){function e(e,t,n){this.action=e,this.trigger=t,this.consecutiveRefreshes=n,this.attemptNumber=0}return e.prototype.retryAsync=function(){return r(this,void 0,void 0,function(){return o(this,function(e){return this.onSend&&this.onSend(this),[2]})})},e}(),f=function(){function e(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return e.prototype.displayCard=function(e){if(!e.renderedElement)throw new Error("displayCard: undefined card.");s.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(e.renderedElement)},e.prototype.showManualRefreshButton=function(e){var t=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var n=void 0;if(this.onRenderManualRefreshButton)n=this.onRenderManualRefreshButton(this);else{var i=p.Strings.runtime.refreshThisCard();if(l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Automatic){var r=p.Strings.runtime.automaticRefreshPaused();" "!==r[r.length-1]&&(r+=" "),i=p.Strings.runtime.clckToRestartAutomaticRefresh()}var o={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:i,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},h=new u.AdaptiveCard;h.parse(o,new u.SerializationContext(d.Versions.v1_2)),h.onExecuteAction=function(n){"refreshCard"===n.id&&(s.clearElementChildren(t._refreshButtonHostElement),t.internalExecuteAction(e,c.ActivityRequestTrigger.Automatic,0))},n=h.render()}n&&(s.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(n),this._refreshButtonHostElement.style.removeProperty("display"))}},e.prototype.createActivityRequest=function(e,t,n){var i=this;if(this.card){var r=new h(e,t,n);return r.onSend=function(e){e.attemptNumber++,i.internalSendActivityRequestAsync(r)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,r,e)?void 0:r}throw new Error("createActivityRequest: no card has been set.")},e.prototype.createMagicCodeInputCard=function(t){var n={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===t?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e._submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e._cancelMagicCodeAuthActionId,title:"Cancel"}]}]},i=new u.AdaptiveCard;return i.parse(n),i},e.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&i(a.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new u.SerializationContext},e.prototype.internalSetCard=function(e,t){var n=this;if("object"==typeof e&&"AdaptiveCard"===e.type&&(this._cardPayload=e),this._cardPayload)try{var r=new u.AdaptiveCard;this.hostConfig&&(r.hostConfig=this.hostConfig);var o=this.createSerializationContext();if(r.parse(this._cardPayload,o),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=r,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(e){n.cancelAutomaticRefresh(),n.internalExecuteAction(e,c.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(e){n.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Automatic&&t<l.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)i(a.LogLevel.Info,"Triggering automatic card refresh number "+(t+1)),this.internalExecuteAction(this._card.refresh.action,c.ActivityRequestTrigger.Automatic,t+1);else{i(a.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var s=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout(function(){n._allowAutomaticCardUpdate&&n.internalExecuteAction(s,c.ActivityRequestTrigger.Automatic,t+1)},l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else l.GlobalSettings.applets.refresh.mode!==a.RefreshMode.Disabled&&(t>0?i(a.LogLevel.Warning,"Stopping automatic refreshes after "+t+" consecutive refreshes."):i(a.LogLevel.Warning,"The card has a refresh section, but automatic refreshes are disabled."),(l.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Manual)&&(i(a.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(e){i(a.LogLevel.Error,"setCard: "+e)}},e.prototype.internalExecuteAction=function(e,t,n){if(e instanceof u.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var i=this.createActivityRequest(e,t,n);i&&i.retryAsync()}this.onAction&&this.onAction(this,e)},e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,e);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner",t.style.width="28px",t.style.height="28px",this._progressOverlay.appendChild(t)}return this._progressOverlay},e.prototype.removeProgressOverlay=function(e){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,e),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},e.prototype.activityRequestSucceeded=function(e,t){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,e,t)},e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):l.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},e.prototype.showAuthCodeInputDialog=function(t){var n=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,t)){var r=this.createMagicCodeInputCard(t.attemptNumber);r.render(),r.onExecuteAction=function(r){if(n.card&&r instanceof u.SubmitAction)switch(r.id){case e._submitMagicCodeActionId:var o=void 0;r.data&&"string"==typeof r.data.magicCode&&(o=r.data.magicCode),o?(n.displayCard(n.card),t.authCode=o,t.retryAsync()):alert("Please enter the magic code you received.");break;case e._cancelMagicCodeAuthActionId:i(a.LogLevel.Warning,"Authentication cancelled by user."),n.displayCard(n.card);break;default:i(a.LogLevel.Error,"Unexpected action taken from magic code input card (id = "+r.id+")"),alert(p.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(r)}},e.prototype.internalSendActivityRequestAsync=function(e){return r(this,void 0,void 0,function(){var t,n,r,s,u;return o(this,function(d){switch(d.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(t=this.createProgressOverlay(e))&&this.renderedElement.appendChild(t),n=!1,r=function(){var t,r,u,d,h,f,y;return o(this,function(o){switch(o.label){case 0:t=void 0,1===e.attemptNumber?i(a.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")"):i(a.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.channelAdapter.sendRequestAsync(e)];case 2:return t=o.sent(),[3,4];case 3:return r=o.sent(),i(a.LogLevel.Error,"Activity request failed: "+r),s.removeProgressOverlay(e),n=!0,[3,4];case 4:if(!t)return[3,10];if(!(t instanceof c.SuccessResponse))return[3,5];if(s.removeProgressOverlay(e),void 0===t.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");u=t.rawContent;try{u=JSON.parse(t.rawContent)}catch(e){}if("string"==typeof u)i(a.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s)."),s.activityRequestSucceeded(t,u);else{if("object"!=typeof u||"AdaptiveCard"!==u.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")");i(a.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s)."),s.internalSetCard(u,e.consecutiveRefreshes),s.activityRequestSucceeded(t,s.card)}return n=!0,[3,10];case 5:return t instanceof c.ErrorResponse?(d=s.activityRequestFailed(t))>=0&&e.attemptNumber<l.GlobalSettings.applets.maximumRetryAttempts?(i(a.LogLevel.Warning,"Activity request failed: ".concat(t.error.message,". Retrying in ").concat(d,"ms")),e.attemptNumber++,[4,new Promise(function(e,t){window.setTimeout(function(){e()},d)})]):[3,7]:[3,9];case 6:return o.sent(),[3,8];case 7:i(a.LogLevel.Error,"Activity request failed: ".concat(t.error.message,". Giving up after ").concat(e.attemptNumber," attempt(s)")),s.removeProgressOverlay(e),n=!0,o.label=8;case 8:return[3,10];case 9:if(t instanceof c.LoginRequestResponse){if(i(a.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s)."),e.attemptNumber<=l.GlobalSettings.applets.maximumRetryAttempts){if(h=!0,t.tokenExchangeResource&&s.onSSOTokenNeeded&&(h=!s.onSSOTokenNeeded(s,e,t.tokenExchangeResource)),h){if(s.removeProgressOverlay(e),void 0===t.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");i(a.LogLevel.Info,"Login required at "+t.signinButton.value),s.onShowSigninPrompt?s.onShowSigninPrompt(s,e,t.signinButton):(s.showAuthCodeInputDialog(e),f=window.screenX+(window.outerWidth-l.GlobalSettings.applets.authPromptWidth)/2,y=window.screenY+(window.outerHeight-l.GlobalSettings.applets.authPromptHeight)/2,window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width=".concat(l.GlobalSettings.applets.authPromptWidth,",height=").concat(l.GlobalSettings.applets.authPromptHeight,",left=").concat(f,",top=").concat(y)))}}else i(a.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)"),alert(p.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+JSON.stringify(t));case 10:return[2]}})},s=this,d.label=1;case 1:return n?[3,3]:[5,r()];case 2:return"break"===(u=d.sent())?[3,3]:[3,1];case 3:return[2]}})})},e.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,c.ActivityRequestTrigger.Manual,0)},e.prototype.setCard=function(e){this.internalSetCard(e,0)},Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),e._submitMagicCodeActionId="submitMagicCode",e._cancelMagicCodeAuthActionId="cancelMagicCodeAuth",e}();t.AdaptiveApplet=f},2839:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(2840))},2840:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(149),a=n(2841),s=n(2842),l=function(e){function t(t,n,i,r,a,s,l,c,p,u,d,h,f){var y=e.call(this)||this;return y.eventingService=t,y.messagingTelemetryService=n,y.peopleService=i,y.tooltipService=r,y.tooltipCssApplicators=a,y.constants=s,y.$timeout=l,y.$compile=c,y.$scope=p,y.$translate=u,y.resources=d,y.loggingService=h,y.featureEnablingMap={},y.waitForMessageListRenderedComponents=[o.ComponentName.Persona,o.ComponentName.PersonaSet],y.featureEnablingMap[o.ComponentName.Persona]=f.valueAsBoolean(s.settings.names.enableAdaptiveCardPersona),y.featureEnablingMap[o.ComponentName.PersonaSet]=f.valueAsBoolean(s.settings.names.enableAdaptiveCardPersonaSet),y}return i(t,e),t.prototype.internalRender=function(){var e=this,t=this.getPlaceholderComponent();return this.featureEnablingMap[this.componentName]&&this.waitForChannelSwitch().then(function(){return e.loadComponent()}),this.componentElement=document.createElement("div"),t&&this.componentElement.append(t),this.componentElement},t.prototype.getJsonTypeName=function(){return this.component&&this.component.getJsonTypeName?this.component.getJsonTypeName():"Component"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.componentName=t.name,this.componentPayload=t},t.prototype.getPlaceholderComponent=function(){var e=document.createElement("div");switch(this.componentName&&this.componentName.toLowerCase()){case o.ComponentName.Persona:case o.ComponentName.PersonaSet:e.style.height="20px"}return e},t.prototype.loadComponent=function(){var e=this;switch(this.componentName&&this.componentName.toLowerCase()){case o.ComponentName.Persona:this.component=new a.Persona(this.componentPayload,function(t){return e.renderAfterLoaded(t)},this.peopleService,this.$scope.$new(),this.$compile,this.loggingService,this.constants);break;case o.ComponentName.PersonaSet:this.component=new s.PersonaSet(this.componentPayload,function(t){return e.renderAfterLoaded(t)},this.peopleService,this.tooltipService,this.tooltipCssApplicators,this.constants,this.$timeout,this.$scope.$new(),this.$translate,this.resources,this.$compile,this.loggingService);break;default:this.component=null}},t.prototype.renderAfterLoaded=function(e){$(this.componentElement).empty().append(e)},t.prototype.waitForChannelSwitch=function(){var e=this;return new Promise(function(t){var n=e.waitForMessageListRenderedComponents.indexOf(e.componentName)>-1;if(e.messagingTelemetryService.activeChannelSwitchScenario&&n)var i=e.eventingService.$on(e.$scope,e.constants.events.messages.messageListRenderStateChanged,function(e,n){n.state>=teamspace.components.MessageListRenderState.Rendered&&(i&&i(),t())});else t()})},t}(r.CardElement);t.Component=l},2841:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(334),r=n(149),o=function(){function e(e,t,n,i,r,o,a){this.payload=e,this.renderAfterLoadedCallback=t,this.peopleService=n,this.$scope=i,this.$compile=r,this.loggingService=o,this.constants=a,this.render()}return e.prototype.getJsonTypeName=function(){return"Persona"},e.prototype.render=function(){if(this.payload){var e=this.payload.properties;if(e&&r.isPersonaProperties(e)&&(e.userPrincipalName||e.displayName)){var t=e.userPrincipalName,n=e.displayName;this.loadPeopleDisplayName(t,n)}}},e.prototype.loadPeopleDisplayName=function(e,t){var n=this,i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardComponent.personaLoadUserProfile);this.peopleService.getPeopleProfileFromAAD(e,"adaptive card persona",!0).then(function(r){n.persona={upn:e,displayName:r.displayName||t},i.stop()}).catch(function(){n.persona={upn:e,displayName:t},i.fail({error:"failed to fetch user profile"})}).finally(function(){n.renderAfterLoaded()})},e.prototype.renderAfterLoaded=function(){var e,t=this.payload.view;switch(this.$scope.persona=this.persona,"string"==typeof t?t.toLowerCase():t){case r.ComponentViewType.Compact:default:e=i.AdaptiveCardComponentUtils.getPersonaCompactHtmlString(!0)}this.renderAfterLoadedCallback(this.$compile(e)(this.$scope)[0])},e}();t.Persona=o},2842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(334),r=n(149),o=function(){function e(e,t,n,i,r,o,a,s,l,c,p,u){this.payload=e,this.renderAfterLoadedCallback=t,this.peopleService=n,this.tooltipService=i,this.tooltipCssApplicators=r,this.constants=o,this.$timeout=a,this.$scope=s,this.$translate=l,this.resources=c,this.$compile=p,this.loggingService=u,this.render()}return e.prototype.getJsonTypeName=function(){return"PersonaSet"},e.prototype.render=function(){if(this.payload){var e=this.payload.properties;if(e&&r.isPersonaSetProperties(e)&&e.users&&e.users.length){var t=e.users.filter(function(e){return e.userPrincipalName||e.displayName});t.length&&this.loadPeopleDisplayNames(t)}}},e.prototype.morePersonasIconMouseenterHandler=function(e){var t=this;this.$timeout.cancel(this.timer),this.isMorePersonasIconHovered=!0,this.isMorePersonasListVisible||(this.timer=this.$timeout(function(){var n={templateUrl:"components/threads/thread/cards/adaptive-card-more-personas-list.html",trigger:"manual",container:"body",scope:t.$scope,autoClose:!0,placement:"right",onHide:function(){t.isMorePersonasListVisible=!1}},i={sourceElement:$(e.target),tooltipType:teamspace.services.TooltipType.Popover,options:n,tooltipId:"adaptiveCardMorePersonasTooltip",cssApplicator:function(){t.tooltipCssApplicators.contextMenu(e)}};t.tooltipService.showTooltip(i),t.isMorePersonasListVisible=!0},200,!1))},e.prototype.morePersonasIconMouseleaveHandler=function(){var e=this;this.$timeout.cancel(this.timer),this.isMorePersonasIconHovered=!1,this.timer=this.$timeout(function(){e.isMorePersonasListHovered||e.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,"adaptiveCardMorePersonasTooltip")},500,!1)},e.prototype.morePersonasListMouseenterHandler=function(){this.$timeout.cancel(this.timer),this.isMorePersonasListHovered=!0},e.prototype.morePersonasListMouseleaveHandler=function(){var e=this;this.$timeout.cancel(this.timer),this.isMorePersonasListHovered=!1,this.timer=this.$timeout(function(){e.isMorePersonasIconHovered||e.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,"adaptiveCardMorePersonasTooltip")},500,!1)},e.prototype.morePersonasIconKeydownHandler=function(e){var t=e.keyCode;t!==this.constants.keyCodes.space&&t!==this.constants.keyCodes.enter||this.morePersonasIconMouseenterHandler(e)},e.prototype.loadPeopleDisplayNames=function(e){var t=this,n=_.map(e,function(e){return e.userPrincipalName}),i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardComponent.personaSetLoadUserProfiles);this.peopleService.getAllShortPeopleProfileFromAAD(n,"adaptive card persona set",!0).then(function(n){var r={};_.each(n,function(e){r[e.userPrincipalName]=e.displayName}),t.personas=_.map(e,function(e){return{upn:e.userPrincipalName,displayName:r[e.userPrincipalName]||e.displayName}}),i.stop()}).catch(function(){t.personas=_.map(e,function(e){return{upn:e.userPrincipalName,displayName:e.displayName}}),i.fail({error:"failed to fetch user profiles"})}).finally(function(){t.renderAfterLoaded()})},e.prototype.renderAfterLoaded=function(){var e=4,t="";if(this.personas.length>4){e=3;var n=this.personas.length-4+1;t=1===n?this.$translate.instant(this.resources.strings.botcards_adaptiveCard_more_personas_icon_aria_label_single):this.$translate.instant(this.resources.strings.botcards_adaptiveCard_more_personas_icon_aria_label_multiple,{morePersonasCount:n})}1===this.personas.length?this.$scope.persona=this.personas[0]:this.$scope.personas=this.personas,this.$scope.morePersonas=this.personas.slice(e),this.$scope.ctrl=this;var o,a=this.payload.view;switch("string"==typeof a?a.toLowerCase():a){case r.ComponentViewType.Compact:default:o=i.AdaptiveCardComponentUtils.getPersonaSetCompactHtmlString(this.personas,4,t)}this.renderAfterLoadedCallback(this.$compile(o)(this.$scope)[0])},e}();t.PersonaSet=o},2843:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(50),a=function(e){function t(t,n,i,r,o,a,s,l,c,p){var u=e.call(this)||this;return u.constants=t,u.enableExpandingImagesInAdaptiveCards=n,u.enlargeImageLabel=i,u.htmlSanitizer=r,u.settingsService=o,u.amsUrlService=a,u.utilityService=s,u.$scope=l,u.$compile=c,u.logger=p,u}return i(t,e),t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return o.AdaptiveCardHelper.addImagePostProcessingForImages(this.constants,[this.isAllowImageExpand],this.enlargeImageLabel,this.htmlSanitizer,t,this.settingsService,this.amsUrlService,this.utilityService,this.$scope,this.$compile,this.logger),t},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isAllowImageExpand=this.enableExpandingImagesInAdaptiveCards&&t&&t.msTeams&&t.msTeams.allowExpand},t}(r.Image);t.Image=a},2844:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(50),a=function(e){function t(t,n,i,r,o,a,s,l,c,p){var u=e.call(this)||this;return u.constants=t,u.enableExpandingImagesInAdaptiveCards=n,u.enlargeImageLabel=i,u.htmlSanitizer=r,u.settingsService=o,u.amsUrlService=a,u.utilityService=s,u.$scope=l,u.$compile=c,u.logger=p,u.isAllowImagesToExpand=[],u}return i(t,e),t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return o.AdaptiveCardHelper.addImagePostProcessingForImages(this.constants,this.isAllowImagesToExpand,this.enlargeImageLabel,this.htmlSanitizer,t,this.settingsService,this.amsUrlService,this.utilityService,this.$scope,this.$compile,this.logger),t},t.prototype.parse=function(t){var n=this;e.prototype.parse.call(this,t),this.enableExpandingImagesInAdaptiveCards&&t&&t.images&&t.images.forEach(function(e){e.msTeams&&e.msTeams.allowExpand?n.isAllowImagesToExpand.push(!0):n.isAllowImagesToExpand.push(!1)})},t}(r.ImageSet);t.ImageSet=a},2845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,i,r,o,a){this.$compile=e,this.$scope=t,this.inputElement=n,this.visibleSvgHtml=i.trustAsHtml(r.get("svg/icons-show-input.html")),this.maskedSvgHtml=i.trustAsHtml(r.get("svg/icons-hide-input.html")),this.hideLabel=o.instant(a.strings.botcards_adaptiveCard_password_input_icon_hide_aria_label),this.revealLabel=o.instant(a.strings.botcards_adaptiveCard_password_input_icon_reveal_aria_label)}return e.prototype.internalRender=function(){this.inputType="password",this.inputElement.setAttribute("autocomplete","off"),this.$scope.ctrl=this;var e=angular.element(this.getIconElement());return this.$compile(e)(this.$scope),e.prepend(this.inputElement),e[0]},Object.defineProperty(e.prototype,"icon",{get:function(){return"text"===this.inputType?this.visibleSvgHtml:this.maskedSvgHtml},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputType",{get:function(){return this.inputElement.getAttribute("type")},set:function(e){this.inputElement.setAttribute("type",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonLabel",{get:function(){return"text"===this.inputType?this.hideLabel:this.revealLabel},enumerable:!0,configurable:!0}),e.prototype.getIconElement=function(){var e=angular.element("<div></div>");e.attr("class","password-input-reveal");var t=angular.element("<button ></button>");t.attr("aria-label","{{ctrl.buttonLabel}}"),t.attr("class","btn btn-default app-icons-fill-hover"),t.attr("ng-click","ctrl.toggleReveal()");var n=angular.element('<ng-bind-html ng-bind-html="ctrl.icon"></ng-bind-html>');return t.append(n),e.append(t),e},e.prototype.toggleReveal=function(){this.inputType="text"===this.inputType?"password":"text"},e}();t.TextInputPassword=i},2846:function(e,t){e.exports='<div class="ac-people-picker">\n  <div class="ts-select-people">\n    <recipient-line class="ts-teammates" placeholder="{{placeholder}}" recipients="selections" type="search" picker-usage-area="AdaptiveCard" aria-labelledby="tag-add-members-label" show-logged-in-user="true" use-people-provider="acPpCtrl.directorySearchMode !== 2" people-provider="acPpCtrl.fetchAllowedUsers(filter)" people-picker-filters="{{acPpCtrl.peoplePickerFilterScenario}}" people-picker-filters-for-initial-search="{{acPpCtrl.peoplePickerFilterScenario}}" people-picker-filters-for-subsequent-search="{{acPpCtrl.peoplePickerFilterScenario}}" choices="acPpCtrl.choices" filter-selected-contacts="true">\n    </recipient-line>\n  </div>\n</div>'},327:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),r=0,t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(t,"__esModule",{value:!0});var s,l=n(36),c=n(13),p=n(2827),u=n(2828),d=n(2829),h=n(19),f=n(78),y=n(50),g=n(188),m=n(116),v=n(19);!function(e){e.None="none",e.Manual="manual",e.Auto="automatic"}(s=t.CardRefreshType||(t.CardRefreshType={}));var b;!function(e){e[e.SHOW=0]="SHOW",e[e.HIDE=1]="HIDE",e[e.IN_PROGRESS=2]="IN_PROGRESS",e[e.COMPLETE=3]="COMPLETE"}(b||(b={}));var C=function(e){function t(t,n,i,r,o,a,s,l,c,p,u,d,f,y,g,m,v,C,S,A,w,P,E,x,I,T,k,O,R,V,M,B){var D=e.call(this,t,n,i,r,R)||this;return D.$scope=r,D.$element=o,D.$compile=a,D.$window=s,D.$translate=l,D.$templateCache=c,D.$timeout=p,D.constants=u,D.localizationService=d,D.ariaLiveService=f,D.eventingService=y,D.botCardFactory=g,D.htmlSanitizer=m,D.resources=v,D.loggingService=C,D.utilityService=S,D.peopleService=A,D.settingsService=w,D.tooltipService=P,D.tooltipCssApplicators=E,D.appsService=x,D.dialogService=I,D.semanticObjectService=T,D.htmlMessageBodyAdapterService=k,D.messagingTelemetryService=O,D.$q=V,D.amsUrlService=M,D.routeUtilityService=B,D.cardHeaderTitle="",D.cardFooterAddAppButtonTitle="",D.showAddAppMessageForButtons=!1,D.showAddAppMessageForRefresh=!1,D.showSignInMessageForRefresh=!1,D.showSSOConsentMessage=!1,D.headlessOverflowActions=[],D.overflowActions=[],D.showHeadlessCardOverflowActions=!1,D.isCardRefreshing=!1,D.disableCardCopy=!1,D.autoRefreshSuccess=!1,D.addAppHandlerFunction=void 0,D.signInHandlerFunction=void 0,D.cardBodyClass="card-body",D.cardBorderClass="card-border",D.cardResponsiveWidthClass="adaptive-card-responsive",D.cardFullWidthClass="adaptive-card-fullwidth",D.cardErrorClass="error",D.cardInfoClass="info",D.clientObservers={},D.refreshButtonState=b.HIDE,D.defaultFontSizeAndFontWeightPayload={fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Web", sans-serif',fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:300,default:400,bolder:600}},D.registeredRenderers={},D.userCountInConversation=-1,D.processMarkDown=function(e,t){var n;n=D.enableSharedMarkdownInstance?D.botCardService.processMarkdown(e):D.markdownIt.render(e),D.isAtMentionsEnabledInAdaptiveCards&&(n=D.populateAtMentionsSemanticObjects(e,n));var i=D.htmlSanitizer.sanitizeHtml(n);return t.didProcess=!0,t.outputHtml=i,i},D.mergePayload=function(e,t){var n=_.cloneDeep(e);delete n[D.constants.bots.cards.adaptiveCard.teamsActionWrapperName];try{var i=_.isString(t)?JSON.parse(t):t;i instanceof Object&&!(i instanceof Array)?n=_.defaults(n,i):D.logger.error("invoke payload must be an object (and array is not supported). Will ignore.")}catch(e){D.logger.error("embeddedActionValue must be either a JSON object OR stringified JSON")}return JSON.stringify(n)},D.logger=C.newLogger("AdaptiveCardController"),D.objectId=S.generateUUIDNormalized(),D.cardHeaderMenuId=S.generateUUID(),D.cardHeaderTitle=l.instant(v.strings.botcards_card_header_menu_more_options),D.acSerializationContext=new h.SerializationContext,r.onReady&&D.subscribe("onReady",r.onReady),r.onWillExecuteAction&&D.subscribe("onWillExecuteAction",r.onWillExecuteAction),r.onDidExecuteAction&&D.subscribe("onDidExecuteAction",r.onDidExecuteAction),r.onPostProcessingStyling&&D.subscribe("onPostProcessingStyling",r.onPostProcessingStyling),r.onCopy&&D.subscribe("onCopy",r.onCopy),r.onPreInit&&D.subscribe("onPreInit",r.onPreInit),y.$on(r,u.events.layout.themeChanged,function(e){return D.setupHostConfig(!0)}),D.cardEventHandler=function(e,t){D.handleCardEvent(e,t)},D.card&&D.card.subscribeForChanges(D.cardEventHandler),D.enlargeImageLabel=l.instant(v.strings.botcards_enlarge_image),D.enableExpandingImagesInAdaptiveCards=w.valueAsBoolean(u.settings.names.enableExpandingImagesInAdaptiveCards),D.isAtMentionsEnabledInAdaptiveCards=w.valueAsBoolean(u.settings.names.enableAtMentionsAdaptiveCardsMessaging),D.shouldDisableRerenderingForAdaptiveCards=w.valueAsBoolean(u.settings.names.disableRerenderingForAdaptiveCards),D.emailCardImprovementsEnabled=w.valueAsBoolean(u.settings.names.enableEmailAdaptiveCardImprovements),D.emailCardHackEnabled=w.valueAsBoolean(u.settings.names.enableEmailAdaptiveCardHack),D.variableCardWidthEnabled=w.valueAsBoolean(u.settings.names.enableAdaptiveCardVariableWidth),D.enableSharedMarkdownInstance=w.valueAsBoolean(u.settings.names.enableSharedMarkdownInstance),D.enableActionExecuteFromInputExtension=w.valueAsBoolean(u.settings.names.enableActionExecuteFromInputExtension),D.enableAdaptiveCardOverflowActions=w.valueAsBoolean(u.settings.names.enableAdaptiveCardOverflowActions),D.enableACv2NewLoadingExperience=w.valueAsBoolean(u.settings.names.enableACv2NewLoadingExperience),D.initializeMarkdownLibrary(),h.GlobalSettings.useMarkdownInRadioButtonAndCheckbox=!1,h.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu=!!D.enableAdaptiveCardOverflowActions,h.AdaptiveCard.onProcessMarkdown=D.processMarkDown,r.$on("$destroy",function(){D.card&&D.card.unsubscribeForChanges(D.cardEventHandler),D.updateRefreshButtonState(b.HIDE),h.AdaptiveCard.onProcessMarkdown=null;for(var e in D.registeredRenderers)D.registeredRenderers[e]&&D.unregisterAdaptiveCardRenderer(e);D.registeredRenderers={},o.parent().empty()}),y.$on(r,u.events.bots.adaptiveCard.viewPortEnter,function(e,t){return D.handleAutoRefreshOnViewPortEnter(!1,t.messageId)}),y.$on(r,u.events.bots.adaptiveCard.cardUpdate,function(e,t){return D.handleCardUpdate(t)}),y.$on(r,u.events.bots.adaptiveCard.triggerCardRefresh,function(e,t){return D.handleCardRefreshEvent(t)}),y.$on(r,u.events.bots.adaptiveCard.cardAuthenticationRequest,function(e,t){return D.handleCardAuthRequest(t)}),y.$on(r,u.events.bots.adaptiveCard.showAppInstallButtonBeforeAuthentication,function(e,t){return D.handleShowAppInstallBtnRequest(t)}),r.$on(u.events.messages.clientLieHasRealId,function(){D.enableActionExecuteFromInputExtension&&w.valueAsBoolean(u.settings.names.enableActionExecuteJITInstallFromCompose)&&D.card&&D.card.isACv2&&D.card.isInputExtension&&D.performAutoRefreshIfRequired()}),D}return i(t,e),t.$inject=["botCardService","uiOrchestrator","$sce","$scope","$element","$compile","$window","$translate","$templateCache","$timeout","constants","localizationService","ariaLiveService","eventingService","botCardFactory","htmlSanitizer","resources","loggingService","utilityService","peopleService","settingsService","tooltipService","tooltipCssApplicators","appsService","dialogService","semanticObjectService","htmlMessageBodyAdapterService","messagingTelemetryService","mruServiceV2","$q","amsUrlService","routeUtilityService"],Object.defineProperty(t.prototype,"adaptiveCardObject",{get:function(){return this.adaptiveCard},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adaptiveCardElement",{get:function(){return this.$element.find("."+this.cardBodyClass)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardContentElement",{get:function(){return this.$element.find(".ts-adaptive-card")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderElement",{get:function(){return this.cardContentElement.find(".card-border-placeholder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appAttributionElement",{get:function(){return this.cardContentElement.find(".card-app-attribution")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCopyElement",{get:function(){return this.$element.find(".power-bar-card-copy")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCloseElement",{get:function(){return this.$element.find(".card-close")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardHeaderElement",{get:function(){return this.$element.find(".card-header")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardOverflowActionsElement",{get:function(){return this.$element.find(".card-overflow-actions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardCollapseElement",{get:function(){return this.$element.find(".card-collapse")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionFeedbackElement",{get:function(){return this.$element.find(".action-feedback")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addAppMessageElement",{get:function(){return this.$element.find(".card-add-app-message")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"signInMessageElement",{get:function(){return this.$element.find(".card-sign-in-message")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorMessageElement",{get:function(){return this.$element.find(".error-text")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshButtonVisible",{get:function(){return this.refreshButtonState!==b.HIDE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorIconElement",{get:function(){return this.$element.find(".error-icon")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"feedbackMessageElement",{get:function(){return this.$element.find(".feedback-text")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"footerAddAppButtonElement",{get:function(){return this.$element.find(".add-app-button")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRefreshButtonInCardHeader",{get:function(){return this.isRefreshButtonVisible&&this.card.isInputExtension},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showInstallConsent",{get:function(){return this.$scope.installConsent&&this.$scope.installConsent.showConsent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.$scope.installConsent&&this.$scope.installConsent.appDefinition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appName",{get:function(){return this.app&&this.app.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popupContainerSelector",{get:function(){return this.$scope.popupContainerSelector?this.$scope.popupContainerSelector:this.$scope.threadId?"#"+teamspace.services.MessagingUtilities.getFormattedThreadId(this.$scope.threadId):"[data-tid='"+this.dateTid+"']"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dateTid",{get:function(){return"ts-adaptive-card-"+this.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this.card.content},set:function(e){this.cardViewModel=this.botCardFactory.createCard({content:e,contentType:this.constants.bots.cards.types.adaptive},null,null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardViewModel",{get:function(){return this.card},set:function(e){this.card.unsubscribeForChanges(this.cardEventHandler),this.card=e,this.card.subscribeForChanges(this.cardEventHandler),this.initAdaptiveCard(),this.render()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardBorder",{get:function(){return this.cardBorderElement.hasClass(this.cardBorderClass)},set:function(e){e!==this.showCardBorder&&(e?this.cardBorderElement.addClass(this.cardBorderClass):this.cardBorderElement.removeClass(this.cardBorderClass))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderTopColor",{get:function(){return this.cardBorderElement[0].style.borderTopColor},set:function(e){this.cardBorderElement[0].style.borderTopColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardHeader",{get:function(){return this.canShowCardHeader(this.card)&&!this.showHeadlessCardOverflowActions&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableCardHeaderButton)&&this.isAnyCardHeaderActionVisible()&&!this.$scope.inCompose},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardBorderColor",{get:function(){return this.cardBorderElement[0].style.borderColor},set:function(e){this.cardBorderElement[0].style.borderColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCopy",{get:function(){return!this.cardCopyElement.hasClass("hide")},set:function(e){e!==this.showCopy&&(e?this.cardCopyElement.removeClass("hide"):this.cardCopyElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardClose",{get:function(){return!this.cardCloseElement.hasClass("hide")},set:function(e){e!==this.showCardClose&&(e?this.cardCloseElement.removeClass("hide"):this.cardCloseElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCardCollapse",{get:function(){return!this.cardCollapseElement.hasClass("hide")},set:function(e){e!==this.showCardCollapse&&(e?this.cardCollapseElement.removeClass("hide"):this.cardCollapseElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showFeedback",{get:function(){return!this.actionFeedbackElement.hasClass("hide")},set:function(e){e!==this.showFeedback&&(e?this.actionFeedbackElement.removeClass("hide"):this.actionFeedbackElement.addClass("hide"),!e&&this.resetFeedbackContainerClasses())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showAddAppMessage",{get:function(){return!this.addAppMessageElement.hasClass("hide")},set:function(e){e!==this.showAddAppMessage&&(e?this.addAppMessageElement.removeClass("hide"):this.addAppMessageElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showSignInMessage",{get:function(){return!this.signInMessageElement.hasClass("hide")},set:function(e){e!==this.showSignInMessage&&(e?this.signInMessageElement.removeClass("hide"):this.signInMessageElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorMessageText",{get:function(){return this.errorMessageElement.text()},set:function(e){this.errorMessageElement.text(e),!!e&&(this.showErrorIcon=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionFeedbackType",{set:function(e){switch(e){case teamspace.services.CardMessageType.info:this.actionFeedbackElement.addClass(this.cardInfoClass);break;case teamspace.services.CardMessageType.error:this.actionFeedbackElement.addClass(this.cardErrorClass)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showErrorIcon",{get:function(){return!this.errorIconElement.hasClass("hide")},set:function(e){e!==this.showErrorIcon&&(e?this.errorIconElement.removeClass("hide"):this.errorIconElement.addClass("hide"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"feedbackMessageText",{set:function(e){this.feedbackMessageElement.text(e),!!e&&(this.showErrorIcon=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useDefaultResponsiveCardWidth",{get:function(){return this.cardContentElement.hasClass(this.cardResponsiveWidthClass)},set:function(e){e!==this.useDefaultResponsiveCardWidth&&(e?this.cardContentElement.addClass(this.cardResponsiveWidthClass):this.cardContentElement.removeClass(this.cardResponsiveWidthClass))},enumerable:!0,configurable:!0}),t.prototype.setCardFooterSignInMessageText=function(e,t){t?(this.showSSOConsentMessage=!0,this.showSignInMessageForRefresh=!1):(this.showSignInMessageForRefresh=!0,this.showSSOConsentMessage=!1),this.showSignInMessage=!0,this.signInHandlerFunction=e},t.prototype.setCardFooterAddAppMessageText=function(e,t){t?(this.showAddAppMessageForRefresh=!0,this.showAddAppMessageForButtons=!1):(this.showAddAppMessageForButtons=!0,this.showAddAppMessageForRefresh=!1),this.showAddAppMessage=!0,this.addAppHandlerFunction=e},t.prototype.onCardClicked=function(){for(var e=$(".ts-adaptive-card.dropdown-menu"),t=0;t<e.length;t++){var n=e.get(t);"visible"===n.style.visibility&&(this.$scope.$broadcast(this.constants.events.adaptiveCard.dismissDropdown),n.style.visibility="hidden")}},t.prototype.handleAddAppBtnClick=function(){this.addAppHandlerFunction&&this.addAppHandlerFunction()},t.prototype.handleLinkClick=function(e){this.botCardService.openLinkFromBotCard(this.card,e)},t.prototype.handleSignInBtnClick=function(){this.signInHandlerFunction&&this.signInHandlerFunction()},t.prototype.handleAppView=function(){this.dialogService.openLazyDialog(this.constants.lazyDialogs.addAppNew,this.constants.lazyModules.extensibilityDialogs,{appID:this.card.appId,action:teamspace.components.AddAppDialogAction.View,autoNavigationOnDone:!0,intent:teamspace.components.AddAppDialogIntent.User,source:"adaptive-card-consent-prompt",appId:this.card.appId,entryPoint:teamspace.components.AddAppDialogEntryPoint.ConsentPromptFooter})},t.prototype.openAppPrivacyUrl=function(){this.botCardService.openSafeUrl(this.app&&this.app.privacyUrl)},t.prototype.openAppTermsOfUseUrl=function(){this.botCardService.openSafeUrl(this.app&&this.app.termsOfUseUrl)},t.prototype.handleAppInstall=function(e){this.openAppInstallDialog(this.card,"adaptive-card",this.constants,this.dialogService,this.loggingService,e),this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId)},t.prototype.handleOnCopy=function(e){var t=this.loggingService.newScenario(this.constants.scenarios.extensibility.inputExtension.cardHeaderCopy);try{this.clientObservers.onCopy&&this.clientObservers.onCopy({$ctrl:this,$event:e}),this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId),t.stop()}catch(e){t.fail({appId:this.card.appId,error:c.ErrorUtility.format(e)})}this.botCardService.logTelemetryForCardHeaderCopy(this.card)},t.prototype.handleCardHeaderMenu=function(e){this.openCardHeaderMenu(this.card,"lazy-components/adaptive-card/card-header-menu.html",e,this.$timeout,this.$scope,this.cardHeaderMenuId,this.tooltipService,this.tooltipCssApplicators,this.appsService,this.popoverPlacement||"auto bottom-right",this.$element)},t.prototype.handleHeadlessOverflowActionsMenu=function(e){var t=(this.popoverPlacement||"auto bottom-right")+" ts-ac-overflow-menu";this.openCardOverflowMenu("lazy-components/adaptive-card/card-overflow-menu.html",e,this.$timeout,this.$scope,this.cardHeaderMenuId,this.tooltipService,this.tooltipCssApplicators,t,this.$element)},t.prototype.handleMenuKeyDown=function(e){e.which===this.constants.keyCodes.escape&&this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId)},t.prototype.postLink=function(){var e=this;if(this.$scope.payload&&(this.card&&this.card.unsubscribeForChanges(this.cardEventHandler),this.card=this.botCardFactory.createCard({content:this.$scope.payload,contentType:this.constants.bots.cards.types.adaptive},null,null),this.card&&this.card.subscribeForChanges(this.cardEventHandler)),this.card&&this.card.content){this.initAdaptiveCard();var t=angular.element(p);this.$element.empty(),this.$element.append(t),this.render(),this.showCardBorder=!angular.isDefined(this.$scope.showCardBorder)||this.$scope.showCardBorder,this.showCardBorder&&this.card.accentColor&&(this.cardBorderTopColor=this.card.accentColor),this.showCopy=!(!angular.isDefined(this.$scope.showCopy)||this.disableCardCopy)&&this.$scope.showCopy,this.showCardClose=this.isUrlPreviewCard(this.card),this.showCardCollapse=this.isUrlPreviewCard(this.card),this.initCardHeader(),this.showFeedback=!1,this.showAddAppMessage=!1,this.showSignInMessage=!1,this.useDefaultResponsiveCardWidth=!!angular.isDefined(this.$scope.useDefaultResponsiveCardWidth)&&this.$scope.useDefaultResponsiveCardWidth,teamspace.common.SafeJQuery.on(this.$scope,this.cardCopyElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.clientObservers.onCopy&&e.clientObservers.onCopy({$ctrl:e,$event:t[0]})}),teamspace.common.SafeJQuery.on(this.$scope,this.cardCloseElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onRemoveCard(e.card,!1)}),teamspace.common.SafeJQuery.on(this.$scope,this.cardCollapseElement,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onRemoveCard(e.card,!0)}),this.isActionExecuteOptimizationEnabled()?this.isACv2IntegratedCachingEnabled()&&this.shouldPerformACv2Processing()?this.handleAutoRefresh():!this.isACv2IntegratedCachingEnabled()&&this.shouldPerformACv2Processing()?this.handleACv2RenderWithCacheRead():this.clientObservers.onReady&&this.clientObservers.onReady({$ctrl:this}):this.isACv2IntegratedCachingEnabled()?this.performAutoRefreshIfRequired().finally(function(){e.clientObservers.onReady&&e.clientObservers.onReady({$ctrl:e})}):this.handleACv2RenderWithCacheRead()}},t.prototype.shouldPerformACv2Processing=function(){return this.card.isBotCard&&this.card.isNewMessageOrMessageEdit&&this.card.isCardInViewPort&&this.card.isACv2||this.card.isInputExtension&&this.card.isCardInViewPort&&this.card.isACv2},t.prototype.render=function(){var e=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardRenderScenario),t=this.adaptiveCard.render();e.mark(this.constants.scenarios.extensibility.bots.adaptiveCardRenderSteps.sdkRender),this.adaptiveCardElement.empty(),this.adaptiveCardElement.append(t),this.postProcessingStyling(),e.mark(this.constants.scenarios.extensibility.bots.adaptiveCardRenderSteps.postProcessing),this.$compile(this.cardContentElement)(this.$scope),e.mark(this.constants.scenarios.extensibility.bots.adaptiveCardRenderSteps.ngCompile),e.stop()},t.prototype.subscribe=function(e,t){this.clientObservers[e]=t},t.prototype.unsubscribe=function(e,t){delete this.clientObservers[e]},t.prototype.overwriteConfig=function(e){var t=this.adaptiveCard.hostConfig,n=_.defaultsDeep({},e,t);this.adaptiveCard.hostConfig=n},t.prototype.resetFeedbackContainerClasses=function(){this.actionFeedbackElement.hasClass(this.cardErrorClass)&&this.actionFeedbackElement.removeClass(this.cardErrorClass),this.actionFeedbackElement.hasClass(this.cardInfoClass)&&this.actionFeedbackElement.removeClass(this.cardInfoClass)},t.prototype.initializeMarkdownLibrary=function(){this.enableSharedMarkdownInstance||(this.markdownIt=new f("zero").enable(["link","emphasis","list","newline","escape"]),g.MentionsRule.addMentionsRule(this.constants.semanticObjectSchemas.mention,this.markdownIt))},t.prototype.isAnyCardHeaderActionVisible=function(){return!this.disableCardCopy||this.showAppDetails||this.showRefreshButtonInCardHeader},t.prototype.initCardHeader=function(){this.showHeadlessCardOverflowActions=this.emailCardImprovementsEnabled&&this.card.content&&this.headlessOverflowActions&&this.headlessOverflowActions.length>0},t.prototype.unregisterAdaptiveCardRenderer=function(e){h.GlobalRegistry.elements.unregister(e),delete this.registeredRenderers[e]},t.prototype.registerAdaptiveCardRenderer=function(e,t,n){this.registeredRenderers[e]&&this.unregisterAdaptiveCardRenderer(e),h.GlobalRegistry.elements.register(e,t),this.registeredRenderers[e]=!0},t.prototype.initAdaptiveCard=function(){var e=this;this.clientObservers.onPreInit&&this.clientObservers.onPreInit({$ctrl:this});var t=this.routeUtilityService.getRootRouteParams(),n=this.card.conversationId||t.threadId;this.registerAdaptiveCardRenderer("Image",y.AdaptiveCardHelper.createWrappingClass(y.Image,function(){return[e.constants,e.enableExpandingImagesInAdaptiveCards,e.enlargeImageLabel,e.htmlSanitizer,e.settingsService,e.amsUrlService,e.utilityService,e.$scope.$new(),e.$compile,e.logger]})),this.registerAdaptiveCardRenderer("ImageSet",y.AdaptiveCardHelper.createWrappingClass(y.ImageSet,function(){return[e.constants,e.enableExpandingImagesInAdaptiveCards,e.enlargeImageLabel,e.htmlSanitizer,e.settingsService,e.amsUrlService,e.utilityService,e.$scope.$new(),e.$compile,e.logger]})),this.registerAdaptiveCardRenderer("Component",y.AdaptiveCardHelper.createWrappingClass(y.Component,function(){return[e.eventingService,e.messagingTelemetryService,e.peopleService,e.tooltipService,e.tooltipCssApplicators,e.constants,e.$timeout,e.$compile,e.$scope.$new(),e.$translate,e.resources,e.loggingService,e.settingsService]})),this.registerAdaptiveCardRenderer("Input.Date",y.AdaptiveCardHelper.createWrappingClass(y.DateInput,function(){return[".ts-message-list-item",e.popupContainerSelector,e.localizationService,e.ariaLiveService,e.$scope.$new(),e.$compile,e.$translate,e.resources]})),this.registerAdaptiveCardRenderer("Input.Time",y.AdaptiveCardHelper.createWrappingClass(y.TimeInput,function(){return[".ts-message-list-item",e.popupContainerSelector,e.localizationService,e.ariaLiveService,e.$scope.$new(),e.logger,e.constants]})),this.registerAdaptiveCardRenderer("Input.ChoiceSet",y.AdaptiveCardHelper.createWrappingClass(y.ChoiceSetInput,function(){return[".ts-message-list-item",e.popupContainerSelector,e.$scope.$new(),e.$compile,e.$templateCache,e.$translate,e.resources,e.ariaLiveService,e.settingsService,e.eventingService,e.objectId,e.utilityService,e.constants,e.htmlSanitizer,n,e.createApplicationSearchQueryHandler(),e.card.loadPeoplePickerChoices]})),this.registerAdaptiveCardRenderer("Input.Toggle",y.AdaptiveCardHelper.createWrappingClass(y.ToggleInput,function(){return[e.$templateCache,e.$translate,e.resources,e.ariaLiveService,e.objectId,e.utilityService,e.htmlSanitizer]})),this.registerAdaptiveCardRenderer("Input.Text",y.AdaptiveCardHelper.createWrappingClass(y.TextInput,function(){return[e.$compile,e.$sce,e.$scope.$new(),e.$templateCache,e.$translate,e.constants,e.resources,e.settingsService]})),h.AdaptiveCard.onProcessMarkdown=this.processMarkDown;var i=this.emailCardImprovementsEnabled?this.extractHeadlessOverflowActions(this.card.content):void 0;this.adaptiveCard=new h.AdaptiveCard;var r=this.enableAdaptiveCardOverflowActions&&h.Versions.latest.compareTo(h.Versions.v1_5)<0?new h.SerializationContext(h.Versions.v1_5):new h.SerializationContext;this.adaptiveCard.parse(this.card.content,r),this.emailCardImprovementsEnabled&&this.parseHeadlessOverflowActions(i),this.setupHostConfig(),this.adaptiveCard.onExecuteAction=function(t){return e.handleOnExecuteAction(t)},this.adaptiveCard.onInlineCardExpanded=function(t,n){return e.handleOnInlineCardExpanded(t,n)},this.adaptiveCard.onElementVisibilityChanged=function(t){return e.handleOnElementVisibilityChanged(t)},this.adaptiveCard.onRenderOverflowActions=function(t,n){return e.handleOnRenderOverflowActions(t,n)},this.adaptiveCard.onDisplayOverflowActionMenu=function(t,n){return e.handleOnDisplayOverflowActionMenu(t,n)}},t.prototype.handleOnRenderOverflowActions=function(e,t){if(this.canShowCardHeader(this.card))return!this.enableAdaptiveCardOverflowActions||!!t&&(this.overflowActions=e,!0)},t.prototype.handleOnDisplayOverflowActionMenu=function(e,t){if(this.enableAdaptiveCardOverflowActions&&t){var n=new Event("click"),i=jQuery.event.fix(n);Object.defineProperty(i,"currentTarget",{writable:!1,value:t}),this.headlessOverflowActions=e;var r=(this.popoverPlacement||"auto bottom-left")+" ts-ac-overflow-menu";this.openCardOverflowMenu("lazy-components/adaptive-card/card-overflow-menu.html",i,this.$timeout,this.$scope,this.cardHeaderMenuId,this.tooltipService,this.tooltipCssApplicators,r,angular.element(t))}return!0},t.prototype.handleOnElementVisibilityChanged=function(e){var t=new teamspace.services.CardButton;t.type=this.constants.bots.cards.adaptiveCard.actions.toggleVisibility,this.botCardService.logTelementryForCardAction(this.card,t)},t.prototype.handleOnInlineCardExpanded=function(e,t){this.postProcessingStyling(),t&&e.card&&e.card.speak&&this.ariaLiveService.update(e.card.speak,!0);var n=new teamspace.services.CardButton;n.type=this.constants.bots.cards.adaptiveCard.actions.showCard,n.title=e.title,this.botCardService.logTelementryForCardAction(this.card,n)},t.prototype.extractHeadlessOverflowActions=function(e){var t=this;if(e&&e.actions){var n=_.partition(e.actions,function(e){return t.emailCardHackEnabled&&t.card.appId===t.constants.appId.shareToTeamsFromOutlook?"Open in Teams"===e.title||"Download"===e.title:e.msTeams&&e.msTeams.overflow}),i=n[0]||[];return e.actions=n[1],i}},t.prototype.isPinTabAction=function(e){var t=e&&e.data&&(e.data.msTeams||e.data["msTeams".toLowerCase()]);return"Action.Submit"==e.type&&t&&t.value&&t.value.type===this.constants.stageConstants.invokeNames.tabInfo&&t.value.tabInfo.pinTab},t.prototype.parseHeadlessOverflowActions=function(e){var t=this;this.headlessOverflowActions=_.map(e,function(e){var n=t.acSerializationContext.parseAction(t.adaptiveCard,e,[],!1);return n&&t.processOverflowActionIcon(n),n})},t.prototype.processOverflowActionIcon=function(e){var t,n=this.settingsService.getStaticsUri();if(e.iconUrl){e.iconUrl=e.iconUrl.trim();var i=e.iconUrl.lastIndexOf("/")+1;if(i>0&&i<e.iconUrl.length-1&&(t=e.iconUrl.substr(i)),t)switch(t=t.toLowerCase()){case"microsoft_teams_logo_refresh.ico":e.iconUrl=n+"/evergreen-assets/adaptiveemail/icon-teams.svg";break;case"downloadicon2x.png":e.iconUrl=n+"/evergreen-assets/adaptiveemail/icon-download.svg"}}},t.prototype.handleOnExecuteAction=function(e,t,n){var i=this;void 0===t&&(t=s.None);var r=this.constants.scenarios.extensibility.bots.adaptiveCardSubmitScenarioSteps,o=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.cardActions.adaptiveCardSubmitScenario);o.mark(r.postProcessingStylingPre),this.postProcessingStyling(),o.mark(r.postProcessingStylingDone);var a=this.findLastClickEvent();o.mark(r.definedCurrentTarget);var l=new teamspace.services.CardButton(this.utilityService.generateUUID());l.parentObjectId=this.objectId;var c=function(){if(i.onCardClicked(),e instanceof h.OpenUrlAction)return i.handleOpenUrlAction(e,a,l);if(t!==s.None&&e instanceof v.ExecuteAction)return i.handleAdaptiveCardRefresh(e,l,t,n);if(e instanceof v.ExecuteAction)return i.handleActionExecuteInvoke(e,a,l);if(e instanceof h.SubmitAction)return i.handleSubmitAction(e,a,l);var r="[AdaptiveCardController::handleOnExecuteAction()] unsupported $action.type to execute = "+e.getJsonTypeName();return i.logger.error(r),Promise.reject(r)},p=function(t,n,s,l){i.clientObservers.onDidExecuteAction&&(o.mark(r.onDidExecuteAction),i.clientObservers.onDidExecuteAction({$ctrl:i,$action:e,$event:a,$result:t,$error:n})),e instanceof h.SubmitAction&&!l&&(i.shouldDisableRerenderingForAdaptiveCards||(i.initAdaptiveCard(),i.render())),n&&s?o.fail({error:n}):o.stop()},u=function(){o.mark(r.executeDefaultActionStart),o.pause({reason:"waiting for action complete"}),i.logger.info("proceedWithDefaultAction"),c().then(function(e){o.resume(),o.mark(r.executeDefaultActionDone),p(e)}).catch(function(e){i.hideACv2Loader(),o.resume(),o.mark(r.executeDefaultActionFailed),p(null,e,!0,!0)})};this.clientObservers.onWillExecuteAction?(o.mark(r.onWillExecuteActionStart),o.pause({reason:"waiting for action complete"}),(this.clientObservers.onWillExecuteAction({$ctrl:this,$action:e,$event:a})||Promise.resolve(!1)).then(function(e){o.resume(),o.mark(r.onWillExecuteActionDone,{continueDefault:e}),e?u():p(null,void 0,void 0,!0)}).catch(function(e){o.resume(),o.mark(r.onWillExecuteActionFailed),p(null,e)})):u()},t.prototype.disableButtons=function(e){var t=this.adaptiveCardElement.children().first();this.uiOrchestrator.nextFrame(teamspace.services.UiOrchestratorPriority.High,function(){t.find("button.ac-pushButton").each(function(t,n){var i=angular.element(n);e?(i.addClass("ts-btn-primary"),i.attr("disabled","disabled")):(i.removeClass("ts-btn-primary"),i.removeAttr("disabled"))})})},t.prototype.findLastClickEvent=function(){var e=this.$window.event||new Event("click"),t=jQuery.event.fix(e);return Object.defineProperty(t,"currentTarget",{writable:!1,value:this.mostRecentButtonClicked||t.currentTarget}),t.currentTarget||Object.defineProperty(t,"currentTarget",{writable:!1,value:e.explicitOriginalTarget}),t},t.prototype.handleOpenUrlAction=function(e,t,n){return n.type=this.constants.bots.cards.actions.openUrl,n.title=e.title,n.value=this.resolveTemplateParamsInUrl(e.url),this.buttonClicked(t,n,this.card)},t.prototype.handleActionExecuteInvoke=function(e,t,n){n.type=this.constants.bots.cards.actions.actionExecuteInvoke,n.title=e.title,n.value=this.getActionExecuteInvokePayload(e,s.Manual,teamspace.services.ActionExecuteSource.ButtonClick),n.actionComplianceParams={type:e.getJsonTypeName(),title:n.title},this.showACv2Loader();var i=this.getValidOAuthCardFromAuthBlock();return i?this.handleAuthenticationAndExecuteAction(i,n,t):this.buttonClicked(t,n,this.card)},t.prototype.handleAuthenticationAndExecuteAction=function(e,t,n,i){void 0===i&&(i=!1);var r=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleAuthBlock);return this.botCardService.isValidSSORequest(e)?this.handleSSOFlow(e,t,n,r,i):this.botCardService.isValidOAuthRequest(e)?this.handleOAuthFlow(e,t,n,r,i):(this.handleErrorInAuthFlow(r,"invalid oauth card"),r.fail({error:"oauth card does not have valid oauth and sso information"}),Promise.resolve(null))},t.prototype.handleSSOFlow=function(e,t,n,i,r){var o=this;return void 0===r&&(r=!1),i.mark(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleSSOStep),new Promise(function(a){var l=o.getRefreshTypeAndSource(t.value),c=l.cardRefreshType,p=l.executeSource;o.botCardService.findAppInPersonalScope(o.card).then(function(l){if(!l)return o.showAddAppButtonOnFooterToCompleteAuth(e,t),a(null);o.botCardService.getSilentAuthToken(o.card,e).then(function(r){if(!r)return o.handleErrorInAuthFlow(i,"failed to get user token",c,p),a(null);var l={id:e.tokenExchangeResource.id,connectionName:e.connectionName,token:r};o.isActionExecuteRefresh(p)?(t.value=o.updateAuthDataInInvokePayload(t.value,null,l),o.botCardService.processClickedButton(t,o.card,o.$scope,c===s.Auto).then(function(e){return i.stop({message:"sso done from auth block",appId:o.card.appId,botId:o.getBotIdFromCard(),cardRefreshType:c,executeSource:p,isInputExtension:o.card.isInputExtension}),a(e)})):(t.value=o.updateAuthDataInInvokePayload(t.value,null,l),o.buttonClicked(n,t,o.card).then(function(e){return i.stop({message:"sso done from auth block",appId:o.card.appId,botId:o.getBotIdFromCard(),cardRefreshType:c,executeSource:p,isInputExtension:o.card.isInputExtension}),a(e)}))}).catch(function(s){if(!s||!s.errorCode||"userConsentRequiredError"!==s.errorCode)return o.handleErrorInAuthFlow(i,s&&s.errorMessage||"non retryable error in sso",c,p,s&&s.errorCode||""),a(null);o.botCardService.isValidOAuthRequest(e)?o.handleOAuthFlow(e,t,n,i,r,!0).then(function(e){return a(e)}):o.handleAADInteractiveAuthFlow(e,t,n,i,r,!0).then(function(e){return a(e)})})}).catch(function(e){return o.handleErrorInAuthFlow(i,e&&e.errorMessage||"error in find app defination flow",c,p,e&&e.errorCode||""),a(null)})})},t.prototype.handleAADInteractiveAuthFlow=function(e,t,n,i,r,o,a){var l=this;void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),i.mark(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleAADInteractiveAuthStep);var c=this.getRefreshTypeAndSource(t.value),p=c.cardRefreshType,u=c.executeSource;return new Promise(function(c){l.botCardService.findAppInPersonalScope(l.card).then(function(d){if(!d)return l.showAddAppButtonOnFooterToCompleteAuth(e,t),c(null);p!==s.Auto||r||a?l.botCardService.launchAADInteractiveSignInFlow(l.card,e).then(function(r){if(!r)return l.handleErrorInAuthFlow(i,"token is null",p,u),c(null);var o={id:e.tokenExchangeResource.id,connectionName:e.connectionName,token:r};t.value=l.updateAuthDataInInvokePayload(t.value,null,o),l.isActionExecuteRefresh(u)?l.botCardService.processClickedButton(t,l.card,l.$scope,!1).then(function(e){return i.stop({message:"aad interactibe auth flow done from auth block",appId:l.card.appId,botId:l.getBotIdFromCard(),cardRefreshType:p,executeSource:u,isInputExtension:l.card.isInputExtension}),c(e)}):l.buttonClicked(n,t,l.card).then(function(e){return i.stop({message:"aad interactibe auth flow done from auth block",appId:l.card.appId,botId:l.getBotIdFromCard(),cardRefreshType:p,executeSource:u,isInputExtension:l.card.isInputExtension}),c(e)})}).catch(function(e){return l.handleErrorInAuthFlow(i,e&&e.errorMessage||"error in aad interactive sign in flow",p,u,e&&e.errorCode||""),c(null)}):(l.showSignInFooterForOAuthRequestOnRefresh(e,t,o),c(new teamspace.services.BotCardInvokeActionResult))}).catch(function(e){return l.handleErrorInAuthFlow(i,e&&e.errorMessage||"error in find app defination flow",p,u,e&&e.errorCode||""),c(null)})})},t.prototype.handleOAuthFlow=function(e,t,n,i,r,o,a){var l=this;void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),i.mark(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleOAuthStep);var c=this.getRefreshTypeAndSource(t.value),p=c.cardRefreshType,u=c.executeSource;return new Promise(function(c){l.botCardService.findAppInPersonalScope(l.card).then(function(d){if(!d)return l.showAddAppButtonOnFooterToCompleteAuth(e,t),c(null);p!==s.Auto||r||a?l.botCardService.launchWebAuthFlow(l.card,e).then(function(e){if(!e)return l.handleErrorInAuthFlow(i,"state is null",p,u),c(null);l.isActionExecuteRefresh(u)?(t.value=l.updateAuthDataInInvokePayload(t.value,e),l.botCardService.processClickedButton(t,l.card,l.$scope,!1).then(function(e){return i.stop({message:"oauth flow done from auth block",appId:l.card.appId,botId:l.getBotIdFromCard(),cardRefreshType:p,executeSource:u,isInputExtension:l.card.isInputExtension}),c(e)})):(t.value=l.updateAuthDataInInvokePayload(t.value,e),l.buttonClicked(n,t,l.card).then(function(e){return i.stop({message:"oauth flow done from auth block",appId:l.card.appId,botId:l.getBotIdFromCard(),cardRefreshType:p,executeSource:u,isInputExtension:l.card.isInputExtension}),c(e)}))}).catch(function(e){return l.handleErrorInAuthFlow(i,e&&e.errorMessage||"error in web signin flow",p,u,e&&e.errorCode||""),c(null)}):(l.showSignInFooterForOAuthRequestOnRefresh(e,t,o),c(new teamspace.services.BotCardInvokeActionResult))}).catch(function(e){return l.handleErrorInAuthFlow(i,e&&e.errorMessage||"error in find app defination flow",p,u,e&&e.errorCode||""),c(null)})})},t.prototype.handleAutoRefresh=function(){this.autoRefreshSuccess||this.performAutoRefresh()},t.prototype.performAutoRefresh=function(){var e=this;this.autoRefreshSuccess=!0,this.performAutoRefreshIfRequired().finally(function(){e.clientObservers.onReady&&e.clientObservers.onReady({$ctrl:e})})},t.prototype.handleAutoRefreshOnViewPortEnter=function(e,t){(e||t&&t==this.card.serverMessageId)&&!this.autoRefreshSuccess&&this.performAutoRefresh()},t.prototype.handleAdaptiveCardRefresh=function(e,t,n,i){t.type=this.constants.bots.cards.actions.actionExecuteInvoke,t.title=e.title,t.value=this.getActionExecuteInvokePayload(e,n,i),this.showACv2Loader();var r=this.getValidOAuthCardFromAuthBlock();return r?this.handleAuthenticationAndExecuteAction(r,t,null):this.botCardService.processClickedButton(t,this.card,this.$scope,n===s.Auto)},t.prototype.handleErrorInAuthFlow=function(e,t,n,i,r){void 0===n&&(n=s.None);var o="authentication flow in card failed with errorCode "+(r||"")+" and errorMessage "+t+" for refresh type: "+n;this.logger.error(o),e.fail({error:o,appId:this.card.appId,botId:this.getBotIdFromCard(),cardRefreshType:n,executeSource:i,isInputExtension:this.card.isInputExtension});var a=this.$translate.instant(this.resources.strings.inputExtension_invoke_failure_nonbots);this.handleCardMessage(a,teamspace.services.CardMessageType.error)},t.prototype.getBotIdFromCard=function(){return this.card.isInputExtension?this.card.inputExtensionBotId:this.card.cardSender&&this.card.cardSender.mri},t.prototype.getValidOAuthCardFromAuthBlock=function(){if(this.settingsService.valueAsBoolean(this.constants.settings.names.enableACv2AuthBlockFlowInAdaptiveCard)&&this.card.content&&this.card.content.authentication){var e=36e5*this.settingsService.valueFor(this.constants.settings.names.authBlockFlowForACv2TTLInHours),t=this.botCardService.getCardCacheKey(this.card),n=this.botCardService.getLastAuthBlockUsageTimeForACv2(t);if(!n||this.shouldProcessAuthBlockInCard(n,e)){this.botCardService.putLastAuthBlockUsageTimeForACv2(t,Date.now());var i={content:this.card.content.authentication,contentType:this.constants.bots.cards.types.oauth.toLowerCase()},r=this.botCardFactory.createCard(i,this.card.conversationId);return r&&(this.botCardService.isValidOAuthRequest(r)||this.botCardService.isValidSSORequest(r))?r:void 0}}},t.prototype.shouldProcessAuthBlockInCard=function(e,t){return Date.now()-e>t},t.prototype.handleSubmitAction=function(e,t,n){if(this.card.isInputExtension?!!this.card.conversationId:!!(this.card.conversationId&&this.card.replyChainId&&this.card.cardSender&&this.card.cardSender.mri)){if(!!this.embeddedMSTeamsActionType(e))return this.transformToMSTeamsAction(t,e,n);var i=new teamspace.services.CardButton(this.utilityService.generateUUID());return i.parentObjectId=this.objectId,i.type=this.constants.bots.cards.actions.messageback,i.title=e.title,i.value=JSON.stringify(e.data),i.actionComplianceParams=r({type:e.getJsonTypeName(),title:i.title},!!e.iconUrl&&{imageUrl:e.iconUrl}),this.buttonClicked(t,i,this.card)}return Promise.resolve(null)},t.prototype.populateAtMentionsSemanticObjects=function(e,t){var n=this.mentions||this.card.mentions;if(n&&this.doesTextHaveMentions(e)){var i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionScenario);i.appendEventData({mentionsArrayLength:n.length,appId:this.card.appId});try{var r=this.getContentWithSemanticObjects(t,n);return this.markAndStopAtMentionsScenario(i,r),r}catch(e){this.logger.error("unable to create at-mentions tags: "+c.ErrorUtility.format(e)),i.fail({appId:this.card.appId,error:c.ErrorUtility.format(e)}),i=null}}return t},t.prototype.doesTextHaveMentions=function(e){return!(!e||-1===e.indexOf(this.constants.semanticObjectSchemas.mention))},t.prototype.getContentWithSemanticObjects=function(e,t){var n=this.semanticObjectService.populateSemanticObjectContent(e,t,void 0,!1,void 0);return this.isSenderUserMri()&&(n=m.BotCardMentionsHelper.addBotTagForBotCardWithMentions(n,this.constants.semanticObjectSchemas.mention)),this.htmlMessageBodyAdapterService.convert(n,!1,!1)},t.prototype.isSenderUserMri=function(){var e=SkypeX.Services.ChatServiceUtils.MriNamespace_SkypeSpacesUser;return!!(this.card.cardSender&&this.card.cardSender.mri&&this.card.cardSender.mri.startsWith(e))},t.prototype.markAndStopAtMentionsScenario=function(e,t){e&&(-1!==t.toLowerCase().indexOf("data-itemprops")?(e.mark(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionProcessingCompleteScenarioStep),e.stop(),this.card.hasMentions=!0):(e.mark(this.constants.scenarios.extensibility.bots.atMentionsInAdaptiveCard.mentionPropertyMissingScenarioStep),e.stop()))},t.prototype.resolveTemplateParamsInUrl=function(e){var t=e||"",n=teamspace.services.O365HttpPOST.regexForValueSubstitution,i=_.uniq(t.match(n));if(i&&i.length>0){var r={};_.each(this.adaptiveCard.getAllInputs(),function(e){var t=e.value;r[e.id]=t&&encodeURIComponent(t)}),_.forEach(i,function(e){var n=e.substring(2,e.indexOf(".value"));t=t.replace(new RegExp(e,"g"),r[n])})}return t},t.prototype.handleCardEvent=function(e,t){if(e)switch(+e){case teamspace.services.CardEvent.updateAppAttribution:this.renderAppAttrubution();break;case teamspace.services.CardEvent.updateAccentColor:this.cardBorderTopColor=this.card.accentColor;break;case teamspace.services.CardEvent.updateCardMessage:var n=t.cardMessage;_.isEmpty(n)||(this.handleCardMessage(n.message,n.messageType),this.showInstallConsent&&this.triggerInputExtensionResizeEvent())}},t.prototype.handleCardMessage=function(e,t){t===teamspace.services.CardMessageType.error&&(this.errorMessageText=e),t===teamspace.services.CardMessageType.info&&(this.feedbackMessageText=e),e?(t===teamspace.services.CardMessageType.error&&this.hideACv2Loader(),this.showFeedback=!0,this.actionFeedbackType=t):this.showFeedback=!1,this.showAddAppMessage=!1,this.showSignInMessage=!1},t.prototype.performAutoRefreshIfRequired=function(){var e=this;return this.checkForRefreshAndUpdateRefreshButtonState().then(function(t){t[0];if(t[1]){var n=e.botCardService.getCardCacheKey(e.card);e.botCardService.getCachedAdaptiveCardData(n).then(function(t){var n=e.botCardService.getAdaptiveCardRefreshAction(e.card,t);n&&e.handleRefreshAction(n,s.Auto)})}})},t.prototype.checkForRefreshAndUpdateRefreshButtonState=function(){var e=this;return this.$q.all([this.botCardService.getAssociatedBotMri(this.card),this.getUserCountFromConversation()]).then(function(t){var n=t[0],i=t[1];return e.isCardRefreshAllowed()?e.botCardService.checkCardForManualAndAutoRefresh(e.card.content,n,i).then(function(t){var n=t[0],i=t[1];return n||i?e.updateRefreshButtonState(b.SHOW):e.updateRefreshButtonState(b.HIDE),[n,i]}):(e.updateRefreshButtonState(b.HIDE),[!1,!1])})},t.prototype.setupHostConfig=function(e){void 0===e&&(e=!1);var t=this.defaultFontSizeAndFontWeightPayload,n=[this.getDefaultHostConfig(),t,this.getColorConfigForCurrentTheme()],i=new h.HostConfig(_.defaultsDeep.apply(_,a([{}],n)));this.overwriteConfig(i),e&&this.render()},t.prototype.getDefaultHostConfig=function(){var e=this.defaultFontSizeAndFontWeightPayload,t=(e.fontFamily,o(e,["fontFamily"]));return{fontTypes:{default:this.defaultFontSizeAndFontWeightPayload,monospace:t},imageSizes:{small:32,medium:52,large:100},separator:{lineThickness:1},actions:{maxActions:this.constants.bots.cards.limits.maxActionButtons,buttonSpacing:8,actionsOrientation:h.Orientation.Horizontal,actionAlignment:h.ActionAlignment.Left,showCard:{actionMode:h.ShowCardActionMode.Inline,inlineTopMargin:16}},factSet:{spacing:16},spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16}}},t.prototype.getColorConfigForCurrentTheme=function(){var e=this.settingsService.getActiveTheme(),t=y.AdaptiveCardHelper.colorThemeConfig[e];switch(e){case this.constants.themes.dark:case this.constants.themes.darkV2:case this.constants.themes.tflDark:t=_.assign({},t,this.$scope.hostConfigDark);break;case this.constants.themes.highContrast:t=_.assign({},t,this.$scope.hostConfigContrast);break;case this.constants.themes.default:case this.constants.themes.defaultV2:case this.constants.themes.tflDefault:default:t=_.assign({},t,this.$scope.hostConfigDefault)}return t},t.prototype.postProcessingStyling=function(){var e=this;this.disableCardCopy=this.enableActionExecuteFromInputExtension&&(this.card.isACv2||!!this.$scope.isUserSpecificCard);var t=this.adaptiveCardElement.children().first(),n=t.children();t.find("button.ac-pushButton").addClass("ts-btn card-common-inset-border"),t.find(".ac-adaptiveCard button.ac-pushButton").addClass("ts-btn-fluent ts-btn-fluent-primary"),t.find("button.expandable.expanded").attr("selected","selected"),t.find("button.expandable:not(.expanded)").attr("selected",null),t.find("div.ac-media").addClass("hide-content"),t.find(".ac-selectable").attr("acc-role","clickable"),n.find("button.ac-inlineActionButton").addClass("ts-btn card-common-inset-border"),n.find(".ac-adaptiveCard button.ac-inlineActionButton").addClass("ts-btn-fluent ts-btn-fluent-primary");var i=function(t,n){t.find(n).each(function(t,n){if(n.onclick){var i=n.onclick;n.onclick=function(t){e.mostRecentButtonClicked=t.currentTarget,i(t)}}})};i(t,"button.ac-pushButton"),i(n,"button.ac-inlineActionButton"),this.postProcessingCardWidth(),this.emailCardImprovementsEnabled&&this.initCardHeader(),this.postProcessingButtonLayout(),this.cardContentElement[0].style.backgroundColor=t[0].style.backgroundColor,this.card.appId!==this.constants.appId.shareToTeamsFromOutlook&&this.card.appAttribution&&this.renderAppAttrubution(),t.find("textarea").attr("contenteditable","true"),t.find("textarea, button.ac-pushButton, button.ac-inlineActionButton").attr("do-not-decorate-click-for-acc",""),t.find("[placeholder]").attr("ng-non-bindable",""),t.find("button.ac-pushButton").attr("ng-non-bindable",""),n.find("button.ac-inlineActionButton").attr("ng-non-bindable",""),this.adaptiveCardElement.find("img[alt]").each(function(t,n){var i=e.htmlSanitizer.escapeAngular(n.getAttribute("alt"));n.setAttribute("alt",i)}),this.adaptiveCardElement.find("[aria-label]").each(function(t,n){var i=e.htmlSanitizer.escapeAngular(n.getAttribute("aria-label"));n.setAttribute("aria-label",i)}),this.adaptiveCardElement.find("[title]").each(function(t,n){var i=e.htmlSanitizer.escapeAngular(n.getAttribute("title"));n.setAttribute("title",i)}),this.clientObservers.onPostProcessingStyling&&this.clientObservers.onPostProcessingStyling({$ctrl:this})},t.prototype.postProcessingCardWidth=function(){var e=((this.card.content.msTeams||this.card.content.msteams||{}).width||"").toUpperCase()===this.constants.bots.cards.adaptiveCard.msTeams.width.full,t=this.card.appId===this.constants.appId.shareToTeamsFromOutlook;(this.variableCardWidthEnabled&&e||this.emailCardHackEnabled&&t)&&this.cardContentElement.addClass(this.cardFullWidthClass)},t.prototype.postProcessingButtonLayout=function(){var e=this,t=this.adaptiveCardElement.children().first(),n=t.children(),i=this.adaptiveCard.hostConfig.actions.buttonSpacing/2+"px",r=t.find("button.ac-pushButton"),o=n.find("button.ac-inlineActionButton"),a=function(e){return _.chain(e).map(function(e){return e.parentElement}).filter(function(e){return"flex"===e.style.display}).uniq().value()},s=a(r),l=a(o);_.each(s,function(t){var n=$(t).find("div");_.forEach(n,function(e){e.innerHTML||$(e).removeAttr("style").end().html()}),e.addButtonStyling(t,"button.ac-pushButton",i)}),_.each(l,function(t){$(t).find("input.ac-input.ac-textInput").addClass("inline-textInput"),$(t).find("textarea.ac-input.ac-textInput.ac-multiline").addClass("inline-textInput"),e.addButtonStyling(t,"button.ac-inlineActionButton",i),$(t).find("button.ac-inlineActionButton").length>0&&$(t).addClass("inline-action-input")})},t.prototype.addButtonStyling=function(e,t,n){_.forEach($(e).find(t),function(e){e.style.margin=n}),e.style.flexWrap="wrap",e.style.margin="-"+n},t.prototype.renderAppAttrubution=function(){if(this.appAttributionElement.empty(),this.card.appAttribution){var t=e.prototype.useNgIncludeForIcon.call(this,this.card.appAttribution.imageUrl),n=this.htmlSanitizer.escapeAngular(this.card.appAttribution.accentColor),i=this.utilityService.escapeHtml(this.card.appAttribution.name),r=this.htmlSanitizer.sanitizeUrl(this.card.appAttribution.imageUrl,["data","http","https"]),o=angular.element("<div></div>");if(o.attr("class","image-container"),o.attr("style","background-color: "+n),t)o.append(angular.element(this.$templateCache.get(r)));else{var a=angular.element("<img />");a.attr("src",r),o.append(a)}var s=angular.element("<span ng-non-bindable></span>");s.append(i),this.appAttributionElement.append(o),this.appAttributionElement.append(s);var l=this.adaptiveCard.hostConfig.spacing.padding+"px";this.appAttributionElement[0].style.padding=l+" "+l+" 0"}},t.prototype.embeddedMSTeamsActionType=function(e){var t=this.constants.bots.cards.adaptiveCard.teamsActionWrapperName;return e&&e.data&&e.data[t]&&e.data[t].type&&_.isString(e.data[t].type)&&e.data[t].type.toLowerCase()},t.prototype.transformToMSTeamsAction=function(e,t,n){var i=this.constants.bots.cards.adaptiveCard.teamsActionWrapperName,o=t.data[i],a=this.embeddedMSTeamsActionType(t),s=new teamspace.services.CardButton(this.utilityService.generateUUID());switch(s.title=t.title,s.parentObjectId=n.parentObjectId,a.toLowerCase()){case this.constants.taskModuleConstants.invokeNames.fetch.toLowerCase():s.type=this.constants.bots.cards.actions.invoke,s.value=this.mergePayload(t.data,JSON.stringify({type:this.constants.taskModuleConstants.invokeNames.fetch}));break;case this.constants.bots.cards.actions.messageback.toLowerCase():s.type=this.constants.bots.cards.actions.messageback,s.displayText=o.displayText,s.text=o.text,s.value=this.mergePayload(t.data,o.value),s.actionComplianceParams=r({type:t.getJsonTypeName(),title:s.title,text:o.text},!!t.iconUrl&&{imageUrl:t.iconUrl});break;case this.constants.bots.cards.actions.invoke.toLowerCase():s.type=this.constants.bots.cards.actions.invoke,s.value=this.mergePayload(t.data,o.value),s.actionComplianceParams=r({type:t.getJsonTypeName(),title:s.title},!!t.iconUrl&&{imageUrl:t.iconUrl});break;case this.constants.bots.cards.actions.reply.toLowerCase():s.type=this.constants.bots.cards.actions.reply,s.value=o.value;break;case this.constants.bots.cards.actions.signIn.toLowerCase():s.type=this.constants.bots.cards.actions.signIn,s.value=o.value;break;default:this.logger.error("Unrecognized action type = "+a)}return s.type?this.buttonClicked(e,s,this.card):Promise.reject("Unrecognized action type = "+a)},t.prototype.getActionExecuteInvokePayload=function(e,t,n){var i=e.data?this.mergePayload(e.data,{type:this.constants.bots.cards.actions.actionExecuteInvoke}):JSON.stringify({type:this.constants.bots.cards.actions.actionExecuteInvoke}),o={action:r(r({},e.toJSON()),{data:JSON.parse(i)}),trigger:t};return n&&(o.source=n),JSON.stringify(o)},t.prototype.updateAuthDataInInvokePayload=function(e,t,n){try{var i=JSON.parse(e);return t&&(i.state=t,delete i.authentication),n&&(i.authentication=n,delete i.state),JSON.stringify(i)}catch(e){throw this.logger.error("updateAuthDataInInvokePayload failed while parsing and stringify"),e}},t.prototype.getRefreshTypeAndSource=function(e){try{var t=JSON.parse(e);return{cardRefreshType:t.trigger,executeSource:t.source}}catch(e){throw this.logger.error("getRefreshTypeAndSource failed while parsing"),e}},t.prototype.isActionExecuteRefresh=function(e){return!e||e!==teamspace.services.ActionExecuteSource.ButtonClick},t.prototype.isActionExecuteOptimizationEnabled=function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableActionExecuteInvokeOptimization)},t.prototype.isACv2IntegratedCachingEnabled=function(){return this.settingsService.valueFor(this.constants.settings.names.enableACv2IntegratedCaching)},t.prototype.isCardRefreshAllowed=function(){return this.isActionExecuteEnabledForCard()&&this.isRefreshEnabledForCard()},t.prototype.renderCard=function(e){this.card.content=e,this.initAdaptiveCard(),this.render()},t.prototype.handleRefreshAction=function(e,t,n){var i=this.acSerializationContext.parseAction(new h.AdaptiveCard,e,[],!1);if(i){var r=t===s.Auto&&this.$scope.inCompose?teamspace.services.ActionExecuteSource.Compose:n;this.handleOnExecuteAction(i,t,r)}},t.prototype.showACv2Loader=function(){this.enableACv2NewLoadingExperience&&(this.disableButtons(!0),this.cardBorderTopColor="transparent"),this.isCardRefreshing=!0,this.updateRefreshButtonState(b.IN_PROGRESS)},t.prototype.hideACv2Loader=function(){this.enableACv2NewLoadingExperience&&(this.disableButtons(!1),this.cardBorderTopColor=this.card.accentColor),this.isCardRefreshing=!1,this.updateRefreshButtonState(b.COMPLETE)},t.prototype.handleCardUpdate=function(e){var t=this;if(this.botCardService.getCardCacheKey(this.card)===e.cacheKey&&(this.hideACv2Loader(),e.cardContent)){this.$scope.isUserSpecificCard=!0;var n=this.botCardFactory.createCard({content:e.cardContent,contentType:this.constants.bots.cards.types.adaptive},null,null);this.card.content=n.content,this.initAdaptiveCard(),this.render(),this.checkForRefreshAndUpdateRefreshButtonState().catch(function(e){var n="Error while executing checkForRefreshAndUpdateRefreshButtonState in handleCardUpdate. Msg: "+e.message;t.logger.error(n)}),this.triggerInputExtensionResizeEvent()}},t.prototype.handleCardAuthRequest=function(e){var t=e.cacheKey,n=e.oauthCard,i=e.sourceCardBtn,r=e.isSSOFlow;this.botCardService.getCardCacheKey(this.card)===t&&this.showSignInFooterForOAuthRequestOnRefresh(n,i,r)},t.prototype.handleShowAppInstallBtnRequest=function(e){var t=e.cacheKey,n=e.oauthCard,i=e.sourceCardBtn;this.botCardService.getCardCacheKey(this.card)===t&&this.showAddAppButtonOnFooterToCompleteAuth(n,i)},t.prototype.showAddAppButtonOnFooterToCompleteAuth=function(e,t){var n=this;this.hideACv2Loader();var i=this.getRefreshTypeAndSource(t.value).executeSource,r=this.isActionExecuteRefresh(i);this.setCardFooterAddAppMessageText(function(){n.handleAddAppButtonClick(t,e)},r)},t.prototype.handleAddAppButtonClick=function(e,t){var n=this,i=this.getRefreshTypeAndSource(e.value),r=i.cardRefreshType,o=i.executeSource,a=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleAddAppButtonClick);this.showAddAppMessage=!1,this.showACv2Loader(),this.botCardService.installAppInPersonalContext(this.card).then(function(){a.mark(n.constants.scenarios.extensibility.bots.adaptiveCardAuth.appInstallDone);var i=n.findLastClickEvent();n.handleAuthenticationAndExecuteAction(t,e,i,!0).then(function(){a.stop({message:"app install and authentication done",appId:n.card.appId,botId:n.getBotIdFromCard(),cardRefreshType:r,executeSource:o,isInputExtension:n.card.isInputExtension})})}).catch(function(e){n.handleErrorInAuthFlow(a,e&&e.errorMessage||"error in app install flow",r,o,e&&e.errorCode||"")}),this.botCardService.logTelemetryForACv2AuthClicksOnFooter(this.card,teamspace.components.PanelActionScenario.cardFooterAddAppButtonClick.toString())},t.prototype.showSignInFooterForOAuthRequestOnRefresh=function(e,t,n){var i=this;if(this.getRefreshTypeAndSource(t.value).cardRefreshType===s.Auto){this.hideACv2Loader();this.setCardFooterSignInMessageText(function(){i.handleSignInButtonClickByUser(e,t,n)},n)}},t.prototype.handleSignInButtonClickByUser=function(e,t,n){var i;n?(i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleSSOConsentButtonClick),this.botCardService.logTelemetryForACv2AuthClicksOnFooter(this.card,teamspace.components.PanelActionScenario.cardFooterSSOConsentButtonClick.toString())):(i=this.loggingService.newScenario(this.constants.scenarios.extensibility.bots.adaptiveCardAuth.handleSignInButtonClick),this.botCardService.logTelemetryForACv2AuthClicksOnFooter(this.card,teamspace.components.PanelActionScenario.cardFooterSignInButtonClick.toString())),this.showSignInMessage=!1,this.showACv2Loader(),n&&!this.botCardService.isValidOAuthRequest(e)?this.handleAADInteractiveAuthFlow(e,t,null,i,!1,n,!0):this.handleOAuthFlow(e,t,null,i,!1,n,!0)},t.prototype.triggerInputExtensionResizeEvent=function(){this.enableActionExecuteFromInputExtension&&this.card.isInputExtension&&this.$scope.inCompose&&this.eventingService.$emit(this.constants.inputExtensionConstants.resizeInputExtension,{cardClientId:this.card.cardClientId,type:this.constants.events.funStuff.type.inputExtension,installConsentSource:this.$scope.installConsent&&this.$scope.installConsent.source})},t.prototype.handleCardRefreshEvent=function(e){e.executeSource!==teamspace.services.ActionExecuteSource.TaskModuleClose&&e.executeSource!==teamspace.services.ActionExecuteSource.StageViewClose||this.handleRefreshOnTaskModuleOrStageViewClose(e)},t.prototype.getUserCountFromConversation=function(){var e=this;return-1!==this.userCountInConversation?this.$q.resolve(this.userCountInConversation):this.botCardService.getUserCountFromConversation(this.card.conversationId).then(function(t){return e.userCountInConversation=t,e.card.telemetryEventData=r(r({},e.card.telemetryEventData),{acv2RefreshTeamSize:e.userCountInConversation}),t})},t.prototype.updateRefreshButtonState=function(e){var t=this;if(this.card.isACv2&&this.refreshButtonState!==e){this.refreshButtonState=e;var n=this.constants.events.messages.refresh.complete;switch(e){case b.SHOW:n=this.constants.events.messages.refresh.show;break;case b.HIDE:n=this.constants.events.messages.refresh.hide;break;case b.IN_PROGRESS:n=this.constants.events.messages.refresh.inprogress;break;default:n=this.constants.events.messages.refresh.complete}this.card.isBotCard&&this.card.notifyAll(teamspace.services.CardEvent.updateRefreshStatus,{cardObjectId:this.objectId,state:n,callback:function(e){return t.handleRefreshButtonClick(e)}})}},t.prototype.handleRefreshButtonClick=function(e){e&&(e.stopPropagation(),e.preventDefault()),this.card.isInputExtension&&this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.cardHeaderMenuId);var t=this.card.content.refresh.action;this.handleRefreshAction(t,s.Manual)},t.prototype.handleRefreshOnTaskModuleOrStageViewClose=function(e){var t,n,i=e.cardObjectId,r=e.executeSource,o=!!this.card.replyChainId&&teamspace.services.MessagingUtilities.isClientLie(this.card.replyChainId);if(i===this.objectId&&this.isCardRefreshAllowed()&&!o){var a=null===(n=null===(t=this.card.content)||void 0===t?void 0:t.refresh)||void 0===n?void 0:n.action;this.handleRefreshAction(a,s.Auto,r)}},t.prototype.handleACv2RenderWithCacheRead=function(){var e=this;this.$q.all([this.botCardService.getAssociatedBotMri(this.card),this.getUserCountFromConversation()]).then(function(t){var n=t[0],i=t[1];if(e.isActionExecuteEnabledForCard()){e.card.isACv2&&e.showACv2Loader();var r=e.botCardService.getCardCacheKey(e.card),o=e.card.content;e.botCardService.shouldACv2CacheReplaceMessagePayload(e.card.content,n,r,e.card.cardMessageVersion,i,e.card.isInputExtension).then(function(t){var a=t[0],l=t[1];a?(o=l.data,e.renderCard(o)):l&&l.data&&e.botCardService.deleteCachedAdaptiveCardData(r),e.isCardRefreshing&&e.hideACv2Loader(),e.isCardRefreshAllowed()?e.botCardService.checkCardForManualAndAutoRefresh(o,n,i).then(function(t){var n=t[0],i=t[1];if(n||i?e.updateRefreshButtonState(b.SHOW):e.updateRefreshButtonState(b.HIDE),i){var r=e.botCardService.getAdaptiveCardRefreshAction(e.card,l);r&&e.handleRefreshAction(r,s.Auto)}}):e.updateRefreshButtonState(b.HIDE)}).catch(function(){e.hideACv2Loader()})}}).finally(function(){e.clientObservers.onReady&&e.clientObservers.onReady({$ctrl:e})})},t.prototype.isActionExecuteEnabledForCard=function(){return this.card.isACv2&&(this.card.isBotCard&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableActionExecuteFromBotCard)||this.card.isInputExtension&&this.enableActionExecuteFromInputExtension)},t.prototype.isRefreshEnabledForCard=function(){return this.card.isBotCard&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableRefreshInBotAdaptiveCard)||this.card.isInputExtension&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableRefreshInInputExtensionAdaptiveCard)},t.prototype.createApplicationSearchQueryHandler=function(){var e=this;return function(t,n,i){var r={queryText:t,dataset:n,context:i,queryOptions:{skip:0,top:15}};return e.botCardService.executeSearchInvoke(r,e.card)}},t.botInvokeName="adaptiveCardSubmit",t}(l.BaseCardController);t.AdaptiveCardController=C,angular.module("teamspace.adaptiveCard",[]).directive("adaptiveCard",[function(){return{restrict:"E",scope:{payload:"<?",popupContainerSelector:"@?",threadId:"@?",showCardBorder:"<?",showCardHeader:"<?",showCopy:"<?",useDefaultResponsiveCardWidth:"<?",hostConfigDefault:"<?",hostConfigDark:"<?",hostConfigContrast:"<?",onReady:"&?",onWillExecuteAction:"&?",onDidExecuteAction:"&?",onPostProcessingStyling:"&?",onCopy:"&?",onPreInit:"&?",popoverPlacement:"@?",inCompose:"<?",isUserSpecificCard:"<?",installConsent:"<?"},controllerAs:"ctrl",bindToController:{card:"<?",seeMoreEnabled:"@?",mentions:"<?"},controller:C,link:function(e,t,n,i){i.postLink()}}}]).run(["$templateCache",function(e){e.put("lazy-components/adaptive-card/adaptive-card.html",p),e.put("lazy-components/adaptive-card/card-header-menu.html",u),e.put("lazy-components/adaptive-card/card-overflow-menu.html",d)}])},328:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),r=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.CardObject=t.ValidationResults=void 0;var o=n(37),a=n(57),s=n(43),l=n(145),c=n(49),p=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:o.ValidationPhase.Validation,source:e,event:t,message:n})},e}();t.ValidationResults=p;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t}return i(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e){return!!this._renderedElement&&this._renderedElement.contains(e)},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(s.GlobalSettings.allowPreProcessingPropertyValues){for(var i=this;i&&!i.onPreProcessPropertyValue;)i=i.parent;if(i&&i.onPreProcessPropertyValue)return i.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,o.ValidationEvent.DuplicateId,a.Strings.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.validateProperties=function(){var e=new p;return this.internalValidateProperties(e),e},t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:void 0},t.prototype.releaseDOMResources=function(){},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),t.typeNameProperty=new c.StringProperty(c.Versions.v1_0,"type",void 0,void 0,void 0,function(e){return e.getJsonTypeName()}),t.idProperty=new c.StringProperty(c.Versions.v1_0,"id"),t.requiresProperty=new c.SerializableObjectProperty(c.Versions.v1_2,"requires",l.HostCapabilities,!1,new l.HostCapabilities),r([(0,c.property)(t.idProperty)],t.prototype,"id",void 0),r([(0,c.property)(t.requiresProperty)],t.prototype,"requires",null),t}(c.SerializableObject);t.CardObject=u},329:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0;!function(e){e.Automatic="automatic",e.Manual="manual"}(t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var r=function(){return function(e,t){this.code=e,this.message=t}}();t.ActivityRequestError=r;var o=function(){return function(e){this.request=e}}();t.ActivityResponse=o;var a=function(e){function t(t,n){var i=e.call(this,t)||this;return i.request=t,i.rawContent=n,i}return i(t,e),t}(o);t.SuccessResponse=a;var s=function(e){function t(t,n){var i=e.call(this,t)||this;return i.request=t,i.error=n,i}return i(t,e),t}(o);t.ErrorResponse=s;var l=function(e){function t(t,n){var i=e.call(this,t)||this;i.request=t,i._auth=n;for(var r=0,o=i._auth.buttons;r<o.length;r++){var a=o[r];if("signin"===a.type&&void 0!==a.value)try{new URL(a.value),i.signinButton=a;break}catch(e){}}return i}return i(t,e),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),t}(o);t.LoginRequestResponse=l},330:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(331),a=n(332),s=n(66),l=function(e){function t(t,n,i,r,o,a,l,c,p,u,d,h,f,y,g,m,v){var b=e.call(this)||this;return b.messageListItemClassSelector=t,b.popupContainerSelector=n,b.$scope=i,b.$compile=r,b.$templateCache=o,b.$translate=a,b.resources=l,b.ariaLiveService=c,b.settingsService=p,b.eventingService=u,b.cardId=d,b.utilityService=h,b.constants=f,b.htmlSanitizer=y,b.conversationId=g,b.executeSearchInvoke=m,b.shouldLoadPeoplePickerChoices=v,b.directorySearchEnabled=!1,b.directorySearchMode=s.DirectorySearchMode.Unknown,b.directorySearchEnabled=p.valueAsBoolean(f.settings.names.enableAdaptiveCardDirectorySearch),b}return i(t,e),t.prototype.internalRender=function(){return this.impl.internalRender()},t.prototype.parse=function(t){e.prototype.parse.call(this,t);var n=!!t.wrap,i="filtered"===t.style,r=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAdaptiveCardTypeahead),l=this.directorySearchEnabled&&t&&t[s.ChoiceSetInputDirectory.choicesDataKey];this.placeholder=t&&t[s.ChoiceSetInputDirectory.placeholder];var c=this.settingsService.valueAsBoolean(this.constants.settings.names.enableAdaptiveCardDynamicTypeahead),p=t["choices.data"];this.directorySearchMode=this.getDirectorySearchMode(l),this.directorySearchMode!==s.DirectorySearchMode.Unknown?this.impl=new s.ChoiceSetInputDirectory(this.$compile,this.$scope,this.$translate,this.resources,this.constants,this.eventingService,this.htmlSanitizer,this.directorySearchMode,this.isMultiSelect,this.placeholder,this.hostConfig,this.utilityService.generateUUID(),this.defaultValue,this.choices,this.conversationId,this.shouldLoadPeoplePickerChoices):this.impl=this.isCompact||i?new a.ChoiceSetCompact(this.isMultiSelect,r&&i,c&&p,this.choices,this.hostConfig,this.$templateCache,this.defaultValue,this.placeholder,this.$scope,this.$compile,this.$translate,this.messageListItemClassSelector,this.popupContainerSelector,this.resources,this.constants,this.utilityService,this.htmlSanitizer,this.executeSearchInvoke):new o.ChoiceSetExpanded(this.isMultiSelect,this.choices,this.hostConfig,this.$templateCache,this.defaultValue,this.$translate,this.resources,this.ariaLiveService,this.cardId,this.id,n,this.utilityService,this.htmlSanitizer)},Object.defineProperty(t.prototype,"value",{get:function(){return this.impl.value},enumerable:!0,configurable:!0}),t.prototype.getDirectorySearchMode=function(e){var t=s.DirectorySearchMode.Unknown;if(!e)return t;var n=e.type,i=e.dataset;return n&&s.ChoiceSetInputDirectory.choicesDataTypeValue===_.toLower(n)&&i&&_.toLower(i).startsWith(s.ChoiceSetInputDirectory.choicesDatasetPrefix)&&(this.conversationId&&s.ChoiceSetInputDirectory.contextualDataset===_.toLower(i)?t=s.DirectorySearchMode.Conversation:s.ChoiceSetInputDirectory.organizationDataset===_.toLower(i)&&(t=s.DirectorySearchMode.Organization)),t},t}(r.ChoiceSetInput);t.ChoiceSetInput=l},331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,i,r,o,a,s,l,c,p,u,d){this.isMultiSelect=e,this.choices=t,this.hostConfig=n,this.defaultValue=r,this.$translate=o,this.resources=a,this.ariaLiveService=s,this.cardId=l,this.id=c,this.wrap=p,this.utilityService=u,this.htmlSanitizer=d,this.inputElements=[],this.unselectedSvgHtml=e?i.get("svg/icons-checkbox-unselected.html"):i.get("svg/icons-radiobox-unselected.html"),this.selectedSvgHtml=e?i.get("svg/icons-checkbox-selected.html"):i.get("svg/icons-radiobox-selected.html")}return Object.defineProperty(e.prototype,"value",{get:function(){var e=this;if(this.isMultiSelect){var t=_.map(_.keys(_.pickBy(this.inputElements,function(e){return e.checked})),Number);return _.map(t,function(t){return e.choices[t].value}).join(this.hostConfig.choiceSetInputValueSeparator)||null}var n=_.findIndex(this.inputElements,function(e){return e.checked});return this.choices[n]&&this.choices[n].value||null},enumerable:!0,configurable:!0}),e.prototype.internalRender=function(){var e,t=this;this.isMultiSelect&&(e=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null);var n=angular.element(document.createElement("div"));return n.addClass("choice-container"),this.inputElements=[],_.each(this.choices,function(i,r){var o=document.createElement("input");o.type=t.isMultiSelect?"checkbox":"radio",o.classList.add("check-item"),o.name=t.cardId+t.htmlSanitizer.escapeAngular(t.id),o.checked=t.isMultiSelect?e&&e.indexOf(i.value)>=0:t.defaultValue&&t.defaultValue===i.value;var a=angular.element('<div class="icons-item-unselected icon hide-text">'+t.unselectedSvgHtml+"</div>"),s=angular.element('<div class="icons-item-selected icon hide-text">'+t.selectedSvgHtml+"</div>");t.wrap&&(a.find("svg").addClass("wrap"),s.find("svg").addClass("wrap"));var l=t.utilityService.escapeHtml(i.title),c=angular.element("<span ng-non-bindable></span>");c.append(l);var p=angular.element(document.createElement("label"));p[0].classList.add("choice-label"),p[0].title=t.htmlSanitizer.escapeAngular(i.title),p[0].setAttribute("tabindex","-1"),p[0].onfocus=function(){return t.narrateFocusedItem(r)},p[0].onkeydown=function(e){return t.onkeydown(e,o,r)},p.append(o),p.append(a),p.append(s),p.append(c),t.addWrapStyling(p),n.append(p),t.inputElements.push(o)}),this.choiceSetInputElement=angular.element(document.createElement("div")),this.choiceSetInputElement.addClass("o365-action-pane-multichoice-input"),this.choiceSetInputElement.append(n),this.choiceSetInputElement[0]},e.prototype.addWrapStyling=function(e){this.wrap&&(e.css("overflow-wrap","break-word"),e[0].style.wordBreak="break-word",e[0].style.height="auto",e[0].style.whiteSpace="unset",e[0].style.display="flex",e[0].style.alignItems="center",e[0].style.textAlign="left",this.isMultiSelect||(e.find("span")[0].style.paddingLeft="1.6rem"))},e.prototype.onkeydown=function(e,t,n){var i=teamspace.Constants.Instance.keyCodes.enter,r=teamspace.Constants.Instance.keyCodes.space;!e||e.keyCode!==i&&e.keyCode!==r||(t.click(),this.narrateFocusedItem(n))},e.prototype.narrateFocusedItem=function(e){var t=this.inputElements[e],n="";n=this.isMultiSelect?t.checked?this.$translate.instant(this.resources.strings.icons_checkbox_selected):this.$translate.instant(this.resources.strings.icons_checkbox_unselected):t.checked?this.$translate.instant(this.resources.strings.icons_radiobox_selected):this.$translate.instant(this.resources.strings.icons_radiobox_unselected),n+=". "+this.choices[e].title,this.ariaLiveService.update(n,!0)},e}();t.ChoiceSetExpanded=i},332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(19),r=n(50),o=function(){function e(e,t,n,i,o,a,s,l,c,p,u,d,h,f,y,g,m,v){var b=this;this.isMultiSelect=e,this.isTypeahead=t,this.dynamicSearchProps=n,this.choices=i,this.hostConfig=o,this.placeholder=l,this.$scope=c,this.$compile=p,this.$translate=u,this.popupContainerSelector=h,this.resources=f,this.utilityService=g,this.htmlSanitizer=m,this.executeSearchInvoke=v,this.showDropdown=!1,this.typeaheadFilterText="",this.debouncedFilterTypeaheadInput=_.debounce(function(e){return b.filterTypeaheadInput(e)},25),this.debouncedTypeaheadQuery=_.debounce(function(e){return b.queryUniversalSearch(e)},300),this.isLoading=!1,this.noResults=!1,this.dynamicSearchError=null,this.checkedTypeaheadChoicesMap={},this.dynamicChoiceListItems=[],this.checkedDynamicChoiceListItems=[],this.focusFirstListElement=function(){};var C=function(e,t){var n=Number.isInteger(t),i=e.find("li"),r=n?i.eq(t):b.selectedItems.length?i.filter(".selected").first():i.first();r&&(_.forEach(i,function(e){e.removeAttribute("tabindex"),e.classList.remove("kb-active")}),r.addClass("kb-active").attr("tabindex","0").focus())},S=function(e,t){e.closest(d).css("overflow",t?"visible":"")};v||(this.dynamicSearchProps=null),c.$on("dropdown.show",function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=$(n[0].$element);S(o,!0),r.AdaptiveCardHelper.scrollToBottomForLastItem(o,d),t?(b.focusFirstListElement=function(){C(o,0)},b.keydownHandler=function(e){"ArrowUp"===e.key?C(o,-1):"ArrowDown"===e.key&&(e.stopPropagation(),C(o,0))},b.choiceSetInputElement.find("input").focus()):C(o)}),c.$on("dropdown.hide.before",function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];b.showDropdown=!1,t&&e&&(b.choiceListChecked.some(_.identity)||b.checkedDynamicChoiceListItems.length)&&(b.typeaheadInput=""),S($(i[0].$element),!1)}),c.$on(y.events.adaptiveCard.dismissDropdown,function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];b.showDropdown=!1}),this.dropdownSvgHtml=a.get("svg/icons-dropdown.html"),this.closeSvgHtml=a.get("svg/icons-close.html"),this.unselectedSvgHtml=e?a.get("svg/icons-checkbox-unselected.html"):a.get("svg/icons-radiobox-unselected.html"),this.selectedSvgHtml=e?a.get("svg/icons-checkbox-selected.html"):a.get("svg/icons-radiobox-selected.html");var A;e&&(A=s?s.split(o.choiceSetInputValueSeparator):null),this.choiceListVisible=i.map(function(){return!0}),this.choiceListChecked=_.map(i,function(t){return e?A&&A.indexOf(t.value)>=0:s&&s===t.value})}return Object.defineProperty(e.prototype,"value",{get:function(){var e=this.selectedItems,t=_.reduce(this.checkedTypeaheadChoicesMap,function(e,t,n){return t&&e.push(n),e},[]);if(this.isMultiSelect)return(this.dynamicSearchProps?t:_.map(e,function(e){return e.value})).join(this.hostConfig.choiceSetInputValueSeparator)||null;return(this.dynamicSearchProps?t&&t[0]:e&&e[0]&&e[0].value)||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeaheadInput",{get:function(){return this.typeaheadFilterText},set:function(e){e.length?this.showDropdown=!0:this.dynamicChoiceListItems=[],this.typeaheadFilterText=e,this.dynamicSearchProps&&e.length?(this.isLoading=!0,this.noResults=!1,this.debouncedTypeaheadQuery(e)):this.debouncedFilterTypeaheadInput(e)},enumerable:!0,configurable:!0}),e.prototype.clearSelection=function(){this.choiceListChecked=this.choiceListChecked.map(function(){return!1}),this.typeaheadInput="",this.checkedTypeaheadChoicesMap={},this.checkedDynamicChoiceListItems=[],this.dynamicChoiceListItems=[],this.updateDropdownTextAndTitle()},e.prototype.internalRender=function(){return this.choiceSetInputElement=angular.element(this.isTypeahead?this.typeaheadTemplate:this.dropdownTemplate),this.$scope.ctrl=this,this.$compile(this.choiceSetInputElement)(this.$scope),this.updateDropdownTextAndTitle(),this.setupClickHandlerForDropdownArrowButton(),this.choiceSetInputElement[0]},e.prototype.filterTypeaheadInput=function(e){var t=this,n=e.toLowerCase();this.choiceListVisible=this.choices.map(function(e,i){return t.choiceListChecked[i]||-1!=e.title.toLowerCase().indexOf(n)}),this.noResults=!this.choiceListVisible.some(_.identity),this.$scope.$apply()},e.prototype.updateDynamicSearchResults=function(e,t){if(this.typeaheadInput===t){if(null===e||null===e.results)return this.dynamicChoiceListItems=[],this.handleDynamicSearchError({statusCode:teamspace.services.UniversalSearchStatusCodes.InternalServerError},t);this.dynamicChoiceListItems=e.results.map(function(e){return new i.Choice(e.title||e.value,e.value)}),this.noResults=!this.dynamicChoiceListItems.length,this.isLoading=!1}},e.prototype.handleDynamicSearchError=function(e,t){if(this.typeaheadInput===t){var n=void 0;n=e.statusCode===teamspace.services.UniversalSearchStatusCodes.InternalServerError?e.value&&e.value.message?this.serviceErrorText+": "+e.value.message:this.serviceErrorText:e.statusCode===teamspace.services.UniversalSearchStatusCodes.RateLimit?this.rateLimitErrorText:e.statusCode===teamspace.services.UniversalSearchStatusCodes.Unauthorized?this.loginErrorText:this.serviceErrorText,this.dynamicSearchError=this.utilityService.escapeHtml(n),this.isLoading=!1,this.noResults=!1}},e.prototype.queryUniversalSearch=function(e){var t=this;this.dynamicChoiceListItems=[],this.dynamicSearchError=null,this.noResults=!1,e&&this.executeSearchInvoke(e,this.dynamicSearchProps.dataset).then(function(n){return t.updateDynamicSearchResults(n,e)}).catch(function(n){return t.handleDynamicSearchError(n,e)})},Object.defineProperty(e.prototype,"dropdownTemplate",{get:function(){var e=angular.element("<div></div>");e.attr("class","o365-action-pane-multichoice-input");var t=angular.element("<div></div>");t.attr("class","o365-multichoice-selector");var n=angular.element("<button bs-dropdown ></button>");n.attr("class","o365-text-input o365-text-input-singleline"),n.attr("data-bs-show","ctrl.showDropdown"),n.attr("aria-haspopup","true"),n.attr("aria-expanded","false"),n.attr("data-placement","bottom-left"),n.attr("data-container",this.popupContainerSelector);var i=angular.element("<div ng-non-bindable></div>");i.attr("class","text");var r=angular.element("<div></div>");r.attr("class","placeholder");var o=this.utilityService.escapeHtml(this.dropdownPlaceholder);r.append(o),n.append(i),n.append(r);var a=angular.element("<button ></button>");a.attr("class","o365-dropdown-button ac-dropdown-icon"),a.attr("tabindex","-1");var s=angular.element("<div></div>");return s.append(this.dropdownSvgHtml),a.append(s),t.append(n),t.append(this.choiceListTemplate),t.append(a),e.append(t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeaheadTemplate",{get:function(){var e=this,t=this.utilityService.escapeHtml(this.dropdownPlaceholder),n=angular.element("<div></div>");n.attr("class","o365-action-pane-multichoice-input");var i=angular.element("<div></div>");i.attr("class","o365-multichoice-selector");var r=angular.element("<input bs-dropdown />");r.attr("class","o365-text-input o365-text-input-singleline"),r.attr("ng-model","ctrl.typeaheadInput"),r.attr("ng-keydown","ctrl.keydownHandler($event)"),r.attr("data-bs-show","ctrl.showDropdown"),r.attr("aria-haspopup","true"),r.attr("aria-expanded","false"),r.attr("data-placement","bottom-left"),r.attr("data-trigger","manual"),r.attr("placeholder",t),r.attr("data-container",this.popupContainerSelector);var o=angular.element("<button ></button>");o.attr("class","o365-dropdown-button"),this.isMultiSelect||o.attr("ng-hide","!!ctrl.value");var a=angular.element("<div></div>");a.attr("aria-hidden","true"),a.append(this.closeSvgHtml),o.append(a);return i.append(r),i.append(this.choiceListTemplate),i.append(o),this.isMultiSelect||i.append(function(){var t=angular.element("<button ></button>");t.attr("ng-hide","!ctrl.value"),t.attr("ng-click","ctrl.clearSelection()"),t.attr("class","o365-close-button"),t.attr("acc-role","clickable");var n=angular.element("<div></div>");return n.attr("aria-hidden","false"),n.append(e.closeSvgHtml),t.append(n),t}()),n.append(i),n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"choiceListTemplate",{get:function(){var e=angular.element("<div></div>");e.attr("class","ts-adaptive-card dropdown-menu o365-multichoice-dropdown "+(this.isMultiSelect&&"isMultiselect"));var t=angular.element("<div></div>");t.attr("acc-role","menu");var n=angular.element("<div simple-scrollbar></div>");n.attr("class","dropdown-item-container");var i=angular.element("<ul ></ul>");return i.attr("class","dropdown-list"),this.isTypeahead?i.append(this.typeaheadChoiceListTemplate):i.append(this.staticChoiceListTemplate),n.append(i),t.append(n),e.append(t),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeaheadChoiceListTemplate",{get:function(){if(this.dynamicSearchProps)return this.dynamicChoiceListTemplate;var e=angular.element("<li ></li>");e.attr("class","item"),e.attr("ng-repeat","choice in ctrl.choices"),e.attr("ng-if","ctrl.choiceListVisible[$index]"),e.attr("ng-class","{'selected' : ctrl.choiceListChecked[$index]}"),e.attr("acc-role","menu-item clickable"),e.append(this.singleTypeaheadChoiceTemplate);var t=angular.element("<span ng-non-bindable></span>");t.attr("class","content"),t.append(this.noResultsText);var n=angular.element("<li ></li>");return n.attr("ng-if","ctrl.noResults"),n.attr("acc-role","menu-item clickable"),n.append(t),[e,n]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"staticChoiceListTemplate",{get:function(){var e=this;return _.map(this.choices,function(t,n){var i=e.utilityService.escapeHtml(t.title),r=angular.element("<li ></li>");r.attr("class","item"),r.attr("ng-class","{'selected' : ctrl.choiceListChecked["+n+"]}"),r.attr("acc-role","menu-item clickable");var o=angular.element("<a ></a>");o.attr("ng-click","ctrl.onDropdownItemClicked($event, "+n+")"),o.attr("track-click-silent","true");var a=angular.element("<div></div>");a.attr("class","icons-item-unselected icon hide-text"),a.append(e.unselectedSvgHtml);var s=angular.element("<div></div>");s.attr("class","icons-item-selected icon hide-text"),s.append(e.selectedSvgHtml);var l=angular.element("<span ng-non-bindable></span>");return l.append(i),o.append(a),o.append(s),o.append(l),r.append(o),r})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dynamicChoiceListTemplate",{get:function(){var e=angular.element("<li ></li>");e.attr("class","item selected"),e.attr("ng-repeat","choice in ctrl.checkedDynamicChoiceListItems"),e.attr("acc-role","menu-item clickable"),e.append(this.singleTypeaheadChoiceTemplate);var t=angular.element("<li ></li>");t.attr("class","item"),t.attr("ng-if","!!ctrl.typeaheadInput.length && !!ctrl.dynamicChoiceListItems.length && !ctrl.checkedTypeaheadChoicesMap[choice.value]"),t.attr("ng-repeat","choice in ctrl.dynamicChoiceListItems"),t.attr("ng-class","{'selected' : ctrl.checkedTypeaheadChoicesMap[choice.value]}"),t.attr("acc-role","menu-item clickable"),t.append(this.singleTypeaheadChoiceTemplate);var n=angular.element("<li ></li>");n.attr("class","item"),n.attr("ng-if","ctrl.shouldShowStaticChoice(choice)"),n.attr("ng-repeat","choice in ctrl.choices"),n.attr("ng-class","{'selected' : ctrl.checkedTypeaheadChoicesMap[choice.value]}"),n.attr("acc-role","menu-item clickable"),n.append(this.singleTypeaheadChoiceTemplate);var i=angular.element("<span ng-non-bindable></span>");i.attr("class","content"),i.append(this.noResultsText);var r=angular.element("<li ></li>");r.attr("ng-if","!!ctrl.typeaheadInput.length && ctrl.noResults"),r.attr("acc-role","menu-item"),r.append(i);var o=angular.element("<span ng-non-bindable></span>");o.attr("class","content"),o.append(this.loadingText);var a=angular.element("<li ></li>");a.attr("ng-if","!!ctrl.typeaheadInput.length && ctrl.isLoading"),a.attr("acc-role","menu-item"),a.append(o);var s=angular.element("<span></span>");s.attr("class","content"),s.append("{{ctrl.dynamicSearchError}}");var l=angular.element("<li ></li>");return l.attr("ng-if","!!ctrl.typeaheadInput.length && !!ctrl.dynamicSearchError"),l.attr("acc-role","menu-item"),l.append(s),[e,t,n,r,a,l]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"singleTypeaheadChoiceTemplate",{get:function(){var e=this.dynamicSearchProps?"ctrl.onDynamicChoiceClicked($event, choice)":"ctrl.onDropdownItemClicked($event, $index)",t=angular.element("<a ></a>");t.attr("ng-click",e),t.attr("track-click-silent","true");var n=angular.element("<div></div>");n.attr("class","icons-item-unselected icon hide-text"),n.append(this.unselectedSvgHtml);var i=angular.element("<div></div>");i.attr("class","icons-item-selected icon hide-text"),i.append(this.selectedSvgHtml);var r=angular.element("<span></span>");return r.append("{{ choice.title }}"),t.append(n),t.append(i),t.append(r),t},enumerable:!0,configurable:!0}),e.prototype.shouldShowStaticChoice=function(e){return!this.checkedTypeaheadChoicesMap[e.value]&&(!this.typeaheadInput.length||!this.dynamicChoiceListItems.length&&!(this.noResults||this.isLoading||this.dynamicSearchError))},e.prototype.onDropdownItemClicked=function(e,t){this.isMultiSelect?this.toggleSelection(t):this.setSelected(t,!0),this.updateDropdownTextAndTitle(),this.isMultiSelect&&e.stopPropagation()},e.prototype.onDynamicChoiceClicked=function(e,t){this.isMultiSelect?(this.setDynamicSelected(t,!this.checkedTypeaheadChoicesMap[t.value]),this.focusFirstListElement()):this.setDynamicSelected(t,!0),this.updateDropdownTextAndTitle(),this.isMultiSelect&&e.stopPropagation()},e.prototype.setDynamicSelected=function(e,t){if(this.isMultiSelect||(this.checkedTypeaheadChoicesMap={}),this.checkedTypeaheadChoicesMap[e.value]=t,this.isMultiSelect)if(t)this.checkedDynamicChoiceListItems.push(e);else{var n=this.checkedDynamicChoiceListItems.findIndex(function(t){return t.value===e.value});this.checkedDynamicChoiceListItems.splice(n,1)}else this.typeaheadFilterText=e.title;this.showDropdown=this.isMultiSelect},e.prototype.setSelected=function(e,t){this.isMultiSelect?this.choiceListChecked[e]=t:this.choiceListChecked=_.map(this.choiceListChecked,function(t,n){return n===e}),this.isTypeahead&&(this.typeaheadFilterText=this.isMultiSelect?this.typeaheadInput:this.choices[e].title,this.showDropdown=this.isMultiSelect)},e.prototype.toggleSelection=function(e){this.setSelected(e,!this.choiceListChecked[e])},Object.defineProperty(e.prototype,"selectedItems",{get:function(){var e=this;return _.filter(this.choices,function(t,n){return e.choiceListChecked[n]})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownDisplayText",{get:function(){if(this.isMultiSelect){var e=this.selectedItems.length+this.checkedDynamicChoiceListItems.length;return 0==e?this.dropdownPlaceholder:this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_multipleSelect_selected,{numItems:e})}return 1===this.selectedItems.length&&this.selectedItems[0].title||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownTooltip",{get:function(){return _.map(this.selectedItems,function(e){return e.title}).join(this.hostConfig.choiceSetInputValueSeparator+" ")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdownPlaceholder",{get:function(){var e;return null!==(e=this.placeholder)&&void 0!==e?e:this.isMultiSelect?this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_multipleSelect):this.$translate.instant(this.resources.strings.botcards_o365_actionCard_title_multichoice_singleSelect)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noResultsText",{get:function(){return this.$translate.instant(this.resources.strings.extensibility_apps_placeholderMessage_no_results)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadingText",{get:function(){return this.$translate.instant(this.resources.strings.botcards_adaptiveCard_dynamic_search_loading)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceErrorText",{get:function(){return this.$translate.instant(this.resources.strings.botcards_adaptiveCard_dynamic_search_loading_failed)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loginErrorText",{get:function(){return this.$translate.instant(this.resources.strings.botcards_adaptiveCard_dynamic_search_failed_login,{name:this.dynamicSearchProps.appName||"the app"})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rateLimitErrorText",{get:function(){return this.$translate.instant(this.resources.strings.botcards_adaptiveCard_dynamic_search_failed_ratelimit)},enumerable:!0,configurable:!0}),e.prototype.toggleShowDropdown=function(){this.showDropdown=!this.showDropdown},e.prototype.updateDropdownTextAndTitle=function(){var e=this.choiceSetInputElement.find(".o365-multichoice-selector .o365-text-input");if(this.isTypeahead)e.attr("placeholder",this.htmlSanitizer.escapeAngular(this.dropdownDisplayText||this.dropdownPlaceholder));else{var t=e.find(".text");e.attr("title",this.htmlSanitizer.escapeAngular(this.dropdownTooltip)),t.text(this.htmlSanitizer.escapeAngular(this.dropdownDisplayText))}var n=this.isMultiSelect?this.dropdownDisplayText+". "+this.dropdownTooltip:this.dropdownDisplayText;e.attr("aria-label",this.htmlSanitizer.escapeAngular(n))},e.prototype.setupClickHandlerForDropdownArrowButton=function(){var e=this,t=this.choiceSetInputElement.find(".o365-multichoice-selector .o365-dropdown-button");teamspace.common.SafeJQuery.on(this.$scope,t,"click",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.toggleShowDropdown(),e.$scope.$apply()})},e}();t.ChoiceSetCompact=o},333:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(296),o=function(){function e(){}return e.scrollToBottomForLastItem=function(e,t){var n=e.closest(t),i=e.closest(".ts-message-list");i&&i[0]&&i.find(t).last().is(n)&&i.scrollTop(i[0].scrollHeight)},e.convertAmsUrlToAmsV2Url=function(e,t){return t.getUpdatedUrl(e).then(function(e){return e}).catch(function(){return e})},e.addImagePostProcessingForImages=function(e,t,n,i,r,o,a,s,l,c,p){var u=this,d=o.valueAsBoolean(e.settings.names.enableCardImageLazyLoad),h=o.valueAsBoolean(e.settings.names.enableAMSV2UrlDomainsForAdaptiveCards);_.each($(r).find("img"),function(e,r){var o=i.sanitizeHtml($(e).attr("src")||"");s.isAmsImage(o)?u.convertAmsUrlToAmsV2Url(o,a).then(function(a){u.setProcessedImageElement(e,o,r,n,i,s,d,h,t,l,c,a)}).catch(function(e){p.log("unable to update to amsV2 image url: ",e)}):u.setProcessedImageElement(e,o,r,n,i,s,d,h,t,l,c)})},e.colorHostConfigForThemes=function(){var e=teamspace.Constants.Instance,t=r.CardCSSVariables,n={};n[e.themes.default]={containerStyles:{default:{backgroundColor:t.$appWhite.toRGBHexString(),foregroundColors:{default:{default:t.$appGray08.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06.toRGBHexString(),subtle:t.$appBrand08.toRGBHexString()},attention:{default:t.$appRed05.toRGBHexString(),subtle:t.$appRed04.toRGBHexString()},good:{default:t.$appGreen06.toRGBHexString(),subtle:t.$appGreen05.toRGBHexString()},warning:{default:t.$appOrange06.toRGBHexString(),subtle:t.$appOrange05.toRGBHexString()}}},emphasis:{backgroundColor:t.$appGray14.toARGBHexString(),foregroundColors:{default:{default:t.$appGray08.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06.toRGBHexString(),subtle:t.$appBrand08.toRGBHexString()},attention:{default:t.$appRed05.toRGBHexString(),subtle:t.$appRed04.toRGBHexString()},good:{default:t.$appGreen06.toRGBHexString(),subtle:t.$appGreen05.toRGBHexString()},warning:{default:t.$appOrange06.toRGBHexString(),subtle:t.$appOrange05.toRGBHexString()}}}}},n[e.themes.dark]={containerStyles:{default:{backgroundColor:t.$appGray10Darktheme.toARGBHexString(),foregroundColors:{default:{default:t.$appWhiteDarktheme.toARGBHexString(),subtle:t.$appGray02Darktheme.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06Darktheme.toARGBHexString(),subtle:t.$appBrand08Darktheme.toARGBHexString()},attention:{default:t.$appRed02.toARGBHexString(),subtle:t.$appRed01.toARGBHexString()},good:{default:t.$appGreen03.toARGBHexString(),subtle:t.$appGreen02.toARGBHexString()},warning:{default:t.$appOrange03.toARGBHexString(),subtle:t.$appOrange02.toARGBHexString()}}},emphasis:{backgroundColor:t.$appGray14Darktheme.toARGBHexString(),foregroundColors:{default:{default:t.$appWhiteDarktheme.toARGBHexString(),subtle:t.$appGray05.toARGBHexString()},dark:{default:t.$appBlackFull.toRGBHexString(),subtle:t.$appGray08.toARGBHexString()},light:{default:t.$appWhite.toRGBHexString(),subtle:t.$appGray01.toARGBHexString()},accent:{default:t.$appBrand06Darktheme.toARGBHexString(),subtle:t.$appBrand08Darktheme.toARGBHexString()},attention:{default:t.$appRed02.toARGBHexString(),subtle:t.$appRed01.toARGBHexString()},good:{default:t.$appGreen03.toARGBHexString(),subtle:t.$appGreen02.toARGBHexString()},warning:{default:t.$appOrange03.toARGBHexString(),subtle:t.$appOrange02.toARGBHexString()}}}}};var i=t.$appAccTextColor.toARGBHexString(),o=t.$appAccBackgroundColor.toARGBHexString();return n[e.themes.highContrast]={containerStyles:{default:{backgroundColor:o,foregroundColors:{default:{default:i,subtle:i},dark:{default:i,subtle:i},light:{default:i,subtle:i},accent:{default:i,subtle:i},attention:{default:i,subtle:i},good:{default:i,subtle:i},warning:{default:i,subtle:i}}},emphasis:{backgroundColor:o,foregroundColors:{default:{default:i,subtle:i},dark:{default:i,subtle:i},light:{default:i,subtle:i},accent:{default:i,subtle:i},attention:{default:i,subtle:i},good:{default:i,subtle:i},warning:{default:i,subtle:i}}}}},n[e.themes.defaultV2]=n[e.themes.default],n[e.themes.darkV2]=n[e.themes.dark],n[e.themes.tflDefault]=n[e.themes.default],n[e.themes.tflDark]=n[e.themes.dark],n},e.setProcessedImageElement=function(e,t,n,i,r,o,a,s,l,c,p,u){var d=$(e),h=r.sanitizeHtml(d.attr("style")||""),f=r.sanitizeHtml(d.attr("class")||""),y=void 0;d.attr("tabindex")&&(y=r.sanitizeHtml(d.attr("tabindex")));var g=d.attr("alt")||"",m=d.attr("aria-label")||"",v=d.parent("ac-inlineAction").length>0,b=l[n]||!1,C=!v&&b;e.onerror=void 0;var S;if((S=angular.element("<img card-image-error />")).attr("src",s&&u?u:t),S.attr("style",h),S.attr("class",f),S.attr("alt",g),S.attr("aria-label",m),S.attr("role","button"),void 0!==y&&S.attr("tabindex",y),a&&(o.isAmsUrlp(t)?((S=angular.element("<card-image-url-preview ></card-image-url-preview>")).attr("src",t),S.attr("style",h),S.attr("class",f),S.attr("alt",g),S.attr("aria-label",m),void 0!==y&&S.attr("tabindex",y)):o.isAmsImage(t)&&((S=angular.element("<ms-image ></ms-image>")).attr("target-src",t),S.attr("style",h),S.attr("class",f),S.attr("alt",g),S.attr("aria-label",m),S.attr("lazy-load","true"),void 0!==y&&S.attr("tabindex",y),p(S)(c))),C){var A=angular.element("<card-image-expand ></card-image-expand>");A.attr("action-label",i),A.attr("target-src",null!==u&&void 0!==u?u:t),A.append(S),S=A}if(e.onclick){var _=e.onclick;S.on("click",function(e){return _(e)})}d.replaceWith(S)},e.colorThemeConfig=e.colorHostConfigForThemes(),e.createWrappingClass=function(e,t){return function(e){function n(){return e.apply(this,t())||this}return i(n,e),n}(e)},e}();t.AdaptiveCardHelper=o},334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getPersonaSetCompactHtmlString=function(e,t,n){var i="";if(!e||!e.length)return i;if(1===e.length)return this.getPersonaCompactHtmlString(!0);if(!t||e.length<=t)i='<div class="ac-persona-container" ng-repeat="persona in personas">'+this.getPersonaCompactHtmlString()+"</div>";else{i='<div class="ac-persona-container" ng-repeat="persona in personas.slice(0, '+(t-1)+')">'+this.getPersonaCompactHtmlString()+"</div>";var r=e.length-t+1;i+='<div class="ac-persona-set-more-personas-container app-font-xsmall-regular" tabIndex="0" role="button" aria-label="'+(n||"")+'" ng-keydown="ctrl.morePersonasIconKeydownHandler($event)" simple-mouseenter="ctrl.morePersonasIconMouseenterHandler($event)" ng-mouseleave="ctrl.morePersonasIconMouseleaveHandler()"><div class="ac-persona-set-more-personas">+'+r+"</div></div>"}return'<div class="ac-persona-set-container">'+i+"</div>"},e.getPersonaCompactHtmlString=function(e){var t=this.getProfilePictureHtmlString();if(!e)return t;return'<div class="ac-persona-container">'+t+'<div class="ac-persona-display-name-container" title="{{persona.displayName}}" ng-bind="::persona.displayName"></div></div>'},e.getProfilePictureHtmlString=function(){return'<div class="ac-persona-profile-picture-container"><profile-picture person-card  principal-name="::persona.upn" display-name="::persona.displayName" size="\'HR20x20\'" css-class="ac-user-picture" src="adaptive-card-persona"></profile-picture></div>'},e}();t.AdaptiveCardComponentUtils=i},335:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(50),a=function(e){function t(t,n,i,r,a,s,l,c){var p=e.call(this)||this;p.popupContainerSelector=n,p.localizationService=i,p.ariaLiveService=r,p.$scope=a,p.$compile=s,p.$translate=l,p.resources=c,p.actionPrefix="actionDatepicker";var u=function(e,n){!function(e){e.css("overflow",n?"visible":"")}(e.closest(t))};return a.$on(p.actionPrefix+".show.before",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.date=t[0].$date||new Date}),a.$on(p.actionPrefix+".show",function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=$(n[0].$element);u(r,!0),o.AdaptiveCardHelper.scrollToBottomForLastItem(r,t),p.narrateDate(),p.narrateDatepickerLabel()}),a.$on(p.actionPrefix+".hide.before",function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];u($(t[0].$element),!1),p.date=t[0].$date}),p}return i(t,e),t.prototype.internalRender=function(){return _.isEmpty(this.defaultValue)||(this.value=this.defaultValue),this.dateInputElement=angular.element(this.getDateInputElement()),this.$scope.ctrl=this,this.$compile(this.dateInputElement)(this.$scope),this.dateInputElement[0]},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.placeholder=t.placeholder,this.defaultValue=t.value,this.min=t.min,this.max=t.max},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=new Date(this.value),t=!0;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var i=new Date(this.max);t=t&&e<=i}return t},Object.defineProperty(t.prototype,"value",{get:function(){var e=moment(this.date||null);return e.isValid()?e.format("YYYY-MM-DD"):null},set:function(e){var t=moment(e);this.date=t.isValid()?t.toDate():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.bindingDate},set:function(e){this.$scope.$parent[this.uniqueId]=e,this.bindingDate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueId",{get:function(){return"id"+this.$scope.$id},enumerable:!0,configurable:!0}),t.prototype.narrateDate=function(){if(this.date){var e=this.localizationService.getDate(this.date,"fullDate");this.ariaLiveService.update(e,!0)}},t.prototype.narrateDatepickerLabel=function(){this.ariaLiveService.update(this.$translate.instant(this.resources.strings.meeting_datepicker_accessible_string),!0)},t.prototype.getDateInputElement=function(){var e="string"==typeof this.min||"number"==typeof this.min?this.min.toString():"",t="string"==typeof this.max||"number"==typeof this.max?this.max.toString():"",n=angular.element("<div></div>");n.attr("class","ts-ac-dateInputContainer");var i=angular.element("<input bs-datepicker />");i.attr("type","text"),i.attr("class","ac-textInput ac-dateInput"),i.attr("ng-attr-placeholder","{{::ctrl.placeholder || ($root.resources.strings.adaptive_card_input_date_default_placeholder|translate)}}"),i.attr("ng-model",this.uniqueId),i.attr("ng-change","ctrl.narrateDate()"),i.attr("data-autoclose","true"),i.attr("data-min-date",e),i.attr("data-max-date",t),i.attr("data-date-format","mediumDate"),i.attr("data-container",this.popupContainerSelector),i.attr("data-prefix-event",this.actionPrefix),i.attr("data-template-url","components/date-picker/date-picker.html");var r=angular.element('<ng-include src="\'svg/icons-calendar.html\'" class="ts-ac-dateInputIcon"></ng-include>');return n.append(i),n.append(r),n},t}(r.Input);t.DateInput=a},336:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(2845),a=function(e){function t(t,n,i,r,o,a,s,l){var c=e.call(this)||this;c.$compile=t,c.$sce=n,c.$scope=i,c.$templateCache=r,c.$translate=o,c.constants=a,c.resources=s,c.passwordStyleEnabled=!1,c.inputStyle="text";var p=a.settings.names.enableAdaptiveCardPasswordInput;return c.passwordStyleEnabled=l.valueAsBoolean(p),c}return i(t,e),Object.defineProperty(t.prototype,"value",{get:function(){var e;return null===(e=this.inputElement)||void 0===e?void 0:e.value},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){var t=this;this.inputElement=e.prototype.internalRender.call(this),this.inputElement.addEventListener("keydown",function(e){[t.constants.keyCodes.up,t.constants.keyCodes.down].includes(e.keyCode)&&e.stopPropagation()});var n=this.inputElement;switch(this.inputStyle){case"password":if(!this.passwordStyleEnabled||this.isMultiline)return n;n=new o.TextInputPassword(this.$compile,this.$scope,this.inputElement,this.$sce,this.$templateCache,this.$translate,this.resources).internalRender()}return n},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.isMultiline&&this.style===r.InputTextStyle.Password&&(this.style=r.InputTextStyle.Text),this.inputStyle=t.style?t.style.toLowerCase():this.inputStyle},t}(r.TextInput);t.TextInput=a},337:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(50),a=function(e){function t(t,n,i,r,o,a,s){var l=e.call(this)||this;return l.messageListItemClassSelector=t,l.popupContainerSelector=n,l.localizationService=i,l.ariaLiveService=r,l.$scope=o,l.logger=a,l.constants=s,l}return i(t,e),t.convertTimeStringToDate=function(e){return new Date("January 01, 1970 "+e)},t.isValidTimeMinMaxValue=function(e){return"string"==typeof e&&e&&/^[0-9]{2}:[0-9]{2}$/.test(e)},t.prototype.internalRender=function(){var e=this;this.timeInputElement=angular.element(document.createElement("input"));var t=this.timeInputElement[0];return t.type="text",t.classList.add("ac-textInput","ac-timeInput"),t.setAttribute("aria-labelledby","starttimetitle"),t.setAttribute("aria-atomic","true"),t.setAttribute("aria-relevant","all"),this.placeholder&&(t.placeholder=this.placeholder),teamspace.common.SafeJQuery.on(this.$scope,this.timeInputElement,"focus",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onTimeFocus()}),!_.isEmpty(this.defaultValue)&&(this.value=this.defaultValue),this.timeInputElement[0]},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.parse=function(n){e.prototype.parse.call(this,n),this.placeholder=n.placeholder,this.defaultValue=n.value,t.isValidTimeMinMaxValue(n.min)&&(this.min=n.min),t.isValidTimeMinMaxValue(n.max)&&(this.max=n.max)},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=t.convertTimeStringToDate(this.value),n=!0;if(this.min){var i=t.convertTimeStringToDate(this.min);n=n&&e>=i}if(this.max){var r=t.convertTimeStringToDate(this.max);n=n&&e<=r}return n},Object.defineProperty(t.prototype,"value",{get:function(){if(this.timeInputElement){var e=this.timeInputElement.val();return this.timeStringFormatConvert(e,t.TimeFormatDisplay,t.TimeFormatHTML5)}return null},set:function(e){var n=this.timeStringFormatConvert(e,t.TimeFormatHTML5,t.TimeFormatDisplay);this.timeInputElement.val(n)},enumerable:!0,configurable:!0}),t.prototype.onTimeFocus=function(){var e=this,t=this.timeInputElement;if(!t.hasClass("ui-timepicker-input")){t.timepicker({showDuration:!0,timeFormat:function(t){return e.localizationService.getDate(t,"shortTime")},appendTo:t.closest(this.popupContainerSelector)});var n=function(t,n){$(t.currentTarget).closest(e.messageListItemClassSelector).css("overflow",n?"visible":"")};teamspace.common.SafeJQuery.on(this.$scope,t,"showTimepicker",function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];n(i[0],!0),o.AdaptiveCardHelper.scrollToBottomForLastItem($(i[0].currentTarget),e.messageListItemClassSelector),e.addDelayedAriaHidden(t),t.on("keydown.adaptiveCardTime",function(t){if(t.which===e.constants.keyCodes.up||t.which===e.constants.keyCodes.down){var n=e.popupContainerSelector+" .ui-timepicker-selected:visible";e.narrateSelectedTime(n)}})}),teamspace.common.SafeJQuery.on(this.$scope,t,"hideTimepicker",function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.data("timepickerList").hide(),n(e[0],!1),t.attr("aria-hidden",""),t.off("keydown.adaptiveCardTime")})}},t.prototype.timeStringFormatConvert=function(e,t,n){var i,r,o,a=/\d{1,2}:\d{1,2}/,s=null!==(r=null===(i=e.match(a))||void 0===i?void 0:i[0])&&void 0!==r?r:"",l=s+" "+(null!==(o=e.replace(s,"").trim())&&void 0!==o?o:""),c=moment(l,t);return c.isValid()&&c.format(n)||null},t.prototype.addDelayedAriaHidden=function(e){var t=this;setTimeout(function(){var n=angular.element(e);n&&n.length>0?n.attr("aria-hidden","true"):t.logger.error("[TimeInput.addDelayedAriaHidden()] Selector did not return any element: {0}",e)},1e3)},t.prototype.narrateSelectedTime=function(e){var t=this;setTimeout(function(){var n=angular.element(e),i=n[n.length-1].innerText;t.ariaLiveService.update(i,!0)})},t.TimeFormatHTML5="HH:mm",t.TimeFormatDisplay="h:mm A",t}(r.Input);t.TimeInput=a},338:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n,i,r,o,a,s){var l=e.call(this)||this;return l.$translate=n,l.resources=i,l.ariaLiveService=r,l.cardId=o,l.utilityService=a,l.htmlSanitizer=s,l.unselectedSvgHtml=t.get("svg/icons-checkbox-unselected.html"),l.selectedSvgHtml=t.get("svg/icons-checkbox-selected.html"),l}return i(t,e),t.prototype.internalRender=function(){var e=this;this.inputElement=document.createElement("input"),this.inputElement.type="checkbox",this.inputElement.classList.add("check-item"),this.inputElement.name=this.cardId+this.htmlSanitizer.escapeAngular(this.id),this.inputElement.checked=this.defaultValue&&this.valueOn&&this.defaultValue===this.valueOn;var t=angular.element('<div class="icons-item-unselected icon hide-text">'+this.unselectedSvgHtml+"</div>"),n=angular.element('<div class="icons-item-selected icon hide-text">'+this.selectedSvgHtml+"</div>");this.wrap&&(t.find("svg").addClass("wrap"),n.find("svg").addClass("wrap"));var i=this.htmlSanitizer.escapeAngular(this.title),r=this.utilityService.escapeHtml(this.title),o=angular.element(document.createElement("label"));o[0].classList.add("choice-label"),o[0].title=i,o[0].setAttribute("tabindex","-1"),o[0].onfocus=function(){return e.narrateFocusedItem()},o[0].onkeydown=function(t){return e.onkeydown(t)},o.append(this.inputElement),o.append(t),o.append(n),o.append(angular.element("<span ng-non-bindable>"+r+"</span>")),this.addWrapStyling(o);var a=angular.element(document.createElement("div"));return a.addClass("choice-container"),a.append(o),this.rootElement=angular.element(document.createElement("div")),this.rootElement.addClass("o365-action-pane-multichoice-input"),this.rootElement.append(a),this.rootElement.addClass("ac-toggleInput"),this.rootElement[0]},Object.defineProperty(t.prototype,"value",{get:function(){return this.inputElement?this.inputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),t.prototype.addWrapStyling=function(e){this.wrap&&(e.css("overflow-wrap","break-word"),e[0].style.wordBreak="break-word",e[0].style.height="auto",e[0].style.whiteSpace="unset",e[0].style.display="flex",e[0].style.alignItems="center",e[0].style.textAlign="left")},t.prototype.onkeydown=function(e){var t=teamspace.Constants.Instance.keyCodes.enter,n=teamspace.Constants.Instance.keyCodes.space;!e||e.keyCode!==t&&e.keyCode!==n||(this.inputElement&&this.inputElement.click(),this.narrateFocusedItem())},t.prototype.narrateFocusedItem=function(){var e=this.inputElement.checked?this.$translate.instant(this.resources.strings.icons_checkbox_selected):this.$translate.instant(this.resources.strings.icons_checkbox_unselected);e+=". "+this.title,this.ariaLiveService.update(e,!0)},t}(n(19).ToggleInput);t.ToggleInput=r},339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2846),r=n(66),o=n(19),a=function(){function e(e,t,n,i,r,o,a,s,l,c,p,u,d,h){var f=this;this.$element=e,this.$q=t,this.$scope=n,this.constants=i,this.conversationsService=r,this.peopleService=o,this.atMentionService=a,this.channelService=s,this.eventingService=l,this.settingsService=c,this.$translate=p,this.resources=u,this.loggingService=d,this.adaptiveCardPeoplePickerHelper=h,this.scenarioName=this.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.searchScenario,this.UPS_TIMEOUT_IN_MS=1e4,this.logger=d.newLogger("acPeoplePicker"),this.initSearchConfigParameters(),n.$watch("selections",function(){return f.selectionsUpdated()},!0),l.$on(n,i.events.messages.messageListRenderStateChanged,function(e,t){!t||t.state!==teamspace.components.MessageListRenderState.Rendered&&t.state!==teamspace.components.MessageListRenderState.RenderedFully||f.resolvePreSelectedIds()})}return e.$inject=["$element","$q","$scope","constants","conversationsService","peopleService","atMentionService","channelService","eventingService","settingsService","$translate","resources","loggingService","adaptiveCardPeoplePickerHelper"],Object.defineProperty(e.prototype,"searchFields",{get:function(){var e=[];return _.isEmpty(this.$scope.searchFields)||(e=this.$scope.searchFields.split(",")),e},enumerable:!0,configurable:!0}),e.prototype.initSearchConfigParameters=function(){this.$scope.searchFields="displayName,email",this.maxSelectionCount=this.settingsService.valueFor(this.constants.settings.names.adaptiveCardPeoplePickerMaxCount),this.isInputReadOnly=!1,this.peoplePickerFilterScenario=teamspace.services.PeoplePickerFor[teamspace.services.PeoplePickerFor.adaptiveCard],this.peoplePickerFilter=new teamspace.services.PeoplePickerFilters(teamspace.services.PeoplePickerFor.adaptiveCard)},e.prototype.searchContacts=function(e,t){var n=this,i=this.searchFields,r=[];return _.isEmpty(t)||t.forEach(function(t){for(var o=!1,a=0;a<i.length&&!(o=o||"string"==typeof t[i[a]]&&"string"==typeof e&&n.checkRegExMatch(t[i[a]],e));a++);o&&r.push(t)}),r},e.prototype.checkRegExMatch=function(e,t){var n=_.escapeRegExp(t);return new RegExp("\\s"+n+"|(^"+n+")","gi").test(e)},e.prototype.doConversationSearch=function(){var e=this.conversationsService.getConversation(this.conversationId);return this.searchUsersInConversation(e)},e.prototype.searchUsersInConversation=function(e){if(e.isChannelConversation()){var t=this.channelService.getParentTeamAndChannelByChannelId(this.conversationId);return this.channel=t.channel,this.team=t.team,this.searchMembersForChannelConversation()}return this.searchMembersForChatConversation(e)},e.prototype.searchMembersForChannelConversation=function(){var e=this;this.usersSearchProfilePromise&&(teamspace.services.QCancelable.cancel(this.usersSearchProfilePromise),this.usersSearchProfilePromise=null);var t=this.atMentionService.searchForUserProfileInChannel(this.getTargetId(),this.$scope.searchText,void 0,"ac-people-picker",void 0,!0,void 0,!0,{timeout:this.UPS_TIMEOUT_IN_MS},void 0,this.isSharedChannelContext());this.usersSearchProfilePromise=services.QCancelable.toCancelablePromise(this.$q,t);var n=this.adaptiveCardPeoplePickerHelper.cancelAndCreateNewScenario(this.scenarioName);return n.mark(this.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.searchInitiatedInChannel),this.usersSearchProfilePromise.then(function(t){var i=e.getGuestUserCountFromSearchResults(t);_.isEmpty(t)||(e.logger.info("{0} profiles found for search text {1} during conversation search",t.length,e.$scope.searchText),n.mark(e.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.userProfilesReceivedForContextBasedSearch,{searchQueryLength:e.$scope.searchText.length,resultsCount:t.length})),n.stop({resultCount:t.length,searchQueryLength:e.$scope.searchText.length,guestUserCount:i,searchContext:"Channel",isSharedChannel:e.isSharedChannelContext()});var r=e.searchContacts(e.$scope.searchText,t);return e.addStaticChoices(r),r}).catch(function(t){return n.fail({searchQueryLength:e.$scope.searchText.length,searchContext:"Channel"}),e.$q.reject([])})},e.prototype.getGuestUserCountFromSearchResults=function(e){var t=0;if(e&&e.length>0&&e.length<=20)for(var n=0;n<e.length;n++)e[n].userType===this.constants.userTypes.guest&&t++;return t},e.prototype.searchMembersForChatConversation=function(e){var t=this;this.usersSearchProfilePromise&&(teamspace.services.QCancelable.cancel(this.usersSearchProfilePromise),this.usersSearchProfilePromise=null);var n=e.members.map(function(e){return SkypeX.Services.ChatServiceUtils.getMri(e&&e.id)}),i=this.peopleService.getAllPeopleProfileForConversation(n,this.conversationId,!1,this.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.peoplePicker,this.peoplePickerFilter);this.usersSearchProfilePromise=services.QCancelable.toCancelablePromise(this.$q,i);var r=this.adaptiveCardPeoplePickerHelper.cancelAndCreateNewScenario(this.scenarioName);return r.mark(this.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.searchInitiatedInChat),this.usersSearchProfilePromise.then(function(e){var n=t.getGuestUserCountFromSearchResults(e);_.isEmpty(e)||(t.logger.info("{0} profiles found for search text {1} during conversation search",e.length,t.$scope.searchText),r.mark(t.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.userProfilesReceivedForContextBasedSearch,{searchQueryLength:t.$scope.searchText.length,resultsCount:e.length})),r.stop({resultCount:e.length,searchQueryLength:t.$scope.searchText.length,guestUserCount:n,searchContext:"Chat"});var i=t.searchContacts(t.$scope.searchText,e);return t.addStaticChoices(i),i}).catch(function(e){return r.fail({searchQueryLength:t.$scope.searchText.length,searchContext:"Chat"}),t.$q.reject([])})},e.prototype.addStaticChoices=function(e){var t=this;_.isEmpty(this.choices)||this.choices.forEach(function(n){if(t.checkRegExMatch(n.title,t.$scope.searchText)){var i=t.choiceToUser(n);i&&e.push(i)}})},e.prototype.choiceToUser=function(e){return{objectId:e.value,displayName:e.title,email:e.title,mri:SkypeX.Services.ChatServiceUtils.MriPrefix_SkypeSpacesUser+e.value,type:this.constants.userTypes.static}},e.prototype.getTargetId=function(){return this.isPrivateOrSharedChannelContext()?this.channel.objectId:this.team.objectId},e.prototype.isPrivateOrSharedChannelContext=function(){return this.channel&&(this.channel.channelType===teamspace.services.ChannelType.Private||this.channel.channelType===teamspace.services.ChannelType.Shared)},e.prototype.isSharedChannelContext=function(){return this.channel&&this.channel.channelType===teamspace.services.ChannelType.Shared},e.prototype.selectionsUpdated=function(){this.updateChoices(),this.updateInputBoxState()},e.prototype.updateChoices=function(){var e={choices:this.getSelectedChoices(),choiceSetIdentifier:this.$scope.choiceSetIdentifier};this.eventingService.$emit(this.constants.events.bots.adaptiveCard.peoplePickerContactsUpdated,e)},e.prototype.updateInputBoxState=function(){var e=_.isEmpty(this.$scope.selections)?0:this.$scope.selections.length,t=this.$scope.isMultiSelect;!t&&1===e||t&&e==this.maxSelectionCount?this.setInputElementAsReadOnly(!0):(!t&&0===e||t&&e<this.maxSelectionCount&&this.isInputReadOnly)&&this.setInputElementAsReadOnly(!1)},e.prototype.getSelectedChoices=function(){var e=[];return _.isEmpty(this.$scope.selections)||this.$scope.selections.forEach(function(t){var n=t.displayName?t.displayName:"",i=t.objectId?t.objectId:t.mri?t.mri.split(SkypeX.Services.ChatServiceUtils.MriPrefix_SkypeSpacesUser)[1]:"";e.push(new o.Choice(n,i))}),e},e.prototype.setInputElementAsReadOnly=function(e){void 0===e&&(e=!1);var t=this.$element.find("input[data-tid='peoplePicker']");t&&t.length>0&&t[0]&&(this.isInputReadOnly=e,t[0].readOnly=e,e&&t.blur())},e.prototype.postLink=function(){var e=this.$scope.shouldLoadPeoplePickerChoices;this.placeholderVal=this.$scope.placeholder,e?this.resolvePreSelectedIds():_.isEmpty(this.$scope.selectedUserIds)||(this.$scope.placeholder=this.$translate.instant(this.resources.strings.adaptive_card_people_picker_loading_placeholder))},e.prototype.resolvePreSelectedIds=function(){var e=this;if(this.$scope.selections=[],!_.isEmpty(this.$scope.selectedUserIds)){var t=[];t=this.$scope.isMultiSelect?this.$scope.selectedUserIds.split(this.$scope.separator):[this.$scope.selectedUserIds],this.resolveSelectedStaticIds(t);var n=[];this.findUnresolvedSelectedIds(t).forEach(function(e){n.push(SkypeX.Services.ChatServiceUtils.MriPrefix_SkypeSpacesUser+e.trim())}),_.isEmpty(n)?this.updateChoices():this.peopleService.getAllPeopleProfile(n,this.constants.scenarios.extensibility.bots.peoplePickerInAdaptiveCard.peoplePicker).then(function(t){_.isEmpty(t)||(e.$scope.selections?e.$scope.selections=e.$scope.selections.concat(t):e.$scope.selections=t),e.updateChoices(),e.$scope.placeholder=e.placeholderVal}).catch(function(){e.$scope.placeholder=e.placeholderVal})}},e.prototype.fetchAllowedUsers=function(e){switch(this.$scope.searchText=e,this.directorySearchMode){case r.DirectorySearchMode.Conversation:return this.doConversationSearch()}},e.prototype.resolveSelectedStaticIds=function(e){var t=this,n=[],i=[];_.isEmpty(this.choices)||_.isEmpty(e)||(n=this.choices.filter(function(t){return e.indexOf(t.value)>-1})),_.isEmpty(n)||(i=n.map(function(e){return t.choiceToUser(e)}),_.isEmpty(this.$scope.selections)?this.$scope.selections=i:this.$scope.selections=this.$scope.selections.concat(i))},e.prototype.findUnresolvedSelectedIds=function(e){if(!_.isEmpty(this.$scope.selections)){var t=this.$scope.selections.map(function(e){return e.objectId});return e.filter(function(e){return t.indexOf(e)<0})}return e},e}();t.ACPeoplePickerController=a,angular.module("teamspace.adaptiveCardPeoplePicker",[]).directive("acPeoplePicker",function(){return{restrict:"E",scope:{contactSelected:"=?",placeholder:"=?",selections:"=?",isMultiSelect:"<?",shouldLoadPeoplePickerChoices:"<?",choiceSetIdentifier:"@?",selectedUserIds:"@?",separator:"@?"},bindToController:{directorySearchMode:"<",conversationId:"=?",choices:"=?"},controllerAs:"acPpCtrl",templateUrl:"lazy-components/adaptive-card/people-picker/adaptive-card-people-picker.html",controller:a,link:function(e,t,n,i){i.postLink()}}}).run(["$templateCache",function(e){e.put("lazy-components/adaptive-card/people-picker/adaptive-card-people-picker.html",i)}])},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.RefreshMode=t.TypeErrorType=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionMode=t.ActionStyle=t.ContainerStyle=void 0;var i=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();t.ContainerStyle=i;var r=function(){function e(){}return e.Default="default",e.Positive="positive",e.Destructive="destructive",e}();t.ActionStyle=r;var o=function(){function e(){}return e.Primary="primary",e.Secondary="secondary",e}();t.ActionMode=o;!function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={}));!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.ImageSize||(t.ImageSize={}));!function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={}));!function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={}));!function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={}));!function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={}));!function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={}));!function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={}));!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));!function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={}));!function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={}));!function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={}));!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={}));!function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={}));!function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={}));!function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(t.InputTextStyle||(t.InputTextStyle={}));!function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(t.ValidationPhase||(t.ValidationPhase={}));!function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(t.ValidationEvent||(t.ValidationEvent={}));!function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={}));!function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(t.TypeErrorType||(t.TypeErrorType={}));!function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(t.RefreshMode||(t.RefreshMode={}));!function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.LogLevel||(t.LogLevel={}))},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;var i=n(37),r=function(){function e(){}return e.useAdvancedTextBlockTruncation=!0,e.useAdvancedCardBottomTruncation=!1,e.useMarkdownInRadioButtonAndCheckbox=!0,e.allowMarkForTextHighlighting=!1,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.setTabIndexAtCardRoot=!0,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!1,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!0,e.applets={logEnabled:!0,logLevel:i.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:i.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},e}();t.GlobalSettings=r,t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var o=function(){function e(){this._isProcessed=!1}return e.prototype.getReferencedInputs=function(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");if(this._original)for(var n=0,i=e;n<i.length;n++){var r=i[n];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&r.id&&(t[r.id]=r)}},e.prototype.substituteInputValues=function(e,n){if(this._processed=this._original,this._original)for(var i=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,r=void 0;null!==(r=i.exec(this._original))&&this._processed;)for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(s.toLowerCase()===r[1].toLowerCase()){var l=e[s],c="";l.value&&(c=l.value),n===t.ContentTypes.applicationJson?c=(c=JSON.stringify(c)).slice(1,-1):n===t.ContentTypes.applicationXWwwFormUrlencoded&&(c=encodeURIComponent(c)),this._processed=this._processed.replace(r[0],c);break}}this._isProcessed=!0},e.prototype.getOriginal=function(){return this._original},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=o;var a=function(){return function(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=i}}();t.SpacingDefinition=a;var s=function(){return function(e,t,n,r){void 0===e&&(e=i.Spacing.None),void 0===t&&(t=i.Spacing.None),void 0===n&&(n=i.Spacing.None),void 0===r&&(r=i.Spacing.None),this.top=i.Spacing.None,this.right=i.Spacing.None,this.bottom=i.Spacing.None,this.left=i.Spacing.None,this.top=e,this.right=t,this.bottom=n,this.left=r}}();t.PaddingDefinition=s;var l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,i.SizeUnit.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(o&&o.length>=a)return r.physicalSize=parseInt(o[1]),3===o.length&&"px"===o[2]&&(r.unit=i.SizeUnit.Pixel),r}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=l;var c=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&i|128]+e.lut[i>>8&255]+"-"+e.lut[i>>16&255]+e.lut[i>>24&255]+e.lut[255&r]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();t.UUID=c,c.initialize()},48:function(e,t,n){"use strict";function i(e,t){for(var n in e){var i=parseInt(n,10);if(i>=0){var r=e[n];if(r&&"string"==typeof r&&r.toLowerCase()===t.toLowerCase())return i}}}function r(e,t,n,i,r){var s=function(){return t-e.scrollHeight>=-1};if(!s()){for(var l=o(n),c=0,p=l.length,u=0;c<p;){var d=Math.floor((c+p)/2);i(n,l[d]),s()?(u=l[d],c=d+1):p=d}if(i(n,u),r&&t-e.scrollHeight>=r-1){for(var h=a(n,u);h<n.length&&(i(n,h),s());)u=h,h=a(n,h);i(n,u)}}}function o(e){for(var t=[],n=a(e,-1);n<e.length;)" "===e[n]&&t.push(n),n=a(e,n);return t}function a(e,t){for(t+=1;t<e.length&&"<"===e[t];)for(;t<e.length&&">"!==e[t++];);return t}var s;Object.defineProperty(t,"__esModule",{value:!0}),t.clearElementChildren=t.getScrollY=t.getScrollX=t.getFitStatus=t.truncate=t.truncateText=t.stringToCssColor=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;var l=n(37),c=n(43);t.isInternetExplorer=function(){return void 0!==window.document.documentMode},t.isMobileOS=function(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)},t.generateUniqueId=function(){return"__ac-"+c.UUID.generate()},t.appendChild=function(e,t){t&&e.appendChild(t)},t.parseString=function(e,t){return"string"==typeof e?e:t},t.parseNumber=function(e,t){return"number"==typeof e?e:t},t.parseBool=function(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t},t.getEnumValueByName=i,t.parseEnum=function(e,t,n){if(!t)return n;var r=i(e,t);return void 0!==r?r:n},t.stringToCssColor=function(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+n+")"}}return e},t.truncateText=function(e,t,n){r(e,t,e.innerText,function(t,n){e.innerText=t.substring(0,n)+"..."},n)};var p="undefined"==typeof window?void 0:null===(s=window.trustedTypes)||void 0===s?void 0:s.createPolicy("adaptivecards#deprecatedExportedFunctionPolicy",{createHTML:function(e){return e}});t.truncate=function(e,t,n){r(e,t,e.innerHTML,function(t,n){var i,r=t.substring(0,n)+"...",o=null!==(i=null===p||void 0===p?void 0:p.createHTML(r))&&void 0!==i?i:r;e.innerHTML=o},n)},t.getFitStatus=function(e,t){var n=e.offsetTop;return n+e.clientHeight<=t?l.ContainerFitStatus.FullyInContainer:n<t?l.ContainerFitStatus.Overflowing:l.ContainerFitStatus.FullyOutOfContainer},t.getScrollX=function(){return window.pageXOffset},t.getScrollY=function(){return window.pageYOffset},t.clearElementChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},49:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;var r=n(43),o=n(48),a=n(37),s=n(57),l=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var i=new e;i._versionString=t;var r=/(\d+).(\d+)/gi.exec(t);return null!=r&&3===r.length?(i._major=parseInt(r[1]),i._minor=parseInt(r[2])):i._isValid=!1,i._isValid||n.logParseEvent(void 0,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidVersionString(i._versionString)),i}},e.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}();t.Version=l;var c=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=e,n=[];for(var i in t)if(i.match(/^v[0-9_]*$/))try{var r=t[i];r instanceof l&&n.push(r)}catch(e){}return n.sort(function(e,t){return e.compareTo(t)})},e.v1_0=new l(1,0),e.v1_1=new l(1,1),e.v1_2=new l(1,2),e.v1_3=new l(1,3),e.v1_4=new l(1,4),e.v1_5=new l(1,5),e.v1_6=new l(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();t.Versions=c,t.isVersionLessOrEqual=function(e,t){return!(e instanceof l)||!(t instanceof l)||t.compareTo(e)>=0};var p=function(){function e(e){void 0===e&&(e=c.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.serializeValue=function(e,t,n,i,o){void 0===i&&(i=void 0),void 0===o&&(o=!1),null===n||void 0===n||n===i?r.GlobalSettings.enableFullJsonRoundTrip&&!o||delete e[t]:n===i?delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,i){null===n||void 0===n||n===i?r.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeBool=function(e,t,n,i){null===n||void 0===n||n===i?r.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,i){null===n||void 0===n||n===i||isNaN(n)?r.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,i,o){void 0===o&&(o=void 0),null===i||void 0===i||i===o?r.GlobalSettings.enableFullJsonRoundTrip||delete t[n]:t[n]=e[i]},e.prototype.serializeArray=function(e,t,n){var i=[];if(n)for(var r=0,o=n;r<o.length;r++){var a=o[r],s=void 0;void 0!==(s=a instanceof w?a.toJSON(this):a.toJSON?a.toJSON():a)&&i.push(s)}0===i.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,i)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,i){this._validationEvents.push({source:e,phase:t,event:n,message:i})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,a.ValidationPhase.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}();t.BaseSerializationContext=p;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(p),d=function(){function e(t,n,i,r){this.targetVersion=t,this.name=n,this.defaultValue=i,this.onGetInitialValue=r,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n,this.defaultValue)},e._sequentialNumber=0,e}();t.PropertyDefinition=d;var h=function(e){function t(t,n,i,r,o,a){void 0===i&&(i=!0);var s=e.call(this,t,n,o,a)||this;return s.targetVersion=t,s.name=n,s.treatEmptyAsUndefined=i,s.regEx=r,s.defaultValue=o,s.onGetInitialValue=a,s}return i(t,e),t.prototype.parse=function(e,t,n){var i=o.parseString(t[this.name],this.defaultValue);if(void 0===i||""===i&&this.treatEmptyAsUndefined||void 0===this.regEx||this.regEx.exec(i))return i;n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(i,this.name))},t.prototype.toJSON=function(e,t,n,i){i.serializeString(t,this.name,""===n&&this.treatEmptyAsUndefined?void 0:n,this.defaultValue)},t}(d);t.StringProperty=h;var f=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=i,o.onGetInitialValue=r,o}return i(t,e),t.prototype.parse=function(e,t,n){return o.parseBool(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,i){i.serializeBool(t,this.name,n,this.defaultValue)},t}(d);t.BoolProperty=f;var y=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=i,o.onGetInitialValue=r,o}return i(t,e),t.prototype.parse=function(e,t,n){return o.parseNumber(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,i){i.serializeNumber(t,this.name,n,this.defaultValue)},t}(d);t.NumProperty=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.parse=function(e,t,n){var i=void 0,o=t[this.name];if("string"==typeof o){var l=!1;try{var c=r.SizeAndUnit.parse(o,!0);c.unit===a.SizeUnit.Pixel&&(i=c.physicalSize,l=!0)}catch(e){}l||n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}return i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(d);t.PixelSizeProperty=g;var m=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=i,o.onGetInitialValue=r,o}return i(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i||!Array.isArray(i))return this.defaultValue;for(var r=[],o=0,s=i;o<s.length;o++){var l=s[o];"string"==typeof l?r.push(l):n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(l),'" of type "').concat(typeof l,'" ignored for "').concat(this.name,'".'))}return r},t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)},t}(d);t.StringArrayProperty=m;var v=function(e){function t(t,n,i,r,o){var a=e.call(this,t,n,r,o)||this;return a.targetVersion=t,a.name=n,a.values=i,a.defaultValue=r,a.onGetInitialValue=o,a}return i(t,e),t.prototype.isValidValue=function(e,t){for(var n=0,i=this.values;n<i.length;n++){var r=i[n];if(e.toLowerCase()===r.value.toLowerCase())return(r.targetVersion?r.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}return!1},t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i)return this.defaultValue;if("string"==typeof i)for(var r=0,o=this.values;r<o.length;r++){var l=o[r];if(i.toLowerCase()===l.value.toLowerCase()){var c=l.targetVersion?l.targetVersion:this.targetVersion;return c.compareTo(n.targetVersion)<=0?l.value:(n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(i,this.name,c.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,i){var r=!1;if(void 0!==n){r=!0;for(var o=0,l=this.values;o<l.length;o++){var c=l[o];if(c.value===n){var p=c.targetVersion?c.targetVersion:this.targetVersion;if(p.compareTo(i.targetVersion)<=0){r=!1;break}i.logEvent(e,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(n,this.name,p.toString(),i.targetVersion.toString()))}}}r||i.serializeValue(t,this.name,n,this.defaultValue,!0)},t}(d);t.ValueSetProperty=v;var b=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t,n,r,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=i,s.defaultValue=r,s.onGetInitialValue=a,s._values=[],o)s._values=o;else for(var l in i){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return i(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if("string"!=typeof i)return this.defaultValue;var r=o.getEnumValueByName(this.enumType,i);if(void 0!==r)for(var l=0,c=this.values;l<c.length;l++){var p=c[l];if(p.value===r){var u=p.targetVersion?p.targetVersion:this.targetVersion;return u.compareTo(n.targetVersion)<=0?r:(n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.propertyValueNotSupported(i,this.name,u.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,i){var r=!1;if(void 0!==n){r=!0;for(var o=0,l=this.values;o<l.length;o++){var c=l[o];if(c.value===n){if((c.targetVersion?c.targetVersion:this.targetVersion).compareTo(i.targetVersion)<=0){r=!1;break}i.logEvent(e,a.ValidationPhase.ToJSON,a.ValidationEvent.InvalidPropertyValue,s.Strings.errors.invalidPropertyValue(n,this.name))}}}r||i.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(d);t.EnumProperty=b;var C=function(e){function t(t,n,i,r,o){void 0===r&&(r=!1);var a=e.call(this,t,n,o,function(e){return a.nullable?void 0:new a.objectType})||this;return a.targetVersion=t,a.name=n,a.objectType=i,a.nullable=r,a}return i(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var r=new this.objectType;return r.parse(i,n),r},t.prototype.toJSON=function(e,t,n,i){var r=void 0;void 0===n||n.hasAllDefaultValues()||(r=n.toJSON(i)),"object"==typeof r&&0===Object.keys(r).length&&(r=void 0),i.serializeValue(t,this.name,r,this.defaultValue,!0)},t}(d);t.SerializableObjectProperty=C;var S=function(e){function t(t,n,i,r){var o=e.call(this,t,n,void 0,function(e){return[]})||this;return o.targetVersion=t,o.name=n,o.objectType=i,o.onItemAdded=r,o}return i(t,e),t.prototype.parse=function(e,t,n){var i=[],r=t[this.name];if(Array.isArray(r))for(var o=0,a=r;o<a.length;o++){var s=a[o],l=new this.objectType;l.parse(s,n),i.push(l),this.onItemAdded&&this.onItemAdded(e,l)}return i.length>0?i:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)},t}(d);t.SerializableObjectCollectionProperty=S;var A=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=i,s.onToJSON=r,s.defaultValue=o,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return i(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,i){this.onToJSON(e,this,t,n,i)},t}(d);t.CustomProperty=A;var _=function(){function e(){this._properties=[]}return e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++){var r=i[n];-1===this.indexOf(r)&&this._properties.push(r)}},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++)for(var r=i[n];;){var o=this.indexOf(r);if(!(o>=0))break;this._properties.splice(o,1)}},e.prototype.getItemAt=function(e){return this._properties[e]},e.prototype.getCount=function(){return this._properties.length},e}();t.SerializableObjectSchema=_,t.property=function(e){return function(t,n){var i=Object.getOwnPropertyDescriptor(t,n)||{};i.get||i.set||(i.get=function(){return this.getValue(e)},i.set=function(t){this.setValue(e,t)},Object.defineProperty(t,n,i))}};var w=function(){function e(){this._propertyBag={},this._rawProperties={},this.maxVersion=e.defaultMaxVersion;for(var t=this.getSchema(),n=0;n<t.getCount();n++){var i=t.getItemAt(n);i.onGetInitialValue&&this.setValue(i,i.onGetInitialValue(this))}}return e.prototype.getDefaultSerializationContext=function(){return new u},e.prototype.populateSchema=function(t){var n=this.constructor,i=[];for(var r in n)try{var o=n[r];o instanceof d&&i.push(o)}catch(e){}if(i.length>0){var a=i.sort(function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0});t.add.apply(t,a)}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){void 0===t||null===t?delete this._propertyBag[e.getInternalName()]:this._propertyBag[e.getInternalName()]=t},e.prototype.internalParse=function(e,t){if(this._propertyBag={},this._rawProperties=r.GlobalSettings.enableFullJsonRoundTrip?e||{}:{},e)for(var n=this.getSchema(),i=0;i<n.getCount();i++){var o=n.getItemAt(i);if(o.isSerializationEnabled){var l=o.onGetInitialValue?o.onGetInitialValue(this):void 0;e.hasOwnProperty(o.name)&&(o.targetVersion.compareTo(t.targetVersion)<=0?l=o.parse(this,e,t):t.logParseEvent(this,a.ValidationEvent.UnsupportedProperty,s.Strings.errors.propertyNotSupported(o.name,o.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(o,l)}}else this.resetDefaultValues()},e.prototype.internalToJSON=function(e,t){for(var n=this.getSchema(),i=[],r=0;r<n.getCount();r++){var o=n.getItemAt(r);o.isSerializationEnabled&&o.targetVersion.compareTo(t.targetVersion)<=0&&-1===i.indexOf(o.name)&&(o.toJSON(this,e,this.getValue(o),t),i.push(o.name))}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.parse=function(e,t){this.internalParse(e,t||new u)},e.prototype.toJSON=function(e){var t;if(e&&e instanceof p?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t)){var n=void 0;return n=r.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0},e.prototype.resetDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||void 0===t||null===t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new _,this.populateSchema(t),e._schemaCache[this.getSchemaKey()]=t),t},e.defaultMaxVersion=c.latest,e._schemaCache={},e}();t.SerializableObject=w},50:function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(327)),i(n(330)),i(n(333)),i(n(2839)),i(n(335)),i(n(2843)),i(n(2844)),i(n(336)),i(n(337)),i(n(338)),i(n(339))},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0;var i=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,i){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(i,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")}},e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.defaults={inlineActionTitle:function(){return"Inline Action"},overflowButtonText:function(){return"..."},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"},youTubeVideoPlayer:function(){return"YouTube video player"},vimeoVideoPlayer:function(){return"Vimeo video player"},dailymotionVideoPlayer:function(){return"Dailymotion video player"}},e}();t.Strings=i},97:function(e,t,n){"use strict";function i(e,t,n){if("string"==typeof t){var i=a.parseEnum(e,t,n);return void 0!==i?i:n}return"number"==typeof t?t:n}var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.TextBlockConfig=t.TextStyleSet=t.TextStyleDefinition=t.BaseTextDefinition=t.TableConfig=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;var o=n(37),a=n(48),s=n(43),l=n(145),c=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}();t.ColorDefinition=c;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highlightColors=new c("#22000000","#11000000"),t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(c);t.TextColorDefinition=p;var u=function(){return function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)}}();t.AdaptiveCardConfig=u;var d=function(){function e(e){this.imageSize=o.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=a.parseNumber(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=d;var h=function(){function e(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}();t.MediaConfig=h;var f=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}();t.TableConfig=f;var y=function(){function e(e){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=i(o.TextSize,e.size,this.size),this.color=i(o.TextColor,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=i(o.TextWeight,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return o.TextWeight.Default},e.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight]}},e}();t.BaseTextDefinition=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontType=o.FontType.Default,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=i(o.FontType,t.fontType,this.fontType))},t}(y);t.TextStyleDefinition=g;var m=function(){function e(e){this.default=new g,this.heading=new g({size:"Large",weight:"Bolder"}),this.columnHeader=new g({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}();t.TextStyleSet=m;var v=function(){return function(e){e&&(this.headingLevel=a.parseNumber(e.headingLevel))}}();t.TextBlockConfig=v;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suffix=" *",t.suffixColor=o.TextColor.Attention,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=i(o.TextColor,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=o.TextColor[this.suffixColor],t},t}(y);t.RequiredInputLabelTextDefinition=b;var C=function(){return function(e){this.inputSpacing=o.Spacing.Small,this.requiredInputs=new b,this.optionalInputs=new y,e&&(this.inputSpacing=i(o.Spacing,e.inputSpacing,this.inputSpacing),this.requiredInputs=new b(e.requiredInputs),this.optionalInputs=new y(e.optionalInputs))}}();t.InputLabelConfig=C;var S=function(){return function(e){this.label=new C,this.errorMessage=new y({color:o.TextColor.Attention}),e&&(this.label=new C(e.label),this.errorMessage=new y(e.errorMessage))}}();t.InputConfig=S;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!0,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(y);t.FactTextDefinition=A;var _=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.TextWeight.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=i(o.TextWeight,t.weight,o.TextWeight.Bolder)),n}return r(t,e),t.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},t}(A);t.FactTitleDefinition=_;var w=function(){return function(e){this.title=new _,this.value=new A,this.spacing=10,e&&(this.title=new _(e.title),this.value=new A(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)}}();t.FactSetConfig=w;var P=function(){function e(e){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,e&&(this.actionMode=i(o.ShowCardActionMode,e.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=P;var E=function(){function e(e){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new P,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=i(o.Spacing,e.spacing&&e.spacing,o.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new P(e.showCard),this.preExpandSingleShowCardAction=a.parseBool(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=i(o.Orientation,e.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=i(o.ActionAlignment,e.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=i(o.ActionIconPlacement,e.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap;try{var t=s.SizeAndUnit.parse(e.iconSize);t.unit===o.SizeUnit.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=E;var x=function(){function e(e){this.default=new p,this.dark=new p,this.light=new p,this.accent=new p,this.good=new p,this.warning=new p,this.attention=new p,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e}();t.ColorSetDefinition=x;var I=function(){function e(e){this.foregroundColors=new x({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}();t.ContainerStyleDefinition=I;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(I),k=function(){function e(e){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new T,this._allStyles[o.ContainerStyle.Emphasis]=new T,this._allStyles[o.ContainerStyle.Accent]=new T,this._allStyles[o.ContainerStyle.Good]=new T,this._allStyles[o.ContainerStyle.Attention]=new T,this._allStyles[o.ContainerStyle.Warning]=new T,e){this._allStyles[o.ContainerStyle.Default].parse(e[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(e[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(e[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(e[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(e[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(e[o.ContainerStyle.Warning]);var t=e.customStyles;if(t&&Array.isArray(t))for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r){var a=r.name;a&&"string"==typeof a&&(this._allStyles.hasOwnProperty(a)?this._allStyles[a].parse(r.style):this._allStyles[a]=new I(r.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach(function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})});var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[o.ContainerStyle.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),e}();t.ContainerStyleSet=k;var O=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}();t.FontTypeDefinition=O;var R=function(){function e(e){this.default=new O,this.monospace=new O("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},e}();t.FontTypeSet=R;var V=function(){function e(e){this.hostCapabilities=new l.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new k,this.inputs=new S,this.actions=new E,this.adaptiveCard=new u,this.imageSet=new d,this.media=new h,this.factSet=new w,this.table=new f,this.textStyles=new m,this.textBlock=new v,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new O,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new R(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new k(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new S(e.inputs||this.inputs),this.actions=new E(e.actions||this.actions),this.adaptiveCard=new u(e.adaptiveCard||this.adaptiveCard),this.imageSet=new d(e.imageSet),this.factSet=new w(e.factSet),this.textStyles=new m(e.textStyles),this.textBlock=new v(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===o.FontType.Monospace?O.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new s.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0,r=e;i<r.length;i++){var o=r[i];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return n},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,e).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}();t.HostConfig=V,t.defaultHostConfig=new V({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{weight:o.TextWeight.Bolder,suffix:" *",suffixColor:o.TextColor.Attention},optionalInputs:{weight:o.TextWeight.Bolder}},errorMessage:{color:o.TextColor.Attention,weight:o.TextWeight.Bolder}},actions:{maxActions:5,spacing:o.Spacing.Default,buttonSpacing:10,showCard:{actionMode:o.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:o.Orientation.Horizontal,actionAlignment:o.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:o.Size.Medium,maxImageHeight:100},factSet:{title:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Default,wrap:!0},spacing:10}})}},[2826]);
//# sourceMappingURL=[[staticsPath]]/hashed/lazy-ng1-mod-adaptive-card-components.min-528fdea.js.map