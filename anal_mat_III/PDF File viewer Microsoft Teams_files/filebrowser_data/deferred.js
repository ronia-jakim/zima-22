/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred"],Array(1365).concat([function(e,t,n){"use strict";n.d(t,"o",function(){return x}),n.d(t,"n",function(){return C}),n.d(t,"i",function(){return O}),n.d(t,"s",function(){return w}),n.d(t,"c",function(){return A}),n.d(t,"t",function(){return L}),n.d(t,"a",function(){return k}),n.d(t,"d",function(){return M}),n.d(t,"e",function(){return P}),n.d(t,"r",function(){return T});var a,i,r,o,s,c,d,l,u,f,p=n(0),m=n(747),_=n(2019),h=n(466),b=n(23),g=n(933),v=n(402),y=n(373),S=n(15),D=void 0,I={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){return void 0===t&&(t=!1),v.n(e,P(h.t.language),t)}function C(e,t,n,a,i,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!1);var o=Date.now()-e.getTime(),s=R(),c=N(s,-1),d=N(s,-6),l=i||{},u=l.displayMinutesToOneHour,f=void 0===u||u,p=l.displayHoursToOneDay,b=void 0===p||p,g=l.displayHoursInDates,S=void 0===g||g,D=l.displayShortenedWeekday,I=void 0===D||D,x=P(r||h.t.language);if(f&&o<-5*y.n)return e.toLocaleDateString(x,j({month:"short",day:"numeric"},a));if(o<y.s)return n?_.n:_.t;if(f&&o<y.t)return B(o,_.i,y.n);if(y.u(s,e))return b?B(o,_.a,y.t):v.t("Today",n);if(e>=c)return t||!S?v.t("Yesterday",n):v.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(x,j({hour:"numeric",minute:"2-digit"},a)));if(e>=d){var C=e.toLocaleDateString(x,j({weekday:"short"},a));return t?C:I||S?m.RelativeDateTime_DayAndTime.replace("{0}",C).replace("{1}",e.toLocaleTimeString(x,j({hour:"numeric",minute:"2-digit"},a))):e.toLocaleDateString(x,j({weekday:"long"},a))}return y.f(s,e)?x.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(x,j({month:"long",day:"numeric"},a)):e.toLocaleDateString(x,j({month:"short",day:"numeric"},a)):e.toLocaleDateString(x,j({month:"short",day:"numeric",year:"numeric"},a))}function O(e,t,n){void 0===t&&(t=!1);var a=P(n||h.t.language),i=R(),r={month:"short",day:"numeric"};return y.f(i,e)||(r.year="numeric"),m.RelativeDateTime_DayAndTime.replace("{0}",e.toLocaleDateString(a,j(r,t))).replace("{1}",e.toLocaleTimeString(a,j({hour:"numeric",minute:"2-digit"},t)))}function w(e){return v.a(e,P(h.t.language))}function E(){var e=a(),t=U();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};r=new Intl.DateTimeFormat(e,n),o=new Intl.DateTimeFormat(e,i),t&&(n.timeZone="UTC",i.timeZone="UTC"),s=new Intl.DateTimeFormat(e,n),c=new Intl.DateTimeFormat(e,i),d=r.format,l=o.format,u=s.format,f=c.format}else d=u=function(t){return t.toLocaleDateString(e)},l=f=function(t){return t.toLocaleTimeString(e)}}function A(e,t){if(!e)return"";d||E();var n=y.u(new Date,e);return(t?n?f:u:n?l:d)(e)}function L(e,t){return e?(d||E(),(t?u:d)(e).replace(/[:\/\\]/g,"-")):""}function k(e,t){d||E();var n=t?u(e):d(e),a=t?f(e):l(e);return Object(b.format)(_.e,n,a)}function M(e,t){return y.m(e,P(h.t.language),t)}function P(e){if(void 0===D)try{D=g.e.isFeatureEnabled(I)}catch(e){D=!1}return D&&function(e){if(void 0===H&&function(){H={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,a=F;n<a.length;n++){var i=a[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(H[i]=!0)}}catch(e){}}(),e)return e=e.toLowerCase(),H[e]}(e)?"en":e}function T(){var e=new Date(2e3,11,22);return e.toLocaleDateString(P(h.t.language),{day:"numeric",month:"numeric",year:"numeric"}).replace(e.getDate().toString(),"DD").replace((e.getMonth()+1).toString(),"MM").replace(e.getFullYear().toString(),"YYYY")}function U(){if(void 0===i)try{var e=a();(new Date).toLocaleDateString(e,{timeZone:"UTC"}),i=!0}catch(e){i=!1}return i}a=function(){for(var e,t=0,n=S.t.isActivated("6f22587b-a676-47a0-b10c-3e037c3f7b14","03/11/2022","Use currentCultureName to display numbers and dates.")?[window.$Config&&window.$Config.mkt,h.t.language,navigator.language,"en"].filter(function(e){return!!e}):[window.$Config&&window.$Config.mkt,h.t.cultureLCID,h.t.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i),e=i;break}catch(e){}}return e=P(e),a=function(){return e},e};var F=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","hy-am","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","sq-al","ur-pk","uz-latn-uz","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","mk","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku"],H=void 0;function R(){var e=new Date;return e.setHours(0,0,0,0),e}function N(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var a=Math.round(e/n);return t.replace("{0}",String(a))}function j(e,t){return U()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},,,,function(e,t,n){"use strict";var a=n(361);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.r}),n.d(t,"i",function(){return a.o}),n.d(t,"r",function(){return a.s})}],Array(487),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(4),i=n(425);function r(e,t){return{borderColor:e,borderWidth:"0px",width:t,height:t}}function o(e){return{opacity:1,borderWidth:e}}function s(e,t){return{borderWidth:"0",width:t,height:t,opacity:0,borderColor:e}}function c(e,t){return Object(a.e)(Object(a.e)({},r(e,t)),{opacity:0})}var d={continuousPulseAnimationDouble:function(e,t,n,a,d){return Object(i.e)({"0%":r(e,n),"1.42%":o(d),"3.57%":{opacity:1},"7.14%":s(t,a),"8%":c(e,n),"29.99%":c(e,n),"30%":r(e,n),"31.42%":o(d),"33.57%":{opacity:1},"37.14%":s(t,a),"38%":c(e,n),"79.42%":c(e,n),79.43:r(e,n),81.85:o(d),83.42:{opacity:1},"87%":s(t,a),"100%":{}})},continuousPulseAnimationSingle:function(e,t,n,a,c){return Object(i.e)({"0%":r(e,n),"14.2%":o(c),"35.7%":{opacity:1},"71.4%":s(t,a),"100%":{}})},createDefaultAnimation:function(e,t){return{animationName:e,animationIterationCount:"1",animationDuration:"14s",animationDelay:t||"2s"}}}}],Array(86),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(1214),i=n(10),r=n(1407),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return i});var a=n(1214),i=new(n(10).t)({name:"".concat("IsFiltersPaneExpanded",".isFiltersPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})}],Array(50),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return T});var a=n(0),i=n(1214),r=n(1374),o=n(3588),s=n(2718),c=n(265),d=n(2269),l=n(1365),u=n(65),f=n(9),p=n(93),m=n(100),_=n(38),h=n(609),b=n(51),g=n(136),v=n(5176),y=n(2435),S=n(14),D=n(206),I=n(429),x=n(151),C=n(300),O=n(36),w=n(69),E=n(97),A=n(3),L="CurrentWebDataSource_CurrentWeb",k="CurrentWebDataSource_SubWebs",M=["Title","Path","Filename","Created","LastModifiedTime","LinkingUrl","ParentLink","SiteID","WebId","UniqueID","ViewsLifeTime","ViewsLifeTimeUniqueUsers","ViewsRecent","ViewsRecentUniqueUsers","ViewsLastMonths1","ViewsLastMonths1Unique","ViewsLast7Days","ViewsLast6Days","ViewsLast5Days","ViewsLast4Days","ViewsLast3Days","ViewsLast2Days","ViewsLast1Days","ViewsLast7DaysUniqueUsers","ViewsLast6DaysUniqueUsers","ViewsLast5DaysUniqueUsers","ViewsLast4DaysUniqueUsers","ViewsLast3DaysUniqueUsers","ViewsLast2DaysUniqueUsers","ViewsLast1DaysUniqueUsers"],P=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._itemsStore=n.itemsStore,a._urlDataSourceLite=n.urlDataSourceLite,a._identityDataSource=n.identityDataSource,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"CurrentWebDataSource"}),a}return Object(a.__extends)(t,e),t.prototype.getCurrentWeb=function(){var e=this,t=this._itemsStore.getValue(L);if(t)return u.n.wrap(t);var n=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'SiteId:"'.concat(b.e.normalizeLower(this._pageContext.siteId,!1),'" ')+'AND WebId:"'.concat(b.e.normalizeLower(this._pageContext.webId,!1),'" ')+"AND (contentclass:STS_Site OR contentclass:STS_Web)",rowlimit:1,bypassresulttypes:!1,selectproperties:M.join(","),SourceId:"8413cd39-2156-4e00-b54d-11efd9abdb89"});return this._pageContext.groupType===v.e.private&&(n=n.parameter("Properties","EnableDynamicGroups:true")),this._dataRequestor.getData({url:n.toString(),qosName:"GetCurrentWeb",method:"POST"}).then(function(t){if(t&&t.d){var n=e._processData(t);for(var a in n)return e._itemsStore.setValue(L,n[a]),n[a]}return null})},t.prototype.getSubWebs=function(){var e=this,t=this._itemsStore.getValue(k);if(t)return u.n.wrap(t);var n=this._pageContext.webAbsoluteUrl,a=this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:'ParentLink:"'.concat(n,'" AND contentclass:STS_Web'),rowlimit:100,bypassresulttypes:!1,selectproperties:M.join(",")});return this._dataRequestor.getData({url:a.toString(),qosName:"GetSubWebs",method:"GET"}).then(function(t){if(t&&t.d){var n=e._processData(t);return e._itemsStore.setValue(k,n),n}return null})},t.prototype.getMyOneDriveUrl=function(){var e;if(Number(this._pageContext.webTemplate)===w.t.mySite&&(Object(A.co)(A.wa)?this._pageContext.isMySiteOwner:this._pageContext.isSiteOwner))e=u.n.resolve(this._pageContext.webAbsoluteUrl);else{if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return u.n.resolve(void 0);var t=this._apiUrlHelper.build().segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");e=this._dataRequestor.getData({url:t.toString(),qosName:"GetMyOneDriveUrl",noRedirect:!0,method:"POST"}).then(function(e){if(e&&e.d){var t=e.d.mySite;return t&&t.replace(/\/$/,"")}})}return this.getMyOneDriveUrl=function(){return e},e},t.prototype.getDefaultOneDriveLibrary=function(e){var t=this._apiUrlHelper.build().method("SP.Web.DefaultDocumentLibraryUrl",e);return this._dataRequestor.getData({url:t.toString(),qosName:"GetDefaultDocumentLibrary"}).then(function(t){var n=t&&t.d&&t.d.DefaultDocumentLibraryUrl;if(n){var a=[],i=new p.t(e),r={title:y.c,target:n.ServerRelativeUrl,customSettingsUrl:i.getScheme()+"://"+i.getHost()+n.ServerRelativeUrl,remote:n.FromCrossFarm};return a.push(r),a}return null})},t.prototype.getLists=function(e,t){var n=this,a=new D.e(e);return this._getTokenIfNecessary(e).then(function(t){var a;return a=t?new I.t({webAbsoluteUrl:e}).build().segment("Web").segment("AppTiles"):n._apiUrlHelper.build().method("SP.RemoteWeb",e).segment("Web").segment("AppTiles"),n._dataRequestor.getData({url:a.toString(),qosName:"GetLists",noRedirect:!0,authToken:t})}).then(function(e){return e&&e.d?e.d.results.filter(function(e){return t?(1===e.AppType||5===e.AppType||0===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate,!0):(1===e.AppType||5===e.AppType)&&n._isSupportedBaseTemplate(e.BaseTemplate)}).map(function(e){return{title:e.Title,thumbnail:e.Thumbnail,lastModified:e.LastModified,appType:e.AppType,appStatus:e.AppStatus,target:a.authority+e.Target,childCount:e.ChildCount,appId:e.AppId,appSource:e.AppSource,assetId:e.AssetId,productId:e.ProductId,contentMarket:e.ContentMarket,customSettingsUrl:e.CustomSettingsUrl,baseTemplate:e.BaseTemplate,appPrincipalId:e.AppPrincipalId}}):null})},t.prototype.getDocumentLibraries=function(e,t){var n=this;void 0===t&&(t={});var a=t.includeMediaLibraries,i=void 0!==a&&a,r=t.includePageLibraries,o=void 0!==r&&r,s=i?"GetDocumentAndMediaLibraries":"GetDocumentLibraries",c=this._apiUrlHelper.build().segment("SP.Web.".concat(s)).parameter("webFullUrl",e);return i&&(c=c.parameter("includePageLibraries",o.toString())),this._dataRequestor.getData({url:c.toString(),qosName:"GetDocumentLibraries",noRedirect:!0}).then(function(e){return e&&e.d?n._processDocLibData(e,s):null})},t.prototype.doesListWithTitleExist=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("lists").method("GetByTitle",e):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("lists").method("GetByTitle",e),a._dataRequestor.getData({url:r.toString(),qosName:"GetListByTitle",noRedirect:!0,additionalHeaders:t,authToken:n}).then(function(){return!0},function(){return!1})})},t.prototype.deleteList=function(e,t,n){var i=this,r=Object(a.__assign)({"X-HTTP-Method":"DELETE","If-Match":"*"},n),o=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(o).then(function(t){var n;return n=t?new I.t({webAbsoluteUrl:o}).build().segment("web").segment("lists").method("GetByTitle",e):i._apiUrlHelper.build().method("SP.RemoteWeb",o).segment("web").segment("lists").method("GetByTitle",e),i._dataRequestor.getData({url:n.toString(),qosName:"DeleteListByTitle",noRedirect:!0,additionalHeaders:r,authToken:t})})},t.prototype.recycleListById=function(e,t,n){var a=this,i=n||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(n){var r;return r=n?new I.t({webAbsoluteUrl:i}).build().segment("web").method("lists",e).segment("recycle"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").method("lists",e).segment("recycle"),a._dataRequestor.getData({url:r.toString(),qosName:"RecycleListById",noRedirect:!0,additionalHeaders:t,authToken:n,method:"POST"})})},t.prototype.checkEffectivePermissions=function(e,t,n){var a=this._apiUrlHelper.build().segment("web").method("GetList",e).segment("EffectiveBasePermissions");return this._dataRequestor.getData({url:a.toString(),qosName:"checkEffectivePermissions",noRedirect:!0,additionalHeaders:n}).then(function(e){return O.e.hasItemPermission({permissions:e.d.EffectiveBasePermissions},t)})},t.prototype.checkWebEffectivePermissions=function(e,t,n){var a=this,i=t||this._pageContext.webAbsoluteUrl;return this._getTokenIfNecessary(i).then(function(t){var r;return r=t?new I.t({webAbsoluteUrl:i}).build().segment("web").segment("EffectiveBasePermissions"):a._apiUrlHelper.build().method("SP.RemoteWeb",i).segment("web").segment("EffectiveBasePermissions"),a._dataRequestor.getData({url:r.toString(),qosName:"checkWebEffectivePermissions",noRedirect:!0,additionalHeaders:n,authToken:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})}).catch(function(){return!1})},t.prototype.ensureSiteAssetsAndPermissions=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").segment("EnsureSiteAssetsLibrary").rawParameter("$expand=EffectiveBasePermissions");return this._dataRequestor.getData({url:n.toString(),qosName:"EnsureSiteAssetsAndPermissions",noRedirect:!0,additionalHeaders:t}).then(function(t){return O.e.hasItemPermission({permissions:t.d.EffectiveBasePermissions},e)})},t.prototype.getListDefaultViewUrlByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e).segment("DefaultView");return this._dataRequestor.getData({url:n.toString(),qosName:"GetListDefaultViewUrlByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.ServerRelativeUrl})},t.prototype.getListIdByTitle=function(e,t){var n=this._apiUrlHelper.build().segment("web").segment("lists").method("GetByTitle",e);return this._dataRequestor.getData({url:n.toString(),qosName:"GetListIdByTitle",noRedirect:!0,additionalHeaders:t}).then(function(e){return e.d.Id})},t.prototype.makeHomePage=function(e){var t={__metadata:{type:"SP.Folder"},WelcomePage:e},n=this._apiUrlHelper.build().segments("web","RootFolder");return this._dataRequestor.getData({url:n.toString(),qosName:"MakeHomepage",additionalPostData:JSON.stringify(t),method:"POST",additionalHeaders:{"x-http-method":"MERGE"}})},t.prototype.setSchedulingFeature=function(e){var t=e?"add":"remove",n=this._apiUrlHelper.build().segments("web","Features","".concat(t,"(guid'E87CA965-5E07-4A23-B007-DDD4B5AFB9C7')"));return this._dataRequestor.getData({url:n.toString(),qosName:"SchedulingFeature",noRedirect:!0}).then(function(t){return{isFeatureActivated:e}})},t.prototype.listPowerPlatformUserDetails=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ListPowerPlatformUserDetails");return this._dataRequestor.getData({url:t.toString(),qosName:"ListPowerPlatformUserDetails",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype.consentToPowerPlatform=function(){var e=this,t=this._apiUrlHelper.build().segments("web","ConsentToPowerPlatform");return this._dataRequestor.getData({url:t.toString(),qosName:"ConsentToPowerPlatform",method:"POST",parseResponse:function(t){return e._processPowerPlatformSyncResult(t)}})},t.prototype._processDocLibData=function(e,t){var n=e.d[t],a=[];return n&&n.results&&(a=n.results.map(function(e){return{title:e.Title,target:e.ServerRelativeUrl,customSettingsUrl:e.AbsoluteUrl,remote:e.FromCrossFarm,id:e.Id}})),a},t.prototype._processData=function(e){for(var t,n={},a=0,i=e.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results;a<i.length;a++){var r=i[a],d=o.getProperties(r.Cells),u=new p.t(d.Path),m=this._urlDataSourceLite.getKey(((t={})[f.n.idParamKey]=u.getPath(),t[f.n.uniqueParamKey]="search".concat(d.UniqueID||""),t)),_=new s.e(m);_.id=b.e.normalizeUpper(d.WebId,!1),_.name=d.Filename,_.parentLink=d.ParentLink,_.displayName=d.Title,_.isPlaceholder=!1,_.type=c.e.Unknown,_.dateModified=Object(l.o)(new Date(d.LastModifiedTime)),_.openUrl=d.LinkingUrl||d.Path,_.statistics=o.getItemStatistics(d),_.itemFromServer=d,n[_.id]=_}return n},t.prototype._processPowerPlatformSyncResult=function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;try{var n=JSON.parse(e);t.synchronizationDataObject=n.d.SynchronizationData,t.synchronizationStatus=n.d.SynchronizationStatus}catch(e){E.e.logError(e,{eventName:"PowerPlatformResponseParsingFailure",feature:"BizAppsForListTemplates"})}return t},t.prototype._isSupportedBaseTemplate=function(e,t){var n=e===S.t.genericList||e===S.t.survey||e===S.t.links||e===S.t.announcements||e===S.t.contacts||e===S.t.tasks||e===S.t.customGrid||e===S.t.issueTracking;return t?n||e===S.t.documentLibrary:n},t.prototype._getTokenIfNecessary=function(e){return this._itemUrlHelper.getUrlParts({webUrl:e,path:e}).isCrossDomain?this._identityDataSource.getSharePointToken(new D.e(e).authority).then(function(e){return e.accessToken}):u.n.resolve("")},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:_.f,itemsStore:d.t,apiUrlHelper:h.e,itemUrlHelper:x.c,dataRequestorType:r.t,urlDataSourceLite:m.fe,identityDataSource:C.a}),t}(i.default);t.default=P;var T=Object(g.r)("WebDataSource",P)},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return r});var a=n(5485),i=n(345),r=new(n(10).t)({name:"GroupsProvider",factory:{dependencies:{pageContext:i.e},create:function(e){return{instance:new a.t({pageContext:e.pageContext})}}}})}],Array(15),[function(e,t,n){"use strict";n.r(t),n.d(t,"EngagementHelper",function(){return s}),n.d(t,"mergeEngagementData",function(){return c}),n.d(t,"EngagementPartType",function(){return i.a}),n.d(t,"EngagementPart",function(){return i.n}),n.d(t,"EngagementBuilder",function(){return i.t}),n.d(t,"ENGAGEMENT_ROOT",function(){return i.e}),n.d(t,"clickEngagementPart",function(){return l.e}),n.d(t,"keyPressEngagementPart",function(){return l.n}),n.d(t,"dropEngagementPart",function(){return l.t}),n.d(t,"getMostSpecificMatchingContext",function(){return u});var a=n(0),i=n(691),r=n(170),o=n(226),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,s=n.logData,c=void 0===s?function(e){return r.e.logData(e)}:s;return a._handlers=o,a._logData=c,a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){if(void 0===e&&(e={}),this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,r=e.isIntentional,o=void 0!==r&&r,s=e.extraData,d=void 0===s?{}:s,l=Object(a.__rest)(d,[]),u=Object(a.__rest)(e,["name","isIntentional","extraData"]),f=Object(a.__assign)({name:i,isIntentional:o,extraData:l},u),p=0,m=t;p<m.length;p++){var _=m[p],h=_.part,b=_.extraData,g=void 0===b?{}:b,v={};for(var y in g)v["".concat(h.name,"_").concat(y)]=g[y];c(f,{extraData:v}),c(f,_.part.getEngagementData(_)||{})}for(var S=0,D=this._handlers;S<D.length;S++){var I=D[S],x=I.getEngagementData.apply(I,t);x&&c(f,x)}this._logData(f)}},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})},t}(i.t);function c(e,t){var n=t.extraData,i=void 0===n?{}:n,r=t.experiment;d(e,Object(a.__rest)(t,["extraData","experiment"])),Object(o.e)(e.extraData,i),void 0!==r&&(e.experiment=r)}function d(e,t){for(var n in t){var a=t[n];if("object"==typeof a&&a){var i="object"==typeof e[n]&&e[n]||{};e[n]=i,d(i,a)}else void 0!==a&&(e[n]=a)}}var l=n(4433);function u(e,t){for(var n=t.length-1;n>=0;n--){var a=t[n];if(e.matches(a))return a}}},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"ShowInfoPaneAction",function(){return r});var a=n(320),i=n(2428),r=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})},function(e,t,n){"use strict";n.r(t),n.d(t,"CopyFieldAction",function(){return h}),n.d(t,"EditItemAction",function(){return g}),n.d(t,"ViewItemAction",function(){return v});var a=n(0),i=n(320),r=n(2428),o=n(13),s=n(80),c=n(43),d=n(14),l=n(28),u=n(120),f=n(1),p=n(36),m=n(5),_=n(12),h=Object(r.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(i.e);return new(e.injected(t.CopyFieldAction))});function b(e,t){var n=Object(c.e)(e,t),a=e.demandItemFacet(l.e,t),i=a&&u.e.serialize(a),r=i&&e.demandItemFacet(f.We,i),o=r&&r.templateType===d.n.mySiteDocumentLibrary;return{isAvailable:!!n&&!n.isAnonymousGuestUser&&!o,pageContext:n,listContext:r}}var g=Object(o.r)()(Object(s.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("deferred"),n.e(797)]).then(n.bind(null,2034))];case 1:return[2,e.sent().EditItemAction]}})})},function(e,t){var n=t.itemKeys;if(!n||n.length<1)return!1;var a=b(e,n[0]),i=a.isAvailable,r=a.listContext;if(!i)return!1;if(r&&r.isDocumentLibrary&&n.length<=1)return!1;if(!_.e.isActivated("0F378815-7F92-48A5-B9E3-A127BEB75AC6","11/9/2020","disable bulk edit when list disableGridEditing is true")&&r&&!0===r.disableGridEditing&&n.length>1)return!1;for(var o=0,s=n;o<s.length;o++){var c=s[o],d=e.demandItemFacet(f.St,c);if(!(i=p.t.hasItemPermission({permissions:d},p.t.editListItems)))break}return!!i})),v=Object(o.r)()(Object(o.a)()(Object(s.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return _.e.isActivated("f96c87d5-d38d-4ca4-b2e7-a1ef3b171359","2/1/2022","Re-expose pagecontext to ViewItemAction")?[4,Promise.all([n.e("deferred.resx-deferred"),n.e(197)]).then(n.bind(null,5005))]:[3,2];case 1:return[2,e.sent().ViewItemAction];case 2:return[4,Promise.all([n.e("deferred.resx-deferred"),n.e(197)]).then(n.bind(null,5005))];case 3:return[2,e.sent().ViewItemActionWithResourceScope]}})})},function(e,t){var n=t.itemKey,a=t.preferredSection;if(!n)return!1;var i=b(e,n),r=i.isAvailable,o=i.listContext;return"comments"===a?r&&(null==o?void 0:o.templateType)===d.n.genericList&&!e.demandItemFacet(m.h,n):r})))}],Array(15),[function(e,t,n){"use strict";n.r(t),n.d(t,"getFirstConsistentlyInteractive",function(){return i});var a=n(2191);function i(e){return void 0===e&&(e={}),"PerformanceLongTaskTiming"in window?new a.e(e).getFirstConsistentlyInteractive():Promise.resolve(null)}n.d(t,"restartLongTaskObserver",function(){return a.t})}],Array(143),[function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(0),i=0,r=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c()&&console.log.apply(console,e)}function c(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function d(e,t){if(e.length>2)return performance.now();for(var n=[],a=0,i=t;a<i.length;a++){var r=i[a];n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"})}for(var o=0,s=e;o<s.length;o++){var c=s[o];n.push({timestamp:c,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var d=e.length,l=n.length-1;l>=0;l--){var u=n[l];switch(u.type){case"requestStart":d--;break;case"requestEnd":if(++d>2)return u.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var u=function(){function e(e){void 0===e&&(e={});var t=this;this._useMutationObserver=!!e.useMutationObserver,this._trackNetworkRequests=!!e.trackNetworkRequests,this._minValue=e.minValue||null,this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3,this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,a=window.__tti&&window.__tti.o;this._longTaskId=0,n?(s("Consuming the long task entries already recorded."),this._longTasks=n.map(function(e){return t._createLongTask(e)}),window.__tti.e=[]):this._longTasks=[],a&&a.disconnect(),this._networkRequests=[],this._incompleteJSInitiatedRequestStartTimes=new Map,this._timerId=void 0,this._timerActivationTime=-1/0,this._scheduleTimerTasks=!1,this._firstConsistentlyInteractiveResolver=null,this._performanceObserver=null,this._mutationObserver=null,this._registerListeners(this._trackNetworkRequests)}return e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t,"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})},e.prototype.startSchedulingTimerTasks=function(){s("Enabling FirstConsistentlyInteractiveDetector"),this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=d(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))},e.prototype._rescheduleTimer=function(e){var t=this;this._scheduleTimerTasks?(s("Attempting to reschedule FirstConsistentlyInteractive "+"check to ".concat(e)),s("Previous timer activation time: ".concat(this._timerActivationTime)),this._timerActivationTime>e?s("Current activation time is greater than attempted reschedule time. No need to postpone."):(clearTimeout(this._timerId),this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now())),this._timerActivationTime=e,s("Rescheduled firstConsistentlyInteractive check at ".concat(e)))):s("startSchedulingTimerTasks must be called before calling rescheduleTimer")},e.prototype._disable=function(){s("Disabling FirstConsistentlyInteractiveDetector"),clearTimeout(this._timerId),this._scheduleTimerTasks=!1,this._unregisterListeners()},e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0),this._performanceObserver=new PerformanceObserver(function(n){for(var a=0,i=n.getEntries();a<i.length;a++){var r=i[a];"resource"===r.entryType&&e&&t._networkRequestFinishedCallback(r),"longtask"===r.entryType&&t._longTaskFinishedCallback(r)}}),this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})},e.prototype._registerListeners=function(e){var t,n,a,s,c,d,l,u,f;void 0===e&&(e=!0),e&&(s=this._beforeJSInitiatedRequestCallback.bind(this),c=this._afterJSInitiatedRequestCallback.bind(this),d=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return s(l.toString()),this.addEventListener("readystatechange",function(){4===e.readyState&&c(l.toString())}),d.apply(this,t)},t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),a=window.fetch,window.fetch=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return new Promise(function(r,o){var s=i++;t(s.toString()),a.apply(void 0,e).then(function(e){n(s.toString()),r(e)},function(e){n(e),o(e)})})}),this._registerPerformanceObserver(e),this._useMutationObserver&&(this._mutationObserver=(u=this._mutationObserverCallback.bind(this),(f=new MutationObserver(function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];("childList"===a.type&&o(a.addedNodes,r)||"attributes"===a.type&&r.includes(a.target.tagName.toLowerCase()))&&u(a)}})).observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),f))},e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect(),this._mutationObserver&&this._mutationObserver.disconnect()},e.prototype._beforeJSInitiatedRequestCallback=function(e){s("Starting JS initiated request. Request ID: ".concat(e)),this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now()),s("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))},e.prototype._afterJSInitiatedRequestCallback=function(e){s("Completed JS initiated request with request ID: ".concat(e)),this._incompleteJSInitiatedRequestStartTimes.delete(e),s("Active XHRs: ".concat(this._incompleteJSInitiatedRequestStartTimes.size))},e.prototype._networkRequestFinishedCallback=function(e){s("Network request finished",e),this._networkRequests.push({start:e.fetchStart,end:e.responseEnd}),this._rescheduleTimer(d(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)},e.prototype._longTaskFinishedCallback=function(e){s("Long task finished",e);var t,n=this._createLongTask(e),a="longTaskEnd".concat(n.id);t=a,window.performance&&performance.mark&&performance.mark(t),n.endMarkName=a,this._longTasks.push(n),this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)},e.prototype._mutationObserverCallback=function(e){s("Potentially network resource fetching mutation detected",e),s("Pushing back FirstConsistentlyInteractive check by ".concat(this._requiredNetworkQuietnessDurationInMilliseconds," milliseconds.")),this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)},e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null},e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}},e.prototype._incompleteRequestStarts=function(){return Object(a.__spreadArray)([],Array.from(this._incompleteJSInitiatedRequestStartTimes.values()),!0)},e.prototype._checkTTI=function(){s("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=d(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,a=this._getMinValue(),i=performance.now();if(null===a)return s("No usable minimum value yet. Postponing check."),void this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3));s("Parameter values:"),s("NavigationStart",e),s("lastKnownNetwork2Busy",t),s("Search Start",n),s("Min Value",a),s("Last busy",t),s("Current time",i),s("Long tasks",this._longTasks),s("Incomplete JS Request Start Times",this._incompleteRequestStarts()),s("Network requests",this._networkRequests);var r=function(e,t,n,a,i,r,o,s){if(r&&a-n<s)return null;var c=0===i.length?e:i[i.length-1].end;if(a-c<o)return null;if(c&&i.length>0){var d=i[i.length-1].endMarkName;d&&performance.measure("TTI",void 0,d)}return Math.max(c,t)}(n,a,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);r&&this._firstConsistentlyInteractiveResolver?(s("maybeFCI",r),this._firstConsistentlyInteractiveResolver({tti:r,longTasks:this._longTasks}),this._disable()):(s("Could not detect First Consistently Interactive. Retrying in 1 second."),this._rescheduleTimer(performance.now()+1e3))},e}()},,,,,,function(e,t,n){"use strict";function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}n.r(t),n.d(t,"getFirstCPUIdle",function(){return o});var r=function(){function e(e){this._longTaskId=0,this._checkFCIRunId=0,this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n,this._requiredMainThreadCPUIdleDurationInMilliseconds=t,this._resultResolver={resolve:void 0,reject:void 0},this._fciPromise=void 0,this._longTasks=[],this._processLongTaskPreQueue(),this._registerLongTaskObserver()}return e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";return this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t,e._resultResolver.reject=n})),this._tryScheduleNextCheck(),this._fciPromise},e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),a=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},a)},e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime+this._requiredMainThreadCPUIdleDurationInMilliseconds,performance.now())},e.prototype._checkFCI=function(){var e,t=performance.now(),n=this._longTasks?this._longTasks.length:0;if(a("Running checkFCI:"),a("Measurement start time",this._measurementStartTime),a("Current time",t),a("Long tasks",this._longTasks),a("latestLongTaskEndTime",null===(e=this._longTasks[n-1])||void 0===e?void 0:e.end),!this._measurementStartTime||this._measurementStartTime<0)this._onFoundFCI(NaN);else if(0!==n){for(var i=this._longTasks[0],r=1;r<n;r++){var o=this._longTasks[r],s=Math.max(i.end,this._measurementStartTime);if(o.start>=this._measurementStartTime&&o.start-s>=this._requiredMainThreadCPUIdleDurationInMilliseconds)return void this._onFoundFCI(s,i.endMarkName);i=o}if(t-i.end>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var c=i.end>this._measurementStartTime?i.endMarkName:void 0;this._onFoundFCI(Math.max(i.end,this._measurementStartTime),c)}}else t-this._measurementStartTime>=this._requiredMainThreadCPUIdleDurationInMilliseconds&&this._onFoundFCI(this._measurementStartTime)},e.prototype._onFoundFCI=function(e,t){t&&performance.measure("FCI",void 0,t),a("possibleFCI:",e),this._resultResolver.resolve&&this._resultResolver.resolve({fci:e,longTasks:this._longTasks}),this._dispose()},e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId),this._longTaskObserver.disconnect(),this._isDisposed=!0},e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var a=n[t];(!e||a.end>e.end)&&(e=a)}return e},e.prototype._processLongTaskPreQueue=function(){if(window.__fci){var e=window.__fci.o,t=window.__fci.e;if(e){for(var n=0,a=t;n<a.length;n++){var i=a[n];if("longtask"===i.entryType){var r=this._createLongTask(i);this._longTasks.push(r)}}e.disconnect()}}},e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,a=t.getEntries();n<a.length;n++){var i=a[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}}),this._longTaskObserver.observe({entryTypes:["longtask"]})},e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}},e.prototype._longTaskFinishedCallback=function(e){a("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd".concat(n.id);t=i,window.performance&&performance.mark&&performance.mark(t),n.endMarkName=i,this._longTasks.push(n),this._tryScheduleNextCheck()},e}();function o(e){return"PerformanceLongTaskTiming"in window?new r(e).measureFCI():Promise.resolve(null)}},,,,function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(23),o=n(2508),s=n("knockout-lib"),c="__automationTypeBinding$elements",d={init:function(e,t,n,a,i){if(s.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i),i){var r=i.$component;if(r){var o=s.utils.unwrapObservable(t());if(o){var d=r[c];d||(d=r[c]={});var l=d[o];l||(l=d[o]=[]),l.push(e),s.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=l.indexOf(e);-1!==t&&(delete l[t],l.splice(t,1))})}}}}},l=n(2203),u=n(1543),f=function(e){function t(t){var n=e.call(this,t)||this,a=n.element.getAttribute("class");return n.element.setAttribute("class",n._expandIconClassNames(a)),n}return Object(a.__extends)(t,e),t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),a=[],i=0,r=n;i<r.length;i++){var o=r[i];if(this._lastClassesAdded&&this._lastClassesAdded[o]||a.push(o),0===o.indexOf("ms-Icon--")){var s=o.substring(9),c=Object(u.e)(s);c&&-1===n.indexOf(c)&&(t[c]=!0,a.push(c))}}return this._lastClassesAdded=t,a.join(" ")}return e},t.after=["css","class"],t}(l.e),p=n(226),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.bindingHandlers={},a.automationId=t&&t.automationId||void 0,a.addBindingHandlers({automation:o.e,automationType:d,icon:f}),a}return Object(a.__extends)(t,e),t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)},t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(r.format)(e,t)},t.prototype.addBindingHandlers=function(e){Object(p.e)(this.bindingHandlers,e)},t}(i.default);t.e=m},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("knockout-lib"),i=n(1364);function r(e){var t=e.tagName,n=e.template,i=e.viewModel,r=e.synchronous,o=void 0!==r&&r;return a.components.register(t,{viewModel:i,template:n,synchronous:o}),e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html"),n.id=e,i.e.setText(n,t),document.head.appendChild(n)}},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1214),r=n("knockout-lib"),o=n(2558),s=n(10),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.element=t.element,a.valueAccessor=t.valueAccessor,a.allBindingsAccessor=t.allBindingsAccessor,a.bindingContext=t.bindingContext,a.controlsDescendantBindings=!1,a}return Object(a.__extends)(t,e),t.init=function(e,t,n,a,i){var c=new s.n(o.e(i)),d=new(this.supportsDependencies?c.resolved(this):c.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});return r.utils.domNodeDisposal.addDisposeCallback(e,function(){return d.dispose()}),{controlsDescendantBindings:d.controlsDescendantBindings}},t.dependencies=Object(a.__assign)({},i.default.dependencies),t.supportsVirtualElements=!1,t.supportsDependencies=!1,t}(i.default);t.t=c},,,function(e,t,n){"use strict";n.d(t,"n",function(){return m}),n.d(t,"e",function(){return _});var a=n(0),i=(n(4412),n(2203)),r=n(10);n.d(t,"t",function(){return r.t});var o=n(2444),s=n(65),c=n(4812),d=n(428),l=n(97),u=n("knockout-lib"),f=n(3838);n.d(t,"i",function(){return f.e});var p=function(){function e(e){var t=e.viewModelType;this.dependencies=Object(a.__assign)(Object(a.__assign)({},t.dependencies||{}),e.dependencies||{}),this._automationName=e.automationName,this._viewModelType=e.viewModelType,this._template=e.template}return e.prototype.create=function(e){var t=this,n=e.resources,i=function(t){function i(i){return t.call(this,i,Object(a.__assign)(Object(a.__assign)({},e||{}),{resources:new r.n(n)}))||this}return Object(a.__extends)(i,t),i}(this._viewModelType),o=function(){return t._getTemplateNodes()},s=this._automationName;return{instance:new(function(){function e(){}return e.prototype.toSpecification=function(e){return{automationName:s,viewModelType:i,getTemplateNodes:o,params:e}},e}())}},e.prototype._getTemplateNodes=function(){var e=u.utils.parseHtmlFragment(this._template);return this._getTemplateNodes=function(){return e},e},e}();function m(e){return new r.t({name:e.name,factory:new p({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})}var _=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.controlsDescendantBindings=!0;var i=a.element;return a._transcludedTemplateNodes=Array.prototype.slice.call(u.virtualElements.childNodes(i)),u.virtualElements.emptyNode(i),a._resolvedSpecification=a._getResolvedSpecification(),a._initializeRenderComponent(),a}return Object(a.__extends)(t,e),t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=h;var r=new o.e;return n.compute(function(){var o,c,d,u=e.valueAccessor();b(u)?(o=n.unwrap(u.specification),c=u.placeholder,d=u.error):o=n.unwrap(u),e.observables.ignore(function(){var n;if(o)if(g(o)){var u=o.params,f=o.definitionKey.local,p=t.consume(f.optional);if(p)i(p.toSpecification(u));else{if(c)if(g(c)){var m=t.consume(c.definitionKey.optional.local);m&&i(Object(a.__assign)(Object(a.__assign)({},m.toSpecification(c.params)),{isPlaceholder:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},c),{isPlaceholder:!0}));n=s.n.resolve(t.consumeAsync(f)).then(function(e){return e.toSpecification(u)})}}else i(o);else i(void 0);r.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!s.n.isCanceled(e)&&(l.e.log(e),d))if(g(d)){var n=t.consume(d.definitionKey.optional.local);n&&i(Object(a.__assign)(Object(a.__assign)({},n.toSpecification(Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}))),{isError:!0}))}else i(Object(a.__assign)(Object(a.__assign)({},d),{params:Object(a.__assign)(Object(a.__assign)({},d.params),{error:e}),isError:!0}))})):s.n.wrap())})}),i},t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,a=this.observables,i=this._transcludedTemplateNodes;a.compute(function(){var a=t._resolvedSpecification();t.observables.ignore(function(){if(e&&(e.dispose(),u.virtualElements.emptyNode(n)),a){var r=a.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new d.e)).attach(new a.viewModelType(a.params));e.attach(new c.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:a.automationName}));for(var s=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o,e.$componentTemplateNodes=i}),l=document.createDocumentFragment(),f=0,p=r;f<p.length;f++){var m=p[f];l.appendChild(m)}u.virtualElements.setDomNodeChildren(n,[l]),u.applyBindingsToDescendants(s,n);var _=t.valueAccessor();if(b(_)){var h=_.afterRender;!h||a.isPlaceholder||a.isError||h()}}})})},t.supportsVirtualElements=!0,t}(i.t);function h(e,t){return!e&&!t||e===t||!(!e||!t)&&e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params}function b(e){return!!e&&"object"==typeof e&&"specification"in e}function g(e){return!!e.definitionKey}t.a=_},,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(1498),r=n(902),o=n(1214),s=n(100),c=n(65),d=n(97),l=n(105),u=n(37),f=n(83),p=n(435),m=n(547),_=n(35),h=n(1240),b=n(104),g=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="BaseAction";var i=a,r=i.resources,o=i.observables,c=n.urlDataSource,d=void 0===c?r.consume(s.ue.optional):c,l=n.instrumentationProvider,u=void 0===l?r.consume(p.r.optional):l;a._BaseAction_urlDataSource=d,a._BaseAction_instrumentationProvider=u,a.isQosLogged=!0,a.logStartEnd=!1,a.enableCustomerPromiseLogging=!1,a._executingInstanceCount=o.create(0);var f={deferEvaluation:!0};return a.isAvailable=o.pureCompute(a._computeIsAvailable,f),a.isToggled=o.pureCompute(a._computeIsToggled,f),a.isExecuting=o.pureCompute(a._computeIsExecuting,f),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n,a=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,r=i?this.getEngagement():void 0;try{if(i&&(this._logEngagementEvent(i.data.extraData,r),this.trackUserAction(this.name)),!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){d.e.log(e),n=e}return t?(this._executingInstanceCount(this._executingInstanceCount.peek()+1),t.then(function(e){a._executingInstanceCount(a._executingInstanceCount.peek()-1),i&&i.end(e)},function(t){a._executingInstanceCount(a._executingInstanceCount.peek()-1),t&&!c.n.isCanceled(t)&&d.e.log(t),i&&i.end(a.onCreateErrorEventArg(e,t,!1))})):(i&&i.end(this.onCreateErrorEventArg(e,n,!0)),t=c.n.reject(n)),t},t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&u.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})},t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&c.n.isCanceled(t)?{resultType:f.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof _.e?{resultType:t.isExpected?f.e.ExpectedFailure:f.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:f.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}},t.prototype.onExecute=function(e,t){var n={resultType:f.e.Failure};return c.n.resolve(n)},t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new h.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&u.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,r=e.error,o=e.extraData;return i.end({resultType:n,errorCode:t,extraData:Object(a.__assign)(Object(a.__assign)({},o),{error:r})}),e}).catch(function(e){var t;if(c.n.isCanceled(e))t={resultType:f.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(b.e)(e),r=n.resultType,o=n.resultCode,s=n.error,d=n.extraData;t={resultType:r,errorCode:o,extraData:Object(a.__assign)(Object(a.__assign)({},d),{error:s})}}throw i.end(t),e})}return t},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){return!1},t.prototype.getEngagement=function(){return this.resources.consume(m.e)},t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}},t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()},t.prototype._computeIsToggled=function(){return!!this.onIsToggled()},t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0},t.prototype._logEngagementEvent=function(e,t){if(void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0),t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:r.e[r.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e||{}),n&&n.getEngagementData()||{}),{isAction:!0})})}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.default.dependencies),{urlDataSource:s.ue,instrumentationProvider:p.r.optional}),t}(o.default);t.e=g},,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(n(4418).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(1214),r=n(10),o=n(136),s={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},c={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},d=new r.t({name:"".concat("ResponsiveUI",".breakpoints"),factory:new r.e(c)}),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._containerElement=t.containerElement||window;var i=a.observables;return a._breakpoints=i.wrap(n.breakpoints),a.events.on(a._containerElement,"resize, orientationchange",a._onContainerResize),a.windowWidth=i.create(0),a.windowHeight=i.create(0),a.formFactorSize=i.pureCompute(a._computeFormFactorSize),a.isHamburgerVisible=i.pureCompute(a._computeIsHamburgerVisible),a.showLabels=i.pureCompute(a._computeShowLabels),a.cssClass=i.pureCompute(a._computeCssClass),a._onContainerResize(),a}return Object(a.__extends)(t,e),t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}},t.determineWindowSize=function(e,t){if(void 0===t&&(t=c),0===e)return"Medium";for(var n in c)if(e<t[n])return n},t.determineCssClass=function(e){return s[e]},t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden",t.width="100px",t.msOverflowStyle="scrollbar",document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var a=document.createElement("div");a.style.width="100%",e.appendChild(a);var i=a.offsetWidth;e.parentNode.removeChild(e);var r=n-i;return this.getScrollbarWidth=function(){return r},r},t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]},t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,a=document.documentElement,i=t.clientWidth||a.clientWidth||t.innerWidth||n.clientWidth,r=t.clientHeight||a.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i),this.windowHeight(r)},t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"},t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())},t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0},t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<c.Large},t.dependencies={breakpoints:d},t.DEFAULT_BREAKPOINTS=c,t.MAC_SCROLL_BAR_WIDTH=8,t}(i.default);t.e=l;var u=Object(o.r)("ResponsiveUI",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2269),i=n(136),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.t},e}(),o=Object(i.r)("ItemParentHelper",r)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(65),r=n(1214),o=n(320),s=n(2672),c=n(136),d=n(2718),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.resources,c=i.observables,l=n.getCurrentItem,u=void 0===l?r.consume(o.o.lazy.optional):l,f=n.getItemSetSelectionModel,p=void 0===f?r.consume(o.I.lazy.optional):f,m=n.getSelectionHelper,_=void 0===m?r.consume(s.t.lazy.optional):m,h=t.allowMultiSelect,b=void 0!==h&&h,g=t.canFallback,v=void 0!==g&&g,y=t.ignoreSelection,S=void 0!==y&&y,D=t.overrideItem,I=t.useCurrentSelectionGroup,x=void 0!==I&&I;return a._allowMultiSelect=b,a._overrideItem=D,a._ignoreSelection=S,a._useCurrentSelectionGroup=x,a._placeholder=a.observables.create(new d.e),a._getSelectionModel=p,D||(a._selectionHelper=_&&_()),v&&u&&(a._fallback=u()),a.selection=c.pureCompute(a._computeSelection),a.firstItem=c.pureCompute(a._computeFirstItem),a.currentItem=c.pureCompute(function(){return(u&&u()||a._placeholder)()}),a}return Object(a.__extends)(t,e),t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,a=0,i=t;a<i.length;a++){var r=i[a],o=n.unwrap(r);if(!o)return!0;if(!e(o))return!1}return!0},t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})},t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})},t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))},t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()},t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()},t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]},t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()},t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];return(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]),e},t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))},t}(r.default),u=Object(c.o)("ItemSelectionHelper",l,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{currentItem:o.o.lazy.optional,itemSetSelectionModel:o.I.lazy.optional,selectionHelper:s.t.lazy.optional}))},,,,function(e,t,n){"use strict";var a=n(0),i=n(2203),r=n(204),o=n(2289),s=n(466),c=n(2835),d={Left:"Right",Right:"Left"},l={Esc:!0},u=function(e){function t(n){var a,i=e.call(this,n)||this,r=i.valueAccessor();if(r instanceof Array)for(var s=function(e){return function(){return e}},c=0,d=r;c<d.length;c++)a=d[c],new(i.managed(t))({element:i.element,valueAccessor:s(a),bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor});else{if("object"!=typeof r)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=r.mappings&&r||{mappings:r},u=l.target||i.element,f=l.useCapture,p=void 0!==f&&f;i._options=l,i.events.on(u,"keydown",i._onKeyDown,p),i._isActive=l.isActive||i.observables.create(!1),new(i.managed(o.t))({element:i.element,bindingContext:i.bindingContext,allBindingsAccessor:i.allBindingsAccessor,valueAccessor:function(){return{isActive:i._isActive}}})}return i}return Object(a.__extends)(t,e),t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,a=t.allowButtonEvents,i=t.context,o=void 0===i?this.bindingContext.$data:i,u=t.preventDefault,f=t.eventFilter,p=e.target,m=function(e){var t;return t=function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t}(e.keyCode),e.metaKey&&(t="Meta"+t),e.ctrlKey&&(t="Ctrl"+t),e.altKey&&(t="Alt"+t),e.shiftKey&&(t="Shift"+t),t}(e),_=!a&&p!==this.element&&c.e(p),h=!l[m]&&!n&&p!==this.element&&c.t(p),b=t.target===document&&!this._isActive.peek(),g=function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1}(this.element,p);if(_||h||b||g)return!0;var v=function(e,t){var n=!!e.useRtlMappings&&s.t.isRightToLeft&&d[t]||t;return e.mappings[n]}(t,m);if(v){if(u&&e.preventDefault&&e.preventDefault(),f&&!f(m,o,e))return!0;for(var y=0,S=v instanceof Array?v:[v];y<S.length;y++)if(!1===S[y].call(o,o,e))return r.t.stopPropagation(e),!1}return!0},t}(i.t);t.e=u},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(1822),n(1214)),r=n(2284),o=n(2718),s=n(2269),c=n(65),d=n(320),l=n(100),u=n(871),f=n(2264),p=n(2527),m=n(2255),_=n(2412),h=n(3019);function b(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}var g=n(1937),v=n(10),y=n(136),S=n(2299),D=n(601),I=n(2762),x=n("knockout-lib"),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(85),E=n(3),A=n(1617),L=n(15),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.co)(E.Vr))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return t.invalidateItem(e.parentKey),t.resources.consume(A.e)&&t.resources.consumeAsync(l.L).then(function(t){t.invalidateItems(e.parentKey)}),n})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.L).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.P))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.Y.optional,itemsStore:s.t,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.default),T=(t.default=P,Object(y.r)("ItemProvider",P))},function(e,t,n){"use strict";var a=function(){function e(){}return e.init=function(e,t,n,a,i){t()(e)},e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(1214),r=n(136),o=n("knockout-lib"),s=n(65),c=n(601),d=n(134),l=n(2880),u=function(){this.icon=null,this.isAvailable=o.observable(!0),this.isVisible=o.observable(!0),this.isDefault=!1,this.automationId="",this.instrumentationId="",this.isExecuting=o.observable(!1),this.isLink=!1,this.execute=function(){return s.n.wrap(1)}},f=function(e){function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var a=t.title,i=t.titleAction,r=t.titleIcon,s=t.titleIconAriaLabel,d=t.customCssClasses,f=t.actions,p=void 0===f?[]:f,m=t.component,_=t.control,h=t.isDismissable,b=void 0===h||h,g=t.isSoftDismissable,v=void 0===g||g,y=t.isDismissableOnResize,S=void 0!==y&&y,D=t.isDismissableOnScroll,I=void 0!==D&&D,x=t.size,C=void 0===x?"Small":x,O=t.automationId,w=t.executeDefaultAction,E=void 0===w||w,A=t.isCallout,L=t.isOverlayHidden,k=void 0!==L&&L,M=t.overlayColor,P=void 0===M?"rgba(255,255,255,.4)":M,T=t.invokerEvent,U=t.calloutHeight,F=t.instrumentationId,H=void 0===F?"":F,R=t.shouldPreserveFocus,N=void 0===R||R,B=t.stayAsPopup,j=void 0!==B&&B,V=t.template,z=void 0===V?1:V,G=t.style,K=void 0===G?l.e.normal:G,W=t.focusOnPrimaryAction,q=void 0!==W&&W,Q=t.dismissOnEsc,Y=void 0!==Q&&Q;n.title=o.isObservable(a)?a:o.observable(a),n.titleAction=i,n.titleIcon=r,n.titleIconAriaLabel=s,n.customCssClasses=d,n.actions=p,n.component=m,n.control=_,n.isDismissable=b,n.isSoftDismissable=v,n.isDismissableOnResize=S,n.isDismissableOnScroll=I,n.size=C,n.automationId=O||"",n.executeDefaultAction=E,n.isCallout=!!A&&!!T,n.isOverlayHidden=k,n.overlayColor=P,n.invokerEvent=T,n.calloutHeight=U,n.instrumentationId=H,n.shouldPreserveFocus=o.isObservable(N)?N:o.observable(N),n.stayAsPopup=j,n.template=z,n.style=K,n.focusOnPrimaryAction=q,n.dismissOnEsc=Y,n.actions=n.actions.map(function(e){return o.utils.extend(new u,e)}),n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,a=n.actions;t<a.length;t++)a[t].isVisible()&&(e=!0);return e},{disposeWhen:function(){return 1!==n.state()}});var J=new c.e;return n.createComputed(function(){var e=n.state();1!==e&&(2===e?J.complete():J.cancel())}),n._promise=J.getPromise(),n.events.on(document,"keydown",n._keyDownEvent),n}return Object(a.__extends)(t,e),t.prototype.complete=function(){this.state(2)},t.prototype.dismiss=function(){this.state(3)},t.prototype.wait=function(){return this._promise},t.prototype._keyDownEvent=function(e){e.keyCode===d.e.escape&&this.dismissOnEsc&&this.state(3)},t}(i.default),p=n(2470),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogs=[],a.currentDialog=a.observables.create(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,a=new f(e);e.queueDialog?(t.push(a),1===t.length&&n(a)):(t.unshift(a),n(a));var i=function(){var e=t.indexOf(a);e>=0&&(t.splice(e,1),n(t[0])),a.dispose()};return a.wait().then(i,i),a},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{needsOverlayContent:p.e}),t}(i.default),_=Object(r.r)("DialogProvider",m)},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true"),n}return Object(a.__extends)(t,e),t}(n(2203).t);function r(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}return t&&t!==document.body||(t=window),t}t.e=i}],Array(16),[function(e,t,n){"use strict";var a;!function(e){e[e.multiple=0]="multiple",e[e.renameItems=1]="renameItems",e[e.deleteItems=2]="deleteItems",e[e.pointInTimeRestore=3]="pointInTimeRestore",e[e.restoreItems=4]="restoreItems",e[e.uploadItems=5]="uploadItems",e[e.moveItems=6]="moveItems",e[e.copyItems=7]="copyItems",e[e.rotateItems=8]="rotateItems",e[e.addItemsToAlbum=9]="addItemsToAlbum",e[e.addCoverPhotos=10]="addCoverPhotos",e[e.removeCoverPhotos=11]="removeCoverPhotos",e[e.createAlbumFromFolder=12]="createAlbumFromFolder",e[e.createColumn=13]="createColumn",e[e.editColumn=14]="editColumn",e[e.deleteColumn=15]="deleteColumn",e[e.checkInItem=16]="checkInItem",e[e.checkOutItem=17]="checkOutItem",e[e.undoCheckOutItem=18]="undoCheckOutItem",e[e.createFolder=19]="createFolder",e[e.updateBundle=20]="updateBundle",e[e.shareItem=21]="shareItem",e[e.reportAbuse=22]="reportAbuse",e[e.requestReview=23]="requestReview",e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto",e[e.createAlbum=25]="createAlbum",e[e.uploadVideos=26]="uploadVideos",e[e.saveItem=27]="saveItem",e[e.createItem=28]="createItem",e[e.publishItem=29]="publishItem",e[e.unPublishItem=30]="unPublishItem",e[e.applyOfficeLens=31]="applyOfficeLens",e[e.removeOfficeLens=32]="removeOfficeLens",e[e.updateMetadata=33]="updateMetadata",e[e.makeHomepage=34]="makeHomepage",e[e.triggerFlow=35]="triggerFlow",e[e.downloadAsZip=36]="downloadAsZip",e[e.saveAutoAlbum=37]="saveAutoAlbum",e[e.discardAutoAlbum=38]="discardAutoAlbum",e[e.addToOneDrive=39]="addToOneDrive",e[e.removeFromSharedList=40]="removeFromSharedList",e[e.setupApprovalFlow=41]="setupApprovalFlow",e[e.setupReminderFlow=42]="setupReminderFlow",e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore",e[e.sharingReport=44]="sharingReport",e[e.editViewColumns=45]="editViewColumns",e[e.runModelOnItems=46]="runModelOnItems",e[e.importModel=47]="importModel",e[e.downloadItem=48]="downloadItem",e[e.deleteSmartTemplate=49]="deleteSmartTemplate",e[e.publishSmartTemplate=50]="publishSmartTemplate",e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate",e[e.universalAnnotationSync=52]="universalAnnotationSync"}(a||(a={})),t.e=a},,,function(e,t,n){"use strict";var a=n(0),i=n(2203),r=n(4816),o=n("knockout-lib"),s=function(e){function t(t){var n=e.call(this,t)||this;new(n.managed(r.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var a=n._componentParentContent,i=n.valueAccessor(),s=function(e){return"object"==typeof e}(i)?i:{},c=s.data,d=void 0===c?n.bindingContext.$data:c,l=s.afterRender;return o.applyBindingsToNode(n.element,{template:{nodes:a.templateNodes,afterRender:l}},a.bindingContext.extend({$host:d,$hostContext:n.bindingContext})),n.controlsDescendantBindings=!0,n}return Object(a.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e},t.supportsVirtualElements=!0,t}(i.t);t.e=s},,,function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(2203),r=n(65),o=n(601),s=n(1195),c=n(1219),d=n("react-lib"),l=n("react-dom-lib"),u=n(66),f=n("knockout-lib"),p=n(323),m=n(2444),_=n(53),h=n(3284),b=n(97),g=n(822),v=n(629),y=n(3063),S=n(4420),D=new(function(){function e(){this._promises={}}return e.prototype.load=function(e){var t=e.path,n=e.getModule,a=window.require.toUrl("".concat(t,"_unmapped")),i=this._promises,c=i[a];c||(c=i[a]=r.n.as(Object(s.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[a]});var d=new o.e;return c.done(function(e){return d.complete(e)},function(e){return d.error(e)}),d.getPromise()},e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var a=t(e);if(a)if("object"==typeof a){if(Object.keys(a).length>0){var i=Object(c.e)(a);i&&(n=i)}}else n=a}return n},e}());function I(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,r=Object(a.__rest)(e,["applyBindings","bindingContext","children"]),o=d.useRef(null),s=Object(S.e)(),c=s[0],l=s[1],u=Object(y.t)({children:i}),p=d.useCallback(function(e){return d.createElement(d.Fragment,null,e.children)},[]),m=d.useRef(),_=d.useRef(!1);d.useEffect(function(){if(o.current&&t&&!_.current){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children"),o.current.appendChild(e)}var r=n||function(){var e=document.createElement("div");f.applyBindings({},e);var t=f.contextFor(e);return f.removeNode(e),t}(),s=t(o.current,r.extend(Object(a.__assign)({$react:c},i?{$data:{bindingHandlers:{react:x},Children:{componentType:p,props:u}}}:{})));m.current=function(){s&&s.dispose(),o.current&&f.cleanNode(o.current)}}},[]),d.useLayoutEffect(function(){return function(){_.current=!0;var e=m.current;e&&e()}},[]);var h=Object(v.e)(function(){return d.createElement("div",Object(a.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},r))},r);return d.createElement(d.Fragment,null,h,l)}var x=function(e){function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var a,i=n.observables;if(n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())}),n._value.peek().useDOMContext){var o=Object(g.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(a=f.contextFor(o))}else a=n.bindingContext;n._context=a&&a.$react,n._transcludedTemplateNodes=Array.prototype.slice.call(f.virtualElements.childNodes(n.element)),f.virtualElements.emptyNode(n.element),n._renderDependencies=n.createObservable(),n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)}),n._componentProps.equalityComparer=p.t,n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)}),n._rootProps.equalityComparer=p.t;var s=n.scope.attach(new m.e);return n.createComputed(function(){var e,t=n._value();if(function(e){return!!e.componentType}(t)){var a=n.observables.unwrap(t.componentType);n._componentNameForLogging=a.displayName||"",u.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=r.n.wrap(a)}else t.getModule||console.error("ReactBinding instantiated with componentPath ".concat(t.componentPath," but missing getModule")),n._componentNameForLogging=t.componentPath,u.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging)),e=D.load({path:t.componentPath,getModule:t.getModule});n.trackPromise(s.debounce(r.n.all({componentType:e}).then(function(e){u.n.mark("EUPL.ReactBinding.Loaded.".concat(n._componentNameForLogging));var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}}),n._renderDependencies(e)})))}),n.createComputed(n._computeRenderComponent),n}return Object(a.__extends)(t,e),t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),r=this._rootProps(),o=this._transcludedTemplateNodes;u.n.mark("EUPL.ReactBinding.AsyncRender.".concat(this._componentNameForLogging));try{this.observables.ignore(function(){var t=o.length>0?function(e,t){f.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,s=d.createElement(_.e,{resources:e.resources},d.createElement(h.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},d.createElement(n,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)({},i),t?{children:d.createElement(I,Object(a.__assign)({bindingContext:e.bindingContext,applyBindings:t},r||{}))}:{})))));e._context?e._context.render(s,e.element):l.render(s,e.element)})}catch(e){b.e.logError(e)}}},t}(i.t);t.t=x},,function(e,t,n){"use strict";var a;!function(e){e[e.created=0]="created",e[e.started=1]="started",e[e.completed=2]="completed",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.expired=5]="expired"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(2201),r=n(2262),o=function(e){function t(t,n){var i=e.call(this,t)||this,o=Object(a.__assign)(Object(a.__assign)({},t.props||{}),{hostViewModel:i});return i.addBindingHandlers({react:r.t}),i.reactBindingParams=Object(a.__assign)({props:o,error:t.error},function(e){return"string"==typeof e.component}(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component}),i}return Object(a.__extends)(t,e),t}(i.e);function s(e,t,n,i){return{tagName:e,template:'<div data-bind="react:reactBindingParams"></div>',viewModel:{createViewModel:function(e,r){return new(e.resources.injected(o))(Object(a.__assign)(Object(a.__assign)({},"string"==typeof t?{component:t,getComponentModule:n}:{component:t}),{error:e.reactRenderError,props:Object(a.__assign)(Object(a.__assign)({},i||{}),e)}),r)}},synchronous:!0}}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});var a=n(0),i=n(1214),r=n(3849),o=n(136),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?a.resources.consume(r.e):i;return a._itemCommandProvider=o,a}return Object(a.__extends)(t,e),t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)},t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,a=n&&n.getCommand(e,t);return a&&a.behavior},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCommandProvider:r.e}),t}(i.default);t.e=s;var c=Object(o.r)("ItemCommandHelper",s)},,function(e,t,n){"use strict";n.d(t,"t",function(){return I});var a=n(0),i=n(2718),r=n(232),o=n(681),s=n(10),c=n(136),d=n(507),l=n(996),u=n(265),f=n(4206),p=n(1368),m=n(40),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)});t.e=D},,,,,function(e,t,n){"use strict";var a=n(3050),i=n(2202),r=n(0),o=n(2201),s=n(2881),c=n(2230),d=n(2258),l=n(1214),u=n("knockout-lib"),f=function(e){function t(t){var n=e.call(this,{})||this,a=t.topTab,i=t.bottomTab,r=t.animation,o=void 0===r?{}:r,s=t.alignToParent,c=void 0===s?u.observable(!0):s,d=t.parentElement,l=t.isOpen;return n.topTab=a,n.bottomTab=i,n.animation=o,n.alignToParent=c,n.parentElement=d,n.isOpen=l,n}return Object(r.__extends)(t,e),t}(l.default),p=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var i=e.call(this,t,n)||this;i.transclusionContentTagName=a.e.tagName;var r=n.overlayProvider,o=void 0===r?i.resources.consume(s.e):r,l=t.animation,u=t.alignToParent,p=void 0!==u&&u,m=t.parentElement,_=t.virtualParentElement;return i.addBindingHandlers({host:d.e,element:c.e}),i.overlayProvider=o,i.topTab=i.createObservable(null),i.bottomTab=i.createObservable(null),i.isOpen=i.createObservable(!1),i.virtualParentElement=_,i.overlay=new f({alignToParent:i.wrapObservable(p),parentElement:m,animation:l,topTab:i.topTab,bottomTab:i.bottomTab,isOpen:i.isOpen}),i}return Object(r.__extends)(t,e),t}(o.e),m=i.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:bottomTab"></a>',viewModel:p,synchronous:!0});t.e=m},,,,,function(e,t,n){"use strict";var a=n(0),i=n(2213),r=n(2220),o=n(2221),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.item,s=n.getItemSelectionHelperType,c=void 0===s?a.resources.consume(o.e.lazy):s,d=n.itemParentHelper,l=void 0===d?a.resources.consume(r.e):d;return a.isItemSpecified=!!i,a.item=i||new(a.scope.attached(c()))({canFallback:!0,ignoreSelection:!0}).currentItem,a.itemParentHelper=l,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t.prototype.getParent=function(e,t,n){var a=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(a):this.unwrapObservable(a)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:r.e}),t}(i.e);t.e=s},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"OperationProvider",function(){return p}),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(1214),r=n(2264),o=n(2527),s=n(2255),c=n(4416),d=function(e){function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=i.create(r.e.created),n.warning=i.create(""),n.error=i.create(),n.count=i.create(1);var c=Object(a.__assign)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:i.create(c.minimum),maximum:i.create(c.maximum),current:i.create(c.current)},n.type=i.create(t.type||s.e.multiple),n.batch=t.batch||new o.e,n._initializeActions(t.actions),n.payloads=i.create(t.payloads||{}),n.visibility=i.create(t.visibility||0),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new c.e({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(i.default),l=n(5104),u=n(4417),f=n(136),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new o.e;a._observers=i.createArray();var s=a.operations=i.createArray(),c=a.scope.attached(l.e),d=a.groups=a.addDisposable(u.e.group(s,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(l.e))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(a.__extends)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new d(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(a.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],o=i.state.peek();if(o===r.e.completed||!e&&(o===r.e.expired||o===r.e.canceled||o===r.e.failed))for(var s=i.operations.peek(),c=void 0,d=0;d<s.length;d++){c=!0;var l=s[d];if(o===r.e.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(s[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(i.default),m=Object(f.r)("OperationProvider",p);t.default=p},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(2203),r=n(2419),o=n("knockout-lib"),s=n(239),c="InteractionScopeBinding_scope",d=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._parentScope=function(e){for(var t,n=e;!(t=o.utils.domData.get(n,c))&&n!==document.body&&Object(s.e)(n);)n=Object(s.e)(n);return n!==document.body&&t||void 0}(a.element);var i=a.valueAccessor(),d=i.isScope,l=void 0!==d&&d,u=i.isRoot,f=void 0!==u&&u;if(l){a._childScopes=o.observableArray(),a._hasFocus=o.observable(!1),a._isRoot=f,a._isActive=a.createPureComputed(a._computeIsActive,{deferEvaluation:!0}),a._isDescendantActive=a.createPureComputed(a._computeIsDescendantActive,{deferEvaluation:!0}),a._scope={isActive:a._isActive,isDescendantActive:a._isDescendantActive,isDescendantOrSelfActive:a.createComputed(a._computeIsDescendantOrSelfActive),register:function(e){return a._registerScope(e)},_owner:a},o.utils.domData.set(a.element,c,a._scope);var p=n.ChildFocusBinding,m=void 0===p?r.e:p;new(a.managed(m))({element:a.element,bindingContext:a.bindingContext,allBindingsAccessor:a.allBindingsAccessor,valueAccessor:function(){return a._hasFocus}}),a._parentScope&&a.addDisposable(a._parentScope.register(a._scope))}else a._parentScope?(a._isActive=a._parentScope.isActive,a._isDescendantActive=a._parentScope.isDescendantActive):(a._isActive=o.observable(!0),a._isDescendantActive=o.observable(!1));return i.isActive&&a.createComputed(function(){return i.isActive(a._isActive())}),i.isDescendantActive&&a.createComputed(function(){return i.isDescendantActive(a._isDescendantActive())}),a}return Object(a.__extends)(t,e),t.prototype._registerScope=function(e){var t=this;return this._childScopes.push(e),{dispose:function(){t._childScopes.remove(e)}}},t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t},t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t},t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++)n[t].isDescendantOrSelfActive()&&(e=!0);return e},t}(i.t);t.t=d},,,,,,,,,,function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(997),r=n(975),o=n(181),s=n(4209);function c(e,t,n){var a=r.e[t]&&r.e[t].iconType||"png",i=e&&"png"===a;return"".concat(s.a).concat(n).concat(i?"_2x":"","/").concat(t,".").concat(a)}function d(e,t,n){return c(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return d(e,i.n(t),n)}function u(e,t,n){return n&&n.vault&&n.vault.root?d(e,n.vault.isLocked?a.vaultClosed:a.vaultOpen,t):n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName?d(e,"samsunggallery",t):void 0}!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(a||(a={}))}],Array(14),[function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.text=t.text,n}return Object(a.__extends)(t,e),t}(n(2201).e),r=n(2202).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=r},,,,,,function(e,t,n){"use strict";var a=n(85);t.e=a.a}],Array(13),[function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(a||(a={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(i||(i={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(r||(r={}))},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return p});var a='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div><div aria-hidden="true"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(0),r=n(2201),o=n(100),s=n(2528),c=n(181),d=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.platformDetection,r=void 0===i?a.resources.consume(c.e):i;return a.areCSS3TransitionsSupported=r.areCSS3TransitionsSupported,a.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif"),a.loadingString=s.e,a}return Object(i.__extends)(t,e),t.resources=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{platformDetection:c.e,settingsDataSource:o.X}),t}(r.e),l=n(2202),u=n(2206),f=Object(l.e)({tagName:"ms-progressSpinnerFlat",template:a,viewModel:d,synchronous:!0}),p=Object(u.n)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:a,viewModelType:d});t.e=f}],Array(16),[function(e,t,n){"use strict";n.r(t),n.d(t,"ItemTaskObserver",function(){return u}),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(1214),r=n(2299);n.d(t,"Task",function(){return r.e});var o=n(2718),s=n(2269),c=n(1368);n.d(t,"Graft",function(){return c});var d=n(10),l=n(136),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.t):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.__extends)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.__rest)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemsStore:s.t}),t}(i.default),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.default=u}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(1214),r=n(232),o=n(114),s=n(136),c=n(100),d=n(97),l=n(2640),u=n(40),f=n(2015),p=n(15),m=n(65);function _(e,t){return e.preferences[(t||"").toLowerCase()]}function h(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function b(e,t,n,i){var r=_(e,t);if(r)for(var o=0,s=Object(a.__spreadArray)(Object(a.__spreadArray)([],r.preview,!0),r.open,!0).filter(g);o<s.length;o++){var c=s[o],d=n&&c[n]||i&&c.handler[i];if(d)return d}}function g(e){return!e.handler.isPromoted}function v(e){return e.filter(g)[0]}var y=function(e){function t(t,n){var a,i=e.call(this,t,n)||this,s=Object(u.isFeatureEnabled)(u.FileHandlersV2),l="data",_=new r.e("FileHandlers",o.e.session);if(s)try{var h=_.getValue(l);a=h&&JSON.parse(h)}catch(e){}var b=i.observables,g=i.data=b.create(a);return g.equalityComparer=f.e,a&&4===a.version&&s||(g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4}),_.setValue(l,JSON.stringify(g.peek()))),s&&b.backgroundCompute(function(){i.trackPromise(m.n.resolve(i.resources.consumeAsync(c.m.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(c.p.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){e&&(_.setValue(l,JSON.stringify(e)),g(e))},function(e){d.e.logError(e)}))}),i}return Object(a.__extends)(t,e),t.prototype.getFileTypeIconUrl=function(e,t){return h(e)?this.getIconUrl(b(this._getData(t),e||"","icon","fileTypeIcon")):void 0},t.prototype.getFileTypeName=function(e,t){return h(e)?b(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0},t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)},t.prototype.getDefaultOpenHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.open)},t.prototype.getDefaultPreviewHandler=function(e,t){var n=_(this._getData(t),e||"");return n&&v(n.preview)},t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,a=n&&n.extensions;return!!n&&(!a||a.indexOf(t.toLowerCase())>=0||a.indexOf(".*")>=0)},t.prototype._getData=function(e){return e?this.data.peek():this.data()},t}(i.default),S=Object(s.r)("FileHandlerProvider",y)},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(51),i=n(429),r=n(206),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new r.e(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),r=e.message.value;n.error={code:i,message:r}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var r=1;r<n.length;r++)(a=n[r].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,n){var a,i,r,o,s=[],c=!1;if(e&&e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var d=1;d<i.length;d++)if((r=i[d].split("\n\r")).length>2){try{o=JSON.parse(r[2])}catch(e){o=r[2]}var l=t&&t[d-1],u=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var f=o.code?o.code.split(","):o.error.code.split(","),p=Number(f[0]),m=o.message.value;u.error={code:p,message:m},c=!0}s.push(u)}}return{items:s,hasError:c}},e.getBatchContent=function(e,t,n,i){for(var r=[],o=0;o<t.length;o++){for(var s=t[o],c=a.e.generate(),d=[],l=0;l<s.length;l++){var u=s[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(n+" "+u+" HTTP/1.1"),d.push(i),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");r.push("--batch_"+e),r.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),r.push("Content-Length: "+f.length),r.push("Content-Transfer-Encoding: binary"),r.push(""),r.push(f),r.push("")}return r.push("--batch_"+e+"--"),r.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,r,o,s){var c=a.e.generate(),d=[];r&&r.length!==t.length&&(r=null);for(var l=0;l<t.length;l++){var u=t[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),s?d.push(s[l]+" "+u+" HTTP/1.1"):d.push(n+" "+u+" HTTP/1.1"),d.push(i),o&&d.push(o),r&&(d.push(""),d.push(r[l])),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");return(d=[]).push("--batch_"+e),d.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),d.push("Content-Length: "+f.length),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(f),d.push(""),d.push("--batch_"+e+"--"),d.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.t=o},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(2213),r=n(83),o=n(1214),s=n(65),c=n(601),d=n(1195),l=n(4216),u=function(e){function t(t){var n=e.call(this,t)||this,a=t.state,i=t.source,r=t.useToggleBehavior,o=t.useGlobalResources,c=t.getParams;if(function(e){return!!e.moduleDefinition}(i)){var u=i.moduleDefinition;n._getComponentDefinition=function(){return Object(d.e)(u)}}else{var f=i.component;n._getComponentDefinition=function(){return s.n.wrap(f)}}return n._useToggleBehavior=r,n._state=a,n._getParams=c,n._action=n.createObservable(),n._hiddenDomProvider=n.resources.consume(l.e),n._useGlobalResources=o,n.isAvailable=n.createPureComputed(n._computeIsAvailable),n.isToggled=n.createPureComputed(n._computeIsToggled),n}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i)return i.cancel(),s.n.wrap()}var r=new c.e,o={complete:function(){r.complete()},fail:function(e){r.error(e)},cancel:function(){r.cancel()}};return this._useToggleBehavior&&this._action(o),s.n.as(this._getParams()).then(function(i){return n._getComponentDefinition().then(function(s){return t=n._hiddenDomProvider.requestControl({name:s.tagName,params:Object(a.__assign)(Object(a.__assign)({action:o,event:e},i||{}),n._useGlobalResources?{}:{resources:n.resources})}),r.getPromise()})}).then(function(){t&&n._hiddenDomProvider.disposeControl(t),n._action.peek()===o&&n._action(void 0)},function(e){return t&&n._hiddenDomProvider.disposeControl(t),n._action.peek()===o&&n._action(void 0),s.n.wrapError(e)})},t.prototype._computeIsAvailable=function(){return this._state().isAvailable},t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()},t}(o.default),f=function(e){function t(t){var n=e.call(this,t)||this,a=t.name,i=t.source,r=t.handlerType,o=t.actionParams,s=t.useToggleBehavior,c=void 0!==s&&s,d=t.useGlobalResources;n.name=a;var l=r?new(n.managed(r))(o):void 0,f=l&&l.state||n.createObservable({isAvailable:!0}),p=l&&l.getParams?function(){return l.getParams()}:function(){};return n._controlExecutorLoader=new(n.managed(u))({source:i,state:f,useToggleBehavior:c,useGlobalResources:d,getParams:p}),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()},t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()},t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:r.e.Success}})},t}(i.e);function p(e){var t=e.name,n=e.source,i=e.useToggleBehavior,r=e.handlerType,o=e.useGlobalResources,s=void 0!==o&&o;return function(e){function o(a){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:a,handlerType:r,useGlobalResources:s})||this}return Object(a.__extends)(o,e),o}(f)}},,,function(e,t,n){"use strict";var a=n(4210);t.e=a.e},,,,,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(35).e);t.e=i},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return C});var a=n(0),i=n(2342),r=n(172),o=n(225),s=n(51),c=n(1363),d=n(2261),l=n(65),u=n(3361),f=n(751),p=n(398),m=n(3725),_=n(1224),h=n(678),b=n(15),g=n(2790),v=n(93),y=n(138),S=n(83),D={ODB:60307},I=!b.t.isActivated("9e533ba5-9804-4d07-b199-3c62f8065367","04/05/2022","enable substrate search for spo search")&&!o.n.isFeatureEnabled({ECS:1009981}),x=!b.t.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!o.n.isFeatureEnabled({ECS:1026572}),C=function(e){function t(t,n){var a=this,i=O(t)?t:n.pageContext;a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i})||this;var r=O(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=r||new f.e({},{itemUrlHelper:new p.e({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(a.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=Object(r.c)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===d.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.e.externalUser?(s.isResolved=!1,s.entityType=i.e.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.e.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.e.group,s.principalType=d.e.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new _.t({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(I&&0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),l.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:r,authToken:a,parseResponse:function(a){var r=t.allowSharePointGroups,o=void 0===r||r,s=t.filterExternalUsers,c=JSON.parse(a),l=JSON.parse(c.d.ClientPeoplePickerSearchUser),u=n._transformData(l,s);return s&&(u=u.filter(function(e){return e.entityType!==i.e.externalUser})),u=u.filter(function(e){return e.principalType===d.e.sharePointGroup?o:e.principalType===d.e.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(u,e,t,i.t.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){var o;if(!r)return a.sharePointSearch(e,n);var s=x&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(o=a._pageContext)||void 0===o?void 0:o.msGraphEndpointUrl:"https://graph.microsoft.com",c=new v.t("".concat(s,"/v1.0/me/people"));if(e)if(c.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),b.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&c.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var l=t._getPersonTypeFilter(n);l&&c.setQueryParameter("$filter",l)}var u=new y.e({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:c.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)u.end({resultType:S.e.Success});else if(u.end({resultType:S.e.Failure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var r=t.value,o=[];return r.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",s=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:r,c={Key:s,IsResolved:!1},l="ImplicitContact"===e.personType.subclass,u="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,p="PublicDistributionList"===e.personType.subclass,_=Object(m.n)(a._webAbsoluteUrl,r);p&&(t=i.n.PublicDistributionList),f&&(t=i.n.unified);var h={department:e.department,email:r,image:l?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||r,name:e.displayName,providerName:u?"Provider":void 0,userId:s,rawData:c,rawPersonData:c,isExternal:!u,aadObjectId:e.id,fromDataSource:i.t.graph,detailedGroupInfo:t};u?(h.entityType=i.e.regularUser,h.principalType=d.e.user,h.isResolved=!0):f?(h.entityType=i.e.group,h.principalType=d.e.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=p?d.e.distributionList:d.e.none,h.entityType="Group"===e.personType.class?i.e.group:i.e.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&o.push(h)}}),a._handleZeroSearchResult(o,e,n,i.t.graph)},function(t){if(u.end({resultType:S.e.Failure,extraData:{error:t}}),Object(h.r)(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var r=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(r=t.siteIBSegmentIDs);var c=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+a},f="";if(o.n.isFeatureEnabled(D)){var p=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],_=s.e.isValidGuid(e),g={Or:p.map(function(e){return{Term:{PeopleSubtype:e}}})},v=r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,I=_?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,x=r||_?_?r?{And:[g,v,I]}:{And:[g,I]}:{And:[g,v]}:g;f=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:_?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:x}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}else f=o.n.isFeatureEnabled(D)&&!b.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:c,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:r?{Or:r.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});var C=new y.e({name:"PeoplePickerSubstrateSearch"});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.e+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:f}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var r=a.Groups[0]?a.Groups[0].Suggestions:[];if(0===r.length){if(C.end({resultType:S.e.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else C.end({resultType:S.e.Success});var o=[];return r.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a=e.EmailAddresses[0]||e.QueryText||"",r=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:a;t.useNew3Ssearch&&!r&&e.Id&&e.Id.indexOf("@")&&(r=e.Id.substring(0,e.Id.indexOf("@")));var s,c={Key:r,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,u="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,p="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,_="PublicDistributionList"===e.PeopleSubtype,h=Object(m.n)(n._webAbsoluteUrl,a);_&&(s=i.n.PublicDistributionList),p&&(s=i.n.unified);var b={department:e.Department,office:e.OfficeLocation,email:a,image:l?void 0:h,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||a,name:e.DisplayName,providerName:"Provider",userId:r,rawData:c,rawPersonData:c,isExternal:!u,detailedGroupInfo:s};u?(b.entityType=i.e.regularUser,b.principalType=d.e.user,b.isResolved=!0):p?(b.entityType=i.e.group,b.principalType=d.e.securityGroup,b.isResolved=!1,b.providerName=void 0):f?b.entityType=i.e.linkedinUser:(b.principalType=_?d.e.distributionList:d.e.none,b.entityType="Group"===e.PeopleType?i.e.group:i.e.externalUser,b.isResolved=!1,b.providerName=void 0),b.userId&&o.push(b)}}),n._handleZeroSearchResult(o,e,t,i.t.substrate)},function(a){if(C.end({resultType:S.e.Failure,extraData:{error:a}}),Object(h.r)(a))switch(a.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.e.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&g.e.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&d.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&d.e.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&d.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!b.t.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.e.externalUser})));var o=r.email;r.isResolved&&(r.image=o?Object(m.n)(n._webAbsoluteUrl,o):null);var s=a.PrincipalType||e.EntityType;switch(s){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.e.externalUser,r.principalType=d.e.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!b.t.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==s){r.entityType=i.e.group,r.principalType="SharePointGroup"===s?d.e.sharePointGroup:d.e.securityGroup,r.detailedGroupInfo="SharePointGroup"===s?i.n.SPGroup:i.n.securityGroup;break}default:r.entityType=i.e.regularUser,r.principalType=d.e.user}return r})},t}(c.t);function O(e){return!!e.webAbsoluteUrl}},,,function(e,t,n){"use strict";var a=n(0),i=n(427),r=n(2203),o=n(2477),s=function(e){function t(t){var n,a,i,r=e.call(this,t)||this,s=t.valueAccessor();!function(e){return"object"==typeof e}(s)?i=s:(n=s.isBodyActive,a=s.activeElement,i=s.isDescendantOrSelfActive),r._focusTracker=r.resources.consume(o.e);var c=r.observables;if(i){var d=c.pureCompute(r._computeIsDescendantOrSelfActive);c.compute(function(){i(d())}).extend({deferred:!0})}if(n){var l=c.pureCompute(r._computeIsBodyActive);c.compute(function(){n(l())}).extend({deferred:!0})}if(a){var u=c.pureCompute(r._computeActiveElement);c.compute(function(){a(u())}).extend({deferred:!0})}return r}return Object(a.__extends)(t,e),t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(i.e)(e,t))},t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body},t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()},t}(r.t);t.e=s},,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"createItemsScopeActionFromKnockout",function(){return l});var a=n(0),i=(n(4412),n("react-lib")),r=n(21),o=n(53),s=n(3063),c=n(4413),d=n(1261);function l(e,t){return void 0===t&&(t={}),function(n){var a=n.itemKey;return i.createElement(c.e,{itemKey:a},i.createElement(u,{createKnockoutAction:e,options:t,actionProps:n}))}}function u(e){var t=this,n=e.createKnockoutAction,c=e.options,l=e.actionProps,u=c.isToggleable,f=void 0!==u&&u,p=c.isExecutorOnly,m=void 0!==p&&p,_=Object(o.n)(),h=Object(d.e)(function(){return n(_,l)},[]),b=Object(s.n)(!!m||h.isAvailable),g=Object(s.n)(f?h.isToggled:void 0);return i.createElement(r.e,{isAvailable:b,onExecute:function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,h.execute(e.event)];case 1:return t.sent(),[2]}})})},isToggled:g})}},,function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.htmlFileUpload=1]="htmlFileUpload",e[e.folderUpload=2]="folderUpload",e[e.downlevelUpload=3]="downlevelUpload",e[e.silverlightUpload=4]="silverlightUpload"}(a||(a={})),t.e=a},,,,,,,,,,,function(e,t,n){"use strict";var a,i=n(0),r=n(2203),o=n(1214),s=n(601),c=n(136),d=n(1464),l=n(2810),u=n(1194),f=n(46),p=n(138);!function(e){e[e.none=0]="none",e[e.queue=1]="queue",e[e.server=2]="server"}(a||(a={}));var m=a,_=Object(u.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:a,type:f.e.Enum}},p.e),h=n(83),b=n(4419),g=n(35),v=!n(15).t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),y=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._semaphore=new l.e(16),a._thumbnailCache=n.thumbnailCache,a}return Object(i.__extends)(t,e),t.prototype.loadImage=function(e){var t=this,n=e.url,a=e.imageElement,i=void 0===a?document.createElement("img"):a,r=e.scenarioName,o=e.getContents,s={url:n,width:0,height:0},c=this._thumbnailCache,l=c.isLoaded(s),u=function(e){return d.e.authenticate(e).then(function(){return t._waitForImageLoad(i,e,r)}).then(function(e){if(c.record(s),i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return v&&o?this.trackPromise(o(void 0,n).then(function(e){var n=URL.createObjectURL(e);return l?u(n):t._semaphore.enqueue(function(){return u(n)})})):l?u(n):this._semaphore.enqueue(function(){return u(n)})},t.prototype._waitForImageLoad=function(e,t,n){var a,i,r,o=this.async,c=this.events,d=function(){r&&o.clearTimeout(r),c.off(e)},l=new s.e(function(){d(),e.setAttribute("src",""),t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),u=t&&t.indexOf("&encodeFailures=1")>=0;return c.onAll(e,{load:function(){if(d(),u&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?h.e.ExpectedFailure:h.e.Failure,resultCode:"".concat(t),error:"Encoded failure"}),l.error(new g.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else i&&i.end({resultType:h.e.Success}),l.complete(a)},error:function(){d(),i&&i.end({resultType:h.e.Failure}),l.error(new Error("Image '".concat(t,"' failed to load")))}}),r=o.setTimeout(function(){l.cancel()},3e4),n&&(i=new _({name:n,loadType:m.server})),e.setAttribute("src",t),a=!!e.complete,this.trackPromise(l.getPromise())},t.prototype._waitForTimeout=function(e){var t,n=this.async,a=new s.e(function(){t&&n.clearTimeout(t)});return t=n.setTimeout(function(){a.complete()},e),a.getPromise()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.default.dependencies),{thumbnailCache:b.e}),t}(o.default),S=Object(c.r)("ImageLoader",y),D=n(2444),I=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._debouncer=new D.e,a._imageLoader=a.resources.consume(S);var i=a.valueAccessor(),r=i.src,o=i.image,s=i.error,c=i.isLoaded,d=i.isError,l=i.actualSize,u=i.scenarioName,f=i.getContents;a._src=a.wrapObservable(r),a._image=a.wrapObservable(o),a._error=a.wrapObservable(s),a._scenarioName=u,a._getContents=f;var p=n.outputExtenders,m=void 0===p?{deferred:!0}:p;return a.createComputed(a._computeLoadImage),a.createBackgroundComputed(function(){var e=a._image();if(c&&c(!!e),l){var t=void 0;e&&(t={width:e.width,height:e.height}),l(t)}o&&o(e)}).extend(m),a.createBackgroundComputed(function(){var e=a._error();s&&s(e),d&&d(!!e)}).extend(m),a}return Object(i.__extends)(t,e),t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),a=this.unwrapObservable(this._getContents);this._image(void 0),this._scenarioName&&(e=new _({name:this._scenarioName,loadType:m.queue})),this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,getContents:a}))).then(function(n){t._image(n),t._error(void 0),e&&e.end({resultType:h.e.Success})},function(n){t._error(n),e&&e.end({resultType:n.isExpected?h.e.ExpectedFailure:h.e.Failure})})},t}(r.t);t.e=I},,,function(e,t,n){"use strict";var a=n(601),i=function(){function e(){}return e.prototype.debounce=function(e){var t=this;this.clear(),this._originalPromise=e;var n=new a.e(function(){return t._originalPromise.cancel()});return this._originalPromise.done(function(e){t._clear(!1),n.complete(e)},function(e){t._clear(!1),n.error(e)}),n.getPromise()},e.prototype.clear=function(){this._clear(!0)},e.prototype.isExecuting=function(){return Boolean(this._originalPromise)},e.prototype._clear=function(e){this.isExecuting()&&(e&&this._originalPromise.cancel(),this._originalPromise=null)},e}();t.e=i},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},,,,function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},,,,,,function(e,t,n){"use strict";var a=n(0),i=n(435),r=n(2203),o=n(3356),s=n(3285),c=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(i.D.optional);return a?(n.teachingBubbleProvider=a,n._value=n.valueAccessor(),n._firstRunExperienceStatus=n.resources.consume(o.e),n._firstRunExperienceStatusKO=n.observables.create(n._firstRunExperienceStatus.get()),n._firstRunExperienceStatus.subscribe(function(){n._firstRunExperienceStatusKO(n._firstRunExperienceStatus.get())}),n.createBackgroundComputed(n._computeAddTeachingBubble),n):n}return Object(a.__extends)(t,e),t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign);this._firstRunExperienceStatusKO()===s.e.notVisible&&t&&(this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.get()&&this.teachingBubbleProvider.currentBubble.get().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble(),this._campaign=t,this.teachingBubbleProvider.addBubble({bubble:t,element:this.element}))}},t}(r.t);t.e=c},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(1457),r=new a.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new i.e(!1)}}}}})},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(1214),r=n(996),o=n(136),s=n(181),c=n(15),d=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a.observables;a._activeElement=i.create({}),a.activeElement=i.pureCompute(a._computeActiveElement),a.activeElement.equalityComparer=r.n,a.isWindowActive=i.create(!0),a._isWithinWindowBlur=!1,a._platform=n.platFormDetection;var o=a.async.throttle(function(){a._activeElement({})},350),s=a._platform&&a._platform.isEdge,c=a._platform&&a._platform.isIE;if(s||c){var d=new MutationObserver(o);d.observe(document.body,{childList:!0,subtree:!0}),a.scope.attach({dispose:function(){d&&d.disconnect()}})}return a.events.onAll(window,{focus:a._onWindowFocus,blur:a._onWindowBlur},!1),a.events.onAll(document.body,{focus:a._onDocumentFocus,blur:a._onDocumentBlur},!0),a}return Object(a.__extends)(t,e),t.prototype._computeActiveElement=function(){return this._activeElement(),document.activeElement},t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout),this._isWithinWindowBlur=!1,this.isWindowActive(!0)},t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout),window.__debugFocus&&console.log("[focus] active:",t),this._activeElement({})}},t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0,this.isWindowActive(!1),this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)},t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout),n&&n!==document.body?(window.__debugFocus&&console.log("[focus] blur:",n),this._activeElement({})):(window.__debugFocus&&console.log("[focus] wait:",n),this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] then blur:",document.activeElement,"from",n),t._activeElement({})},c.e.isActivated("759ADC51-E16E-4AA6-9DBD-E84CF7AACBA5","10/24/2022","Add grace period for detecting body focus")?0:10))}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{platFormDetection:s.e}),t}(i.default),l=Object(o.r)("FocusTracker",d,Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{platFormDetection:s.e}))},function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(0),i=n("knockout-lib"),r=n(38),o=n(1214),s=function(){function e(){}return e.Search="Search",e}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBuckets=function(){return t.getBuckets(this.resources)},t.getBuckets=function(e){return e&&e.isExposed(r.d)?e.consume(r.d):i.observable([])},t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)},t.getLoggingContextData=function(e){var n=null;return e&&e.isExposed(r.c)&&(n=e.consume(r.c)),n?n.get(t.getBuckets(e).peek()):{}},t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)},t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(r.d)&&(n=e.consume(r.d).peek()),t.forEach(function(e){n.indexOf(e)<0&&n.push(e)}),e.isExposed(r.d)||e.expose(r.d,i.observable(n))}},t}(o.default)}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"p",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"d",function(){return h}),n.d(t,"u",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"m",function(){return v});var a=n(40),i=n(4439),r="ms-albums-list",o=Object(a.isFeatureEnabled)(a.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list",s="ms-grid-customlist",c="ms-details-customlist",d="ms-details-list",l="ms-compact-details-list",u=Object(a.isFeatureEnabled)(a.UseTilesList)?"od-tiles-list":"ms-grid-list",f="ms-single-album-list",p="od-tag-grid",m="od-tags-list",_="od-doccard-grid",h="od-shared-grid-list",b="od-sites-grid-list",g={"ms-albums-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(397)]).then(n.bind(null,5477))}),"od-tiles-list":Object(i.e)(function(){return n.e(410).then(n.bind(null,5482))}),"ms-all-photos-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(398)]).then(n.bind(null,5478))}),"ms-grid-customlist":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(400)]).then(n.bind(null,5472))}),"ms-details-customlist":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(401)]).then(n.bind(null,5319))}),"ms-details-list":Object(i.e)(function(){return n.e(402).then(n.bind(null,3666))}),"ms-compact-details-list":Object(i.e)(function(){return n.e(399).then(n.bind(null,3991))}),"ms-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(404)]).then(n.bind(null,4184))}),"ms-single-album-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(406)]).then(n.bind(null,5491))}),"od-tag-grid":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(408)]).then(n.bind(null,5479))}),"od-tags-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(409)]).then(n.bind(null,5467))}),"od-doccard-grid":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(403)]).then(n.bind(null,5492))}),"od-shared-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(405)]).then(n.bind(null,5493))}),"od-sites-grid-list":Object(i.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(407)]).then(n.bind(null,5473))})};function v(e,t){var n=t&&t.isCustomList,a=t&&t.isPlaceholder;switch(e){case r:return r;case o:return o;case s:case"ms-grid-list":case"od-tiles-list":case u:return a?e:n?s:u;case c:case d:return a?e:n?c:d;case l:return l;case f:return f;case p:return p;case m:return m;case _:return _;case h:return h;case b:return b;default:return n?c:d}}},,,function(e,t,n){"use strict";var a=n(2202),i=n(0),r=n(2201),o=n(2855),s=n(23),c=n(4419),d=n(2689),l=n(2015);function u(e,t){return e===t||!e&&!t||!(!e||!t)&&e.url===t.url}n(1822);var f=n(1214),p=n(4147),m=function(e){function t(t){var n=e.call(this,t)||this,a=t.hasAnimated,i=t.fadeIn,r=t.image,o=t.referenceImage,s=t.referenceRotation;return n._fadeIn=i,n._image=r,n._referenceImage=o,n._referenceRotation=s,n.isLoaded=n.createObservable(!1),n._hasAnimated=n._getHasAnimated(),n.rotation=n.createPureComputed(n._computeRotation),n.createBackgroundComputed(function(){return a(n._hasAnimated())}),n}return Object(i.__extends)(t,e),t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;return e.isLoaded.peek()?(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50):(e.isLoaded(),n=!1),n})},t.prototype._computeRotation=function(){var e=this.rotation.peek();return(u(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation()),e},t}(f.default),_=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageTileTagName=p.e.tagName;var i=t.image,r=t.rotation,o=t.desiredSize,s=t.scale,c=void 0===s?1:s,d=t.fadeIn,f=void 0===d||d,_=t.allowLoading,h=void 0===_||_,b=t.isLoaded,g=t.isCurrent,v=t.alignment,y=t.position,S=t.loadedImage,D=t.error,I=t.loadImageScenarioName,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x,O=n.AnimationTracker,w=void 0===O?m:O;return a._animationTrackerType=w,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(r),a._desiredSize=o,a._scale=c,a.fadeIn=a.wrapObservable(f),a._allowLoading=a.wrapObservable(h),a._alignment=v,a._scenarioName=I,a._tileDefinitions=a.createPureComputed(a._computeTileDefinitions),a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=l.e,a._loadedImage=a.createPureComputed(a._computeLoadedImage),a._loadedImage.equalityComparer=u,a._error=a.createPureComputed(a._computeError),a._error.equalityComparer=l.e,a.tiles=a._getTiles(),y&&a.createBackgroundComputed(function(){return y(a._position())}).extend(C),S&&a.createBackgroundComputed(function(){return S(a._loadedImage())}).extend(C),b&&a.createBackgroundComputed(function(){return b(!!a._loadedImage())}).extend(C),g&&a.createBackgroundComputed(function(){return g(u(a._loadedImage(),a._image()))}).extend(C),D&&a.createBackgroundComputed(function(){return D(a._error())}).extend(C),a}return Object(i.__extends)(t,e),t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.error;if(i())break;if(r()){e=r();break}}return e},t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.position;if(i()){e=r();break}}return e},t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var a=t[n],i=a.isLoaded,r=a.image;if(i()){e=this.unwrapObservable(r);break}}return e},t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var a=void 0,r=void 0,o=void 0,s=n[n.length-1];s?(a=u(s.image,e),r=s.hasAnimated.peek(),o=!!s.error.peek()):(a=!1,r=!1),a?r?n=[s]:s.hasAnimated():((!s||r||o)&&(s={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)},n=Object(i.__spreadArray)(Object(i.__spreadArray)([],n,!0),[s],!1)),s.hasAnimated(),s.error())}}else n=[];return n},t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,a=t.error,i=t.hasAnimated,r=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:r.rotation,isLoaded:r.isLoaded,error:a,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){r.dispose()}}}}));return this.createBackgroundComputed(function(){t.splice.apply(t,Object(i.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))}),n},t}(r.e),h=Object(a.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:_,synchronous:!0}),b=n(15),g=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.imageStackTagName=h.tagName;var i=t.image,r=t.rotation,s=void 0===r?o.e.none:r,f=t.alignment,p=t.desiredSize,m=t.isLoaded,_=t.isCurrent,b=t.error,g=t.coverage,v=void 0===g?{minimum:1,maximum:1}:g,y=t.scale,S=t.fadeIn,D=t.allowLoading,I=t.position,x=t.loadImageScenarioName,C=n.thumbnailCache,O=void 0===C?a.resources.consume(c.e):C,w=n.outputExtenders,E=void 0===w?{deferred:!0}:w;return a._thumbnailCache=O,a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(s),a._alignment=d.n(f),a._desiredSize=a.wrapObservable(p),a._isLoaded=m,a._coverage=a.wrapObservable(v),a._loadedImage=a.createObservable(),a._effectiveDesiredSize=a.createPureComputed(a._computeEffectiveDesiredSize),a._effectiveDesiredSize.equalityComparer=l.e,a._idealSize=a.createPureComputed(a._computeIdealSize),a._idealSize.equalityComparer=l.e,a._idealImage=a.createPureComputed(a._computeIdealImage),a._idealImage.equalityComparer=u,a._fallbackImage=a.createPureComputed(a._computeFallbackImage),a._fallbackImage.equalityComparer=u,a._cachedImage=a.createPureComputed(a._computeCachedImage),a._cachedImage.equalityComparer=u,a._currentImage=a.createPureComputed(a._computeCurrentImage),a._currentImage.equalityComparer=u,a._isCurrent=a.createPureComputed(a._computeIsCurrent),a.imageStackParams={image:a._currentImage,rotation:a._rotation,desiredSize:a._desiredSize,loadedImage:a._loadedImage,isLoaded:a._isLoaded,error:b,scale:y,alignment:a._alignment,fadeIn:S,allowLoading:D,position:I,loadImageScenarioName:x},_&&a.createBackgroundComputed(function(){return _(a._isCurrent())}).extend(E),a}return Object(i.__extends)(t,e),t.prototype._computeIsCurrent=function(){return u(this._loadedImage(),this._idealImage())},t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),a=this._fallbackImage();return e?u(e,t)?this._currentImage.peek():t:n||a||t},t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;return t&&(e={width:t.width*n,height:t.height*n}),e},t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,a=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&a){var r=this._alignment.getTransform(t,i);e={width:r.scale*t.width,height:r.scale*t.height}}}else e={width:n,height:a}}return e},t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();return t&&(n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t,b.t.isActivated("0ECA92CE-9CE8-41A7-8AEA-ED7D0D862836","10/08/2022","fix secure thumbnail link and meta throttling issue")||(e=Object(i.__assign)(Object(i.__assign)({},t),e))),e},t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=(this._coverage()||{}).fallback,i=void 0===a?0:a;if(i){var r={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,r))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,r,!1)}}return e},t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var a=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},r=i.minimum,o=void 0===r?1:r,s=i.maximum,c=o*a,d=(void 0===s?1:s)*a;e=this._thumbnailCache.retrieve(t,d,c)}return e},t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:s.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}},t}(r.e),v=Object(a.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:g,synchronous:!0});t.e=v},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(271),i=n(136),r=n(1214),o=n(857),s=n(428),c=n(996),d=n(934),l={itemCacheStore:o.e,observablesFactoryType:r.observablesFactoryTypeResourceKey,asyncType:r.asyncTypeResourceKey},u=function(){function e(e,t){void 0===e&&(e={});var n=this._scope=new s.e,i=t.itemCacheStore;this._observables=n.attach(new t.observablesFactoryType({owner:this})),this._async=n.attach(new t.asyncType(this)),this._itemCacheEvaluator=i.dispatch(a.t)}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.pureCompute=function(e,t){void 0===t&&(t={});var n=t.suppressGetItems,a=void 0!==n&&n,i=t.evaluationContext,r=this._observables,o=this._itemCacheEvaluator,l=this._scope.attach(new s.e),u=l.attach(r.create()),f=!0,p=function(t){return f?r.ignore(function(){return e(t,{})}):e(t,{})};p.selector=e;var m=o.createItemCacheSelector(p,{suppressGetItems:a,evaluationContext:i}),_=l.attach(r.pureCompute(function(){m.markAsChanged(),f=!1;var e=m.get();return f=!0,e}));_.equalityComparer=c.n,u(m.get()),m.subscribe(function(){u(m.get()),m.registerDemands()});var h=l.attach(r.pureCompute(function(){return _(),u(),m.get()}));return h.equalityComparer=c.n,this._async.setImmediate(function(){m.registerDemands()}),l.attach({dispose:function(){m.dispose()}}),Object(d.e)(h,function(){l.dispose()})},e}(),f=Object(i.r)("ItemCacheObservable.new",u,l)},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n("knockout-lib"),i="__automationBinding$elements";function r(e,t){var n=e[i];return n&&n[t]}t.e={init:function(e,t,n,r,o){if(a.applyBindingsToNode(e,{attr:{"data-automationId":t()}},o),o){var s=o.$component;if(s){var c=a.utils.unwrapObservable(t());if(c){var d=s[i];d||(d=s[i]={}),d[c]=e,a.utils.domNodeDisposal.addDisposeCallback(e,function(){d[c]&&delete d[c]})}}}}}}],Array(18),[function(e,t,n){"use strict";var a=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(2722),i=new a.e("Item",a.t.subject)},,,,,,,function(e,t,n){"use strict";var a=n("knockout-lib"),i=n(3357),r=function(){function e(){this.handlers=[]}return e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})},e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){var a=this.handlers[n].callback.call(this,e,t);return"boolean"!=typeof a||a}return!1},e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0},e}(),o=r,s=n(204),c=n(134),d=function(){function e(){}return e.init=function(t,n,r,o,c){var d,l=a.utils.unwrapObservable(n()),u=r(),f=new s.t(null),p={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},m=l.selectionModel||new i.e;d=l.data?l.data:u.foreach&&u.foreach.data||u.foreach||u.template&&u.template.foreach,m.items=a.isObservable(d)?d:a.observableArray(d),m.rootElement=a.observable(t),l?(m.focused=l.focused||a.observable(null),m.anchor=l.anchor||a.observable(null),m.layout=l.layout||a.observable(null),m.toggleClass=m.layout()?m.layout().getToggleClass():l.toggleClass||null,m.clearSelectionOnRemoval=l.clearSelectionOnRemoval,m.selectFirstItemOnActivate="boolean"!=typeof l.selectFirstItemOnActivate||l.selectFirstItemOnActivate,a.isObservable(l.mode)?m.mode=l.mode:m.mode=a.observable(l.mode||p.mode),a.isObservable(l.direction)?m.direction=l.direction:m.direction=a.observable(l.direction||p.direction),a.utils.extend(p.properties,l.properties)):(m.selection=a.observableArray(l.data),m.focused=a.observable(null),m.anchor=a.observable(null),m.mode=a.observable(p.mode),m.direction=a.observable(p.direction),m.layout=null),m.init(p);var _=e.getMode(m.mode())(m,l.isReadyToBeSelected);e._registerEventHandlers(f,t,m,_,l.alwaysSelectFirst,l.isActive,l.allowInputEvents),a.utils.domNodeDisposal.addDisposeCallback(t,function(){m.clearSelectionOnRemoval&&m.clear(),f.dispose()})},e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n},e._registerEventHandlers=function(e,t,n,a,i,r,o){function s(e){var t=e.target,i=t&&"A"===t.tagName,r=n.findItemData(e.target);e.hasItem=!!r,e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target),i||a.match(e,r)}e.on(t,"touchstart",s),e.on(t,"touchend",s),e.on(t,"touchmove",s),e.on(t,"click",s),e.on(t,"focusin",function(e){if(!(e.relatedTarget&&t.contains(e.relatedTarget)||n.isActive.peek())){if(i){var a=n.firstItem();n.focused(a),n.anchor(a)}else if(e.target===t){var r=n.focused.peek();0===n.selection.peek().length&&!r&&n.selectFirstItemOnActivate?(a=n.firstItem(),n.focused(a),n.anchor(a),n.selectItem(a)):r&&(n.selectItem(r),n.anchor(r))}n.activate()}}),e.on(t,"focusout",function(e){e.relatedTarget&&!t.contains(e.relatedTarget)&&n.deactivate()}),e.on(t,"keydown",function(e){var i=e.target,s=i&&("INPUT"===i.tagName||"TEXTAREA"===i.tagName);if(!o&&s||r&&!r())return!0;var d=n.focused.peek();e.hasItem=!!d,e.keyCode===c.e.tab&&e.shiftKey&&!e.ctrlKey&&t.focus(),a.match(e,d)&&(e.stopPropagation(),e.preventDefault())})},e._isItemReadyToBeSelected=function(e,t){var n=!1;return!e||t&&!t(e)||(n=!0),n},e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var a=new o;return a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,t){}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,hasItem:!1},{type:"keydown",which:c.e.down,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,hasItem:!1},{type:"keydown",which:c.e.right,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,hasItem:!0},{type:"keydown",which:c.e.tab,shiftKey:!0,hasItem:!0},function(a,i){var r=t.leftItem(i);if(i===t.firstItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,hasItem:!0},{type:"keydown",which:c.e.tab,hasItem:!0},function(a,i){var r=t.rightItem(i);if(i===t.lastItem())return!1;e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a},e._getMultiMatchers=function(t,n){var a=new o;return a.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)}),a.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n),t.anchor(n)}),a.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.space,hasItem:!0},function(e,n){t.toggleSelection(n),t.anchor(n)}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.end,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end,ctrlKey:!0},{type:"keydown",which:c.e.end,metaKey:!0},function(e,n){var a=t.lastItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.end,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())}),a.register({type:"keydown",which:c.e.end},function(e,n){var a=t.lastItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:c.e.home,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home,ctrlKey:!0},{type:"keydown",which:c.e.home,metaKey:!0},function(e,n){var a=t.firstItem();t.focused(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.home,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())}),a.register({type:"keydown",which:c.e.home},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),(t.hasVertical()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.up,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.up,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.down,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.up,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.up,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))}),a.register({type:"keydown",which:c.e.up,altKey:!1,hasItem:!0},function(a,i){var r=t.aboveItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.down,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.down,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.down,altKey:!1,hasItem:!0},function(a,i){var r=t.belowItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),(t.hasHorizontal()||t.hasCustom())&&(a.register({type:"keydown",which:c.e.left,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.left,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:c.e.right,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var a=t.firstItem();t.selectItem(a),t.anchor(a)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.left,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.left,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.left,altKey:!1,hasItem:!0},function(a,i){var r=t.leftItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.appendSelectionFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:c.e.right,metaKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.focused(r),t.anchor(r))}),a.register({type:"keydown",which:c.e.right,shiftKey:!0,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&t.replaceSelectionWithRangeFromAnchor(r)}),a.register({type:"keydown",which:c.e.right,altKey:!1,hasItem:!0},function(a,i){var r=t.rightItem(i);e._isItemReadyToBeSelected(r,n)&&(t.selectItem(r),t.anchor(r))})),a.register({type:"keydown",which:c.e.a,ctrlKey:!0},{type:"keydown",which:c.e.a,metaKey:!0},function(e,n){t.selectAll()}),a},e.modes={single:e._getSingleMatchers,multi:e._getMultiMatchers},e}();t.e=d}],Array(21),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var r=n(10),o=n(934),s=n(4812);function c(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var d={loadViewModel:function(e,t,n){n(function(n,d){void 0===n&&(n={});var l,u=i.contextFor(d.element),f=i.utils.unwrapObservable(n.resources)||c(u),p={owner:e,useFactoriesOnKeys:!0},m=f?new r.n(f,p):new r.n(p);n=Object(a.__assign)(Object(a.__assign)({},n),{resources:m}),l=function(e){return"function"==typeof e.createViewModel}(t)?t.createViewModel(n,d):new(m.injected(t))(n);var _=new s.e({name:e,viewModel:l,element:d.element,bindingContext:u});return Object(o.e)(l,function(){_.dispose(),m.dispose()})})}};i.components.loaders.unshift(d)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"t",function(){return g});var a=n(0),i=n(1214),r=n(142),o=n(1890),s=n(2269),c=n(371),d=n(320),l=n(10),u=n(136),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables;a._selectionModel=n.itemSetSelectionModel,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemsStore=n.itemsStore;var s=a.selection=new o.e({selectionMode:1===a._selectionModel.mode?r.n.single:r.n.multiple,onSelectionChanged:a._onSelectionChange.bind(a),getKey:a.getKey.bind(a),canSelectItem:a._canSelectItem.bind(a)});return a._isModal=i.create(!!s.isModal&&s.isModal()),i.compute(a._computeUpdateItems),i.backgroundCompute(a._computeUpdateReactSelection),a.isModal=i.compute({read:function(){return a._isModal()},write:function(e){return s&&s.setModal(e)},pure:!0}),a}return Object(a.__extends)(t,e),t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem("".concat(e.key)))||"".concat(t)},t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,a=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1),n.setAllSelected(!1);for(var i=0,r=a;i<r.length;i++){var o=r[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})},t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var a=0,i=e.selection();a<i.length;a++){var r=i[a];if(!t.isKeySelected(e.getItemKey(r))){n=!0;break}}return n},t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;if(e._isModal(!!n.isModal&&n.isModal()),e._shouldUpdateSelection()){if(n.mode===r.n.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var a=[],i=0,o=n.getSelection();i<o.length;i++){var s=o[i],c=e.getKey(s);a.push(c)}t.setSelectedKeys(a)}var d=e._clientSideExtensionHelper;d&&d.raiseListChangeEvent(n.getSelection())}})},t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var a=0,i=t.content().items;a<i.length;a++){var r=i[a],o=this.observables.peekUnwrap(r);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var a=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||a&&a.isStub)&&e.selection.setItems(n,!1)})},t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})},t}(i.default),p=new l.t({name:"".concat("SelectionManager",".selectionManager"),factory:new u.n(f,Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemSetSelectionModel:d.I,clientSideExtensionHelper:c.e.optional,itemsStore:s.t}))}),m=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}}),_=new l.t({name:"".concat("SelectionManager",".selectionMode"),factory:{dependencies:{itemSetSelectionModel:d.I},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?r.n.multiple:r.n.single}}}}),h=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.isModal}}}}),b=new l.t({name:"SelectionManager",factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.selection}}}}),g=new l.t({name:"".concat("SelectionManager",".hasSelection"),factory:{dependencies:{itemSetSelectionModel:d.I,isSelectionModal:h,observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,a=e.isSelectionModal;return{instance:t.pureCompute(function(){return a()||n.selectedCount()>0}),disposable:t}}}})}],Array(20),[function(e,t,n){"use strict";n.r(t),n.d(t,"typeResourceKey",function(){return m});var a=n(0),i=n(2213),r=n(65),o=n(83),s=n(146),c=n(320),d=n(507),l=n(2015),u=n(10),f=n(136),p=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Navigation";var i=t.url,r=t.viewParams,o=t.target,d=void 0===o?"_top":o,l=t.forceNavigation,u=void 0!==l&&l,f=t.ignoreHistory,p=t.beforeNavigation,m=t.afterNavigation,_=t.postProcessUrl,h=n.navigation,b=void 0===h?a.resources.consume(s.e):h,g=n.viewParamsObservable,v=void 0===g?a.resources.consume(c.P):g;return a._navigation=b,a._viewParams=v,a._url=a.wrapObservable(i),a._inputViewParams=a.wrapObservable(r),a._target=a.wrapObservable(d),a._forceNavigation=u,a._ignoreHistory=f,a._beforeNavigation=p,a._afterNavigation=m,a._postProcessUrl=_,a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this._url.peek(),a=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var s=this._postProcessUrl?this._postProcessUrl(n):n;return(this._forceNavigation||n)&&this._navigation.navigateTo({url:s,viewParams:a,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory}),this._afterNavigation&&this._afterNavigation(this._navigation),r.n.wrap({resultType:o.e.Success})},t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),a="#"+d.t(n),i=t&&0===t.indexOf("#")?t.substring(1):"",r=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(r){var o=d.e(r);return!l.e(n,o)}return e!==a},t.dependencies={resources:u.r,navigation:s.e,viewParamsObservable:c.P},t}(i.e);t.default=p;var m=Object(f.o)("NavigationAction",p)}],Array(18),[function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"f",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"p",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"o",function(){return f}),n.d(t,"s",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"l",function(){return h}),n.d(t,"u",function(){return b});var a=n(3363),i=new a.e("createFolder"),r=new a.e("rename"),o=(new a.e("moveFrom"),new a.e("copyFrom"),new a.e("moveTo")),s=new a.e("copyTo"),c=new a.e("deleteItem"),d=new a.e("restoreItem"),l=(new a.e("deleteAllItems"),new a.e("restoreAllItems"),new a.e("createText"),new a.e("changeExpiration"),new a.e("open")),u=new a.e("openInTextEditor"),f=new a.e("openInHtmlViewer"),p=new a.e("openInImageEditor"),m=new a.e("openPdfInBrowser"),_=(new a.e("quickEdit"),new a.e("editItem"),new a.e("createShortcut")),h=new a.e("pinToMru"),b=new a.e("printPdf")}],Array(21),[function(e,t,n){"use strict";n.r(t),n.d(t,"SiteDataSource",function(){return u});var a=n(0),i=n(1366),r=n(172),o=n(65),s=n(93),c=n(1094),d=n(467);n.d(t,"SiteReadOnlyState",function(){return c.e});var l="SiteDataSource",u=function(e){function t(t,n){var a=e.call(this,{dataSourceName:l,id:"".concat(l,"(").concat(t?t.siteId:"",")")},{pageContext:t})||this;return a.getOAuthToken=n,a}return Object(a.__extends)(t,e),t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return t===c.e.unknown?this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(e._pageContext),"/_api/Site/ReadOnly")},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):o.n.resolve(t!==c.e.notReadOnly)},t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?c.e.unknown:null===this._pageContext.readOnlyState?c.e.notReadOnly:this._pageContext.readOnlyState},t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(e._pageContext),"/_api/Site?$select=StatusBarLink,StatusBarText")},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var n=t.d.StatusBarLink,a=void 0,i=void 0;if(n){var r=n.split("|");a=r[0];var o=1===r.length?r[0]:r[1];if(0===o.lastIndexOf("http",0)){var c=new s.t(o);i=encodeURI(c.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:a,StatusBarLinkTarget:i}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})},t.prototype.setClassificationProperty=function(e){var t="".concat(Object(r.s)(this._pageContext),"/_api/Site"),n=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e});return this.dataRequestor.getData({url:t,qosName:"SetClassificationProperty",additionalPostData:n,method:"PATCH"})},t.prototype.setClassificationPropertyAndId=function(e,t){var n="".concat(Object(r.s)(this._pageContext),"/_api/Site"),a=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e,SensitivityLabelId:t});return this.dataRequestor.getData({url:n,qosName:"SetClassificationProperty",additionalPostData:a,method:"PATCH"})},t.prototype.getCanSyncHubSitePermissionsProperty=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(Object(r.s)(t._pageContext),"/_api/Site/CanSyncHubSitePermissions")},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.CanSyncHubSitePermissions},qosName:"GetCanSyncHubSitePermissionsProperty",method:"GET",cachingStrategy:e?d.e.bypassCache:d.e.useCacheAndUpdateInTheBackground,noRedirect:!0})},t.prototype.SyncTeamSiteSettings=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/sp.TeamChannelManager.SyncTeamSiteSettings")},qosName:"SyncTeamSiteSettings",method:"POST",noRedirect:!0,cachingStrategy:d.e.bypassCache})},t.prototype.GetTeamSiteData=function(){return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sp.TeamChannelManager.GetTeamSiteData"),qosName:"GetTeamSiteData",parseResponse:function(e){var t=JSON.parse(e);return null==t?void 0:t.d},cachingStrategy:d.e.useCacheAndUpdateInTheBackground,cacheRequestKey:"".concat(this._pageContext.relatedGroupId),method:"POST",noRedirect:!0})},t.prototype.setCanSyncHubSitePermissionsProperty=function(e){var t="".concat(Object(r.s)(this._pageContext),"/_api/Site"),n=JSON.stringify({__metadata:{type:"SP.Site"},CanSyncHubSitePermissions:e});return this.dataRequestor.getData({url:t,qosName:"SetCanSyncHubSitePermissionsProperty",additionalPostData:n,method:"PATCH",noRedirect:!0})},t.prototype.isSiteFeatureEnabled=function(e,t){var n=this,a=t||Object(r.s)(this._pageContext),i="".concat(a,"/_api/site/Features/GetById('").concat(e.toString(),"')");return this.getOAuthToken(a).then(function(e){return n.dataRequestor.getData({url:i,qosName:"GetSPSiteFeatureEnabled",method:"GET",authToken:null!=e?e:void 0,parseResponse:function(e){try{var t=JSON.parse(e);if(t&&t.d&&t.d.DefinitionId)return!0}catch(e){return!1}return!1}})})},t}(i.t);t.default=u},,function(e,t,n){"use strict";n.r(t),n.d(t,"PowerAppsStore",function(){return _}),n.d(t,"getPowerAppRunTimeUrl",function(){return h}),n.d(t,"getPowerAppRunTimeHost",function(){return b}),n.d(t,"resourceKey",function(){return g});var a=n(0),i=n(1214),r=n(10),o=n(136),s=n(40),c=n(601),d=n(3851),l=n(65),u=n(100),f=n(37),p=n(4852),m=n(15).t.isActivated("e034d0fc-3a86-451a-bd9c-a58b8c73135f","09/01/2022","Use the WebPlayer SDK from @ms/bapisdk package"),_=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._initialized=!1,a.recentlyCreatedViews=[],a.appView=a.createObservable(null),a.appForm=a.createObservable(null),a.showAppView=a.createObservable(!1),a.showAppForm=a.createObservable(!1),a.loadPowerApp=a.createObservable(!1),a.formData=a.createObservable(null),a.isFormInitialized=!1,a._powerAppsVerifier=n.powerAppsVerifier,a}return Object(a.__extends)(t,e),t.arePowerAppsFormsEnabled=function(){return p.e.arePowerAppsFormsEnabled()},t.prototype.isPowerAppsSupportedScenario=function(){return this._powerAppsVerifier.isPowerAppsSupportedScenario()},t.prototype.hasPowerAppsForm=function(e){if(void 0===e&&(e=!1),!this._powerAppsVerifier.mayHavePowerAppsForm())return l.n.resolve(!1);var t=this.resources.consume(u.ue);return t.isCurrentQuery(f.e.RecycleBin)||t.isCurrentQuery(f.e.SecondStageRecycleBin)?l.n.resolve(!1):(this._hasPowerAppsFormPromise&&!e||(this._hasPowerAppsFormPromise=l.n.resolve(this.resources.consumeAsync(d.e.optional)).then(function(e){return e&&e.hasFormRenderMode(3)})),this._hasPowerAppsFormPromise)},t.prototype.createAppForm=function(e){var t=this;this.loadPowerAppJs(function(){t.appForm(e)})},t.prototype.setAndShowAppForm=function(e,t,n,a,i){this.formData({item:this.createObservable(e),type:this.createObservable(t),contentTypeId:n,originalClickTime:a,activityPaneSection:i}),this.showAppForm(!0),this.loadPowerApp.peek()||this.loadPowerApp(!0)},t.prototype.createAppView=function(e){var t=this;this.loadPowerAppJs(function(){t.appView(e)})},t.prototype.loadPowerAppJs=function(e){var t=this;this._initialized?e&&e():m?window.require(["power-app"],function(n){t._initialized=!0,e&&e()}):n.e(842).then(n.t.bind(null,5337,7)).then(function(n){t._initialized=!0,e&&e()})},t.prototype.ensureAppLoadSignal=function(e){return this.appLoadSignal&&!e||(this.appLoadSignal=new c.e),this.appLoadSignal},t.prototype.ensureListContextUpdateSignal=function(e){return this.listContextUpdateSignal&&!e||(this.listContextUpdateSignal=new c.e),this.listContextUpdateSignal},t.prototype.ensurePowerAppSdkPreloaded=function(){this._powerAppsVerifier.ensurePowerAppSdkPreloaded()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{powerAppsVerifier:p.t}),t}(i.default);function h(e,t){var n="apps.powerapps.com";if(Object(s.isFeatureEnabled)(s.PowerAppsAndAndProcessSimpleTestEnvironment))n="apps.test.powerapps.com";else if(t&&t.farmSettings){var a=t.farmSettings.ExternalService_powerappsappshostname;a&&(n=a)}return"https://".concat(n,"/play/").concat(e,"?source=sharepoint")}function b(e){var t="apps.powerapps.com";if(Object(s.isFeatureEnabled)(s.PowerAppsAndAndProcessSimpleTestEnvironment))t="apps.test.powerapps.com";else if(e&&e.farmSettings){var n=e.farmSettings.ExternalService_powerappsappshostname;n&&(t=n)}return"https://".concat(t)}t.default=_;var g=new r.t({name:"PowerAppsStore",factory:new o.n(_)})},,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor();n._isDragging=a.isDragging,n._mayReceiveDrop=a.mayReceiveDrop,n._receiveDrop=a.receiveDrop;var i=n.observables;return n._state=i.create({isWithinElement:!1,data:void 0}).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}),n._isDragging&&i.compute(function(){n._isDragging.call(n.bindingContext.$data,n._state().isWithinElement,n._state().data)}),n.events.onAll(n.element,{"od-dragEnter":n._onDragEnter,"od-dragLeave":n._onDragLeave,"od-processDrop":n._onProcessDrop,"od-dragOutWindow":n._onDragOutWindow}),n}return Object(a.__extends)(t,e),t.prototype._onDragEnter=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(this._state({isWithinElement:!0,data:{dragData:t.dragData,dropTargetData:t.dropTargetData}}),!t.dropTargetData&&this._mayReceiveDrop&&(t.dropTargetData=this._mayReceiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)),0))},t.prototype._onDragLeave=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t.prototype._onProcessDrop=function(e){var t=e.args;return!(t&&t.dragData&&t.dropSourceElement&&(!t.isHandled&&this._receiveDrop&&this._receiveDrop.call(this.bindingContext.$data,t.dragData,t.dropSourceElement)?(t.isHandled=!0,1):(this._state({isWithinElement:!1,data:void 0}),0)))},t.prototype._onDragOutWindow=function(e){return this._state({isWithinElement:!1,data:void 0}),!0},t}(n(2203).t);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return A});var a=n(0),i=n(1214),r=n(65),o=n(265),s=n(83),c=n(105),d=n(37),l=n(1498),u=n(100),f=n(3286),p=n(4205),m=n(97),_=n(1937),h=n(507),b=n(2984),g=n(93),v=n(547),y=n(320),S=n(4604),D=n(10),I=n(136),x=n(1367),C=n(1830),O=!n(15).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),w=new D.t({name:"".concat("DropHelper",".updateItemMetadataOperator"),loader:new I.t(function(){return r.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e(531)]).then(n.bind(null,5415))).then(function(e){return e.typeResourceKey})})}),E=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,a._shortcutProvider=n.shortcutProvider,a._currentItemSet=n.currentItemSet,a._engagement=n.engagement,a._postUploadProjectionHelper=n.postUploadProjectionHelper,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._wip=n.wip,a._quotaBlockAction=new(a.managed(n.actionMap.QuotaBlockAction))({isDragAndDrop:!0}),a}return Object(a.__extends)(t,e),t.prototype.processDrop=function(e,t,n,a){var i=this;if(void 0===n&&(n=!1),void 0===a&&(a=!1),!t||!t.isDropEnabled||t===e.item||this._wip&&this._wip.isWIPEnabled())return!1;var b=this._engagement;if(0===e.type){if(b.logData({name:"DragAndDropEvent",isIntentional:!0}),this._quotaBlockAction.isAvailable.peek())return this._quotaBlockAction.execute(null),!1;var v=this._currentItemSet.peek();return r.n.resolve(this.resources.consumeAsync(f.e)).then(function(a){var r=new a({files:e.files,parentItem:t,itemSet:v,wasDragAndDropped:!0,type:e.uploadType,metadata:e.metadata,skipInvalidation:!!n});return i.trackPromise(r.start()),r.wait()}).done(null,function(e){m.e.log(e)}),!0}if(1===e.type){var y=e.metadata&&e.metadata.group;return y?(this._resolveSelection(e).then(function(f){var p=new l.e({name:"DragChangeGroup",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]}),b=[];n&&f.forEach(function(e){var t=_.e(e);if(!a){var n=h.e(t.key);n.group=y.groupingId,t.key=h.t(n)}t.state.upload.status=1,t.properties[y.fieldSchema.Name]=y.groupingId,b.push(i.createObservable(t)),e.state.removing=!0}),r.n.resolve(i.resources.consumeAsync(w)).then(function(a){var o=new a({items:f,metadata:e.metadata,parentItem:t,skipInvalidation:n,onComplete:function(t){t?(n&&i._postUploadProjectionHelper.updateItemSetPostUpload(e.itemSet,b,y),i._isItemsScopeEnabled()&&y.itemKey&&r.n.resolve(i.resources.consumeAsync(u.L)).then(function(e){e.invalidateGroups([y.itemKey])})):alert("failure updating metadata")}});return i.trackPromise(o.start()),o.wait()}).done(void 0,function(e){return m.e.log(e)});var g={},v={count:f.length};if(1===f.length){g.fileType=o.e[f[0].type];var S=O&&f[0].extension?Object(C.e)(f[0].extension):f[0].extension||"";g.extension=S}p.end({resultType:s.e.Success,extraData:g,extraMetrics:v})}).done(null,function(e){return m.e.log(e)}),!0):e.itemSet.item.peek().key!==t.key&&(this._resolveSelection(e).then(function(n){n=n.filter(function(e){return e!==t});var a=new l.e({name:"DragMove",pageType:c.e[i._urlDataSource.getPageType()],queryType:d.e[i._urlDataSource.getQueryType()]});return i.resources.consumeAsync(p.n).then(function(a){return a.copyItems({items:n,parentKey:e.item.parentKey,targetId:t.id,targetKey:t.key,cid:i._urlDataSource.getOwnerId(),group:t.isGroup?1:0,isAsync:!1,isMove:!0})}).then(function(){var e={},r={count:n.length};if(i._isItemsScopeEnabled()&&i.resources.consumeAsync(u.L).then(function(e){e.invalidateItems(t.key)}),1===n.length){e.fileType=o.e[n[0].type];var c=O&&n[0].extension?Object(C.e)(n[0].extension):n[0].extension||"";e.extension=c}a.end({resultType:s.e.Success,extraData:e,extraMetrics:r})},function(){a.end({resultType:s.e.Failure})})}).done(null,function(e){return m.e.log(e)}),!0)}if(3===e.type&&this._shortcutProvider){b.logData({name:"Link.DragAndDrop.Drop",isIntentional:!0});var S=e.links.split("\n");return(S=S.filter(function(e){return"#"!==e.charAt(0)})).forEach(function(e){var n=new g.t(e).getHost()+".url";i._shortcutProvider.createShortcut(t.key,n,e)}),!0}},t.prototype._resolveSelection=function(e){return e.selection?e.selection.resolve().then(function(t){return t&&0!==t.length||(t=[e.item]),t}):r.n.wrap([e.item])},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{shortcutProvider:b.resourceKey.optional,urlDataSource:u.ue,wip:u.Se.optional,actionMap:y.e,currentItemSet:y.s,postUploadProjectionHelper:S.e,engagement:v.e,isItemsScopeEnabled:x.f.lazy}),t}(i.default),A=Object(I.r)("DropHelper",E)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"d",function(){return D}),n.d(t,"a",function(){return x}),n.d(t,"i",function(){return C}),n.d(t,"t",function(){return w}),n.d(t,"o",function(){return E}),n.d(t,"s",function(){return A});var a,i,r,o,s,c=n(361),d=n(2217),l=n(664),u=n(1369);n.d(t,"e",function(){return u.e}),n.d(t,"n",function(){return u.t}),n.d(t,"r",function(){return u.n}),n.d(t,"l",function(){return u.a}),n.d(t,"u",function(){return u.i}),n.d(t,"f",function(){return u.r});var f="ms-word",p="onenote|UsePlain",m="ms-powerpoint",_="ms-excel",h="ms-visio",b="ms-publisher",g="ms-project",v=((a={})[f]=l.OpenInWordOnline,a[p]=l.OpenInOneNoteOnline,a[m]=l.OpenInPowerPointOnline,a[_]=l.OpenInExcelOnline,a[h]=l.OpenInVisioOnline,a);function y(e){return v[e]||""}var S=((i={})[f]=l.OpenInWord,i[p]=l.OpenInOneNote,i[m]=l.OpenInPowerPoint,i[_]=l.OpenInExcel,i[h]=l.OpenInVisio,i[b]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function D(e){return S[e]}var I=((r={})[f]="Word",r[p]="OneNote",r[m]="PowerPoint",r[g]="Project",r[h]="Visio",r[_]="Excel",r);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":I[e.appMap]||"Word"}function C(e){return I[e]}(o={})[f]="WordLogo",o[p]="OneNoteLogo",o[m]="PowerPointLogo",o[_]="ExcelLogo",o[h]="VisioLogo",o[b]="Page";var O=((s={})[f]="svg/word_16x1.svg",s[p]="svg/onenote_16x1.svg",s[m]="svg/powerpoint_16x1.svg",s[_]="svg/excel_16x1.svg",s[h]="svg/visio_16x1.svg",s[b]="Page",s.Stream="svg/stream_16x1.svg",s),w={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function E(e){var t=O[e];return t&&new d.e(t)}function A(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1214),i=new(n(10).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,function(e,t,n){"use strict";var a,i=n(933),r={ODB:563,ODC:null,Fallback:!1};!function(e){function t(e){return"url"===e||"website"===e}var n;e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))},e.isShortcutFileType=t,e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(r)},(n=e.ShortcutErrors||(e.ShortcutErrors={}))[n.UnknownError=0]="UnknownError",n[n.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError",n[n.InvalidCharacterError=2]="InvalidCharacterError"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"s",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"i",function(){return s}),n.d(t,"n",function(){return o}),n.d(t,"o",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"t",function(){return l});var a=5e3,i=1e4;function r(e){return e}var o,s=new Map([["FileUploadError","FileUploadFailed"],["LockAcquireFailed","LoadTemplateFailed"],["GetTemplateMetadataFailed","LoadTemplateFailed"],["PlaceholderListDataSourceValidationFailed","LoadTemplateFailed"],["LockRefreshFailed","TemplatizationError"],["FreezeTemplateCanvas","TemplatizationError"],["SiteFetchFailed","TemplatizationError"],["ListFetchFailed","TemplatizationError"],["ColumnFetchFailed","TemplatizationError"],["TermLoadFailed","TemplatizationError"],["AssociatingTableSourceFailed","TemplatizationError"],["TableSourceListViewFailed","TemplatizationError"],["PublishTemplateFailed","TemplateSaveFaled"],["DeleteTemplateFailed","TemplateSaveFailed"],["RenameTemplateFailed","TemplateSaveFailed"],["UnpublishTemplateFailed","TemplateSaveFailed"],["PublishTemplateSlow","TemplateSaveSlow"],["LoadTemplateStudioSlow","LoadTemplateStudioSlow"]]);!function(e){e.ContentAssemblyTemplatization="ContentAssemblyTemplatization",e.ContentAssemblyDocumentGeneration="ContentAssemblyDocumentGeneration"}(o||(o={}));var c=new Map([[o.ContentAssemblyTemplatization,"Edit"],[o.ContentAssemblyTemplatization,"Edit"]]);function d(e){return e}function l(e){return e}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"a",function(){return y});var a,i=n(0),r=n(65),o=n(15),s=n(1366),c=n(3718),d=n(225),l=n(93),u=n(2784),f=n(170),p=n(138),m=n(83),_=n(467),h={links:void 0,name:"",startingNodeKey:"",isAudienceEnabled:!1,isAudienceTargeted:!1,isAudienceAffected:!1};!function(e){e[e.None=0]="None",e[e.TopOrHub=1]="TopOrHub",e[e.QuickLaunch=2]="QuickLaunch"}(a||(a={}));var b=function(e){function t(t,n){var a=e.call(this,{id:"ViewNavDataSource"},{pageContext:t})||this;return a._mapProviderName=n,a._audiencesDataSource=u.e.getInstance(t),a._viewNavCacheKey="viewNavDataSource"+"_".concat(t.aadUserId),a}return Object(i.__extends)(t,e),t.isRelativeUrl=function(e){return!!e&&!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.shouldLinkOpenInSameWindow=function(e){if(!e)return!1;var t=new l.t(e),n=t.getScheme()+"://"+t.getAuthority();return(""===t.getScheme()&&""===t.getAuthority()||n===window.location.origin)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.transformNodesToLinks=function(e,n,a){var i=function(e,r){a&&(e=e.filter(function(e){return a(e,r)}));var o=y();return e.map(function(e){var a;return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:n,isDocLib:e.IsDocLib,links:e.Children&&e.Children.length?i(e.Children,r+1):void 0,audiences:e.AudienceIds||void 0,currentLCID:e.CurrentLCID,openInNewWindow:e.OpenInNewWindow,target:d.n.isFeatureEnabled({ODB:60322})?(null!==(a=e.OpenInNewWindow)&&void 0!==a?a:!t.shouldLinkOpenInSameWindow(e.Url))?"_blank":"_self":o?"":t.shouldLinkOpenInSameWindow(e.Url)?"_self":"_blank"}})};return i(e=e||[],0)},t.getAreaNavigationSettingsUrl=function(e){return"".concat(e.webAbsoluteUrl,"/_layouts/15/AreaNavigationSettings.aspx")},t.prototype.setGlobalNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/SetGlobalNavEnabled?isEnabled=").concat(e);return this.dataRequestor.getData({url:t,qosName:"SetGlobalNavEnabled",method:"POST",noRedirect:!0})},t.prototype.getGlobalNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNavEnabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.GlobalNavEnabled},qosName:"getGlobalNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNavEnabled")})},t.prototype.setHomeSiteNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings"),n={__metadata:{type:"Microsoft.SharePoint.Navigation.REST.HomeSiteNavigationSettings"},IsEnabled:e};return this.dataRequestor.getData({url:t,qosName:"setHomeSiteNavEnabled",method:"PATCH",additionalPostData:JSON.stringify(n),noRedirect:!0})},t.prototype.getHomeSiteNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/homesitesettings/isenabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsEnabled},qosName:"getHomeSiteNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getHomeSiteNavEnabled")})},t.prototype.getGlobalNav=function(e,t,n){var a=this,i=new p.e({name:"GlobalNavigation"}),r="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNav");t&&(r+="?source='".concat(t,"'"));var o={url:r,qosName:"GetGlobalNavigation",parseResponse:function(e){var t=JSON.parse(e);return a._transformToNavLinkGroup(t,!1,i,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,cachingStrategy:e?_.e.bypassCache:_.e.useCacheIfNotExpired,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNav")};return this.getDataUtilizingPersistentCache(o).then(function(e){return a._processGlobalNavNodes(e,n)})},t.prototype.processGlobalNavLKG=function(e,t){var n=new p.e({name:"GlobalNavigationFromLKG"});return this._processGlobalNavNodes(this._transformToNavLinkGroup(e,!1,n,!0),t)},t.prototype.getHomeSiteNav=function(e,n,a,i){var r=this,s=d.n.isFeatureEnabled({ODB:1420}),c=!o.t.isActivated("759873da-625e-430b-a1f4-fb8f101c48db","10/11/2022","Utilize the getCurrentResourcesNav endpoint instead of the getHomeSiteNav endpoint")&&s,l=c?new p.e({name:"GetCurrentResourcesNav"}):new p.e({name:"GetHomeSiteNav"}),u="".concat(this._pageContext.webAbsoluteUrl,c?"/_api/navigation/CurrentResourcesNav":"/_api/navigation/HomeSiteNavigation");e&&(u+="?source='".concat(e,"'")),i&&c&&(u+="".concat(e?"&":"?","includeVivaResources=true"));var f={url:u,qosName:c?"GetCurrentResourcesNav":"GetHomeSiteNav",parseResponse:function(e){var t=JSON.parse(e);return r._transformToNavLinkGroup(t,!1,l,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,cachingStrategy:a&&c?_.e.bypassCache:_.e.useCacheIfNotExpired,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getCurrentResourcesNav")};return this.dataRequestor.getData(f).then(function(e){return n||v()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?e:r._audiencesDataSource.filter("HomeSiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})})},t.prototype.isNavAudienceTargetedEnabled=function(){var e;return Boolean(0===this._pageContext.webPropertyFlags2||this._pageContext.webPropertyFlags2?this._pageContext.webPropertyFlags2&t.NAV_AUDIENCE_TARGET_FLAG:null===(e=this._pageContext.navigationInfo)||void 0===e?void 0:e.isAudienceTargeted)},t.prototype.getMenuState=function(e){var n=this;void 0===e&&(e={});var a=new p.e({name:"TransformMenuStateToLinkGroup"}),i=e.providerName,r=void 0===i?this._mapProviderName:i,s=e.isGlobalNav,d=e.useCache,l=e.forceRefresh,u=e.menuNodeKey,m=e.maxRetries,b=void 0===m?1:m,g=e.depth,y=void 0===g?3:g,S=e.skipAudienceFiltering,D=e.audienceFilterNodeKey,I=d?"getMenuStateUsingCache":"NavigationGetMenuState",x="";r=r||this._mapProviderName,u?(x+="?menuNodeKey='".concat(u,"'"),r&&(x+="&mapProviderName='".concat(r,"'"))):(s||r)&&(x+="?menuNodeKey=".concat(s?c.t.globalNavParent:""),r&&(x+="&mapProviderName='".concat(r,"'"))),o.t.isActivated("a59d510d-6e9d-493a-92ca-e77f6cb190fc","2022-11-09","Not pass depth value to getMenuState")&&x&&x.length>0&&(x+="&depth='".concat(y,"'"));var C,O={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/MenuState").concat(x),qosName:I,qosExtraData:{NavProviderName:r},parseResponse:function(e){var t=JSON.parse(e);return n._transformToNavLinkGroup(t,Boolean(S),a)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:b,crossSiteCollectionCall:!0,cachingStrategy:l?_.e.bypassCache:_.e.useCacheAndUpdateInTheBackground,noRedirect:!0};return C=d?this.getDataUtilizingPersistentCache(O).then(function(e){return v()?e:e||h}):this.dataRequestor.getData(O),v()?!S&&this.isNavAudienceTargetedEnabled()?C.then(function(e){return e&&n._isGroupAudienceTargeted(e)?(e.name===c.t.footerNavParent&&e.links&&D&&n._audiencesDataSource.containsAudiences(e.links.filter(function(e){return e.name===D}),"links")&&f.e.logData({name:"FooterNav.AudienceTargeting"}),n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(t){return e.links=t||[],e})):e}):C:C.then(function(e){return e.isAudienceEnabled&&e.isAudienceTargeted?n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e}):e})},t.checkIfLinksAffected=function(e,t){return g(e)!==g(t)},t.prototype.clearCache=function(){this.flushCache()},t.prototype._transformToNavLinkGroup=function(e,t,n,a){if(!e||!e.Nodes||0===e.Nodes.length)return n.end({resultType:m.e.ExpectedFailure,error:"getMenuState empty MenuState"}),v()?void 0:h;try{var i=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix),r={isAudienceEnabled:!v()&&!t&&(a?e.IsAudienceTargetEnabledForGlobalNav:this.isNavAudienceTargetedEnabled()),isAudienceTargeted:(v()||!t)&&this._audiencesDataSource.containsAudiences(i,"links"),isAudienceAffected:!1,name:e.StartingNodeTitle||"",links:i,startingNodeKey:e.StartingNodeKey};return n.end({resultType:m.e.Success}),r}catch(e){return n.end({resultType:m.e.Failure,error:e?e.toString():"getMenuState failed"}),v()?void 0:h}},t.prototype._processGlobalNavNodes=function(e,n){return n||v()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?r.n.resolve(e):this._audiencesDataSource.filter("GlobalNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})},t.prototype._getLinksFromNodes=function(e,n){var a=this,i=function(e,r,o){e=e.filter(function(e){return e.Key!==c.t.quickLaunchRecent&&-1===e.Key.indexOf("SPNavigationNodeId=".concat(c.t.quickLaunchRecent))&&!e.IsDeleted&&!e.IsHidden});var s=o?o+"/":"";return e.map(function(e){var o,c,l=r&&s+r.FriendlyUrlSegment,u=a._getUrl(e,!!r,n,l),f=e.CustomProperties?a._getCustomPropertyValue(e.CustomProperties,"Target"):void 0,p="_blank"===f||null!==f&&void 0,m=d.n.isFeatureEnabled({ODB:60322}),_=m?(null!==(c=null!==(o=e.OpenInNewWindow)&&void 0!==o?o:p)&&void 0!==c?c:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self":(null!=p?p:!t.shouldLinkOpenInSameWindow(u))?"_blank":"_self";return{name:e.Title,url:u,key:e.Key,ariaLabel:e.Title,isExpanded:!1,hasChildLinks:e.CustomProperties?"True"===a._getCustomPropertyValue(e.CustomProperties,"HasChildNodes"):void 0,target:_,links:e.Nodes&&e.Nodes.length?i(e.Nodes,e,l):void 0,audiences:e.AudienceIds&&e.AudienceIds.length>0?e.AudienceIds:void 0,currentLCID:e.CurrentLCID,openInNewWindow:m?e.OpenInNewWindow:void 0}})};return i(e||[])},t.prototype._getCustomPropertyValue=function(e,t){for(var n=e.length-1;n>0;n--)if(e[n].Key===t)return e[n].Value;return""},t.prototype._getUrl=function(e,t,n,a){return e.SimpleUrl?e.SimpleUrl:(e.NodeType===c.e.FriendlyUrl&&e.FriendlyUrlSegment&&(i=(i=t?n+((a?"/".concat(a):"")+"/".concat(e.FriendlyUrlSegment)):n+e.FriendlyUrlSegment).replace("//","/")),i);var i},t.prototype._isGroupAudienceTargeted=function(e){return!!e.isAudienceTargeted||!(e.name!==c.t.footerNavParent||!e.links)&&this._audiencesDataSource.containsAudiences(e.links,"links")},t.NAV_AUDIENCE_TARGET_FLAG=8388608,t}(s.e);function g(e){if(!e)return 0;for(var t=e.length,n=0,a=e;n<a.length;n++)t+=g(a[n].links);return t}function v(){return o.t.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function y(){return o.t.isActivated("7487a3f0-e21c-4b2f-9383-9337f1b30e6f","08/23/2022","Open all same-origin urls in the current tab and all external urls in a new tab unless OpenInNewWindow is set")}t.n=b},,,function(e,t,n){"use strict";n.d(t,"e",function(){return _}),n.d(t,"t",function(){return h});var a=n(0),i=n(1214),r=n(2231),o=n(2322),s=n(65),c=n(664),d=n(4423),l=n(2217),u=n(320),f=n(681),p=n(136),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogProvider=n.dialogProvider,a._promiseTracker=n.promiseTracker,a._itemSetSelectionModel=n.itemSetSelectionModel,a}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(d.e),a=this.createObservable(!0),i=this.createObservable(!1),r=this._shouldShowDialog();return this._itemSetSelectionModel?(t=this._itemSetSelectionModel.resolveSelection().then(function(t){return r=!1,e&&e.state(2),t},function(t){return e&&(n(d.t),a(!1),i(!0)),s.n.wrapError(t)}),r&&(e=this._createDialog(n,a,i)).wait().done(void 0,function(){t.cancel()}),this._promiseTracker&&this._promiseTracker.registerPromise(t)):t=s.n.wrap([]),t},t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:d.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:c.cancelActionText,execute:function(){return s.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:c.ok,execute:function(){return s.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})},t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{dialogProvider:r.e,promiseTracker:u.w.optional,itemSetSelectionModel:u.I}),t}(i.default);function _(e,t){void 0===t&&(t=!1);var n=e.selection();if(1===n.length){var a=Object(f.i)(n[0]);return t&&a.video?a.appMap?a.appMap:"Stream":a.appMap?a.appMap:"nonOfficeApp"}}var h=Object(p.r)("SelectionHelper",m)},,function(e,t,n){"use strict";n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return v}),n.d(t,"e",function(){return y});var a=n(265),i=n(2420),r=n(23),o=n(439),s="Doc",c="One",d="Ppt",l="Xls",u="Vsd",f="Lib",p="Drive",m={WinDocuments:f,WinLibrary:f,WinMusic:f,WinPictures:f,WinPodcastLibrary:f,WinVideos:f,WinDrive:p,CDDrive:"CDDrive",GenericDrive:p,UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:s,Docm:s,Docx:s,Dot:s,Dotm:s,Dotx:s,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:d,Ods:l,Odt:s,One:c,Onepkg:c,Onetoc2:c,Notebook:"OneNotebook",Pot:d,Potm:d,Potx:d,Ppa:d,Ppam:d,Pps:d,Ppsm:d,Ppsx:d,Ppt:d,Pptm:d,Pptx:d,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:u,Vsd:u,Vsdm:u,Vsdx:u,Vsl:u,Vss:u,Vssm:u,Vssx:u,Vst:u,Vstm:u,Vstx:u,Xaml:"Xaml",Xla:l,Xlam:l,Xll:l,Xls:l,Xlsb:l,Xlsm:l,Xlsx:l,Xlt:l,Xltm:l,Xltx:l,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function _(e,t,n){var o=e.extension,s=o&&o.slice("."===o[0]?1:0),c=s&&s.toUpperCase(),d=g(e.itemFromServer&&e.itemFromServer.iconType||s);return e.isDocSet?i.fileTypeDocSet:d||e.type!==a.e.Folder?n||(e.panorama?i.fileTypePanorama:e.photo&&!e.video?r.format(i.fileTypeImage,c||"").trim():d?i["fileType"+d]:c?r.format(i.fileTypeUnknown,c):t?i.listItemType:i.fileTypeNoExtension):i.fileTypeFolder}function h(e){var t=e.slice(e.lastIndexOf(".")+1);return r.format(i.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):i.fileTypeNoExtension)}function b(e){var t=i.fileTypeNoExtension;if(!e)return t;var n=g(r.capitalize(e));if(n)return i["fileType"+n];var a=e.toUpperCase();return a?r.format(i.fileTypeUnknown,a):t}function g(e){return m[e]}function v(e){return!!e.properties&&!!e.properties.autoAlbumTag}function y(e){if(!e)return o.e.Word;var t=g(r.capitalize(e.split(".").pop()));return t===c?o.e.OneNote:t===d?o.e.PowerPoint:t===l?o.e.Excel:t===u?o.e.Visio:o.e.Word}}],Array(14),[function(e,t,n){"use strict";var a=n(1121);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a="role:1073741827",i="role:1073741826",r="role:1073741829",o="role:1073741830"},function(e,t,n){"use strict";var a=n(5567);t.e=a.e},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(136),i=n(2416),r=n(1001),o=n(345),s=n(3260),c=n(3012),d=n(2949),l=n(3362),u=Object(a.r)("PeoplePickerDataSource",i.e,{apiUrlHelper:r.e,pageContext:o.e,dataRequestor:s.e,oAuthTokenProvider:c.e,graphPeoplePickerHelper:d.e,substratePeoplePickerHelper:l.e})}],Array(25),[function(e,t,n){"use strict";var a=n(37);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},,,,function(e,t,n){"use strict";var a=n(1573);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(3363),i=new a.e("share"),r=(new a.e("addToShared"),new a.e("embed")),o=(new a.e("comment"),new a.e("removeFromShared"),new a.e("addAsMountPoint"),new a.e("removeAsMountPoint"),new a.e("reportAbuse"),new a.e("requestReview"),new a.e("alertItem")),s=new a.e("alertItem")}],Array(14),[function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(213),i=n(36);function r(e){return e}function o(e){return e}function s(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},,,function(e,t,n){"use strict";var a=n(4824);t.e=a.e},function(e,t,n){"use strict";var a=n(2342);t.e=a.e}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1214),i=new(n(10).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})}],Array(19),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("react-lib"),r=n(5307),o=n(2166),s=n(195),c=n(1966),d=n(1967),l=n(496),u=n(232),f=n(114),p=n(170),m=function(e){function t(t){var n=e.call(this,t)||this;n._onButtonClick=function(){n._closeBanner("Button");var e=n.props.buttonClick;e&&e()},n._onCloseClick=function(){n._closeBanner("X")},n._dataStore=new u.e("UpdateBanner",f.e.local),n._dataStoreKey=t.cacheKey,n._engagementPrefix=t.engagementPrefix||"Banner",n.state={isHidden:n._dataStore.getValue(n._dataStoreKey,f.e.local)||!1};var a=n.props,i=a.image,r=a.maxWidth,o=a.minHeight,s=a.canDismiss,c=void 0===s||s;if(n._canDismiss=c,i){var d=n.props.image,l=d.alignBottom,p=d.background,m=d.containerWidth,_=void 0===m?256:m;n._imageContainerStyle={backgroundColor:p,minWidth:_+"px"},n._imageContainerClass="od-Banner-imageContainer od-Banner-image".concat(l?"Bottom":"Center"),n._imageStyle={maxWidth:_-40+"px",height:"calc(100% - ".concat(20*(l?1:2),"px)")}}return n._bannerStyle={maxWidth:r?"".concat(r,"px"):"",minHeight:o?"".concat(o,"px"):""},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.header,n=e.iconName,a=e.message,u=e.image,f=e.buttonText,p=void 0===f?r.e:f,m=e.isVerticalLayout,_=e.className;return this.state.isHidden?i.createElement("div",{className:"od-Banner od-Banner-hide"}):i.createElement(o.e,null,i.createElement("div",{className:Object(s.e)(_,"od-Banner"),style:this._bannerStyle},u&&i.createElement("div",{className:this._imageContainerClass,style:this._imageContainerStyle},i.createElement("img",{role:"presentation",src:u.url,style:this._imageStyle})),i.createElement("div",{className:Object(s.e)("od-Banner-messageContainer",{"od-Banner-messageContainer--vertical":m})},t&&i.createElement("h2",{className:"od-Banner-header"},t),i.createElement("div",{className:Object(s.e)("od-Banner-message",{"od-Banner-message--vertical":m})},i.createElement(l.e,{className:"od-Banner-icon",iconName:n}),i.createElement("span",null,a)),i.createElement(c.e,{className:Object(s.e)("od-Banner-button",{"od-Banner-button--vertical":m,"od-Banner-button--horizontal":!m}),onClick:this._onButtonClick,text:p}),this._canDismiss&&i.createElement(d.e,{className:"od-Banner-close",iconProps:{iconName:"Cancel"},"aria-label":r.t,title:r.t,onClick:this._onCloseClick}))))},t.prototype._closeBanner=function(e){this._canDismiss&&(p.e.logData({name:"".concat(this._engagementPrefix,".Banner.").concat(e,".Click"),isIntentional:!0}),this._dataStore.setValue(this._dataStoreKey,!0,f.e.local),this.setState({isHidden:!0}))},t}(i.Component),_=n(5308),h=function(e){function t(t){var n=e.call(this,t)||this;n._onClick=function(){return n._action.execute(null)};var a=t.actionMap,i=t.resources;return n._action=new(i.injected(a.LaunchTeamChannelAction))({}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(m,{className:"od-TeamChannelBanner",iconName:"Info",message:_.t,buttonText:_.e,buttonClick:this._onClick,canDismiss:!1,isVerticalLayout:!0,engagementPrefix:"TeamChannel"})},t}(n(1446).e);t.default=h},,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a,i=n(0),r="MembershipsCache";function o(){if(!window||!window.localStorage)throw new Error("localStorage is not supported")}function s(e){return"".concat(r,"_").concat(e)}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}));var c=function(){function e(e,t){var n=this;this._log=function(e,t,a){n._logCacheQoS&&n._logCacheQoS("".concat(r,".").concat(e),t,a)},this._getData=e,this._logCacheQoS=t}return e.doesItemContainAudiences=function(e){var t;return((null===(t=null==e?void 0:e.audiences)||void 0===t?void 0:t.length)||0)>0},e.containsAudiences=function(t,n){if(!t)return!1;if(t.some(e.doesItemContainAudiences))return!0;if(n)for(var a=0,i=t;a<i.length;a++){var r=i[a];if(e.containsAudiences(r[n],n))return!0}return!1},e.getInstance=function(t,n){return e._instance||(e._instance=new e(t,n)),e._instance},e.prototype.filter=function(e,t,n,a,i,r,o){var s=this;return i?this.getCurrentUserMemberships(e,t,n,a,o).then(function(e){return s.filterWithMembership(e,i,r)}).catch(function(){return s.filterWithMembership([],i,r)}):Promise.resolve(void 0)},e.prototype.filterWithMembership=function(e,t,n){var a=this;if(!t)return t;var r=t.filter(function(t){return!function(e){return Boolean(e.audiences&&e.audiences.length>0&&"00000000-0000-0000-0000-000000000000"!==e.audiences[0])}(t)||function(e,t){var n=e.audiences;if(!n)return!1;for(var a=0;a<n.length;a++)if(-1!==t.indexOf(n[a]))return!0;return!1}(t,e)});return n&&(r=r.map(function(t){var r;return Object(i.__assign)(Object(i.__assign)({},t),((r={})[n]=a.filterWithMembership(e,t[n],n),r))})),r},e.prototype.getCurrentUserMemberships=function(e,t,n,i,r){var c,d=this,l=new URLSearchParams(window.location.search),u=!1;if("Preview"===l.get("env")&&l.has("audiences")){var f=l.get("audiences");c=f?f.split(","):[],u=!0}else try{c=function(e,t){o();var n=window.localStorage.getItem(s(e));if(n){var a=JSON.parse(n),i=Boolean(a&&a.lastModified&&Date.now()-a.lastModified<=72e5);if(t?navigator.onLine?i:Boolean(a):i)return a.data}}(t,r)}catch(e){this._log(i,a.Failure,{error:e.message||e,scenario:i})}if(c)return u||this._log(i,a.Success),Promise.resolve(c);if(!this._getMembershipsPromise){var p=n+"/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships"+(i?"?scenario='".concat(i,"'"):"");this._getMembershipsPromise=this._getData(p,i).then(function(n){return d._getMembershipsPromise=void 0,n&&function(e,t,n){if(o(),n&&(e||n.length)){var a={data:n,lastModified:Date.now()};window.localStorage.setItem(s(t),JSON.stringify(a))}else window.localStorage.removeItem(s(t))}(e,t,n),d._log(i,a.ExpectedFailure),n})}return this._getMembershipsPromise},e}(),d=n(65),l=n(51),u=n(15),f=n(138),p=n(262),m=function(){function e(e){var t=this;this._getDataFromAPI=function(e,n){var a={url:e,qosName:n?"getUserMembershipsForAudienceTargeting.".concat(n):"getUserMembershipsForAudienceTargeting",cacheRequestKey:t._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return t._dataRequestor.getData(a)},this._logCacheQoS=function(e,t,n){return new f.e({name:e}).end({name:e,resultType:t,extraData:n})},this._pageContext=e,this._dataRequestor=new p.e({qosName:"AudiencesDataSource"},{pageContext:e}),this._cacheRequestKey=e.aadUserId||e.userLoginName,this._audienceTargetComponent=c.getInstance(this._getDataFromAPI,this._logCacheQoS)}return e.getInstance=function(t){var n=t.aadUserId||t.userLoginName;return e._instances[n]||(e._instances[n]=new e(t)),e._instances[n]},e.prototype.containsAudiences=function(e,t){if(!e)return!1;if(e.filter(_).length>0)return!0;if(t)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(this.containsAudiences(i[t],t))return!0}return!1},e.containsAudienceTargetedNode=function(e){var t=this;return!!e&&(e.filter(_).length>0||e.filter(function(e){return t.containsAudienceTargetedNode(e.links)}).length>0)},e.prototype.filter=function(e,t,n){var a=u.t.isActivated("845880ed-07f0-4103-bef6-d3d7779183b5");return d.n.resolve(this._audienceTargetComponent.filter(h(),this._cacheRequestKey,this._pageContext.webAbsoluteUrl,e,t,n,!a))},e.prototype.filterWithMembership=function(e,t,n){return this._audienceTargetComponent.filterWithMembership(e,t,n)},e.filterLinksWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t,function(e){return e.links},function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{links:t})})},e.getGroupObjectId=function(e){return e.userId&&e.userId.length>=36?e.userId.substr(e.userId.length-36):void 0},e.prototype.getCurrentUserMemberships=function(e){var t=this._pageContext.webAbsoluteUrl;return window&&window.location&&window.location.origin&&-1===t.indexOf(window.location.origin)&&(t=window.location.origin),d.n.resolve(this._audienceTargetComponent.getCurrentUserMemberships(h(),this._cacheRequestKey,t,e))},e._filterRecursively=function(t,n,a,i){if(!n)return n;var r=n.filter(function(e){var n;return!_(e)||(null===(n=e.audiences)||void 0===n?void 0:n.some(function(e){return t.has(e)}))});return a&&i&&(r=r.map(function(n){var r=a(n),o=e._filterRecursively(t,r,a,i);return i(n,o)})),r},e._instances={},e}();function _(e){return!!(e.audiences&&e.audiences.length>0&&e.audiences[0]!==l.e.Empty)}function h(){return u.t.isActivated("c3d89da1-4105-4818-9cd3-f4a8b4ad9016")}},,,,,function(e,t,n){"use strict";var a=n(0),i=n(2203),r=n(2238),o=function(e){function t(t){var n,a,i=e.call(this,t)||this,r=i.valueAccessor();return a=(n=i.isObservable(r)?{hasFocus:r}:r).focusState?n.focusState:n.hasFocus?i.createComputed({read:function(){return n.hasFocus()?2:0},write:function(e){return n.hasFocus(!!e)},pure:!0}):i.createObservable(0),i._focusState=a,i._asyncUpdateFocus=i.async.debounce(i._updateFocus,30),i.events.on(i.element,"focus",i._onFocus),i.events.on(i.element,"blur",i._onBlur),i.subscribe(i._focusState,i._onFocusStateChanged),n.timeout?i.async.setTimeout(i._startUpdateFocus,n.timeout):i._startUpdateFocus(),i}return Object(a.__extends)(t,e),t.prototype._onFocus=function(){this._focusState(2),this._startUpdateFocus()},t.prototype._onBlur=function(){this._focusState(0),this._startUpdateFocus()},t.prototype._onFocusStateChanged=function(){this._startUpdateFocus()},t.prototype._startUpdateFocus=function(){this._focusAttempts=0,this._updateFocus()},t.prototype._updateFocus=function(){var e=this._focusState.peek();if(e){this._focusAttempts++;var t=Object(r.t)(this.element),n=void 0,a=void 0;t&&(n=t.scrollTop,a=t.scrollLeft),this.element.focus(),t&&1===e&&(t.scrollTop!==n&&(t.scrollTop=n),t.scrollLeft!==a&&(t.scrollLeft=a)),!this._checkIfFocused()&&this._focusAttempts<3&&this._asyncUpdateFocus()}else this.element.blur()},t.prototype._checkIfFocused=function(){var e,t=this.element.ownerDocument;try{e=t.activeElement}catch(n){e=t.body}return e===this.element},t}(i.t);t.e=o},function(e,t,n){"use strict";var a=function(){function e(t){var n;if(this._raw=t,t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var a,i,r=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,s=e.EmailMatchTypes.None;null!==(i=r.exec(t));){var c=i[0],d=c.charAt(0),l=c.charAt(c.length-1);if((s="<"===d&&">"===l?e.EmailMatchTypes.Bracketed:'"'===d&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o&&(a=i,o=s,s===e.EmailMatchTypes.Bracketed))break}var u=t;if(a){n=a[0];var f=a.index,p=f+n.length,m=f>0?t.substr(0,f).trim():"",_=p<t.length?t.substr(p):"";"'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&_&&"'"===_.charAt(0)&&(n=n.slice(1),_=_.slice(1).trim()),u=""===m?_:m,this._email=n.trim()}(u=u.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==u.charAt(u.length-2)&&(u=u.replace(/\s*"$/,"")),""!==(u=u.replace(/\//g,""))&&u!==n&&(this._name=u)}}return e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())},e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),a=[],i=0,r=n.length;i<r;i++)a.push(new e(n[i]));return a},e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1},e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),a=n.length-1;a>=0;a--)n[a]=n[a].trim(),0===n[a].length&&n.splice(a,1);return n},e.prototype.getEmail=function(){return this._email},e.prototype.getName=function(){return this._name},e.prototype.getRaw=function(){return this._raw},e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?",e.EmailRegex=new RegExp(e.EmailRegexPattern,"i"),e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)",e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i"),e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/,e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/,e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3},e}();t.e=a},,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(65),i=n("knockout-lib"),r=n(2266),o=Object(r.e)("sp-teamify-banner","@ms/odsp-shared-react/lib/TeamifyBanner",function(){return a.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(860)]).then(n.bind(null,3163)))});i.components.isRegistered(o.tagName)||i.components.register(o.tagName,o),t.default=o},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a.e}),n(5193);var a=n(3012)},,,,,,,function(e,t,n){"use strict";var a=n(65),i=n(601),r=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0,a.n.is(n.result)&&n.result.cancel()}),this._queue.push(n),t=n.signal.getPromise()}return a.n.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(n){t.signal.complete(n),e._promiseComplete()},function(n){t.signal.error(n),e._promiseComplete()}))}},e}();t.e=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1214),r=n(136),o=n(2470),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.contexts=a.observables.createArray(),a._additions=[],a._removals=[],a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.transclude=function(e){var t=this;return this._needsOverlayContent.needsOverlayContent.set(!0),this._transclude(e),{dispose:function(){t._dispose(e)}}},t.prototype._transclude=function(e){this._additions.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._dispose=function(e){this._removals.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate(),e.push.apply(e,t);for(var a=0,i=n;a<i.length;a++){var r=i[a],o=e.indexOf(r);o>-1&&e.splice(o,1)}this.contexts.valueHasMutated()},t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated(),this._updateContextsTimeoutId=void 0,(this._additions.length||this._removals.length)&&this._updateContexts()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{needsOverlayContent:o.e}),t}(i.default),c=new r.n(s,i.default.dependencies)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"r",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"n",function(){return d});var a=n(3363),i=new a.e("checkout"),r=new a.e("quickEdit"),o=new a.e("editItem"),s=new a.e("viewItem"),c=new a.e("versionHistory"),d=new a.e("exportList")}],Array(18),[function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};function r(e){var t=e;return!(!t||!(t.tagName in a)&&!t.isContentEditable)}function o(e){return!(!e||!(e.tagName in i))}},,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return u});var a=n(0),i=n(2741),r=n(136),o=n(38),s=n(97),c=n(12),d=function(){function e(){}return e.Online="Online",e.Offline="Offline",e}(),l=function(e){function t(t,n){return e.call(this,n.pageContext)||this}return Object(a.__extends)(t,e),t.prototype.getListAIModel=function(e,t){var n="".concat(e,"/_api/web/Lists('").concat(t,"')/rootfolder/properties?$select=vti_x005f_modellibrary,vti_x005f_predictionmodelid,vti_x005f_predictionmodel");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e);return null==t?void 0:t.d},qosName:"getListModelProperty",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then(function(e){var t,n=e.vti_x005f_modellibrary||"",a=n?{driveId:n}:void 0,i=e.vti_x005f_predictionmodelid||"",r=e.vti_x005f_predictionmodel||"",o=[];if(r)try{o=JSON.parse(r)}catch(e){s.e.logError("JSON parse failed for vti_x005f_predictionmodel propety value: "+r)}if(c.e.isActivated("d4a520ab-4c94-4f34-a24d-afbb43276999","09/23/2021","Avoid using Array find method because of error in IE11 that find function is undefined"))t=i&&o&&o.length>0?o.find(function(e){return e.id===i}):void 0;else if(i&&o&&o.length>0)for(var d=0;d<o.length;d++)if(o[d].id===i){t=o[d];break}return{machineTeachingModel:a,predictionModel:t||(!t&&i?{id:i}:void 0)}})},t.prototype.updateFormProcessingModelRetentionLabel=function(e,t,n){var a="".concat(e,"/_api/web/Lists('").concat(t,"')/UpdateFormProcessingModelRetentionLabel(retentionLabel='").concat(n,"')");return this.dataRequestor.getData({url:a.toString(),qosName:"updateFormProcessingModelRetentionLabel",method:"POST",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},noRedirect:!0})},t.prototype.UpdateFormProcessingModelSettings=function(e,t,n,a){var i=void 0!==n?n:"",r=void 0!==a?a:"",o="".concat(e,"/_api/web/Lists('").concat(t,"')/UpdateFormProcessingModelSettings(retentionLabel='").concat(i,"',linkedList='").concat(r,"')");return this.dataRequestor.getData({url:o.toString(),qosName:"UpdateFormProcessingModelSettings",method:"POST",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},noRedirect:!0})},t.prototype.getLayoutCandidateFields=function(e,t){var n="?$select=Id,Title,TypeDisplayName,InternalName&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (FieldTypeKind eq 2)",a=t?"".concat(e,"/_api/web/Lists('").concat(t,"')/fields").concat(n):"".concat(e,"/_api/web/fields").concat(n);return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getLayoutCandidateFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getLinkedCandicateLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title&$filter=BaseTemplate eq 100 and BaseType eq 0 and Hidden eq false");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n=JSON.parse(e);return null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.results},qosName:"getLinkedCandicateLists",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})},t.prototype.getAllLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title,BaseTemplate,BaseType,Hidden");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n=JSON.parse(e);return null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.results},qosName:"getLinkedCandicateLists",method:"GET",additionalHeaders:{accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}})},t.dependencies={pageContext:o.f},t}(i.e),u=Object(r.r)("ListModelDataSource",l)}],Array(14),[function(e,t,n){"use strict";var a=n(543),i=n(186),r=Object(i.t)(a.r),o=r?window.require.toUrl("odsp-media/fluenthybridfont/"):window.require.toUrl("odsp-media/fonts/");(r?function(){return n.e(703).then(n.bind(null,5833))}:function(){return n.e(700).then(n.bind(null,5834))})().then(function(e){(0,e.initializeIcons)(o,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)})},,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.right=1]="right",e[e.flip=2]="flip",e[e.left=3]="left"}(a||(a={}));var i=a},,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"e",function(){return p});var a=n(2),i=n(126),r=n(16),o=n(1082),s=n(24),c=n(19),d=n(553),l=n(3),u=new i.e("knockoutStoreItem",function(e,t){var n=t.itemKey,a=e.demandItemFacet(d.t,n);if(void 0!==a){Object(l.co)(l.Vr)||e.demandItemFacet(p,n&&f.serialize({itemKey:n}));var i=e.demandItemFacet(o.e,r.c),s=o.e.evaluate(i)(e,{}).getItem;if(s)return s(a.key)}}),f=new s.e("odspNextStoreKey",{itemKey:c.e}),p=new a.e("createdStoreItem")}],Array(17),[function(e,t,n){"use strict";var a;!function(e){e[e.normal=0]="normal",e[e.blocker=1]="blocker",e[e.vaultBlocker=2]="vaultBlocker"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(2813),r=new a.t({name:"OverlayProvider.key",factory:i.e})},function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"i",function(){return u});var a=n(1214),i=n(996),r=n(10),o=function(e){return{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(t){var n=new(0,t.observablesFactoryType)({}),a=n.create();return e&&(a.equalityComparer=i.n),{instance:a,disposable:n}}}},s=new r.t({name:"".concat("ShareCommandKeys",".shareFocusItem"),factory:o(!0)}),c=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),d=new r.t({name:"".concat("ShareCommandKeys",".copyFormLinkFocusItem"),factory:o()}),l=new r.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),u=new r.t({name:"".concat("ShareCommandKeys",".shareFromGrantAccess"),factory:o()})},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(706),i=void 0;function r(e){if(void 0===i)for(var t in i={},a.e){var n=parseInt(t);if(!isNaN(n)){var r=a.e[n].toLowerCase();i[r]=n}}var o=e?e.toLowerCase():"";return i[o]||a.e.unknown}t.e=a.e},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(3363),i=new a.e("createWorkflow"),r=new a.e("baseFlow")},,,,,function(e,t,n){"use strict";var a=n(0),i=(n(4412),n("react-lib")),r=n(2206),o=n(10),s=n(3063),c=n(2262),d=n(124),l=n(53),u=n(293);function f(e){var t=e.specification,n=e.placeholder,a=Object(l.n)(),o=Object(s.t)(t),f=Object(d.e)(function(t,i){var s=new u.e;if(e.onApplyBindings){var c=e.onApplyBindings(t);c&&s.attach(c)}return s.attach(new(a.resolved(r.a))({element:t,valueAccessor:function(){return{specification:o,placeholder:n}},bindingContext:i})),s});return i.createElement(c.e,{applyBindings:f},e.children)}function p(e){var t=e.resources,n=Object(a.__rest)(e,["resources"]),r=i.createElement(f,Object(a.__assign)({},n));return t?i.createElement(l.e,{resources:t},r):r}t.e=p,new o.t({name:"Knockout",factory:new o.e(p)})}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o});var a=n(0),i="__shyConductor";function r(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return o()?[2,o()]:[3,1];case 1:return[4,Promise.all([n.e("plt.resx-plt"),n.e("deferred.resx-deferred"),n.e("deferred")]).then(n.bind(null,5250))];case 2:return[2,e.sent().default]}})})}function o(){return window[i]}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("rootItems")}],Array(24),[function(e,t,n){"use strict";var a=n(2202),i=n(0),r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.isSelectable,i=void 0!==a&&a,r=t.isSelected,o=void 0!==r&&r;return n.isSelectable=n.wrapObservable(i),n.isSelected=n.wrapObservable(o),n}return Object(i.__extends)(t,e),t}(n(2201).e),o=Object(a.e)({tagName:"ms-item-check",template:'<span class="ItemCheck"><i class="ItemCheck-circle ms-Icon ms-Icon--CircleRing" data-bind="icon:true"></i><i class="ItemCheck-check ms-Icon ms-Icon--StatusCircleCheckmark" data-bind="icon:true"></i></span>',viewModel:r,synchronous:!0});t.e=o},,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"disabledCampaign",function(){return _}),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(40),r=n(1214),o=n(136),s=n(232),c=n(114),d=n(146),l=n(435),u=n(3356),f=n(3285),p=n(73),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.D)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.default);t.default=h;var b=Object(o.r)("CoachmarkProvider",h)},function(e,t,n){"use strict";var a;!function(e){e[e.Lock=1]="Lock",e[e.Unlock=2]="Unlock",e[e.Manage=3]="Manage",e[e.FreDialog=4]="FreDialog",e[e.ShowFiles=5]="ShowFiles",e[e.Reset=6]="Reset",e[e.Debug=7]="Debug",e[e.FilesRemaining=8]="FilesRemaining"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(345),i=n(136),r=n(3291),o=n(3012),s=n(3848),c=Object(i.r)("GraphPeoplePickerHelper",r.t,{oAuthTokenProvider:o.e,pageContext:a.e,sharingContextInformation:s.e.optional})}],Array(25),[function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(10),i=n(136),r="f9ebc8b2-a976-48f0-a8fa-0846164c0466",o=new a.t({name:"ListDataSource.key",loader:new i.t(function(){return n.e(805).then(n.bind(null,2308)).then(function(e){return e.resourceKey})})})},,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(65),r=n(1214),o=n(100),s=n(2229),c=n(37),d=n(10),l=n(136),u=n(2269),f=!n(15).e.isActivated("8485CDCB-7021-4116-8F71-B4B0E64E13EB","6/21/2022","Blocks KOToItemCacheItemsStore from being used in the ShortcutProvider, which is fully KO"),p=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=n.urlDataSource,f?(a.legacyStoreResourceScope=a.addDisposable(new d.n(a.resources)),a.legacyStoreResourceScope.block(u.t),a._itemProvider=a.legacyStoreResourceScope.consume(s.resourceKey)):a._itemProvider=n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.createShortcut=function(e,t,n){var a=this;return this._getShortcutDataSource().then(function(a){return a.createShortcut(e,t,n)}).then(function(t){return a._itemProvider.invalidateItem(e),t})},t.prototype.getShortcutTargetData=function(e,t,n,a){return this._getShortcutDataSource().then(function(i){return i.getShortcutTargetData({url:e,avoidGetFileByUrlCall:t,parentKey:n,targetSiteUrl:a})})},t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})},t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(c.e.Recent),startIndex:0,endIndex:5,queryType:c.e.Recent};return this._itemProvider.getItem(e)},t.prototype._getShortcutDataSource=function(){return i.n.resolve(this.resources.consumeAsync(o.ne))},t}(r.default);t.default=p;var m=Object(l.r)("ShortcutProvider",p,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{urlDataSource:o.ue,itemProvider:s.resourceKey}))},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1632);function i(e){return!!e.flags2&&Object(a.e)(e.flags2,e.isDocLib,e.listTemplateType)}},function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"e",function(){return a}),n.d(t,"r",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"i",function(){return l});var a,i=n(15),r=n(4446),o="metadatasearchfield",s=i.t.isActivated("b14cddcb-bed5-46fa-a924-d2c3b45f8020","11/09/2022","add title attribute to dropdown");!function(e){e[e.Text=0]="Text",e[e.DateRange=1]="DateRange",e[e.Date=2]="Date",e[e.PeoplePicker=3]="PeoplePicker",e[e.ContentType=4]="ContentType",e[e.Boolean=5]="Boolean",e[e.Currency=6]="Currency",e[e.Number=7]="Number",e[e.TextMultiple=8]="TextMultiple",e[e.Dropdown=9]="Dropdown",e[e.Percentage=10]="Percentage",e[e.ManagedMetadata=11]="ManagedMetadata"}(a||(a={}));var c=[{key:"inclusion",text:r.n,selected:!0,title:s?void 0:r.n},{key:"exclusion",text:r.a,title:s?void 0:r.a}];function d(e){var t=[{displayName:r.o,fieldType:a.Text,isSystemField:!0},{displayName:r.i,fieldType:a.Text,isSystemField:!0,kqlProperty:"Filename"},{displayName:r.u,fieldType:a.PeoplePicker,isSystemField:!0,kqlProperty:"People"},{displayName:r.s,fieldType:a.DateRange,isSystemField:!0,kqlProperty:"LastModifiedTime"},{displayName:r.r,fieldType:a.Dropdown,isSystemField:!0,kqlProperty:"FileType",choices:[{key:"powerpoint",text:r.p,data:{iconName:"pptx"},title:s?void 0:r.p},{key:"word",text:r._,data:{iconName:"docx"},title:s?void 0:r._},{key:"excel",text:r.t,data:{iconName:"xlsx"},title:s?void 0:r.t},{key:"pdf",text:r.l,data:{iconName:"pdf"},title:s?void 0:r.l},{key:"photo",text:r.f,data:{iconName:"photo"},title:s?void 0:r.f},{key:"video",text:r.m,data:{iconName:"video"},title:s?void 0:r.m},{key:"other",text:r.d,data:{iconName:"genericfile"},title:s?void 0:r.d}]},{displayName:r.e,fieldType:a.ContentType,isSystemField:!0,kqlProperty:"ContentTypeId"}],n=t;return e&&(n=t.filter(function(e){return"Filename"!==e.kqlProperty&&"FileType"!==e.kqlProperty})),n.forEach(function(e,t){e.fieldId=t}),n}function l(e,t){return t||/^0x012000.{32}$/i.test(e)||/^0x010100.{32}$/i.test(e)||/^0x01010400.{32}$/i.test(e)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("SmartFiltersDataSource.key")},function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return u});var a=n(0),i=n(83),r=n(138),o={};function s(e){return o[e]}function c(e,t){o[e]=t}function d(e){var t=s(e);if(t&&(t.end({resultType:i.e.Failure}),t=void 0),!t){var n={name:e};c(e,t=new r.e(n))}return t}function l(e){f(e,i.e.Success)}function u(e,t){f(e,i.e.Failure,t)}function f(e,t,n){var i=s(e);if(i){var r={resultType:t};n&&(r=Object(a.__assign)(Object(a.__assign)({},r),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}})),i.end(r),c(e,void 0)}}}],Array(23),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(136),i=n(3719),r=n(754),o=n(623),s=n(3291),c=n(3361),d=n(65),l=n(35),u=function(){function e(e,t){this._getIdentityDataSource=t.getIdentityDataSource}return e.prototype.getToken=function(e,t){return this.getInstrumentedToken(e,t).then(function(e){return e.tokenInfo.token})},e.prototype.getInstrumentedToken=function(e,t){var n=Date.now();return d.n.resolve(this._getIdentityDataSource().then(function(t){return e===s.e&&t.getGraphToken?t.getGraphToken({resource:e}):e===c.e&&t.getSubstrateToken?t.getSubstrateToken(o.e.Default):"ocps"===e&&t.getOCPSToken?t.getOCPSToken():t.getOAuthSessionToken?t.getOAuthSessionToken(e):void 0}).then(function(e){var t=null==e?void 0:e.accessToken;if(!e||!t)throw new l.e({code:"UnableToResolveToken"});return{tokenInfo:{token:t,isGuest:!1,expirationTimeMs:e.tokenExpiry},spRequestId:e.correlationId||"",spRequestTimestamp:n}}))},e}(),f=Object(a.r)("OAuthTokenDataSource",u,{getIdentityDataSource:r.e.async.lazy}),p=Object(a.r)("OAuthTokenProviderBase",i.e,{oAuthTokenDataSource:f})},,,,,function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){this._originalProvider=new a.bindingProvider,this._bindingHandlers={},this._bindingContexts=[]}return e.getInstance=function(){return e._instance},e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)},e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}},e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||a.bindingHandlers[e]},e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,r=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;return this._bindingHandlers[r]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)},this._bindingHandlers[r].after=t.after,t.supportsVirtualElements&&(a.virtualElements.allowedBindings[r]=!0),r},e.prototype._remapKeys=function(e,t){var n=e,a=this._getLocalBindingHandlers(t);if(a)for(var i in n={},e){var r=a[i];n[r&&this.getUniqueKeyForBindingHandler(r,i)||i]=e[i]}return n},e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t},e._instance=new e,e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey",e._lastUniqueKeyOrdinal=0,e}().getInstance();a.getBindingHandler=i.getBindingHandler.bind(i),a.bindingProvider.instance=i},,function(e,t,n){"use strict";var a=n(3283),i=n("knockout-lib"),r=n(996);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n("knockout-lib"),r=n(44),o=n(320),s=n(38),c=n(69),d=n(181),l=n(1451);function u(e){var t=e.listSchema,n=e.resources,a=e.groupSchema,i=e.hasFixedSchema,r=e.listContext,u=e.getItemContext,f=e.sortFallback,m=n.consume(o.f.optional),_=n.consume(d.e).isMobile&&n.consume(o.k.optional);r||(r=n.consume(s.o));var h={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:_,disableShareHeroCommand:m},b=l.e.buildSchema(t,r,h,a,u),g=n.consume(s.f),v=Number(g.webTemplate)===c.t.mySite;return b.filter(function(e){return!v||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){return e.groupable=!v&&e.groupable,f.sortField===e.internalName&&f.sortDirection&&(e.isSorted=!0,e.isAscending="ascending"===f.sortDirection),p(e,r)})}var f=function(){function e(){}return e.getCustomColumns=function(e,t,n){var a=this,i=this._convertToSPColumn(e),r=t.map(function(e){return e.map(function(e){return a._convertToSPColumn(e)})}),o=n.map(function(e){return a._convertToSPColumn(e)});return l.e.getCustomColumns(i,r,o).map(function(e){return p(e)})},e.getMappedColumnType=function(e){return l.e.getMappedColumnType(e)},e.getIconColumnWidth=function(e){return e.consume(d.e).isMobile&&e.consume(o.k.optional)?48:16},e.getIconColumnMinWidth=function(e){return e.consume(d.e).isMobile&&e.consume(o.k.optional)?48:16},e.fillColumnDefinitionDefaults=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={});var o=t.isCollapsible,s=void 0===o||o;return e.map(function(e,o){var c=e.isIcon,d=void 0!==c&&c,l=e.sortable,u=void 0===l?!!t.sortable:l,f=e.resizable,p=void 0===f?!!t.resizable:f,m=e.isCollapsable,_=void 0===m?s:m,h=e.fieldType,b=void 0===h?r.e.Text:h,g=e.name,v=e.getValue,y=e.key,S=e.width,D=!!n.sortField&&n.sortField===e.internalName,I=!!n.groupBy&&n.groupBy===e.internalName;return Object(a.__assign)(Object(a.__assign)({},e),{key:y,name:g,width:S,index:o,fieldType:b,isCollapsable:_,isIcon:d,isVisible:!0,isVisibleMobile:!0,isGrouped:I,sortable:u,isSorted:D,isAscending:D&&n.isAscending,filterable:!1,isFocused:i.observable(!1),getValue:v,resizable:p})})},e._convertToSPColumn=function(e){var t=this;return Object(a.__assign)(Object(a.__assign)({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})},e}();function p(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{key:(n=e.key,"FileSizeDisplay"===n?"size":n),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:i.observable(e.isFiltered),isMenuOpen:i.observable(!1),isFocused:i.observable(!1),customWidth:i.observable(0),filterValues:i.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return p(e,t)}):void 0});var n}t.e=f},,,function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(3363),i=new a.e("upload"),r=new a.e("download"),o=new a.e("sync")},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a={"ar-SA":"dd/MM/yyyy","bg-BG":"dd.MM.yyyy","ko-KR":"yyyy-MM-dd","nn-NO":"dd.MM.yyyy","ga-IE":"dd/MM/yyyy","is-IS":"dd.MM.yyyy","sv-FI":"dd-MM-yyyy","lv-LV":"dd.MM.yyyy","nb-NO":"dd.MM.yyyy"};function i(e,t){var n=a[e];if(n){var i=t.getFullYear().toString(),r=("0"+(t.getMonth()+1)).slice(-2),o=("0"+t.getDate()).slice(-2);return n.replace("MM",r).replace("dd",o).replace("yyyy",i)}return t.toLocaleDateString(e)}}],Array(22),[function(e,t,n){"use strict";var a=n(2202),i=n(0),r=n(2201),o=n(2203),s=n("knockout-lib"),c=function(e){this.templateNodes=e.templateNodes,this.bindingContext=e.bindingContext,this.renderCount=e.renderCount||s.observable(0),this.parentElement=e.parentElement||null,this.options=e.options||null},d=n(4816),l=function(e){function t(t){var n=e.call(this,t)||this;return new(n.managed(d.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new c({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)},t.supportsVirtualElements=!0,t}(o.t),u=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({transclusionContent:l}),n._provider=t.provider,n.bindingParams={context:s.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options},n.createComputed(function(){var e=n.bindingParams.context();n._transclusion&&(n._transclusion.dispose(),n._transclusion=null),e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))}),n}return Object(i.__extends)(t,e),t}(r.e),f=a.e({tagName:"od-transclusion-content",template:"\x3c!--ko transclusionContent:bindingParams--\x3e\x3c!--/ko--\x3e",viewModel:u,synchronous:!0});t.e=f},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"a",function(){return f}),n(0);var a=n("react-lib"),i=n(53),r=n(681),o=n(1214),s=n(226),c=n(384);function d(e,t){var n=function(e,t){var n=f(),i=u(a.useMemo(function(){return e},t)),r=a.useRef();return r.current||(r.current=Object(s.e)(n.pureCompute(function(){return i()()}),{equalityComparer:c.e}))}(e,t);return l(n)}function l(e){var t=f(),n=t.peekUnwrap(e),i=a.useState(function(){return n})[1];return a.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]),n}function u(e,t){var n,i=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,r=f(),o=a.useRef(),d=o.current||(o.current=Object(s.e)(r.create(e),{equalityComparer:c.e}));return(i?a.useMemo:a.useEffect)(function(){d(e)},[e]),d}function f(){var e=Object(i.n)(),t=a.useRef(),n=t.current||(t.current=new(e.consume(o.observablesFactoryTypeResourceKey.optional)||r.e));return a.useLayoutEffect(function(){return function(){n.dispose()}},[]),n}}],Array(27),[function(e,t,n){"use strict";var a;n.r(t),function(e){function t(e){var t,n="";switch(e.fieldSchema.Type){case"User":case"Lookup":n=e.name;break;case"DateTime":var a=decodeURIComponent(e.groupString).split(";#"),i=a[0];a.length>0&&(a=a.slice(1,a.length-1))[e.level]&&(i=a[e.level]),n=(t=i)?[t.substring(0,4),"-",t.substring(4,6),"-",t.substring(6,8)].join(""):t;break;default:n=e.fieldValue}return n}e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level)return t.filter(function(t){return t.groupingId===e.parentKey})[0]},e.getFilterDetails=function(n,a){for(var i=n,r=[],o=[];i&&i.fieldSchema;){r.unshift(i.fieldSchema.Name);var s=t(i);o.unshift(s),i=e.getParent(i,a)}return{fields:r,values:o}}}(a||(a={})),t.default=a}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(2428),i=n(0),r=n("react-lib"),o=n(57),s=n(3063),c=n(2862);function d(e,t){void 0===t&&(t={});var n,d=Object(a.createItemsScopeActionFromKnockout)(e,t);return(n=function(e){return{item:e}},function(e){var t=e;return Object(o.e)(function(e,t){return{storeItem:e.demandItemFacet(c.t,t.itemKey)}})(function(e){var a=e.storeItem,o=Object(s.n)(a),c=Object(s.t)(o);return r.createElement(t,Object(i.__assign)({},e,n(c)))})})(d)}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"r",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c});var a="MoveItemsOperation",i="CopyItemsOperation",r="MoveItemsOperationAsync",o="CopyItemsOperationAsync",s="CopyItems",c="MoveItems"},,function(e,t,n){var a;!function(i,r){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,a){return 1===arguments.length?t.get(e):t.set(e,n,a)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[t._cacheKeyPrefix+e]},t.set=function(e,n,a){return(a=t._getExtendedOptions(a)).expires=t._getExpiresDate(n===r?-1:a.expires),t._document.cookie=t._generateCookieString(e,n,a),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var a=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return a+=(n=n||{}).path?";path="+n.path:"",a+=n.domain?";domain="+n.domain:"",(a+=n.expires?";expires="+n.expires.toUTCString():"")+(n.secure?";secure":"")},t._getCacheFromString=function(e){for(var n={},a=e?e.split("; "):[],i=0;i<a.length;i++){var o=t._getKeyValuePairFromCookieString(a[i]);n[t._cacheKeyPrefix+o.key]===r&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},s="object"==typeof i.document?o(i):o;(a=function(){return s}.call(t,n,t,e))===r||(e.exports=a)}("undefined"==typeof window?this:window)},function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"r",function(){return d});var a=n(3363),i=(new a.e("createExcel"),new a.e("createOneNote"),new a.e("createPowerPoint"),new a.e("createWord"),new a.e("createSurvey"),new a.e("viewSurvey"),new a.e("editSurvey"),new a.e("publishSurvey"),new a.e("openOnline")),r=new a.e("openInClient"),o=(new a.e("viewVersionHistory"),new a.e("openInPowerBI")),s=new a.e("contentTypeNavigation"),c=new a.e("editNewMenu"),d=new a.e("uploadTemplate")},function(e,t,n){"use strict";var a=function(){function e(){}return e.alert=function(t,n,a,i,r){void 0===a&&(a=!1),void 0===r&&(r="alert");var o="sp_a11y_alert_"+t,s=document.querySelector("#"+o);s&&document.body.removeChild(s);var c=document.createElement("p");a||c.setAttribute("style",e._cssHidden),i&&c.classList.add(i),c.setAttribute("role",r),c.setAttribute("aria-live","assertive"),c.setAttribute("id",o);var d=document.createTextNode(n);document.body.appendChild(c),c.appendChild(d)},e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;",e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1214),i=new(n(10).t)({name:"".concat("Selection.key",".hasSelection"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.createCallback({defaultValue:!1,reducer:function(e,t){return e||t}}),disposable:t}}}})}],Array(21),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(0);function i(e){if(e){var t=e.fieldSchema,n=e.children,r=Object(a.__rest)(e,["fieldSchema","children"]);return Object(a.__assign)({fieldSchema:t?Object(a.__assign)(Object(a.__assign)({},t),{Name:t.Name}):void 0,children:n?n.map(i):void 0},r)}}}],Array(39),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1214),i=new(n(10).t)({name:"".concat("UseItemCacheData.key",".useItemCacheData"),factory:{dependencies:{observablesFactoryType:a.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},a=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(a){var i=void 0,r=void 0;(e=(e=a[2]||"0").slice(-16)).length<=8?(i=0,r=parseInt(e,16)):(i=parseInt(e.slice(0,-8),16),r=parseInt(e.slice(-8),16)),isNaN(i)||isNaN(r)||(n.High=i,n.Low=r)}return n},e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})},e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}}(a||(a={})),t.t=a},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(3),i=n(172);function r(e){var t=!!e&&!!e.folder,n=e&&e.properties.ProgId;return o()&&t&&s(n)}function o(){return Object(a.co)(a.Ti)}function s(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}function c(e){return e&&e.relatedGroupId&&(e.teamsChannelType===i.o.SharedChannel||e.teamsChannelType===i.o.PrivateChannel)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"SuiteNavProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(638)]).then(n.bind(null,2383)).then(function(e){return e.resourceKey})})})}],Array(72),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(136),i=n(0),r=n(299),o=n(754),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(i.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{identityDataSource:o.e}),t}(r.e),c=Object(a.r)("GraphTokenProvider",s),d=n(10),l=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),u=new d.t({name:"GraphUrlDataSource",factory:new a.i(l)}),f=n(1224),p=Object(a.r)("GraphDataRequestor",f.e,{sessionManagementProvider:c,urlDataSource:u});f.e},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(4),i=n("react-lib"),r=n(4415),o=n(5180),s=n(98),c=n(661),d={root:"ms-StackItem"},l={start:"flex-start",end:"flex-end"},u=Object(o.e)(function(e){var t=e.children,n=Object(s.s)(e,s.c);if(i.Children.count(t)<1)return null;var o=Object(r.t)(e,{root:"div"});return Object(r.n)(o.root,Object(a.e)({},n),t)},{displayName:"StackItem",styles:function(e,t,n){var a=e.grow,i=e.shrink,r=e.disableShrink,o=e.align,s=e.verticalFill,u=e.order,f=e.className,p=Object(c.e)(d,t);return{root:[t.fonts.medium,p.root,{margin:n.margin,padding:n.padding,height:s?"100%":"auto",width:"auto"},a&&{flexGrow:!0===a?1:a},(r||!a&&!i)&&{flexShrink:0},i&&!r&&{flexShrink:1},o&&{alignSelf:l[o]||o},u&&{order:u},f]}}})}],Array(18),[function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n("react-lib"),r=n(83),o=n(97),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)},t.prototype.componentDidCatch=function(e,t){var n=this.props.onError;o.e.logError(e,{"react.componentStack":t.componentStack,"react.component":this.props.componentName},{eventName:"ReactRenderError",resultCode:"",resultType:r.e.Failure}),n&&n(e)},t}(i.PureComponent)},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"UploadOperator.key",loader:new i.t(function(){return Promise.all([n.e("deferred"),n.e(532)]).then(n.bind(null,3449)).then(function(e){return e.typeResourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(1214),r=new a.t({name:"".concat("UploadedItemResourceKey",".UploadedItem"),factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(225),i=n(214),r=n(40),o=n(4817),s=n(593);function c(e,t,n,c,d){if(!c)return[!1,void 0];var l=Object(s.e)(c);if(Object(s.i)(l)||Object(s.n)(l))return[!1,void 0];var u=Object(r.isFeatureEnabled)(n);if(Object(s.r)(l)&&!u)return[!1,void 0];var f=Object(r.isFeatureEnabled)(e),p={experimentId:"number"==typeof e.ODB?e.ODB:void 0,variant:f?1:0,isAATest:!1,isOverride:a.n.isFeatureEnabled(e),correlationId:c?c.CorrelationId:"",cloudType:c?String(c.cloudType):""},m=0;f||(m=Object(i.n)(t,c));var _=function(e,t){if(!t)return{experimentId:e,variant:void 0,isAATest:!1,isOverride:!1,correlationId:"",cloudType:""};var n=Object(i.t)(e,t);return{experimentId:n._experimentId,variant:n._variantToLog,isAATest:n._isAATest,isOverride:n._isOverride,correlationId:t.CorrelationId,cloudType:String(t.cloudType)}}(t,c),h=f?p:_,b=f||m>0;return void 0!==h.variant?[b,h=function(e,t){var n=o.e();return void 0===e.variant||t&&JSON.stringify(t)===JSON.stringify(e)||(o.t(n,e),t=e),t}(h,d)]:[b,void 0]}},function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return m});var a=n(65),i=n(225),r=n(83),o=n(138),s=n(232),c=n(114),d=n(15),l={ODB:387},u="https://graph.microsoft.com",f="DisableGraph",p=!d.t.isActivated("f70d9a82-9e0b-4ab4-8337-221f328b5181","10/19/2022","enable crossdomain fetch graph token")&&!i.n.isFeatureEnabled({ECS:1047773}),m=function(){function e(e,t){var n=this;this._getOauthProviderGetTokenPromise=function(){return n._oAuthTokenProvider?n._oAuthTokenProvider.getToken(u):null},this._getTokenReturnPromise=function(e,t,i,o){return e.then(function(e){return i.end({resultType:r.e.Success}),e},function(e){var s=o?o():null;return s?n._getTokenReturnPromise(s,"oAuthTokenProvider.getToken",i):a.n.isCanceled(e)?(i.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(e)):(i.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message,providerName:t}}),n.disableGraphCallsForPicker(),null)})},this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&(!p||!this._pageContext.getAuthToken)&&this._pageContext.authToken)return!1;var e=this._pageContext&&(this._oAuthTokenProvider||p&&this._pageContext.getAuthToken)&&i.n.isFeatureEnabled(l);return this._dataStore&&(e=e&&!this._dataStore.getValue(f,c.e.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(f,!0,c.e.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return a.n.resolve(this._graphToken);if(p){var t=new o.e({name:"PeoplePicker.GetGraphToken"});if(this._pageContext&&this._pageContext.getAuthToken)return this._getTokenReturnPromise(this._pageContext.getAuthToken("ms-graph",this._pageContext.msGraphEndpointUrl?this._pageContext.msGraphEndpointUrl:"https://graph.microsoft.com").then(function(e){if(e)return e;throw new Error("token is empty")}),"pageContext.getAuthToken",t,this._getOauthProviderGetTokenPromise);if(this._oAuthTokenProvider)return this._getTokenReturnPromise(this._oAuthTokenProvider.getToken(u),"oAuthTokenProvider.getToken",t)}else if(this._oAuthTokenProvider){var n=new o.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(u).then(function(e){return n.end({resultType:r.e.Success}),e},function(t){return a.n.isCanceled(t)?(n.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(t)):(n.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(0),r=n(2213),o=n(65),s=n(83),c=n(2221),d=n(100),l=n(265),u=n(863),f=n(37);!function(e){e[e.DefaultClick=0]="DefaultClick",e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline",e[e.OpenFileLocation=2]="OpenFileLocation",e[e.OpenItemActivityItem=3]="OpenItemActivityItem",e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(a||(a={}));var p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i,o=t.actionType;return n.name="OpenInDesktop",n._itemSelectionHelper=new(n.child(c.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n._urlDataSource=n.resources.consume(d.ue),n._actionType=o,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),i={id:n.id,name:n.name,actionType:a[this._actionType],queryType:f.e[n.queryType],itemType:l.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[u.t.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};return window.external.notify(JSON.stringify(i)),o.n.wrap({resultType:s.e.Success})},t}(r.e);t.t=p},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)({name:"ModuleLoaderDataSource.key"})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(1214),r=new a.t({name:"".concat("IsListFormActivityPaneExpanded.key",".IsListFormActivityPaneExpanded"),factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})}],Array(16),[function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){}return e.update=function(e,t){var n=a.unwrap(t());e.style.visibility=n?"inherit":"hidden"},e}();t.e=i}],Array(25),[function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(4826),o=n(682),s=n(93),c=n(1473),d=n(753),l=function(e){function t(t){var n=e.call(this,t)||this;return n.resources&&(n._itemUrlHelper=n.resources.consume(d.c),n._sharingContextInformation=n.resources.consume(c.e.optional)),n._sharingDataSourceHelperCommon=new r.e({itemUrlHelper:n._getItemUrlHelper(),sharingContextInformation:n._getSharingContextInformation()}),n}return Object(a.__extends)(t,e),t.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return o.e(t[0],!0)+(t[1]?"?".concat(t[1]):"")},t.prototype.getApiRoot=function(e,t){var n=this.getParentListId(t),a=this._getSharingContextInformation();return a&&t.isRootFolder&&(a.isListSharing=!0),this._sharingDataSourceHelperCommon.getApiRoot(e,this.convertToISPListItem(t),n)},t.prototype.getExpirationFromLink=function(e){if(e&&e.indexOf("expiration=")>-1){var t=new s.t(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var n=Date.parse(t);if(n)return new Date(n).toString()}return null},t.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null},t.prototype.getFileUrl=function(e){return this._getItemUrlHelper().getItemUrlParts(e.key).fullItemUrl},t.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},t.prototype._getItemUrlHelper=function(){return this._itemUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t}(i.default),u=l,f=n(15),p=n(37),m=n(2220),_=n(2738),h=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(m.e),n}return Object(a.__extends)(t,e),t.prototype.getParentListId=function(e){var t,n,a;if(f.e.isActivated("d559ae5a-9bcc-467b-93a4-3bc2c5a23451","07/14/2022","Share command for search results")||(null==e?void 0:e.queryType)!==p.e.Search){var i=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=i?i.list.id:e&&e.properties?e.properties.listId:null}else if(!(a=null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.listId)){var r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));a=null===(n=null==r?void 0:r.list)||void 0===n?void 0:n.id}return a},t.prototype.convertToISPListItem=function(e){return Object(_.n)(e)},t}(u);t.e=h},,function(e,t,n){"use strict";n.d(t,"e",function(){return P}),n.d(t,"t",function(){return T});var a,i=n(0),r=n(5570),o=n(398),s=n(751),c=n(1363),d=n(4210);!function(e){e[e.unknown=0]="unknown",e[e.prefetch=1]="prefetch",e[e.hostapp=2]="hostapp",e[e.api=3]="api"}(a||(a={}));var l=n(5567),u=n(5568),f=n(5569),p=n(2884),m=n(5184),_=n(5185),h=n(5571),b=n(5572),g=n(5560),v=n(172),y=n(190),S=n(4826),D=n(85),I=n(69),x=n(3725),C=n(15),O=n(1223),w=n(2690),E=n(1004),A=n(933),L=n(225),k=!C.t.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),M=!C.t.isActivated("4d79eceb-84fd-45bc-af6c-c5946827a170","10/12/2022","ask shareLink to return nav in copy link instead of adding it on the client side")&&!A.e.isFeatureEnabled({ECS:1046652})&&L.n.isFeatureEnabled({ODB:1687}),P=function(e){function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var a=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;a._getParentListId=t.getParentListId,a._itemUrlHelper=t.itemUrlHelper||new o.e({},{pageContext:t.pageContext}),a._apiUrlHelper=t.apiUrlHelper||new s.e({},{pageContext:t.pageContext,itemUrlHelper:a._itemUrlHelper}),a._sharingContextInformation=t.sharingContextInformation||void 0,a._sharingDataSourceHelper=new S.e({itemUrlHelper:a._itemUrlHelper,sharingContextInformation:a._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(v.s)(a._pageContext);return a._shareUrl=i+"/_api/SP.Web.ShareObject",a}return Object(i.__extends)(t,e),t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})},t.parseSharingRole=function(e){switch(e){case 0:return d.e.None;default:return d.e.View;case 2:return d.e.Edit;case 6:return d.e.Review}},t.prototype.getSharingInformation=function(e,t,n,i,r,o){var s,c=this,d=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),l="pickerSettings";return t&&(l+=",permissionsInformation"),n&&(l+=",sharingLinkTemplates"),r&&(l+=",addressBarLinkSettings"),s=d.oDataParameter("$Expand",l).toString(),this.getData(function(){return s},function(t){var n=JSON.parse(t),i=c._parseGetSharingInformationResponse(n,e);return i.getSharingInformationSources=a.api,i},"GetSharingInformation",null,"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":"WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))}:null,null,null,!0,void 0,void 0,this._getExtraData(),o)},t.prototype.emailWithoutPermissioning=function(e,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return r},function(e){var a=JSON.parse(e).d,i=[];a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n&&n.id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];t.push(o.rawPersonData)}var s={peoplePickerInput:JSON.stringify(t),emailBody:a,emailSubject:i};return JSON.stringify(s)})},t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,n){var a,i=this,r=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(n.linkType===l.e.Organization||n.linkType===l.e.Edit||n.linkType===l.e.View)return this._shareLink(e,n);if(r){var o=n.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));a=s.segment("ShareObject").toString()}else a=this._shareUrl;return this.getData(function(){return a},function(e){var a=JSON.parse(e).d,i=[];Object(E.e)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(a)),a.UniquelyPermissionedUsers&&a.UniquelyPermissionedUsers.results&&(i=a.UniquelyPermissionedUsers.results);var r=[];a.InvitedUsers&&a.InvitedUsers.results&&(r=a.InvitedUsers.results);var o={};if(o.statusCode=a.StatusCode,o.errorMessage=a.ErrorMessage,o.people=t.parsePeople(i),o.invitedUsers=t.parsePeople(r),o.itemId=n.items[0]&&n.items[0].id,r.length>0&&(o.invitationLink=r[0].InvitationLink),o.invalidEmails=[],a.UsersWithInvalidEmails&&a.UsersWithInvalidEmails.results)for(var s=0,c=a.UsersWithInvalidEmails.results;s<c.length;s++){var d=c[s];o.invalidEmails.push(d.User)}return o},"Share",function(){for(var t=[],a=0;a<e.length;a++){var o=e[a];t.push(o.rawPersonData)}n.roleValue===d.e.Edit.toString()?n.roleValue=w.e:n.roleValue===d.e.View.toString()&&(n.roleValue=w.a);var s={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return r||(s.url=i._sharingDataSourceHelper.getFileUrl(n.items[0])),Object(E.e)()&&window.sessionStorage.setItem("Share_Payload",JSON.stringify(s)),JSON.stringify(s)})},t.prototype.updatePermissions2=function(e,t,n){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case u.e.none:case u.e.view:case u.e.review:case u.e.edit:case u.e.owner:t=n;break;default:t=u.e.view}var a={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(a)})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case u.e.none:t=0;break;case u.e.view:t=1;break;case u.e.review:t=6;break;case u.e.edit:t=2;break;default:t=1}var r={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:a,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.parseRawSharingInformation=function(e,t){return this._parseGetSharingInformationResponse(e,t)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=this,n=e.settings,a=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(a)).segment("ShareLink").toString(),o={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&N(this._sharingContextInformation.listId.slice(1,-1))&&(o["X-SP-REQUESTRESOURCES"]="WEBPROPERTIES, list=".concat(this._sharingContextInformation.listId.slice(1,-1))),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(o.Prefer="DirectUrlWithShareToken")),this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?(Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(t.d)),T(t)):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLink",function(){var a=null;n.expiration&&(a=Object(r.e)(n.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var o=0,s=e.recipients;o<s.length;o++){var c=s[o];c.rawPersonData&&i.push(c.rawPersonData)}}var d=null;if(n.inviteesToRemove&&n.inviteesToRemove.length>0){d=[];for(var l=0,u=n.inviteesToRemove;l<u.length;l++){var f=u[l];d.push({id:f.id,loginName:f.loginName,name:f.primaryText,isExternal:f.isExternal,principalType:f.type,email:f.email})}}var p={request:{createLink:!!n.createLink,settings:{allowAnonymousAccess:n.allowAnonymousAccess,trackLinkUsers:n.trackLinkUsers,linkKind:n.sharingLinkKind,expiration:a,role:n.role,restrictShareMembership:n.restrictShareMembership,updatePassword:n.updatePassword,password:n.password,shareId:n.shareId,description:n.description,scope:n.scope}}};if(t._sharingContextInformation&&t._sharingContextInformation.navId&&t._sharingContextInformation.optInSendNavIdInShareLink&&M&&(p.request.settings.nav=t._sharingContextInformation.navId),d&&(p.request.settings.inviteesToRemove={results:d}),i&&i.length>0){p.request.peoplePickerInput=JSON.stringify(i);var m=e.emailData,_=e.emailSubject;void 0!==m&&void 0===_&&(p.request.emailData={body:e.emailData,subject:""}),void 0===m&&void 0!==_&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==m&&void 0!==_&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var h=e.settings.shareId;h&&(p.request.settings.shareId=h,p.request.emailData={body:""});var b=JSON.stringify(p);return Object(E.e)()&&window.sessionStorage.setItem("ShareLink_Payload",b),b},"POST",0!==Object.keys(o).length?o:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,n){var a=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return a},function(e){var t=JSON.parse(e);return t.d?U(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:f.t.generic,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){if(k)return{error:e};var t="";try{t=JSON.stringify(e)}catch(e){}return{error:f.t.generic,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(O.e)(this._pageContext))return p.e.sharePoint;switch(e){case I.t.teamSite:case I.t.group:case I.t.subgroup:case I.t.sitePagePublishing:return p.e.sharePoint;case I.t.mySite:return p.e.odb;default:return p.e.sharePoint}},t.prototype._shareLink=function(e,t){var n=this,a=t.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareLink").toString();return this.getData(function(){return i},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var a=[],i=0,o=e;i<o.length;i++){var s=o[i];a.push(s.rawPersonData)}var c=null;t.expiration&&(c=Object(r.e)(t.expiration));var d={request:{peoplePickerInput:JSON.stringify(a),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:c}};return JSON.stringify(d)})},t.prototype._getSharingLinkKind=function(e,t){var n=m.e.direct;return e===l.e.Edit?n=m.e.anonymousEdit:e===l.e.View?n=m.e.anonymousView:e===l.e.Organization&&(n=t===d.e.Edit.toString()?m.e.organizationEdit:m.e.organizationView),n},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:f.t.generic,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0};var n=e.d,a=n.userPhotoCdnBaseUrl,r=n.permissionsInformation,o=!!r,s=!!n.sharingLinkTemplates,c=o,d=!!n.addressBarLinkSettings,l=o?this._parseSharingLinks(r.links.results,n.directUrl,a):[],u=s?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results,a):[],p=d?n.addressBarLinkSettings:null,b=[];if(o){var g=r.siteAdmins.results,v=r.principals.results,S=this._parseSharingPrincipals(g,void 0,a);S.forEach(function(e){return e.isSiteAdmin=!0});var I=this._parseSharingPrincipals(v,void 0,a);b=S.concat(I)}var x=this._getDefaultSharingLink(n.defaultLinkKind,n.defaultShareLinkScope,l,n.sharingAbilities),C={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var O=t.properties,w=O.ItemChildCount?parseInt(O.ItemChildCount,10):0,A=O.FolderChildCount?parseInt(O.FolderChildCount,10):0,L=t.type===y.t.OneNote?0:w+A,k=this._isPolicyTipFlagSet(t.policyTip,D.a.blockSharing);C={name:t.name,childCount:L,hasDlpPolicy:k,extension:t.extension,appmap:t.appMap,itemType:t.type}}var M=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||l.length>1,P={anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:M,defaultSharingLink:x,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!c&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(l,b),item:C,sharingLinks:l,sharingPrincipals:b,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,defaultShareLinkScope:n.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:_.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.existing,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:u,addressBarLinkSettings:p,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl,permissionsInformation:n.permissionsInformation,sensitivityLabelInformation:n.sensitivityLabelInformation},T=window.sessionStorage.getItem("Get_Sharing_Information");if(Object(E.e)()&&T&&Object.keys(T).length>0){var U=JSON.parse(T);return Object(i.__assign)(Object(i.__assign)({},P),U)}return P},t.prototype._computeIsShared=function(e,t){for(var n=!1,a=0,i=e;a<i.length;a++){var r=i[a];r.isActive&&r.sharingLinkKind!==m.e.direct&&(n=!0)}return n||(n=t.length>0),n},t.prototype._parseSharingLinks=function(e,t,n){var a=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,i=e.linkDetails;return t=void 0!==i.Scope&&i.Scope!==h.e.uninitialized?H(i.LinkKind,i.Scope):F(i.LinkKind,i.AllowsAnonymousAccess,i.RestrictedShareMembership),{allowsAnonymousAccess:i.AllowsAnonymousAccess,hasPassword:i.RequiresPassword,blockDownload:i.BlocksDownload,description:i.Description,audience:t,expiration:i.Expiration?new Date(i.Expiration):null,isActive:i.IsActive,isEdit:R(i.LinkKind)||i.IsEditLink,isReview:i.IsReviewLink,isManageList:i.IsManageListLink,principals:a._parseSharingPrincipals(e.linkMembers.results,i.LinkKind,n),invitees:a._parseLinkInvitees(i,n),shareId:i.ShareId,sharingLinkKind:i.LinkKind,sharingScope:i.Scope,url:i.Url,updatePassword:i.UpdatePassword,password:i.Password,passwordLastModifiedBy:a._parseSharingPrincipal(i.PasswordLastModifiedBy,n),isCreateOnlyLink:i.IsCreateOnlyLink,isAddressBarLink:i.IsAddressBarLink,isUnhealthy:i.IsUnhealthy,status:i.SharingLinkStatus,created:i.Created,trackLinkUsers:i.TrackLinkUsers}});return(i=i.sort(function(e,t){return a._getLinkRanking(t)-a._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:_.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:m.e.direct,sharingScope:h.e.specificPeople,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),i},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case _.e.anyone:t+=30;break;case _.e.organization:t+=20;break;case _.e.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case b.e.anyone:t+=30;break;case b.e.organization:t+=20;break;case b.e.specificPeople:t+=10}switch(e.role){case u.e.edit:t+=3;break;case u.e.review:t+=2;break;case u.e.view:t+=1}}return t},t.prototype._parseSharingLinkTemplates=function(e,t){var n=this;return e.map(function(e){var a,i,r=e.linkDetails;null!==r&&(i=void 0!==r.Scope&&r.Scope!==h.e.uninitialized?H(r.LinkKind,r.Scope):F(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),a={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:R(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:n._parseLinkInvitees(r,t),shareId:r.ShareId,sharingLinkKind:r.LinkKind,sharingScope:r.Scope,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy,t)});return{linkDetails:a,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}}).sort(function(e,t){return n._getSharingLinkTemplateRanking(t)-n._getSharingLinkTemplateRanking(e)})},t.prototype._parseLinkInvitees=function(e,t){var n=this,a=e.Invitations;if(!a)return[];for(var i=[],r=0,o=a.results;r<o.length;r++){var s=o[r];s&&s.invitee&&i.push(s.invitee)}return i.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:Object(x.n)(n._pageContext.webAbsoluteUrl,e.email,t)}})},t.prototype._parseSharingPrincipals=function(e,t,n){var a=this,i=e.map(function(e){var i=e.principal;i||(i=e);var r={id:i.id,isExternal:i.isExternal,loginName:i.loginName,primaryText:i.name,role:e.role,secondaryText:i.jobTitle,type:i.principalType,imageUrl:Object(x.n)(a._pageContext.webAbsoluteUrl,i.email,n),email:i.email};return t&&(r.sharingLinkKind=t),r});return S.e.getUniqueSharingPrincipals(i)},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:g.e[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e,t){if(e){var n=e.principal;return n||(n=e),{id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:Object(x.n)(this._pageContext.webAbsoluteUrl,n.email,t),email:n.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,n,a){a.peopleSharingLinkAbilities&&(a.peopleSharingLinkAbilities.canManageEditLink.enabled||a.peopleSharingLinkAbilities.canManageReadLink.enabled)&&e===m.e.direct&&(e=m.e.flexible);var i=e,r=t;a.anyoneLinkAbilities?(i!==m.e.anonymousEdit||a.anyoneLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anyoneLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anyoneLinkAbilities.canManageReadLink.enabled||a.anyoneLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)):(i!==m.e.anonymousEdit||a.anonymousLinkAbilities.canManageEditLink.enabled||(i=m.e.anonymousView),i!==m.e.anonymousView||a.anonymousLinkAbilities.canManageReadLink.enabled||(i=m.e.organizationEdit),r!==h.e.anyone||a.anonymousLinkAbilities.canManageReadLink.enabled||a.anonymousLinkAbilities.canManageReadLink.enabled||(r=h.e.organization)),a.organizationLinkAbilities&&(i!==m.e.organizationEdit||a.organizationLinkAbilities.canManageEditLink.enabled||(i=m.e.organizationView),i!==m.e.organizationView||a.organizationLinkAbilities.canManageReadLink.enabled||(i=m.e.direct),r!==h.e.organization||a.organizationLinkAbilities.canManageReadLink.enabled||a.organizationLinkAbilities.canManageEditLink.enabled||(r=h.e.specificPeople)),a.peopleSharingLinkAbilities&&(r!==h.e.specificPeople||a.peopleSharingLinkAbilities.canManageReadLink.enabled||a.peopleSharingLinkAbilities.canManageEditLink.enabled||(r=h.e.existing));var o=void 0;return e===m.e.anonymousEdit||e===m.e.anonymousView?o=_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?o=_.e.organization:e===m.e.direct?o=_.e.specificPeople:e===m.e.flexible&&(o=_.e.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:o,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,sharingScope:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(c.t);function T(e){if(e.d)return U(e.d.ShareLink.sharingLinkInfo)}function U(e){var t;t=void 0!==e.Scope&&e.Scope!==h.e.uninitialized?H(e.LinkKind,e.Scope):F(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:R(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function F(e,t,n){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t?_.e.anyone:!1===n?_.e.organization:_.e.specificPeopleFlex:void 0}function H(e,t){return e===m.e.anonymousEdit||e===m.e.anonymousView?_.e.anyone:e===m.e.organizationEdit||e===m.e.organizationView?_.e.organization:e===m.e.direct?_.e.specificPeople:e===m.e.flexible?t==h.e.anyone?_.e.anyone:t===h.e.organization?_.e.organization:_.e.specificPeopleFlex:void 0}function R(e){return e===m.e.anonymousEdit||e===m.e.organizationEdit||e!==m.e.anonymousView&&e!==m.e.organizationView&&null}function N(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)&&"00000000-0000-0000-0000-000000000000"!=e}}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(10),i=n(1457),r=n(3285),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n("knockout-lib"),o=n(239),s=function(e){function t(){var t=e.call(this)||this;return t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.keyToIndexHash={},t.indexToKeyHash={},t.unresolvedSelectedIndices={},t._focusedIndex=-1,t._subscriptions=[],t._selectItemKeyToModel={},t.itemSet=r.observable(null),t.layout=r.observable(),t.selection=r.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}}),t.selectionKeyHash=r.observable({}),t.focused=r.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}}),t.items=r.observableArray(),t.focusedKeyHash=r.observable({}),t.isAllSelected=r.observable(!1),t.isActive=r.observable(!1),t.clearSelectionOnRemoval=!1,t.selectFirstItemOnActivate=!0,t}return Object(a.__extends)(t,e),t._set=function(e,t,n,a){(e=r.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&r.isObservable(e[t])&&e[t](n),e&&e.key&&(a()[e.key]=n,a.valueHasMutated())},t._setAll=function(e,n,a,i){for(var r=0;r<e.length;r++)t._set(e[r],n,a,i)},t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))},t._getParentElement=function(e){return e&&Object(o.e)(e)||null},t._insideElementWithClass=function(e,n,a){a=a||null;for(var i=e;i;){if(t._hasCssClass(i,n))return!0;if(i===a)return!1;i=t._getParentElement(i)}return!1},t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!r.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties,this._buildKeyIndexHash(),this.async.setTimeout(function(){n.cleanup(),n._updateFocused(e.properties.focused,!0)},0),this._subscriptions=[],this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=r.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1,n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)})),this._subscriptions.push(this.selection.subscribe(function(a){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange")),this._subscriptions.push(this.selection.subscribe(function(a){"single"===n.mode()&&a.length>1?n.selection([a.slice(-1)[0]]):t._setAll(a,e.properties.selected,!0,n.selectionKeyHash);var i=n.items().length,r=n.selection().length;n.isAllSelected(i>0&&i===r)})),this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash(),n.cleanup()})),t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange")),this._subscriptions.push(this.focused.subscribe(function(a){t._set(a,e.properties.focused,!0,n.focusedKeyHash)})),this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)},t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null),this.isAllSelected()?this.selectAll():(r.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)}),t.length!==this.selection.peek().length&&this.selection(t))}},t.prototype.clear=function(){this.focused&&this.focused(null),this.anchor&&this.anchor(null),this._focusedIndex=-1,this.removeSelection()},t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()},t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()},t.prototype.hasCustom=function(){return"custom"===this.direction.peek()},t.prototype.toggleAllSelected=function(){this.selection.peek().length===this.items.peek().length?(this.selection([]),this._updateAllSelectItemViewModels(!1)):this.selectAll()},t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice()),this._updateAllSelectItemViewModels(!0)},t.prototype.selectItem=function(e){var t=[],n=r.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1),e&&(t.push(e),this._updateIsSelectedObservable(n.key,!0)),this.selection(t),this.focused(e)},t.prototype.firstItem=function(){return this.items()[0]},t.prototype.lastItem=function(){return this.items()[this.items().length-1]},t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]},t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]},t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null},t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null},t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null},t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null},t.prototype.isAlreadySelected=function(e){var t=r.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==r.utils.arrayIndexOf(this.selection(),e)},t.prototype.toggleSelection=function(e,t){var n=r.utils.unwrapObservable(e);this.isAlreadySelected(e)?t||(this.selection.remove(e),this._updateIsSelectedObservable(n.key,!1)):!1!==t&&(this.selection.push(e),this._updateIsSelectedObservable(n.key,!0)),this.focused(e)},t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={},this.selection([]),this._updateAllSelectItemViewModels(!1)},t.prototype.appendSelectionWithCurrentItem=function(e){if(e){if(this.anchor(e),!this.isAlreadySelected(e)){var t=r.utils.unwrapObservable(e);this.selection.push(e),this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}},t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e),this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0)),this._updateSelectItemViewModelInSelection(!0),this.focused(e)}},t.prototype.replaceSelectionWithRangeFromAnchor=function(e){e&&(this.anchor.peek()||this.anchor(e),this._updateSelectItemViewModelInSelection(!1),this.selection(this._createRange(this.items,this.anchor.peek(),e)),this._updateSelectItemViewModelInSelection(!0),this.focused(e))},t.prototype.findItemData=function(e){var t=r.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext,n=this._getItemFromContext(t)}return null},t.prototype.isClickOnToggleElement=function(e,n){var a=this.toggleClass;return!!a&&t._insideElementWithClass(n,a,e)},t.prototype.activate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0),this.isActive(!0)},t.prototype.deactivate=function(){r.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1),this.isActive(!1)},t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]},t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],a=-1;n&&((a=n.indexOf(t))>-1&&n.splice(a,1),0===n.length&&delete this._selectItemKeyToModel[e])},t.prototype.getFocusedItemKey=function(){var e=null;return this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]),e},t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)},t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])},t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]},t.prototype._findItemIndex=function(e){var t=-1,n=r.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var a=this.keyToIndexHash[n.key];void 0!==a&&(t=a)}else t=r.utils.arrayIndexOf(this.items.peek(),e);return t},t.prototype._getKeyForItem=function(e){var t,n=r.utils.unwrapObservable(e);return n&&n.hasOwnProperty("key")&&(t=n.key),t},t.prototype._createRange=function(e,t,n,a){var i=this.selectionKeyHash(),r=e(),o=this._findItemIndex(t),s=this._findItemIndex(n),c=[];if(o>s){var d=o;o=s,s=d}for(var l=o;l<=s;l+=1){var u=this._getKeyForItem(r[l]);u?a&&i[u]||c.push(r[l]):this.unresolvedSelectedIndices[l]=!0}return c},t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),a=0;a<n.length;a++){var i=n[a];if(i&&i.hasOwnProperty(e)&&r.isObservable(i[e])&&i[e]()===t){this.focused(i);break}}},t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})},t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})},t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})},t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,a=this.selection.peek(),i=0;i<a.length;i++)(t=r.utils.unwrapObservable(a[i]))&&(n=t.key,this._updateIsSelectedObservable(n,e))},t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={},this.indexToKeyHash={};for(var a=0;a<n.length;a++)(t=r.utils.unwrapObservable(n[a]))&&t.hasOwnProperty("key")&&(e=t.key,this.keyToIndexHash[e]=a,this.indexToKeyHash[a]=e);this._checkUnresolvedIndicies()},t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)t[Number(n)]&&(delete this.unresolvedSelectedIndices[n],(e=e||{})[n]=!0);if(e){for(var a=[],i=this.selectionKeyHash.peek(),r=0;r<t.length;r++){var o=t[r];(i[this._getKeyForItem(o)]||e[r]||this.unresolvedSelectedIndices[r])&&a.push(o)}this.selection(a)}},t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null},t}(i.default);t.e=s},,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(10),i=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:new a.e(!1)}),r=new a.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:new a.e(function(){return!1})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return p});var a=n(65),i=n(138),r=n(83),o=n(1224),s=n(232),c=n(114),d=n(225),l="DisableSubstrateSearch",u="https://outlook.office.com/search",f={ODB:1286},p=function(){function e(e,t){this._dataRequestor=new o.e({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&d.n.isFeatureEnabled(f)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(l,c.e.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(l,!0,c.e.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return a.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(u).then(function(e){return t.end({resultType:r.e.Success}),e},function(n){return a.n.isCanceled(n)?(t.end({resultType:r.e.ExpectedFailure,resultCode:"Canceled"}),a.n.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t,n,a="".concat(u,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:a,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(t=this._pageContext)||void 0===t?void 0:t.aadUserId,"@").concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.e("PeoplePicker",c.e.session))},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(3848),i=n(345),r=n(136),o=n(3361),s=n(3012),c=Object(r.r)("SubstratePeoplePickerHelper",o.t,{oAuthTokenProvider:s.e,pageContext:i.e,sharingContextInformation:a.e.optional})},function(e,t,n){"use strict";var a=function(){function e(t){this.id="".concat(++e._lastId),this.name=t}return e.prototype.matches=function(e){return e===this},e._lastId=0,e}();t.e=a}],Array(30),[function(e,t,n){}],Array(44),[function(e,t,n){"use strict";var a=n(0),i=n(5117),r=n(4829),o=n(2279),s=n(38),c=n(83),d=n(65),l=n(37),u=n(2229),f=n(146),p=function(e){function t(t){var n=e.call(this,t)||this;return n.name="CreateCustomDocument",n.openInNewTab=!1,n.fileCreationMenu=t.fileCreationMenu,n.entryIndex=t.entryIndex,n.navigation=n.resources.consume(f.e),n.itemProvider=n.resources.consume(u.resourceKey),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this.item().queryType===l.e.Files},t.prototype.onExecute=function(e,t){var n=this.item.peek();return this._createCustomDocument(n)},t.prototype._createCustomDocument=function(e,t){var n=this,a=null,i=this.fileCreationMenu.createNewFileControl(this.entryIndex),r=i.get_fileExtension(),o=this.itemProvider.createCustomDocument(e.key,r,t).then(function(e){return e?(a=e.id,d.n.wrap({resultType:c.e.Success})):d.n.wrap({resultType:c.e.Failure})});return o.done(function(e){if(a&&null!=i){var t=n.resources.consume(s.f);i.set_itemUrl(a),i.set_httpRoot(t.webAbsoluteUrl);var r=i.getRedirectUrl();null!=r&&n.async.setImmediate(function(){return n.navigation.navigateTo({url:r,frameId:n.openInNewTab?"_blank":null})})}}),o},t}(o.e),m=n(5118),_=n(2213),h=n(2529),b=n(10),g=n(136),v=new b.t({name:"AppUrlHelper.key",loader:new g.t(function(){return n.e(492).then(n.bind(null,5702)).then(function(e){return e.resourceKey})})}),y=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ExternalNavigate",n._item=t.item,n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._item})},t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank");return d.n.resolve(this.resources.consumeAsync(v)).then(function(e){return e.getItemUrl(t._item.peek())}).then(function(e){return n.location.href=e,{resultType:c.e.Success}},function(){return n.close(),{resultType:c.e.Failure}})},t}(_.e),S=n(2221),D=n(2231),I=n(863),x=n(40),C=n(2217),O=n(2322),w=n(2530),E=n(75),A=n(1699),L=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources;return n.name="OpenInImmersiveReader",n._itemSelectionHelper=new(n.child(S.e))({allowMultiSelect:!1,canFallback:!1}),n._dialogProvider=a.consume(D.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Object(x.isFeatureEnabled)(x.EnableOpenInImmersiveReader))return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=e.urls&&e.urls[I.t.immersiveReaderUrl],n=e.size;return!!t&&!!n&&Object(A.e)(n)},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,d.n,function(){var e,t,i,r,o,s,l,u=this;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return e=this._itemSelectionHelper.firstItem(),(t=e&&e.urls&&e.urls[I.t.immersiveReaderUrl])?(i=t,(null==e?void 0:e.displayName)&&Object(x.isFeatureEnabled)(x.EnableTitleInImmersiveReader)&&(i="".concat(t,"&title=").concat(e.displayName)),[4,n.e(9).then(n.bind(null,4882))]):[2,d.n.wrap({resultType:c.e.Failure})];case 1:return r=f.sent().getImmersiveReaderOptions,(o=r({url:i,qosName:"OpenInImmersiveReader.ko"}).getImmersiveReaderContext)?[4,n.e(10).then(n.bind(null,4911))]:[2,d.n.wrap({resultType:c.e.Failure})];case 2:return s=f.sent().launchImmersiveReader,l=new E.e,[2,s({getImmersiveReaderContext:o,options:{uiZIndex:1000001,onExit:function(){l.resolve()}}}).then(function(){return l.promise.then(function(){return d.n.wrap({resultType:c.e.Success})}).catch(function(){return d.n.wrap({resultType:c.e.Failure})})}).catch(function(e){return Object(a.__awaiter)(u,void 0,void 0,function(){var e,t=this;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e=this.observables.create(!0),[4,this._dialogProvider.requestDialog({title:w.s,component:{name:O.e.tagName,params:{text:w.r}},actions:[{name:w.o,execute:function(){return Object(a.__awaiter)(t,void 0,d.n,function(){return Object(a.__generator)(this,function(e){return[2,2]})})},isAvailable:e,isDefault:!0,icon:new C.e("Cancel"),automationId:"ImmersiveReaderErrorDialog"}]}).wait()];case 1:return n.sent(),[2,d.n.wrap({resultType:c.e.Failure})]}})})})]}})})},t}(_.e),k=n(3840),M=n(320),P=n(100),T=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;a.name="NavigateToItem",a._urlDataSource=a.resources.consume(P.ue),a._viewParams=a.resources.consume(M.P);var i=t.item,r=t.itemSet,o=void 0===r?a.resources.consume(M.s.optional):r,s=t.parentItem,c=t.urlType,d=t.isRedirect,l=void 0!==d&&d,u=t.forceInSameWindow,f=void 0!==u&&u,p=t.shouldPreserveAction,m=void 0!==p&&p;a._itemSet=o,a._parentItem=s,a._urlType=a.wrapObservable(c),a._isRedirect=l,a._forceInSameWindow=a.wrapObservable(f),a._shouldPreserveAction=a.wrapObservable(m);var _=n.itemSelectionHelperType,h=void 0===_?a.resources.consume(S.e):_;a._itemSelectionHelper=new(a.scope.attached(h))({overrideItem:i,allowMultiSelect:!1,canFallback:!0}),a._url=a.createPureComputed(a._computeUrl),a._target=a.createPureComputed(a._computeTarget);var b=a.resources.consume(M.e);return a._navigationAction=new(a.managed(b.NavigationAction))({url:a._url,ignoreHistory:a._isRedirect,target:a._target}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return Object(x.isFeatureEnabled)(x.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{urlType:this._urlType(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""},t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"},t}(_.e),U=n(2583),F=n(4435),H=n(9),R=n(51),N=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenDocSet",a._urlDataSource=a.resources.consume(P.ue),a._url=a.createPureComputed(a._computeTargetUrl),a._actionMap=a.resources.consume(M.e),a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e){return new(this.managed(this._actionMap.NavigationAction))({url:this._url}).execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.item})},t.prototype._computeTargetUrl=function(){var e,t=this.item();return this._urlDataSource.getDefaultClickUrl(t,{additionalViewParams:(e={},e[H.n.viewIdKey]=R.e.normalizeLower(t.properties.WelcomeViewId,!1),e)})},t}(o.e),B=n(3116),j=n(4831),V=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OpenInExplorer",n._helper=new(n.managed(j.e)),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){return this.onIsAvailable()?(B.set("odbnu","0"),this._helper.navigateToClassic(),d.n.wrap({resultType:c.e.Success})):d.n.wrap({resultType:c.e.ExpectedFailure})},t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()},t.prototype.onIsToggled=function(){return!1},t}(_.e),z=n(435),G=n(410);function K(e){if(!(e=(e||"").toLowerCase())||0!==e.indexOf("~site/_layouts/15/formserver.aspx"))return!1;var t=e.substring(e.indexOf("?")+1),n=G.e(t);return"{itemurl}"===n.xmllocation&&"browser"===n.openin}var W,q=function(e){function t(t){var n=e.call(this,t)||this;return n._fallbackAction=t.fallbackOpenAction,n._item=t.item,n._actionMap=n.resources.consume(M.e),n._customActionProvider=n.resources.consume(z.t.optional),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this,a=this._item.peek();return(this._customActionProvider?this._customActionProvider.getCustomActionData().then(function(e){for(var t=0,i=e.ContextMenu||[];t<i.length;t++){var r=i[t];if(!r.children){var o=r;if(K(o.action)&&"function"==typeof o.isEnabled&&o.isEnabled(a))return new(n.managed(n._actionMap.CustomActionNavigationAction))({customAction:o,item:n._item})}}return n._fallbackAction}).catch(function(){return n._fallbackAction}):d.n.resolve(this._fallbackAction)).then(function(t){return t.execute(e)})},t}(_.e),Q=n(4436),Y=n(2267),J=n(3117),X=n(118),Z=n(12),$=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var a=t.openLocal,i=void 0!==a&&a,r=t.forceReadOnly,o=void 0!==r&&r,s=t.useDefaultAction,c=void 0!==s&&s;n._forceReadOnly=o,n._useDefaultAction=c,n._urlDataSource=n.resources.consume(P.ue),n._viewParams=n.resources.consume(M.P),n._itemSelectionHelper=new(n.child(S.e))({overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(Y.t),n.item=n._itemSelectionHelper.firstItem,n._url=n.createPureComputed(n._computeUrl);var d=!1;Z.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(d=Object(X.n)());var l=n.resources.consume(M.e);return n._navigationAction=new(n.managed(l.NavigationAction))({url:n._url,target:i||d?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}}),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){return e},t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,J.i)&&this._navigationAction.isAvailable()},t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})},t}(_.e),ee=n(1891),te=n(226),ne=n(2455),ae=n(3292),ie=n(1830),re=n(15),oe=!re.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),se=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pageContext=n.resources.consume(s.f);var a=n.resources.consume(M.e);return Object(X.e)()&&(n._openInDesktopAction=new(n.managed(a.OpenInDesktopAction))({openRelation:2,item:n.item,actionType:ae.e.OpenInOfficeOnline})),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){var t=(new Date).getTime().toString();return ee.e.AddWopiPerfMarkToTargetUrl(t,"DocLib",e)},t.prototype.onIsAvailable=function(){return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){var a=this.item.peek();if(n.data.extraData||(n.data.extraData={}),this._openInDesktopAction)return this._openInDesktopAction.execute(t);var i=this._pageContext.userDisplayName,r=this._pageContext.userLoginName,o=r&&-1!==r.lastIndexOf("@")?r.substring(0,r.lastIndexOf("@")):void 0,s=void 0;if(a&&a.sharingType){var d=a&&a.sharingType;s=d===ne.e.Shared||d===ne.e.Public||d===ne.e.PublicUnlisted}var l=a.extension?a.extension.toLowerCase():void 0;return te.e(n.data.extraData,{uniqueId:a.properties?a.properties.uniqueId:void 0,fileType:oe&&l?Object(ie.e)(l):l,isInODB:a.itemFromServer&&a.itemFromServer.SiteTitle&&i?-1!==a.itemFromServer.SiteTitle.indexOf(i):void 0,isInODBv2:a.openUrl&&o?-1!==a.openUrl.toLowerCase().indexOf(o.toLowerCase()):void 0,isItemShared:s}),e.prototype.onExecute.call(this,t,n).then(function(){return{resultType:c.e.Success}})},t}($),ce=new b.t({name:"".concat("ODSPTeamsSharedResources",".hostedApplication"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(553)]).then(n.bind(null,4408))];case 1:return e=t.sent().HostedApplicationFactory,[2,new b.e(function(t){return e.getHostedApplicationInstance(t)})]}})})}}});new b.t({name:"".concat("ODSPTeamsSharedResources",".utilities"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n.e(554).then(n.bind(null,2946))];case 1:return e=t.sent().TeamsUtilities,[2,new b.e(e)]}})})}}}),function(e){e.AppType="doclibPagesApp"}(W||(W={}));var de=n(2220),le=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i;return n.name="OpenInTeamsPreview",n._itemSelectionHelper=new(n.child(S.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a,i,r=this,o=this._itemSelectionHelper.firstItem();this._itemParentHelper=this.resources.consume(de.e),this._pageContext=this.resources.consume(s.f);var l=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(o,"subsite")),u=null!==(a=null===(n=null==l?void 0:l.subsite)||void 0===n?void 0:n.serverRelativeUrl)&&void 0!==a?a:this._pageContext.webAbsoluteUrl,f={id:null===(i=null==o?void 0:o.properties)||void 0===i?void 0:i.uniqueId,name:o.name||o.displayName,openUrl:o.openUrl,extension:o.extension,type:o.type,baseUrl:u||""};return this.resources.consumeAsync(ce).then(function(e){r._teamsHostedApplication=e(W.AppType),r._teamsHostedApplication.openOneDriveItemInFilePreview(f)}),d.n.wrap({resultType:c.e.Success})},t}(_.e),ue=n(106),fe=n(151),pe=n(181),me=n(213),_e=n(1383),he=n(2602),be=n(3),ge=n(3023),ve=n(3118),ye=n(664),Se=Z.e.isActivated("995DA390-4F3E-4CA5-A276-9DAB53FEE8A8","10/21/2022","Enables the openInTextEditor Command for html files"),De=Z.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),Ie=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a.resources,r=n.itemUrlHelper,o=void 0===r?i.consume(fe.c):r;return a._itemUrlHelper=o,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!e.prototype.onIsAvailable.call(this))return!1;var t=this.itemSelectionHelper.firstItem();return!(!t||this._itemUrlHelper.getItemUrlParts(t.key).geoRelation!==ue.e.sameGeo)},t}(function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInTextEditor";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(P.ue):r,s=n.viewParams,c=void 0===s?i.consume(M.P):s,d=n.itemCommandHelper,l=void 0===d?i.consume(Y.t):d,u=n.platformDetection,f=void 0===u?i.consume(pe.e):u,p=n.actionMap,m=void 0===p?i.consume(M.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(S.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a._isOneDriveWinApp=Object(X.e)(),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(Object(be.co)(x.EnableOneUpTextFileV2)&&!this._availableForHtml(e))return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),a=this._urlDataSource.getQueryType(n),i=Z.e.isActivated("35BD4D5C-F09B-4F80-BBFD-1080AFB2EBC1","11/10/2021","Use item.parentKey as fallback since item.UNSAFE_parent will not be set in ItemsScope pivots")?!!e.UNSAFE_parent||Object(be.co)(be.Vr)&&!!e.parentKey:!!e.UNSAFE_parent||!!e.parentKey;return this._itemCommandHelper.isCommandSupported(e,he.c)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&i&&Object(_e.a)(e)&&a!==l.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(a)&&e.itemStatus!==me.t.ConditionalAccessViewOnly&&e.itemStatus!==me.t.ConditionalAccessBlocked},t.prototype.onExecute=function(e){var t=this;return De?this._navigationAction.execute(e):new d.n(function(n){setTimeout(function(){ve.e.alert("OpenInTextEditor",ye.OpenInTextEditorAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";if(!Object(be.co)(x.EnableOneUpTextFileV2))return this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams()});var t=this._availableForHtml(e)?this._urlDataSource.saveViewerType("TextFile"):{};return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t.prototype._availableForHtml=function(e){var t=e&&e.htmlConversion&&Object(be.co)(x.UseSandboxHtmlViewer)&&(Object(ge.e)()||this._platformDetection.isEdge),n="TextFile"===this._urlDataSource.getViewerType(this._viewParams());return t&&!n&&!Se},t}(_.e)),xe=Z.e.isActivated("17DB17D7-FC3F-4243-B2CE-A54D5E531404","10/27/2022","Enable OpenInHtmlViewer Action"),Ce=Z.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),Oe=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInHtmlViewer";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(P.ue):r,s=n.viewParams,c=void 0===s?i.consume(M.P):s,d=n.itemCommandHelper,l=void 0===d?i.consume(Y.t):d,u=n.platformDetection,f=void 0===u?i.consume(pe.e):u,p=n.actionMap,m=void 0===p?i.consume(M.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(S.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(!Object(be.co)(x.EnableOneUpTextFileV2))return!1;var t=e&&e.htmlConversion&&Object(be.co)(x.UseSandboxHtmlViewer)&&(Object(ge.e)()||this._platformDetection.isEdge),n="TextFile"!==this._urlDataSource.getViewerType(this._viewParams());return this._itemCommandHelper.isCommandSupported(e,he.o)&&t&&!n&&!xe},t.prototype.onExecute=function(e){var t=this;return Ce?this._navigationAction.execute(e):new d.n(function(n){setTimeout(function(){ve.e.alert("OpenInHTMLViewer",ye.OpenInHtmlViewerAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._urlDataSource.saveViewerType("Html");return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t}(_.e),we=n(2738),Ee=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var a=n,i=a.observables,r=a.resources;n._itemCommandHelper=r.consume(Y.t),n._itemSelectionHelper=new(n.child(S.e))({overrideItem:t.item}),n._urlDataSource=r.consume(P.ue);var o=i.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),s=r.consume(M.e);return n._navigationAction=new(n.managed(s.NavigationAction))({url:o,target:"_blank"}),Object(X.e)()&&(n._openInDesktopAction=new(n.managed(s.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:ae.e.OpenPdfInBrowser})),n._pdfViewerHelper=t.pdfViewerHelper,n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&!!e&&Object(we.e)(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,he.d)&&".pdf"===e.extension.toLowerCase()&&(!this._pdfViewerHelper||!this._pdfViewerHelper.isPdfEditAvailable(e))},t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t}(_.e),Ae=n(4437),Le=n(232),ke=n(114),Me=n(593),Pe=n(265),Te=!re.e.isActivated("A61307C5-CA5C-474C-99AB-E9F954A94351","06/06/2022","Hide preview button for loop powered files"),Ue=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var a=n.resources.consume(M.e);return n._dataStore=new Le.e("",ke.e.local),n._itemSelectionHelper=new(n.child(S.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._openAction=new(n.managed(a.OpenAction))({urlType:n.observables.compute(n._computeUrlType),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0}),n._itemParentHelper=n.resources.consume(de.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=void 0;return e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"))),!(Te&&this._isBFile()||!e||e.external||!this._openAction.isAvailable()||e.type===Pe.e.OneNote||Object(Me.i)()&&e.queryType===l.e.SharedWithMe||t&&t.list&&!t.list.isDocumentLibrary)},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();return!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date),this._openAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrlType=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.queryType===l.e.Recent?"default":"focus"},t.prototype._isBFile=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=e.extension,n=e.properties,a=t?t.toLowerCase():"",i=n&&n.ProgId?n.ProgId:"";return".fluid"===a||".note"===a||".whiteboard"===a||".loop"===a||"Fluid."===i.substring(0,6)}return!1},t}(_.e),Fe=n(90),He=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._isOneDriveWinApp=Object(X.e)(),n._pageContext=n.resources.consume(s.f),n._itemSelectionHelp=new(n.child(S.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._platformDetection=n.resources.consume(pe.e),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!this._isOneDriveWinApp&&!Object(Fe.d)()&&!this._platformDetection.isPWA&&this._pageContext.isSPO&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){var a=this._itemSelectionHelp.firstItem.peek();n.data.extraData||(n.data.extraData={});var i=this._pageContext.userDisplayName,r=this._pageContext.userLoginName,o=r&&-1!==r.lastIndexOf("@")?r.substring(0,r.lastIndexOf("@")):void 0,s=void 0;if(a&&a.sharingType){var c=a&&a.sharingType;s=c===ne.e.Shared||c===ne.e.Public||c===ne.e.PublicUnlisted}return te.e(n.data.extraData,{isInODB:a.itemFromServer&&a.itemFromServer.SiteTitle&&i?-1!==a.itemFromServer.SiteTitle.indexOf(i):void 0,isInODBv2:a.openUrl&&o?-1!==a.openUrl.toLowerCase().indexOf(o.toLowerCase()):void 0,isItemShared:s}),e.prototype.onExecute.call(this,t,n)},t}(Ue),Re=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SelectAction";var i=n.itemSelectionHelperType,r=void 0===i?a.resources.consume(S.e):i,o=n.actionMap,s=void 0===o?a.resources.consume(M.e):o;return a._item=t.item,a._selectItems=t.selectItems,a._itemSelectionHelper=new r({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),t.showProperties&&(a._showPropertiesAction=new(a.managed(s.ShowPropertiesAction))({})),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,d.n,function(){var t,n=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return this._selectItems?(t=this._selectItems.map(function(e){return n.observables.peekUnwrap(e)}),this._itemSelectionHelper.selectItems(t)):this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]),this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,{resultType:c.e.Success}]}})})},t}(_.e),Ne=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="SelectAll",a._selectionModel=a.resources.consume(M.I),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode},t.prototype.onExecute=function(e,t){return this._selectionModel.selectAll(),d.n.resolve({resultType:c.e.Success})},t}(_.e),Be=n(1364),je=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetFocus",n._selector=t.selector,n._shouldClick=t.shouldClick,n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);return n&&(n.focus(),this._shouldClick&&Be.e.clickElement(n)),d.n.wrap({resultType:c.e.Success})},t}(o.e),Ve=n(4832),ze=n(2562),Ge=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ToggleSelectionModeAction",n._platformDetection=n.resources.consume(pe.e),n._isSelectionModal=n.resources.consume(ze.n),n._selectionHelper=new(n.child(S.e))({}),n._isOneDriveXboxApp=Object(X.t)(),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()},t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();return this._isSelectionModal(!t),d.n.wrap({resultType:c.e.Success})},t.prototype.onIsToggled=function(){return this._isSelectionModal()},t}(_.e),Ke=n(1219);function We(e,t){return r.e(e,function(){return t().then(Ke.e)})}var qe=function(e){function t(){var t=e.call(this)||this;return t.CreateCustomDocumentAction=p,t.DefaultClickAction=m.e,t.ExternalNavigateAction=y,t.FileHandlerOpenAction=k.e,t.NavigateToItemAction=T,t.NavigationAction=U.default,t.OpenAction=F.e,t.OpenInExplorerAction=V,t.OpenInfoPathAction=q,t.OpenInOfficeClientAction=Q.e,t.OpenInOfficeOnlineAction=se,t.OpenInImmersiveReaderAction=L,t.OpenInDesktopAction=ae.t,t.OpenInTeamsPreviewAction=le,t.OpenInTextEditorAction=Ie,t.OpenInHtmlViewerAction=Oe,t.OpenPdfInBrowserAction=Ee,t.OpenShortcutAction=Ae.e,t.PreviewAction=He,t.SelectAction=Re,t.SelectAllAction=Ne,t.SetFocusAction=je,t.ShowOperationsAction=Ve.e,t.ToggleSelectionModeAction=Ge,t.OpenDocSetAction=N,t.ActivateUniversalAnnotationAction=We("../ActivateUniversalAnnotationAction",function(){return n.e(115).then(n.bind(null,5692))}),t.AddFlowAction=We("../flow/AddFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(143)]).then(n.bind(null,4656))}),t.AddToOneDriveAction=We("../AddToOneDriveAction",function(){return n.e(124).then(n.bind(null,5088))}),t.SetUpReminderFlowAction=We("../flow/SetUpReminderFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(145)]).then(n.bind(null,4659))}),t.LaunchConfigureFlowsPanelAction=We("../flow/launchConfigureFlowsPanel/LaunchConfigureFlowsPanelAction",function(){return n.e(153).then(n.bind(null,4660))}),t.AlertAction=We("./AlertAction",function(){return n.e(232).then(n.bind(null,3973))}),t.AuthenticationPolicyWarningAction=We("./AuthenticationPolicyWarningAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(233)]).then(n.bind(null,4973))}),t.CheckInAction=We("./CheckInAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(234)]).then(n.bind(null,4158))}),t.CheckOutAction=We("./CheckOutAction",function(){return n.e(235).then(n.bind(null,4974))}),t.ClearFilterAction=We("../ClearFilterAction",function(){return n.e(116).then(n.bind(null,3967))}),t.ClearSelectionAction=We("../ClearSelectionAction",function(){return n.e(117).then(n.bind(null,3974))}),t.ContentTypeNavigationAction=We("./ContentTypeNavigationAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(236)]).then(n.bind(null,3975))}),t.CreateDocumentAction=We("./CreateDocumentAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(237)]).then(n.bind(null,3454))}),t.CreateFolderAction=We("../createFolder/odb/CreateFolderAction",function(){return n.e(126).then(n.bind(null,3662))}),t.CreateFileRequestAction=We("../createFileRequest/CreateFileRequestAction",function(){return n.e(578).then(n.bind(null,4975))}),t.CreateNewFolderAction=We("../createNewFolder/CreateNewFolderAction",function(){return n.e(128).then(n.bind(null,4976))}),t.CustomActionNavigationAction=We("./CustomActionNavigationAction",function(){return n.e(238).then(n.bind(null,4662))}),t.DeleteAction=We("../delete/odb/DeleteAction",function(){return n.e(129).then(n.bind(null,3978))}),t.DownloadAction=We("../download/odb/DownloadAction",function(){return n.e(133).then(n.bind(null,3979))}),t.OpenSWAAction=We("../openswa/OpenSWAAction",function(){return n.e(251).then(n.bind(null,5693))}),t.DownloadZipContentsAction=We("../downloadZipContents/odb/DownloadZipContentsAction",function(){return n.e(131).then(n.bind(null,5062))}),t.EditAction=We("./EditAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(239)]).then(n.bind(null,3682))}),t.EditPdfAction=We("../mspdf/EditPdfAction",function(){return n.e(228).then(n.bind(null,5694))}),t.EmptyRecycleBinAction=We("../emptyRecycleBin/odb/EmptyRecycleBinAction",function(){return n.e(140).then(n.bind(null,3980))}),t.FilterAction=We("../FilterAction",function(){return n.e(118).then(n.bind(null,3969))}),t.InvokeFirstRunExperienceAction=We("../splist/InvokeFirstRunExperienceAction",function(){return n.e(300).then(n.bind(null,4626))}),t.GetLinkAction=We("../getLink/odb/GetLinkAction",function(){return n.e(157).then(n.bind(null,3981))}),t.GroupItemsAction=We("../groupItems/GroupItemsAction",function(){return n.e(160).then(n.bind(null,4663))}),t.LaunchColumnManagementPanelAction=We("../launchColumnManagementPanel/LaunchColumnManagementPanelAction",function(){return n.e(784).then(n.bind(null,4977))}),t.LaunchColumnCustomizationPaneAction=We("../splist/LaunchColumnCustomizationPaneAction",function(){return Promise.all([n.e("deferred"),n.e(783)]).then(n.bind(null,3590))}),t.LaunchCreateGroupPanelAction=We("../LaunchCreateGroupPanelAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(119)]).then(n.bind(null,5991))}),t.LaunchCreateShortcutPanel=We("./LaunchCreateShortcutPanel",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(240)]).then(n.bind(null,4145))}),t.LaunchFlowWidgetPanelAction=We("../flow/launchFlowWidgetPanel/LaunchFlowWidgetPanelAction",function(){return n.e(155).then(n.bind(null,4664))}),t.LaunchGroupifyPanelAction=We("../launchGroupifyPanel/LaunchGroupifyPanelAction",function(){return n.e(210).then(n.bind(null,4978))}),t.LaunchMoveCopyPanelAction=We("../launchMoveCopyPanel/odb/LaunchMoveCopyPanelAction",function(){return n.e(216).then(n.bind(null,4180))}),t.LaunchPdfExtractionAction=We("../LaunchPdfExtractionAction",function(){return n.e(229).then(n.bind(null,5695))}),t.LaunchTeamChannelAction=We("../launchTeamChannel/LaunchTeamChannelAction",function(){return n.e(221).then(n.bind(null,4979))}),t.LaunchUserExpirationPanelAction=We("../launchUserExpirationPanel/LaunchUserExpirationPanelAction",function(){return Promise.all([n.e("deferred"),n.e(600)]).then(n.bind(null,4574))}),t.MoveCopyAction=We("../moveCopy/odb/MoveCopyAction",function(){return n.e(227).then(n.bind(null,5119))}),t.NavigateToSharePointHomeAction=We("../navigateToSharePointHome/NavigateToSharePointHomeAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(230)]).then(n.bind(null,4980))}),t.OpenInPowerBIAction=We("../OpenInPowerBIAction",function(){return n.e(120).then(n.bind(null,4981))}),t.OpenSiteAction=We("../openSite/OpenSiteAction",function(){return n.e(250).then(n.bind(null,5696))}),t.PinToMruAction=We("../pinToMru/PinToMruAction",function(){return n.e(253).then(n.bind(null,4982))}),t.PolicyTipAction=We("../PolicyTipAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(645)]).then(n.bind(null,4137))}),t.PrintPdfAction=We("../printPdf/odb/PrintPdfAction",function(){return n.e(255).then(n.bind(null,4983))}),t.RemoveFromSharedListAction=We("./RemoveFromSharedListAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(241)]).then(n.bind(null,4366))}),t.RemoveTagAction=We("../RemoveTagAction",function(){return n.e(121).then(n.bind(null,4984))}),t.RenameAction=We("../rename/odb/RenameAction",function(){return n.e(256).then(n.bind(null,3982))}),t.RestoreAction=We("../restore/RestoreAction",function(){return n.e(258).then(n.bind(null,3983))}),t.SaveAction=We("../save/odb/SaveAction",function(){return n.e(260).then(n.bind(null,4181))}),t.ShareAction=We("../share/odb/ShareAction",function(){return n.e(810).then(n.bind(null,3779))}),t.ShareByLinkAction=We("../shareByLink/odb/ShareByLinkAction",function(){return n.e(262).then(n.bind(null,3780))}),t.ShowPermissionsAction=We("../showPermissions/ShowPermissionsAction",function(){return n.e(630).then(n.bind(null,3984))}),t.ShowRunReportAction=We("../showRunReport/ShowRunReportAction",function(){return n.e(273).then(n.bind(null,4985))}),t.ShowItemAnalyticsAction=We("../showItemAnalytics/ShowItemAnalyticsAction",function(){return n.e(265).then(n.bind(null,4182))}),t.ShowKeyPointsAction=We("../showKeyPoints/ShowKeyPointsAction",function(){return n.e(267).then(n.bind(null,4183))}),t.ShowShareAction=We("../showShare/ShowShareAction",function(){return n.e(794).then(n.bind(null,4986))}),t.ShowKeyboardMapAction=We("../showKeyboardMap/ShowKeyboardMapAction",function(){return n.e(269).then(n.bind(null,3985))}),t.ShowExistingFlowsAction=We("../flow/ShowExistingFlowsAction",function(){return n.e(146).then(n.bind(null,4665))}),t.ShowFiltersAction=We("../showFilters/odb/ShowFiltersAction",function(){return n.e(756).then(n.bind(null,4320))}),t.ShowPropertiesAction=We("../ShowPropertiesAction",function(){return n.e(757).then(n.bind(null,3986))}),t.ShowSelectionAction=We("../ShowSelectionAction",function(){return n.e(122).then(n.bind(null,3987))}),t.ShowVersionHistoryAction=We("../showVersionHistoryAction/ShowReactVersionHistoryAction",function(){return n.e(275).then(n.bind(null,4987))}),t.ShowMalwareDetectedAction=We("./ShowMalwareDetectedAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(242)]).then(n.bind(null,4367))}),t.ViewInFolderAction=We("../viewInFolder/ViewInFolderAction",function(){return n.e(331).then(n.bind(null,4321))}),t.OneDriveSortAction=We("../sort/od/OneDriveSortAction",function(){return n.e(278).then(n.bind(null,3781))}),t.SortAction=We("../sort/SortAction",function(){return n.e(277).then(n.bind(null,3501))}),t.SyncAction=We("./SyncAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(244)]).then(n.bind(null,4139))}),t.ToggleIsLeftNavUserExpandedAction=We("../../controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",function(){return n.e(392).then(n.bind(null,2898))}),t.ToggleListLayoutAction=We("../toggleListLayout/odb/ToggleListLayoutAction",function(){return n.e(330).then(n.bind(null,3455))}),t.TriggerFlowAction=We("../flow/TriggerFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(148)]).then(n.bind(null,2897))}),t.TriggerFlowByIdAction=We("../flow/TriggerFlowByIdAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(149)]).then(n.bind(null,4667))}),t.TriggerODBConvertToPdfFlowAction=We("../flow/TriggerODBConvertToPdfFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(150)]).then(n.bind(null,4668))}),t.TriggerODBRequestSignOffFlowAction=We("../flow/TriggerODBRequestSignOffFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(151)]).then(n.bind(null,4669))}),t.UndoCheckOutAction=We("./UndoCheckOutAction",function(){return n.e(245).then(n.bind(null,3988))}),t.UpdatePermissionsAction=We("../UpdatePermissionsAction",function(){return n.e(123).then(n.bind(null,2903))}),t.UploadAction=We("./UploadAction",function(){return n.e(246).then(n.bind(null,3453))}),t.ViewOriginalAction=We("../viewOriginal/ViewOriginalAction",function(){return n.e(332).then(n.bind(null,4989))}),t.BackToClassicAction=We("../odb/BackToClassicAction",function(){return Promise.resolve().then(n.bind(null,5697))}),t.OpenInImageEditorAction=We("../openInImageEditor/OpenInImageEditorAction",function(){return n.e(248).then(n.bind(null,5698))}),t.EmbedAction=We("../embed/odb/EmbedAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(139)]).then(n.bind(null,5886))}),t.EditInClipchampAction=We("../editInClipchamp/EditInClipchampAction",function(){return n.e(135).then(n.bind(null,5699))}),t.NewClipchampAction=We("../newClipchamp/NewClipchampAction",function(){return n.e(231).then(n.bind(null,5700))}),t.OpenInClipchampAction=We(".../openInClipchamp/OpenInClipchampAction",function(){return n.e(247).then(n.bind(null,5701))}),t}return Object(a.__extends)(t,e),t}(i.e);t.e=qe},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(4),i=n("react-lib"),r=n(4415),o=n(5180),s=n(1353),c=n(98),d=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},l=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,a=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(a.toString().length)||"px"}},u=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?d(e,t):n.reduce(function(e,n){return d(e,t)+" "+d(n,t)})},f=n(661),p={start:"flex-start",end:"flex-end"},m={root:"ms-Stack",inner:"ms-Stack-inner"},_=n(3264),h={Item:_.e},b=Object(o.e)(function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,d=e.wrap,l=Object(a.r)(e,["as","disableShrink","wrap"]);Object(s.e)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var u=i.Children.map(e.children,function(e,t){if(!e)return null;if((r=e)&&"object"==typeof r&&r.type&&r.type.displayName===_.e.displayName){var n={shrink:!o};return i.cloneElement(e,Object(a.e)(Object(a.e)({},n),e.props))}var r;return e}),f=Object(c.s)(l,c.c),p=Object(r.t)(e,{root:n,inner:"div"});return d?Object(r.n)(p.root,Object(a.e)({},f),Object(r.n)(p.inner,null,u)):Object(r.n)(p.root,Object(a.e)({},f),u)},{displayName:"Stack",styles:function(e,t,n){var i,r,o,s,c,_,h,b=e.verticalFill,g=e.horizontal,v=e.reversed,y=e.grow,S=e.wrap,D=e.horizontalAlign,I=e.verticalAlign,x=e.disableShrink,C=e.className,O=Object(f.e)(m,t),w=n&&n.childrenGap?n.childrenGap:e.gap,E=n&&n.maxHeight?n.maxHeight:e.maxHeight,A=n&&n.maxWidth?n.maxWidth:e.maxWidth,L=n&&n.padding?n.padding:e.padding,k=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:l(d(n[0],t)),columnGap:l(d(n[1],t))};var a=l(d(e,t));return{rowGap:a,columnGap:a}}(w,t),M=k.rowGap,P=k.columnGap,T=""+-.5*P.value+P.unit,U=""+-.5*M.value+M.unit,F={textOverflow:"ellipsis"},H={"> *:not(.ms-StackItem)":{flexShrink:x?0:1}};return S?{root:[O.root,{flexWrap:"wrap",maxWidth:A,maxHeight:E,width:"auto",overflow:"visible",height:"100%"},D&&(i={},i[g?"justifyContent":"alignItems"]=p[D]||D,i),I&&(r={},r[g?"alignItems":"justifyContent"]=p[I]||I,r),C,{display:"flex"},g&&{height:b?"100%":"auto"}],inner:[O.inner,{display:"flex",flexWrap:"wrap",marginLeft:T,marginRight:T,marginTop:U,marginBottom:U,overflow:"visible",boxSizing:"border-box",padding:u(L,t),width:0===P.value?"100%":"calc(100% + "+P.value+P.unit+")",maxWidth:"100vw",selectors:Object(a.e)({"> *":Object(a.e)({margin:""+.5*M.value+M.unit+" "+.5*P.value+P.unit},F)},H)},D&&(o={},o[g?"justifyContent":"alignItems"]=p[D]||D,o),I&&(s={},s[g?"alignItems":"justifyContent"]=p[I]||I,s),g&&{flexDirection:v?"row-reverse":"row",height:0===M.value?"100%":"calc(100% + "+M.value+M.unit+")",selectors:{"> *":{maxWidth:0===P.value?"100%":"calc(100% - "+P.value+P.unit+")"}}},!g&&{flexDirection:v?"column-reverse":"column",height:"calc(100% + "+M.value+M.unit+")",selectors:{"> *":{maxHeight:0===M.value?"100%":"calc(100% - "+M.value+M.unit+")"}}}]}:{root:[O.root,{display:"flex",flexDirection:g?v?"row-reverse":"row":v?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:b?"100%":"auto",maxWidth:A,maxHeight:E,padding:u(L,t),boxSizing:"border-box",selectors:Object(a.e)((c={"> *":F},c[v?"> *:not(:last-child)":"> *:not(:first-child)"]=[g&&{marginLeft:""+P.value+P.unit},!g&&{marginTop:""+M.value+M.unit}],c),H)},y&&{flexGrow:!0===y?1:y},D&&(_={},_[g?"justifyContent":"alignItems"]=p[D]||D,_),I&&(h={},h[g?"alignItems":"justifyContent"]=p[I]||I,h),C]}},statics:h})},,,,,function(e,t,n){"use strict";var a=n(0),i=n(4207),r=n(2229),o=n(65),s=n(320),c=n(601),d=n(83),l=n("knockout-lib"),u=function(e){function t(t){var n=e.call(this,t)||this,a=t.itemSet,i=void 0===a?n.resources.consume(s.s):a,r=t.indexResolver;return n._itemSet=i,n._indexResolver=r,n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):o.n.wrap()},t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)},t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)},t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=t[r];this._isItemResolved(o)||n.push(r)}return n},t}(n(1214).default),f=n(2220),p=n(4208),m=n(3181),_=n(2269),h=n(1439),b=function(e){function t(t){void 0===t&&(t={});var n=this,a={getItemKey:v};l.utils.extend(a,t||{}),n=e.call(this,a)||this;var i=t.itemSet,o=void 0===i?n.resources.consume(s.s):i,c=t.indexResolver,d=t.enableSelectionResolution,h=void 0===d||d;return n.itemSet=o,n.itemProvider=n.resources.consume(r.resourceKey),n._enableSelectionResolution=h,n._itemParentHelper=n.resources.consume(f.e),n._refreshMessageHelper=n.resources.consume(p.e),n._currentItems=n.createPureComputed(n.computeCurrentItems),n._itemKey=n.createPureComputed(n._computeItemKey),n._useItemCacheData=n.resources.consume(m.e),n._itemsStore=n.resources.consume(_.t),n.createComputed(function(){n._onItemSetChanged(n._currentItems())}),n.createComputed(n._computeResetSelectionOnKeyChange),c&&(n._selectionResolver=new(n.managed(u))({itemSet:n.itemSet,indexResolver:c})),n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource(),n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate),n}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return o.n.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],a=this.getItems(),i=0;i<a.length;i++)(this.isIndexSelected(i)||!a[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var r={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new c.e,getItemPromises:[]};return this.validateResolvedSelection(r),r.signal.getPromise()}return o.n.wrap(this._unwrapSelection(this.selection.peek(),!0))},t.prototype.validateResolvedSelection=function(e){if(e.resolveAttempt++,e.resolveAttempt>4)e.signal.error({resultType:d.e.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();if(e.getItemPromises=[],e.missingRanges=t,e.pendingCount=t.length,0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}},t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),a=l.utils.extend({},e.itemSet.context);a.avoidSeamSnapping=!0,a.startIndex=n.start,a.endIndex=n.end,a.pageSize=n.end-n.start+1,e.getItemPromises.push(this.itemProvider.getItem(a).then(function(){e.pendingCount--,e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}},t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()},t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,a=this.getMissingIndicies();if(a.length)for(t=a[0],n=a[a.length-1];t>-1;){var i=Math.min(n,t+1e3-1),r={start:t,end:i};e.push(r),t=i===n?-1:i+1}return e},t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]},t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),a=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));a&&a.list?this.getItemKey=g.bind(void 0,a.list.isDocumentLibrary):this.getItemKey=v;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,r=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=r?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0,this.setItems(e,!1),this._refreshMessageHelper.clearRecentlyRefreshedItems()},t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey(),this.clear(!0)},t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o=this.peekUnwrapObservable(r);!o&&t||n.push(o)}return n},t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key},t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,a=e.selectedKOItemKeys();n<a.length;n++){var i=a[n];if(i){var r=this._itemsStore.getItem(i);t.push(this.getItemKey(r))}}0===t.length?this.clear():this.setSelectedKeys(t)}},t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();return this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(h.e.optional).then(function(e){e&&t(e)}):e._useItemCacheData()}),this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})},t}(i.e);function g(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function v(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.e=b},,,,,,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("metadataSearchDataSource")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(273),i=Object(a.e)(function(e){return{}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.startExitingQuickEditEventName="startExitingQuickEdit",e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList",e.deleteCompletedEventName="quickEditDeleteCompleted",e.switchGridLayout="switchGridLayout",e.undoChangeEventName="quickEditUndoChange",e.redoChangeEventName="quickEditRedoChange",e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange",e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange",e.gridGlobalsInitialized="gridGlobalsInitialized",e}();t.t=a}],Array(113),[function(e,t,n){"use strict";n.r(t),n.d(t,"themeOffice",function(){return i}),n.d(t,"themeDarkMode",function(){return r}),n.d(t,"themeODDarkModeDialog",function(){return d}),n.d(t,"themeODDarkMode",function(){return l}),n.d(t,"isODBDarkModeKey",function(){return u});var a=n(0),i={themeName:"Office",themeDescription:"Default theme",themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#005a9e",themeDarker:"#004578",neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralSecondaryAlt:"#767676",neutralSecondary:"#666666",neutralPrimary:"#333",neutralPrimaryAlt:"#3c3c3c",neutralDark:"#212121",black:"#000000",white:"#fff",primaryBackground:"#fff",primaryText:"#333"},r={themeName:"Dark Mode",themeDescription:"(Dark) A dark theme based on the default.",themePrimary:"#2899f5",themeLighterAlt:"#0c2031",themeLighter:"#043862",themeLight:"#092C47",themeTertiary:"#185f00",themeSecondary:"#004C87",themeDarkAlt:"#3AA0F3",themeDark:"#6CB8F6",themeDarker:"#82c7ff",neutralLighterAlt:"#282828",neutralLighter:"#201f1e",neutralLight:"#252423",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#FAF9F8",black:"#ffffff",white:"#1b1a19",primaryBackground:"#1f1f1f",primaryText:"#f3f2f1",bodyBackground:"#1f1f1f",bodyText:"#ffffff",disabledBackground:"#1d1d1d",disabledText:"#797775"},o={themeName:"ODB Dark Mode",themeDescription:"ODB dark mode",themePrimary:"#2899f5",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#3aa0f3",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",primaryBackground:"#1b1a19",primaryText:"#f3f2f1",whiteTranslucent40:"rgba(0,0,0,.5)",freOverlayColor:"rgba(0,0,0,.5)",shareSuccessIcon:"#92C353",wordColor:"#296FE6",powerpointColor:"#CA5010",excelColor:"#10893C",excelPrimaryColor:"#10893C",excelShade10Color:"#0F7937",excelShade20Color:"#0A5325",powerpointPrimaryColor:"#CA5010",powerpointShade10Color:"#B1470E",powerpointShade20Color:"#79310A",wordPrimaryColor:"#296FE6",wordShade10Color:"#2461CA",wordShade20Color:"#19428A",wordIconColor:"#598FEC",powerpointIconColor:"#D67540",excelIconColor:"#37A660",visoIconColor:"#598FEC",oneNoteIconColor:"#D0AFE2",oneUpPaneBackground:"rgba(27, 26, 25, .75)"},s={bodyBackground:o.primaryBackground,bodyStandoutBackground:o.neutralLight,buttonText:o.black,buttonTextPressed:o.neutralDark,buttonTextHovered:o.neutralPrimary,bodySubtext:o.neutralSecondary,disabledBackground:o.neutralQuaternaryAlt,errorText:o.redDark,inputBackgroundChecked:o.themePrimary,menuBackground:o.neutralLighter,menuItemBackgroundHovered:o.neutralQuaternaryAlt,menuItemBackgroundPressed:o.neutralQuaternary,menuDivider:o.neutralTertiaryAlt,menuIcon:o.themeDarkAlt,menuHeader:o.black,menuItemText:o.neutralPrimary,menuItemTextHovered:o.neutralDark,messageText:o.neutralPrimary,primaryButtonBackground:o.themeTertiary,primaryButtonBackgroundHovered:o.themeLight,primaryButtonBackgroundPressed:o.themeLighter,primaryButtonText:o.black,primaryButtonTextHovered:o.black,primaryButtonTextPressed:o.black,primaryButtonTextDisabled:"#605e5c",variantBorder:o.neutralQuaternary,infoBackground:o.neutralQuaternaryAlt,infoIcon:o.neutralPrimaryAlt,errorIcon:o.redDark,warningIcon:o.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},c=Object(a.__assign)(Object(a.__assign)({},o),{white:"#252423",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",themePrimary:"#3AA0F3",themeDarkAlt:"#6CB8F6",themeDark:"#82C7FF"}),d={palette:c,semanticColors:Object(a.__assign)(Object(a.__assign)({},s),{bodyStandoutBackground:c.neutralLight,disabledBackground:c.neutralQuaternaryAlt,inputBackgroundChecked:c.themePrimary,menuBackground:c.neutralLighter,menuItemBackgroundHovered:c.neutralQuaternaryAlt,menuIcon:c.themeDarkAlt}),isInverted:!0},l={palette:o,semanticColors:s,isInverted:!0},u="isODBDarkMode"},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.locate=1]="locate",e[e.defaultClick=2]="defaultClick",e[e.download=3]="download",e[e.share=4]="share",e[e.sharing=5]="sharing",e[e.sendSurvey=6]="sendSurvey",e[e.createTextDocument=7]="createTextDocument",e[e.createWord=8]="createWord",e[e.createExcel=9]="createExcel",e[e.createExcelForm=10]="createExcelForm",e[e.createPowerPoint=11]="createPowerPoint",e[e.createOneNote=12]="createOneNote",e[e.openInExcel=13]="openInExcel",e[e.openInWord=14]="openInWord",e[e.openInPowerPoint=15]="openInPowerPoint",e[e.openInOneNote=16]="openInOneNote",e[e.openInVisio=17]="openInVisio",e[e.openInProject=18]="openInProject",e[e.openInPublisher=19]="openInPublisher",e[e.openInOffice=20]="openInOffice",e[e.embed=21]="embed",e[e.reportAbuse=22]="reportAbuse",e[e.addToShared=23]="addToShared",e[e.editBrowser=24]="editBrowser",e[e.feedback=25]="feedback",e[e.versionHistory=26]="versionHistory",e[e.showProperties=27]="showProperties",e[e.edit=28]="edit",e[e.editNew=29]="editNew"}(a||(a={}));var i={};for(var r in a)if("number"==typeof a[r]){var o=r,s=a[o];i[o.toLowerCase()]=s}t.t=a},function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(24),i=n(19),r=new a.e("uploadProgress",{sourceEntryKey:i.e});function o(e){return r.serialize({sourceEntryKey:e})}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function r(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return r(i,e)}function s(e){return r(a,e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"getProperties",function(){return r}),n.d(t,"createSearchRoot",function(){return o}),n.d(t,"getItemStatistics",function(){return s}),n.d(t,"getUserFromOwsString",function(){return c});var a=n(2718),i=n(265);function r(e){for(var t={},n=0,a=e.results;n<a.length;n++){var i=a[n],r=i.Key,o=i.Value;switch(i.ValueType){case"Edm.Boolean":t[r]={false:!1,true:!0}[o];break;case"Edm.Double":t[r]=parseFloat(o);break;case"Edm.Byte":case"Edm.Int32":case"Edm.Int64":t[r]=parseInt(o,10);break;case"Null":t[r]=null;break;case"Edm.String":if("Edges"===r){for(var s=JSON.parse(o),c=0,d=s;c<d.length;c++){var l=d[c];l.Properties.BlobContent&&(l.Properties.BlobContent=JSON.parse(l.Properties.BlobContent.toString()))}t[r]=s}else t[r]=o;break;default:t[r]=o}}return t}function o(e){var t=new a.e(e.key);return t.type=i.e.Folder,t.queryType=t.displayType=e.queryType,t.name=t.displayName=e.name,t.isRootFolder=!0,e.isPlaceholder||(t.isPlaceholder=!1),"number"==typeof e.childCount&&(t.folder={childCount:e.childCount}),t}function s(e){return{views:e.ViewsLifeTime||0,viewsUnique:e.ViewsLifeTimeUniqueUsers||0,viewsLast2Weeks:e.ViewsRecent||0,viewsLast2WeeksUnique:e.ViewsRecentUniqueUsers||0,viewsLastMonth:e.ViewsLastMonths1||0,viewsLastMonthUnique:e.ViewsLastMonths1Unique||0,viewsLastWeek:(e.ViewsLast7Days||0)+(e.ViewsLast6Days||0)+(e.ViewsLast5Days||0)+(e.ViewsLast4Days||0)+(e.ViewsLast3Days||0)+(e.ViewsLast2Days||0)+(e.ViewsLast1Days||0),viewsLastWeekUnique:(e.ViewsLast7DaysUniqueUsers||0)+(e.ViewsLast6DaysUniqueUsers||0)+(e.ViewsLast5DaysUniqueUsers||0)+(e.ViewsLast4DaysUniqueUsers||0)+(e.ViewsLast3DaysUniqueUsers||0)+(e.ViewsLast2DaysUniqueUsers||0)+(e.ViewsLast1DaysUniqueUsers||0)}}function c(e){var t={title:"",email:"",id:"",sip:""};if(e){var n=e.indexOf("|");t.sip=e.slice(0,n).trim();var a=e.indexOf("|",n+1);t.title=e.slice(n+1,a).trim()}return t}},,function(e,t,n){"use strict";n.r(t),n.d(t,"isCustomizingCardResourceKey",function(){return f}),n.d(t,"setCustomFormatterClass",function(){return p}),n.d(t,"setColumnToFormat",function(){return m});var a=n(0),i=n(2213),r=n(506),o=n(320),s=n(10),c=n(65),d=n(83),l=n(1944),u=n(1951),f=new s.t("base.columnCustomizationPane.isCustomizingCard");function p(){return window.CustomFormatter?c.n.wrap({resultType:d.e.Success}):c.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(814)]).then(n.bind(null,4330))).then(function(e){return window.CustomFormatter=e.CustomFormatter,{resultType:d.e.Success}})}function m(e,t,n,a){if(!a&&void 0!==t&&n)for(var i=0,o=n.peek()&&n.peek().schema.peek();i<o.length;i++){var s=o[i];if(s.internalName===t){a=s;break}}e.consume(r.e.columnCustomizationPane.columnToFormat)(a),e.consume(r.e.columnCustomizationPane.viewToFormat)(null)}var _=function(e){function t(t){var n=e.call(this,t)||this;return n.name="LaunchColumnCustomizationPane",n._columnToFormat=t.column,n._internalName=t.internalName,n._itemSet=n.resources.consume(o.s),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){try{this.resources.consume(u.resourceKey)(!1),this.resources.consume(l.resourceKey)(!1),m(this.resources,this._internalName,this._itemSet,this._columnToFormat);var n=this.resources.consume(r.e.columnCustomizationPane.isColumnCustomizationPaneExpanded);return n(!1),n(!0),p()}catch(e){return c.n.wrap({resultType:d.e.Failure})}},t.prototype.onIsAvailable=function(){return!!this.resources.consume(o.l)()},t}(i.e);t.default=_},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o});var a,i=n(1237),r=n(1665);!function(e){e[e.ExistingItemUpload=0]="ExistingItemUpload",e[e.SPOFilePicker=1]="SPOFilePicker",e[e.BrowseDeviceFilePicker=2]="BrowseDeviceFilePicker"}(a||(a={}));var o=function(e){e.consumeAsync(r.e).then(function(t){t.getComplianceCheckResult().then(function(t){t&&Object(i.e)(e,"SyntexModelsGeneralFeedback",!0)})})}}],Array(39),[function(e,t,n){"use strict";var a=n(465);n.d(t,"e",function(){return a})}],Array(71),[function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(10),i=new a.t("app.admin"),r=new a.t("app.spourl");new a.t("app.suitenavrendered")},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r});var a={globalNavParent:"1002",quickLaunchParent:"1025",globalNavHome:"2003",subsites:"1026",quickLaunchHome:"1031",quickLaunchRecent:"1033",siteContents:"1034",footerNavParent:"13b7c916-4fea-4bb2-8994-5cf274aeb530",footerNavLogo:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",footerNavName:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",footerNavLinks:"3a94b35f-030b-468e-80e3-b75ee84ae0ad",footerNavSections:"47a59018-dcc3-4e98-a14e-146bc4001628",clientRecycleBin:"-1000",clientEdit:"-999",clientSharedWithUs:"-998",clientToggleLeftNav:"-997",clientAllFiles:"-996"},i={publishingGlobalNav:"GlobalNavigationSwitchableProvider",publishingQuickLaunch:"CurrentNavigationSwitchableProvider"},r={SimpleLink:0,FriendlyUrl:1}},function(e,t,n){"use strict";var a,i=n(65),r=n(138),o=n(83);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var s=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e}();t.e=s},,function(e,t,n){"use strict";var a=n("knockout-lib"),i=function(){function e(){}return e.init=function(e,t,n,i,r){var o=a.utils.unwrapObservable(t()),s=o&&o.activate||o;s&&s.call(r.$data,e)},e.supportsVirtualElements=!0,e}();t.e=i},,function(e,t,n){"use strict";n.r(t),n.d(t,"previewImageUrl",function(){return i}),n.d(t,"previewImageUrlFromProps",function(){return r}),n.d(t,"previewImageUrlFromUrl",function(){return o});var a=n(2689);function i(e,t,n,a){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,s=e.WebId||e.webId||n.webId,c=e.UniqueId||e.UniqueID||e.uniqueId,d=e.Url||e.url||e.Path;return c&&i&&s&&!a?r(i,s,c,t,n):o(d,t,n)}}function r(e,t,n,a,i){var r;if(i.isSPO)return n&&(r=s(function(r){var o=r?"":"&resolution=Width1024";return a+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o})),r}function o(e,t,n){var a;if(n.isSPO)return e&&(a=s(function(a){var i=a?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i})),a}function s(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===a.t.name),width:0,height:0}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"r",function(){return u});var a=n(2435),i=n(3725),r=n(23);function o(e){return e?r.format(a.k,e):""}function s(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function c(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.t)({userLoginName:t.email})}}function d(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function u(e){return e&&"0x0120"===e.slice(0,6)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s});var a,i=n(206),r=n(1370);function o(e,t){var n;switch(e.size){case a.Large:n=r.UserPhotoSize.Large;break;case a.Medium:n=r.UserPhotoSize.Medium;break;default:n=r.UserPhotoSize.Small}return Object(r.getUserPhotoUrl)(e.userLoginName,n,t)}function s(e,t,n){var a=Object(r.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new i.e(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a="_shareHeroCommand",i="_calloutInvoker",r=["DocIcon","LinkFilename",a,i,"Modified","Editor"];function o(e,t){if(e.length===r.length){for(var n=0;n<r.length;n++){var o=r[n];if(!(t&&o===a||o===i)&&e[n].internalName!==o)return!1}return!0}return!1}},function(e,t,n){"use strict";var a;!function(e){e[e.Success=0]="Success",e[e.FolderDoesNotExist=1]="FolderDoesNotExist",e[e.ItemDoesNotExist=2]="ItemDoesNotExist",e[e.TooManyItems=3]="TooManyItems",e[e.ItemNotInSpotlight=4]="ItemNotInSpotlight",e[e.InvalidArgument=5]="InvalidArgument",e[e.ServerError=6]="ServerError",e[e.InvalidServerJSON=7]="InvalidServerJSON",e[e.UnknownServerResult=8]="UnknownServerResult"}(a||(a={})),t.e=a},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a,i,r=n(0);!function(e){e[e.Empty=1]="Empty",e[e.InProgress=2]="InProgress",e[e.Saved=3]="Saved",e[e.Error=0]="Error"}(a||(a={})),function(e){e[e.Loading=0]="Loading",e[e.TemplateList=1]="TemplateList",e[e.JSONEditor=2]="JSONEditor",e[e.TemplateEditor=3]="TemplateEditor",e[e.ConditionEditor=4]="ConditionEditor",e[e.StyleEditor=5]="StyleEditor"}(i||(i={}));var o={templateId:"templateId",rowClassTemplateId:"rowClassTemplateId"},s=Object(r.__spreadArray)(Object(r.__spreadArray)([],Object.keys(o).map(function(e){return o[e]}),!0),["rulesOrder"],!0)},function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r}),function(e){e[e.None=0]="None",e[e.InSync=1]="InSync",e[e.ChangesSaved=2]="ChangesSaved",e[e.Syncing=3]="Syncing",e[e.Attention=4]="Attention",e[e.SyncConflict=5]="SyncConflict",e[e.SettingUp=6]="SettingUp",e[e.Unsupported=7]="Unsupported",e[e.Removed=8]="Removed",e[e.Error=9]="Error",e[e.ListStatusConnectionLost=10]="ListStatusConnectionLost",e[e.ListStatusConnected=11]="ListStatusConnected"}(a||(a={})),function(e){e[e.UnknownError=0]="UnknownError"}(i||(i={})),function(e){e[e.SetupRequired=0]="SetupRequired",e[e.SignInRequired=1]="SignInRequired"}(r||(r={}))}],Array(60),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return $});var a=n(2206),i=n(0),r=n(2201),o=n(2219),s=n(1959),c=n(4550),d=n(320),l=n(5259),u=n(2225),f=n("knockout-lib"),p=n(204),m=function(){function e(){}return e.init=function(e,t,n,a,i){var r=new p.t(null);r.on(e,"focus",f.unwrap(t()).bind(f.dataFor(e))),f.utils.domNodeDisposal.addDisposeCallback(e,function(){r.dispose()})},e}(),_=n(547),h=n(1002),b=n(105),g=n(2461),v=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.strings=l,a.addBindingHandlers({focus:m,keyboard:u.e,teachingBubble:g.e});var i=n.currentPageType,r=void 0===i?a.createObservable(b.e.Files):i,o=n.engagement,s=t.context;return a.context=s,a.teachingBubbleOptions={campaign:a.createObservable(h.ODC_PHOTOS_SEARCH),isVisible:a._isPhotosPage},a._engagement=o,a._isPhotosPage=a.createPureComputed(a._computeIsPhotosPage),a._pageType=r,a}return Object(i.__extends)(t,e),t.prototype.handleClick=function(){var e=this.peekUnwrapObservable(this.teachingBubbleOptions.campaign);e&&this._teachingBubbleProvider&&(this._teachingBubbleProvider.clearCurrentBubble(),this._teachingBubbleProvider.markBubbleAsDismissed(e)),this._engagement.logData({name:"Focus.SearchBox.SearchBox.Click",isIntentional:!0}),this.context.focusInput()},t.prototype._computeIsPhotosPage=function(){return this._pageType()===b.e.Photos},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{currentPageType:d.c.optional,engagement:_.e}),t}(r.e),y=Object(a.n)({name:"SearchBox",automationName:"ms-search-box",viewModelType:v,template:'<div class="od-SearchBox" role="presentation" data-bind="click:context.focusInput,css:{\'od-SearchBox--active\':context.isActive,\'od-SearchBox--hasBack\':context.hasBack,\'od-SearchBox--hasText\':context.searchText,\'od-SearchBox--searchIconLeft\':context.searchIconLeft,\'od-SearchBox--searchIconRight\':context.searchIconRight},teachingBubble:teachingBubbleOptions"><span class="od-SearchBox-iconWrapper od-SearchBox-iconArrowWrapper" data-bind="attr:{title:strings.BackIconLabel}"><button class="ms-Icon ms-Icon--Back" data-bind="icon:true,click:context.onBack,clickBubble:false"></button></span><span class="od-SearchBox-search"><input class="od-SearchBox-input" type="text" role="search" data-bind="hasFocus:context.inputFocused,keyboard:{allowInputEvents:true,preventDefault:true,mappings:{Enter:context.onEnter,Down:context.onArrowDown,Up:context.onArrowUp}},attr:{placeholder:context.placeholder,name:context.placeholder,\'aria-label\':context.searchBoxAriaLabel},textInput:context.searchText,automation:\'SearchBox-Input\',click:handleClick,clickBubble:false"></span><span class="od-SearchBox-iconWrapper od-SearchBox-iconSearchWrapper"><button class="ms-Icon ms-Icon--Search" data-bind="attr:{\'aria-label\':strings.SearchIconLabel},icon:true,click:context.onSearchClick,clickBubble:false,focus:context.focusInput"></button></span><span class="od-SearchBox-iconWrapper od-SearchBox-iconClearWrapper"><button class="ms-Icon ms-Icon--Cancel" data-bind="icon:true,click:context.clearInput.bind(this),clickBubble:false,attr:{\'aria-label\':strings.ClearIconLabel}"></button></span></div>'}),S=n(2501),D=n(2202),I=n(1365),x=n(83),C=function(){function e(){}return e.Default="od-search-result-default",e.Expanded="od-search-result-expanded",e.Glyph="od-search-result-glyph",e.Upscope="od-search-result-upscope",e}(),O=n(2353),w=n(3721),E=n(2536),A=n(3311),L=n(2307),k=n(4549),M=function(e){function t(t,n){var a=e.call(this,t,n)||this;a.addBindingHandlers({activate:w.e,keyboard:u.e,selection:E.e,visibility:A.e});var i=t.context,r=a.observables,s=a.resources,d=i.searchData;return a.context=i,a.fadeIn=r.create(!1),a.getRelativeDateTimeStringPast=I.o,a.iconDesiredSize=r.pureCompute(function(){return a._getIconDesiredSize()}),a.imageFrameTagName=S.e.tagName,a.isRenderComplete=r.create(!1),a.parentFolderLabel=c.t,a.progressSpinnerFlatTagName=O.e.tagName,i.capabilities.showOnlyResults?a.statusMessage=r.create(""):a.statusMessage=r.pureCompute(function(){var e=i.searchData(),t=i.errorMessage(),n=i.searchText;return t||(n&&n().length<i.capabilities.minimumQueryLength?c.r:i.queryInProgress()?c.i:!i.capabilities.showNoResults||e.containers&&e.containers.length?"":c.e)}).extend({rateLimit:150}),a._responsiveUI=s.consume(o.t),a.responsiveMaxHeight=r.pureCompute(function(){var e=a._responsiveUI,t=e.formFactorSize(),n=e.windowHeight();return"Small"===t||"Medium"===t?"100%":"".concat(.7*n,"px")}),r.compute(function(){if(d()&&a.isRenderComplete()){var e=d.peek(),t=e.traceId;t&&a.resources.consumeAsync(k.e).then(function(e){e.logSuggestionsResultsRendered(t)});var n=e.responseToRenderEvent;n&&n.end({resultType:x.e.Success})}}),a}return Object(i.__extends)(t,e),t.prototype.getTemplate=function(e){var t;switch(e.type){case 6:t=C.Expanded;break;case 3:case 4:t=C.Glyph;break;case 7:t=C.Upscope;break;default:t=C.Default}return{name:t}},t.prototype.onClickResult=function(e,t){this.context.searchResultClicked(e)},t.prototype.getIconImage=function(e){var t=this,n=e.iconName;return{url:n,width:96,height:96,getAligned:function(e,a){var i,r=e.width;return i=r<24?16:r<32?24:r<48?32:r<64?48:r<96?64:96,{url:L.e(t.resources,n,i),width:i,height:i}}}},t.prototype.displayOdbMetadata=function(e){return!!e.parentFolder&&!!e.lastModifiedDateDisplay},t.prototype.displayLastModifiedBy=function(e){return!!e.lastModifiedBy},t.prototype.renderComplete=function(){this.isRenderComplete(!0)},t.prototype._getIconDesiredSize=function(){return"Small"===this._responsiveUI.formFactorSize()?{width:20,height:20}:{width:48,height:48}},t}(r.e);Object(D.t)(C.Default,'<li class="od-SearchResults-suggestion" tabindex="-1" data-bind="attr:{\'aria-label\':titleAriaLabel||title},click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},hasFocus:isFocused"><div class="od-SearchResults-result-icon" data-bind="component:{name:$component.imageFrameTagName,params:{desiredSize:$component.iconDesiredSize,fadeIn:$component.fadeIn,image:$component.getIconImage($data)}}"></div><div class="od-SearchResults-result-title"><div class="od-SearchResults-result-title-text" data-bind="html:title"></div>\x3c!--ko if:$component.displayOdbMetadata($data)--\x3e<div class="od-SearchResults-result-metadata"><div data-bind="text:parentFolder"></div><div data-bind="text:lastModifiedDateDisplay" class="ms-dotSeparatorBefore"></div>\x3c!--ko if:$component.displayLastModifiedBy($data)--\x3e<div data-bind="text:lastModifiedBy" class="ms-dotSeparatorBefore"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></li>'),Object(D.t)(C.Expanded,'<li class="od-SearchResults-result od-SearchResults-expanded-result" role="presentation"><div class="od-SearchResults-result-link" tabindex="-1" role="listitem" data-bind="click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},attr:{\'aria-label\':titleAriaLabel||title},hasFocus:isFocused"><div class="od-SearchResults-result-icon" data-bind="component:{name:$component.imageFrameTagName,params:{image:{url:iconUrl},desiredSize:{width:24,height:24},fadeIn:$component.fadeIn}}"></div><span class="od-SearchResults-result-title" data-bind="html:title"></span></div>\x3c!--ko if:!!$data.lastModifiedBy&&!!$data.lastModifiedDate&&!!$data.parentFolder--\x3e<div class="od-SearchResults-result-metadata ms-font-s ms-fontColor-neutralSecondary"><span data-bind="text:lastModifiedBy" class="ms-dotSeparatorAfter"></span><a data-bind="text:parentFolder,attr:{href:parentUrl,\'aria-label\':$component.parentFolderLabel}" class="od-SearchResults-result-folderLink ms-font-s ms-fontColor-themePrimary" target="_blank" tabindex="-1"></a><span data-bind="text:$component.getRelativeDateTimeStringPast(lastModifiedDate)" class="ms-dotSeparatorBefore"></span></div>\x3c!--/ko--\x3e\x3c!--ko if:$data.showSummary&&!!$data.summary--\x3e<div class="od-SearchResults-result-summary ms-font-s ms-fontColor-neutralSecondary"><span data-bind="html:summary" class="ms-enquote"></span></div>\x3c!--/ko--\x3e</li>'),Object(D.t)(C.Glyph,'<li class="od-SearchResults-suggestion" tabindex="-1" data-bind="attr:{\'aria-label\':titleAriaLabel},click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},hasFocus:isFocused"><div class="od-SearchResults-result-glyph" data-bind="component:{name:\'od-icon-glyph\',params:{icon:glyph}}"></div><div class="od-SearchResults-result-title"><div class="od-SearchResults-result-title-text" data-bind="html:title"></div></div></li>'),Object(D.t)(C.Upscope,'<li class="od-SearchResults-result od-SearchResults-upscope-result" role="presentation"><div class="od-SearchResults-result-link" tabindex="0" role="link" data-bind="click:$component.onClickResult.bind($component),clickBubble:false,css:{\'od-SearchResults-result-link--focused\':isFocused},attr:{\'aria-label\':titleAriaLabel},hasFocus:isFocused">\x3c!--ko component:{name:\'od-icon-glyph\',params:{icon:glyph}}--\x3e\x3c!--/ko--\x3e<span class="od-SearchResults-result-title" data-bind="text:title"></span></div></li>');var P=Object(a.n)({name:"SearchResults",automationName:"ms-search-results",viewModelType:M,template:'<div class="od-SearchResults" data-bind="css:{\'od-SearchResults-hasStatus\':!!statusMessage()},style:{\'max-height\':responsiveMaxHeight()},keyboard:{allowInputEvents:true,preventDefault:true,mappings:{Enter:context.onEnter,Esc:context.clearInput,Down:context.onArrowDown,Up:context.onArrowUp,Space:context.onSpace}}">\x3c!--ko if:!context.queryInProgress()&&!statusMessage()--\x3e<div class="ms-accessible" aria-live="assertive" data-bind="text:context.newResultsAlert"></div>\x3c!--/ko--\x3e<div class="od-SearchResults-progressBox" data-bind="component:{name:progressSpinnerFlatTagName},visible:context.queryInProgress()"></div><div class="od-SearchResults-status" data-bind="text:statusMessage"></div><ul class="od-SearchResults-resultsBox ms-noList" data-bind="attr:{id:context.ariaResultsId}" role="list">\x3c!--ko foreach:context.searchData().containers--\x3e\x3c!--ko foreach:results--\x3e\x3c!--ko template:$component.getTemplate.call($component,$data)--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:$index()<$parent.context.searchData().containers.length-1--\x3e<li class="od-SearchResults-separator" role="separator"><hr class="od-SearchResults-separator-line"></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--ko activate:$component.renderComplete()--\x3e\x3c!--/ko--\x3e</div>'}),T=n(1214),U=n(146),F=n(23),H=n(65),R=n(136),N=n(2221),B=n(37),j=n(9),V=n(10),z=n(100),G=new V.t({name:"SearchProvider",factory:new R.e(z.J)}),K=n(435),W=n(2217),q=function(e){function t(n,a){var i=e.call(this,n,a)||this,r=i._engagement=a.engagement;return i._hideDropdown=f.observable(!1),i._instrumentationProvider=a.instrumentationProvider,i._navigation=a.navigation,i._searchProvider=a.searchProvider,i._urlDataSource=a.urlDataSource,i._viewParams=a.viewParams,i._itemSelectionHelper=new(i.scope.attached(a.itemSelectionHelperType))({canFallback:!1,ignoreSelection:!0}),i._currentItem=i._itemSelectionHelper.currentItem,i.search=function(){var e=i.searchText.peek();i._searchProvider&&e&&(i._tsLogSearchDone(e),r.logData({name:"Upscope.Search.Click",isIntentional:!0}),i._onNavigateAway(),i._searchProvider.upscopeSearch({query:e}),i.unfocusInput())},i.onSpace=function(){var e=i.focusedItem.peek();e&&7===e.type&&i.searchResultClicked(e)},i.onEnter=function(){var e=i.focusedItem.peek();e?i.searchResultClicked(e):i._logAndSubmit()},i.clearInput=function(){i.searchText(""),i._tsResetSearchSession(),i.inputFocused(!0),i._setFocusItem(null),i.isActive(!0),i._hideDropdown(!0)},i.focusInput=function(){i._hideDropdown(!1),i.inputFocused(!0),i._setFocusItem(null),i.isActive(!0),""===i.searchText.peek()&&i._autoSuggest("")},i.onSearchClick=function(){i.isActive.peek()?i._logAndSubmit():i.focusInput()},i.unfocusInput=function(){i.inputFocused(!0),i.inputFocused(!1),i.isActive(!1)},i.onBack=function(){i.clearInput(),i.unfocusInput()},i.onArrowDown=function(){if(i._hideDropdown(!1),i.showResults.peek()){var e=i.allResults.peek();if(e&&e.length){var t=i.focusedItem.peek(),n=e[0];if(null!==t){var a=e.indexOf(t);n=(a+=1)===e.length?null:e[a]}i._setFocusItem(n)}return!1}},i.onArrowUp=function(){if(i._hideDropdown(!1),i.showResults.peek()){var e=i.allResults.peek();if(e&&e.length){var t=i.focusedItem.peek(),n=e[e.length-1];if(null!==t){var a=e.indexOf(t);n=0!==a?e[a-=1]:null}i._setFocusItem(n)}return!1}},i.searchResultClicked=function(e){var t;if(i._setFocusItem(null),i._searchProvider&&e)if(7===e.type)i._logAndSubmit();else{i._tsLogEntitySelected(e),i._engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0}),i._searchProvider.searchResultClicked(e),i._updateText(e,!1),i._instrumentationProvider&&e.instrumentationUrl&&i._instrumentationProvider.userClickSuggestion(e.instrumentationUrl);var n=e.key,a=e.url;n?(i._onNavigateAway(),i._navigation.navigateTo({url:i._urlDataSource.getItemUrl(n,{viewParams:(t={},t.v="",t)})})):a&&(i._onNavigateAway(),i._navigation.navigateTo({url:a,frameId:"_blank"}))}i.unfocusInput()},i.placeholder=n.searchParams.placeholder,i.submitPlaceholder=n.searchParams.submitPlaceholder,i.hasBack=n.searchParams.hasBack,i.hideResultsUntilChange=f.observable(!1),i.submitAction=n.searchParams.submitAction||i.search,i.searchIconLeft=f.observable(!1),i.searchIconRight=f.observable(!1),i.createBackgroundComputed(function(){i._urlDataSource.getQueryType(i._viewParams&&i._viewParams())!==B.e.Search&&(i.searchText(""),i._tsResetSearchSession(),i._hideDropdown(!0))}),i.capabilities=i._searchProvider.getCapabilities(),i.isFocused=f.observable(!1),i.isActive=f.observable(!1),i.ariaAutoComplete=i.capabilities.supportsResultsWheeling?"list":"none",i.ariaResultsId="od-searchResults-list-"+t.resultsId++,i.searchBoxAriaLabel=n.searchParams.searchBoxAriaLabel,i.searchText=n.searchParams.searchText||f.observable(""),i.searchText.peek()&&i.async.setImmediate(function(){i._logAndSubmit()}),i.inputFocused=f.observable(!1),i._hadResults=!1,i._ignorableTextUpdateCount=0,i._isTemporarySuggestion=!1,i._tsLastTraceId=void 0,i._tsLastLogicalId=void 0,i.searchData=f.observable({}),i.allResults=f.observableArray(),i.newResultsAlert=f.observable(""),i.focusedItem=f.observable(null),i.subscribe(i.allResults,function(){i._setFocusItem(null)}),i.queryInProgress=f.observable(!1),i.errorMessage=f.observable(""),i.createComputed(i._computeSearchTextChanged).extend({rateLimit:i.capabilities.maxQueryRate}),i.createComputed(function(){i.isFocused()?i.isActive(!0):i.isActive(!1)}),i.showResults=i.addDisposable(f.pureComputed({read:function(){var e=i.searchText();if(i._hideDropdown()||i.hideResultsUntilChange())return!1;var t=!0;if(i.capabilities.showOnlyResults){var n=i.allResults();n&&n.length&&(i._hadResults||n.length>1)?(t=!0,i._hadResults=!0):t=!1}else e.length<i.capabilities.minimumQueryLength&&(t=!1);return i.capabilities.supportsResultsWheeling&&i.isFocused()&&t},write:function(){}})),i.createComputed(function(){i.isFocused()||i.hideResultsUntilChange(!1)}),i.createBackgroundComputed(function(){i.isActive();var e=o.e.determineWindowSize(window.innerWidth);o.e.DEFAULT_BREAKPOINTS[e]<=o.e.DEFAULT_BREAKPOINTS.Large&&i.async.setTimeout(function(){p.t.raise(document.body,"resize",void 0,!0)},400)}),i.observables.compute(function(){var e=i.searchData();e&&(i._tsLastTraceId=e.traceId,i._tsLastLogicalId=e.logicalId)}),i}return Object(i.__extends)(t,e),t.prototype._computeSearchTextChanged=function(){var e=this.searchText();e&&this._hideDropdown(!1),this.hideResultsUntilChange(!1),this.capabilities.supportsResultsWheeling&&this.isFocused.peek()&&this._previousSearchText!==e&&0===this._ignorableTextUpdateCount&&(this._isTemporarySuggestion=!1,this._autoSuggest(e)),this._ignorableTextUpdateCount&&this._ignorableTextUpdateCount--},t.prototype._autoSuggest=function(e){this.queryInProgress.peek()&&this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel(),this.queryInProgress(!0),this._searchProvider.getItems&&(this._searchResultsRequestPromise=this._searchProvider.getItems(e,this._currentItem?this._currentItem.peek():null),this._searchResultsRequestPromise.done(this._resultCallback(),this._errorCallback()),this._previousSearchText=e)},t.prototype._logAndSubmit=function(){this._instrumentationProvider.logStartSearchOnSubmit(),this.submitAction(this)},t.prototype._clearResults=function(){this.searchData({}),this.allResults.removeAll()},t.prototype._resultCallback=function(){var e=this;return function(t){e.queryInProgress(!1),e.errorMessage("");var n=t.containers,a=!t.upscopeUnavailable&&e.searchText();if(a){var i=e.submitPlaceholder.peek();n.push({results:[{type:7,title:i,titleAriaLabel:i,glyph:new W.e("Search")}]})}var r=e._viewFromISearchResult(t),o=r.containers.reduce(function(e,t){return e.concat(t.results)},[]),s=o.length;e.capabilities.showOnlyResults&&!s&&e.showResults(!1),e.searchData(r),e.allResults(o),e.newResultsAlert(F.format(c.a,a?s-1:s))}},t.prototype._errorCallback=function(){var e=this;return function(t){H.n.isCanceled(t)||(e.queryInProgress(!1),e.errorMessage(String(t)),e._clearResults())}},t.prototype._viewFromISearchResult=function(e){var t=e.containers.map(function(e){return{results:e.results.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{isFocused:f.observable(!1)})})}});return Object(i.__assign)(Object(i.__assign)({},e),{containers:t})},t.prototype._onNavigateAway=function(){this._tsResetSearchSession(),this._isTemporarySuggestion=!1,this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel()},t.prototype._setFocusItem=function(e){var t=this.focusedItem.peek();t!==e&&(t&&t.isFocused(!1),this.focusedItem(e),e?(e.isFocused(!0),this._updateText(e,!0)):this.focusInput())},t.prototype._updateText=function(e,t){4===e.type?(this._ignorableTextUpdateCount++,this.searchText(e.titleText),this._isTemporarySuggestion=t):this._isTemporarySuggestion&&(this._ignorableTextUpdateCount++,this.searchText(this._previousSearchText),this._isTemporarySuggestion=!1)},t.prototype._tsLogEntitySelected=function(e){var t=this.searchData.peek().traceId,n=e.referenceId,a=this.searchData.peek().logicalId;t&&n&&this.resources.consumeAsync(k.e).then(function(e){e.selectedEntity(t,n,a)})},t.prototype._tsLogSearchDone=function(e){var t=this._tsLastTraceId,n=this._tsLastLogicalId;e!==this._navigation.viewParams[j.n.queryParamKey]&&t&&this.resources.consumeAsync(k.e).then(function(e){e.didSearch(t,n)})},t.prototype._tsResetSearchSession=function(){this._tsLastTraceId&&this.resources.consumeAsync(k.e).then(function(e){e.renderedResults("",-1)}),this._tsLastTraceId=void 0,this._tsLastLogicalId=void 0},t.dependencies=Object(i.__assign)(Object(i.__assign)({},T.default.dependencies),{engagement:_.e,instrumentationProvider:K.r,navigation:U.e,searchProvider:G,urlDataSource:z.ue,viewParams:d.P,itemSelectionHelperType:N.e}),t.resultsId=0,t}(T.default),Q=Object(R.o)("SearchContext",q),Y=n(2419),J=n(2230),X=n(2274),Z=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.addBindingHandlers({keyboard:u.e,hasChildFocus:Y.e,element:J.e,control:a.a}),i._responsiveUI=n.responsiveUI,i.rootElement=i.createObservable(),i.overlayTagName=X.e.tagName;var r=t.placeholder,o=void 0===r?i.createObservable(s.S):r,d=t.searchBoxAriaLabel,l=void 0===d?s.h:d,f=t.submitPlaceholder,p=void 0===f?i.createObservable(c.n):f,m=t.hasBack,_=void 0===m?i.createObservable(!1):m,h=t.searchText,b=t.submitAction;return i.context=i.scope.attach(new n.searchContextType({searchParams:{placeholder:o,searchBoxAriaLabel:l,submitPlaceholder:p,hasBack:_,searchText:h,submitAction:b}})),i.searchBoxSpecification=n.searchBoxControl.toSpecification({context:i.context}),i.searchResultsSpecification=n.searchResultsControl.toSpecification({context:i.context}),i.isMdDown=i.createPureComputed(function(){if(i._responsiveUI){var e=i._responsiveUI.formFactorSize();return"Medium"===e||"Small"===e}return!1}),i.resultsStyle=i.createPureComputed(function(){var e=i.context.isFocused(),t=i.isMdDown(),n=i.rootElement();if(e&&t&&n){var a=n.getBoundingClientRect();return{top:String(a.top+a.height)+"px"}}return{}}),i}return Object(i.__extends)(t,e),t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{responsiveUI:o.t,searchBoxControl:y,searchResultsControl:P,searchContextType:Q}),t}(r.e),$=Object(a.n)({name:"Search",automationName:"ms-search",viewModelType:Z,template:'<div class="od-Search" id="od-Search-div" data-bind="keyboard:{allowInputEvents:true,mappings:{Esc:context.clearInput}},css:{\'od-Search--active\':context.isActive},hasChildFocus:context.isFocused,element:rootElement">\x3c!--ko control:searchBoxSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if:context.showResults()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:!isMdDown()}}--\x3e<div class="od-Search-overlay" data-bind="control:searchResultsSpecification,css:{\'od-Search--active\':context.isActive,\'od-Search--maximized\':isMdDown()},style:resultsStyle"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return m}),n.d(t,"r",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"e",function(){return v});var a=n(320),i=n(2428),r=n(0),o=n(80),s=n(13),c=n(5),d=n(1),l=n(36),u=n(28),f=n(120),p=n(14),m=Object(s.r)()(Object(s.a)()(Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(177).then(n.bind(null,5726))];case 1:return[2,e.sent().ComplianceDetailsAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItem({isFolder:c.h,permissions:d.St,spItem:u.e},n),i=a.isFolder,r=a.permissions,o=a.spItem,s=o&&f.e.serialize(o),m=e.demandItemFacet(d.We,s);if(m&&m.templateType===p.t.mySiteDocumentLibrary)return!1;var _=l.t.hasItemPermission({permissions:r},l.t.viewVersions);return!i&&_}return!1}))),_=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.WorkflowAction))}),h=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.EditRenditionsAction))}),b=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.PublishAction))}),g=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.UnPublishAction))({unPublishType:0})}),v=Object(i.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(a.e);return new(e.injected(t.UnPublishAction))({unPublishType:1})})}],Array(21),[function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"a",function(){return d});var a=n(2669),i=n(3718),r=n(1989),o="EditLinkGroup",s="http://linkless.header/",c={quickLaunch:"QuickLaunch",globalNav:"GlobalNav",hubNav:"HubNav",footer:"Footer"};function d(e,t,n,o,s){var c=void 0;return e.PublishingFeatureOn&&(c=a.t.getAreaNavigationSettingsUrl(e),n=function(e){window.open(c,"_blank")}),{name:o||r.e,url:c,onClick:n,icon:t?"Edit":void 0,key:i.t.clientEdit,ariaLabel:s,automationId:"navEditLink"}}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(740),i=a.t.protocolCommand;function r(e,t,n,i,r,o){var s=a.e.none;return r&&(s=a.e.encodeCommand),a.t.createProtocolHandlerUrl(e,t,n,i,s,o)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(4).e},function(e,t,n){"use strict";function a(e,t){return{definitionKey:e,params:t}}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("ItemCacheEvaluationContext.key")},function(e,t,n){"use strict";var a=n(0),i=n(2213),r=n(83),o=n(2221),s=n(65),c=n(2386),d=n(371),l=function(e){function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";var a=n._fileHandlerAction=t.fileHandlerAction;return n._fileHandlerProvider=n.resources.consume(c.e),n._itemSelectionHelper=new(n.child(o.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}),n._defaultHandlerAction=n.observables.pureCompute(n._computeDefaultHandlerAction),a&&a.handler&&a.handler.isPromoted&&(n.name="PromotedFileHandlerOpen"),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,a=this._fileHandlerAction;return a?n.isActionForExtension(a,t):!!this._defaultHandlerAction()},t.prototype.onExecute=function(e){var t,n=this,a=this._fileHandlerAction;if(!a||!a.handler.isPromoted){if(!(t=window.open("","_blank")))return s.n.reject({resultType:r.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){var i=a||n._defaultHandlerAction.peek();return i?n.resources.consumeAsync(d.t).then(function(n){return n.invokeAction({items:[e],action:i,target:t})}):s.n.reject("No action available for file handler")}).then(function(){return s.n.wrap({resultType:r.e.Success})},function(e){return s.n.wrap({resultType:s.n.isCanceled(e)?r.e.ExpectedFailure:r.e.Failure})})},t.prototype._computeDefaultHandlerAction=function(){if(!this._fileHandlerAction){var e=this._itemSelectionHelper.firstItem();if(e&&e.graph)return this._fileHandlerProvider.getDefaultOpenHandler(e.extension)}},t}(i.e);t.e=l},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("sharingContextInformation")},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1214),r=n(100),o=n(136),s=function(e){function t(t,n){var a=e.call(this,t)||this;return a._commandDataSource=n.itemCommandDataSource,a}return Object(a.__extends)(t,e),t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCommandDataSource:r.E}),t}(i.default),c=Object(o.r)("ItemCommandProvider",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("MoveCopyCapabilities")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"provider.clientForm.async",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e(574)]).then(n.bind(null,2941)).then(function(e){return e.resourceKey})})})}],Array(295),[function(e,t,n){"use strict";var a=n(2202),i=n(0),r=n(2201),o=n(2855),s=n(2441),c=n(2203),d=n(1214),l=n(601),u=n(136),f=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=a._images=[];return a.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4),a}return Object(i.__extends)(t,e),t.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")},t.prototype.checkInImage=function(e){var t=this,n=new l.e,a=this.async;return a.setTimeout(function(){e.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),e.removeAttribute("style"),e.removeAttribute("class"),a.setTimeout(function(){e.removeAttribute("src"),t._images.push(e),n.complete()},1e3)},0),n.getPromise()},t}(d.default),p=Object(u.r)("ImageRecycler",f),m=n("knockout-lib"),_=function(e){function t(t){var n=e.call(this,t)||this,a=n.resources.consume(p),r=n.valueAccessor(),o=a.checkOutImage(),c=n.bindingContext,d=r.attr,l=void 0===d?{}:d,u=r.style,f=r.css,_=r.class;return m.applyBindingsToNode(o,{attr:Object(i.__assign)({alt:""},l)},c),u&&m.applyBindingsToNode(o,{style:u},c),f&&m.applyBindingsToNode(o,{css:f},c),_&&m.applyBindingsToNode(o,{class:_},c),new(n.managed(s.e))({element:o,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return r.imageLoader},bindingContext:c}),m.virtualElements.setDomNodeChildren(n.element,[o]),n.addDisposable({dispose:function(){o&&(m.cleanNode(o),a.checkInImage(o).done())}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.supportsVirtualElements=!0,t}(c.t),h=n(23),b=n(741),g=n(1197),v=n(2689),y=n(4419),S=n(2015),D=n(15),I=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({imageLoader:s.e,imageRecycler:_});var i=t.image,r=t.rotation,c=void 0===r?o.e.none:r,d=t.desiredSize,l=t.scale,u=void 0===l?1:l,f=t.isLoaded,p=void 0===f?a.createObservable(!1):f,m=t.position,h=t.loadedImage,b=t.error,g=t.loadImageScenarioName,D=n.thumbnailCache,I=void 0===D?a.resources.consume(y.e):D,x=n.outputExtenders,C=void 0===x?{deferred:!0}:x;return a._image=a.wrapObservable(i),a._rotation=a.wrapObservable(c),a._scale=a.wrapObservable(u),a._desiredSize=a.wrapObservable(d),a._alignment=v.n(t.alignment),a._thumbnailCache=I,a._loadedImage=a.wrapObservable(h),a._error=a.wrapObservable(b),a.isRotating=a._getIsRotating(),a.alignmentName=a.createPureComputed(a._computeAlignmentName),a.actualSize=a.createPureComputed(a._computeActualSize),a.actualSize.equalityComparer=S.e,a.isLoaded=a.createPureComputed(a._computeIsLoaded),a._imageUrl=a.createPureComputed(a._computeImageUrl),a._finalSize=a.createPureComputed(a._computeFinalSize),a._finalSize.equalityComparer=S.e,a._position=a.createPureComputed(a._computePosition),a._position.equalityComparer=S.e,a.imageElementStyle=a.createPureComputed(a._computeImageElementStyle),a.imageElementStyle.equalityComparer=S.e,a.imageBackgroundStyle=a.createPureComputed(a._computeImageBackgroundStyle),a.imageBackgroundStyle.equalityComparer=S.e,a.createBackgroundComputed(a._computeRecordImage),a.imageLoaderParams={src:a._imageUrl,image:a._loadedImage,error:a._error,scenarioName:g,getContents:a.observables.pureCompute(function(){return a._image().getContents})},m&&a.createBackgroundComputed(function(){return m(a._position())}).extend(C),p&&a.createBackgroundComputed(function(){return p(a.isLoaded())}).extend(C),a}return Object(i.__extends)(t,e),t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&h.format(e.url,e.width,e.height)||""},t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var a=this.actualSize(),i=window.devicePixelRatio||1;e=a&&{width:a.width*n/i,height:a.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e},t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i;i=t&&t.width&&t.height?t:n;var r=this._alignment.getTransform(n,i),o=r.translate.x/i.width,s=r.translate.y/i.height,c=r.scale*n.width/i.width,d=void 0;if(a){var l=void 0;if(a%2==1){var u={width:n.height,height:n.width};l=this._alignment.getTransform(u,i).multiply(r.invert())}else l=b.e.IDENTITY;d="rotate(".concat(90*a,"deg) scale(").concat(l.scale.toFixed(6),")")}else d="";e={left:"".concat((100*o).toFixed(2),"%"),top:"".concat((100*s).toFixed(2),"%"),width:"".concat((100*c).toFixed(2),"%"),"-webkit-transform":d,"-ms-transform":d,transform:d}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e},t.prototype._computeImageBackgroundStyle=function(){var e,t,n=this._finalSize(),a=D.t.isActivated("0ECA92CE-9CE8-41A7-8AEA-ED7D0D862836","10/08/2022","fix secure thumbnail link and meta throttling issue"),i=!a&&(null===(e=this._image())||void 0===e?void 0:e.getContents)?null===(t=this._loadedImage())||void 0===t?void 0:t.url:this._imageUrl();return{"max-width":n?"".concat(n.width.toFixed(2),"px"):"","max-height":n?"".concat(n.height.toFixed(2),"px"):"","background-image":a||i?'url("'.concat(i,'")'):""}},t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),a=this.createPureComputed(function(){var a=t._rotation();return e&&t.async.clearTimeout(e),e=t.async.setTimeout(function(){return n(a)},300),n()});return this.createPureComputed(function(){return t._rotation()!==a()})},t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)},t.prototype._computeIsLoaded=function(){return!!this._loadedImage()},t.prototype._computeActualSize=function(){var e,t=this._loadedImage();return t&&(e={width:t.width,height:t.height}),e},t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),a=this._rotation();if(n){var i,r;i=t&&t.width&&t.height?t:n,r=a%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(r,i),s=o.translate.x,c=o.translate.y,d=o.scale*r.width,l=o.scale*r.height;e=new g.e(s,c,d,l)}return e},t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e},t}(r.e),x=Object(a.e)({tagName:"od-image-tile",template:"<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>",viewModel:I,synchronous:!0});t.e=x},function(e,t,n){"use strict";var a,i=n(0),r=n(1214),o=n(428),s=n(100),c=n(435),d=n(320),l=n(371),u=n(506),f=n(38),p=n(266),m=n(146),_=n(5085),h=n(547),b=n(40);!function(e){e[e.Page=0]="Page",e[e.Card=1]="Card"}(a||(a={}));var g=a,v=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._peopleToPrefetch={},n._debouncedPrefetch=n.async.debounce(function(){return n._prefetchPeopleCards()},50),n}return Object(i.__extends)(t,e),t.prototype.personRendered=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a&&!this._peopleToPrefetch[a]&&(this._peopleToPrefetch[a]=!0)}this._debouncedPrefetch()},t.prototype.getPeopleCardData=function(e){Object(b.isFeatureEnabled)(b.PeopleCardsOnLoki)&&!Object(b.isFeatureEnabled)(b.PeopleCardsReactComponent)&&(this.resources.consume(h.e).logData({name:"PeopleCard.DataLoad"}),this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(c.l)),this._peopleCardProvider.getPeopleCard(e,!1))},t.prototype._prefetchPeopleCards=function(){if(Object(b.isFeatureEnabled)(b.PeopleCardsOnLoki)&&!Object(b.isFeatureEnabled)(b.PeopleCardsReactComponent)){this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(c.l));var e=Object.keys(this._peopleToPrefetch);e.length>0&&this._peopleCardProvider.prefetchPeopleCards(e,g.Page)}this._peopleToPrefetch={}},t}(r.default),y=n(1602),S=n(4766),D=n(1577),I=n(4836),x=n(1378),C=function(){var e=this.mediaBaseUrl="odsp-media";x.e.addPaths({"@ms/odsp-media/lib":e})},O=n(4837),w=n(4218),E=n(4428),A=n(4838),L=n(2975),k=n(4839),M=n(1666),P=n(1017),T=n(300),U=n(308),F=n(3293),H=n(10),R=n(136),N=n(105),B=n(4439),j={base:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(501)]).then(n.bind(null,5703))}),settings:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(521)]).then(n.bind(null,5885))}),share:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(522)]).then(n.bind(null,5968))}),mobileUpsell:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(517)]).then(n.bind(null,5948))}),picker:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(505)]).then(n.bind(null,5704))}),textEditor:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(524)]).then(n.bind(null,5844))}),fileRequest:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(507)]).then(n.bind(null,5871))}),embed:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(503)]).then(n.bind(null,5848))}),oneUp:Object(B.e)(function(){return n.e(518).then(n.bind(null,5920))}),files:Object(B.e)(function(){return n.e(508).then(n.bind(null,5969))}),error:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(504)]).then(n.bind(null,5949))}),mobileUpsellInner:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(516)]).then(n.bind(null,5087))}),settingsInner:Object(B.e)(function(){return n.e(520).then(n.bind(null,5894))}),restore:Object(B.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(519)]).then(n.bind(null,5921))}),commands:Object(B.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(510)]).then(n.bind(null,5930))})},V=function(){function e(){}return e.prototype.getPageModuleLoader=function(e){if(e===N.e.MobileAppUpsell&&Object(b.isFeatureEnabled)(b.EnableMobileWebOfficeAppUpsell))return j.mobileUpsell;switch(e){case N.e.Error:case N.e.Restore:return j.base;case N.e.Settings:return j.settings;case N.e.Share:return j.share;case N.e.FilePicker:return j.picker;case N.e.TextFileEditor:return j.textEditor;case N.e.FileRequest:return j.fileRequest;case N.e.Embed:return j.embed;case N.e.OneUp:return j.oneUp;default:return j.files}},e.prototype.getInnerPageModuleLoader=function(e){switch(e){case N.e.MobileAppUpsell:return j.mobileUpsellInner;case N.e.Settings:return j.settingsInner;case N.e.Restore:return j.restore;case N.e.Error:default:return j.error}},e.prototype.getCommandSetModuleLoader=function(){return j.commands},e}(),z=new H.t({name:"ModuleLoaderDataSource",factory:new R.i(V)}),G=n(3850),K=n(4840),W=n(1099),q=n(4841),Q=n(1461),Y=n(2269),J=n(3452),X=n(3439),Z=n(4842),$=n(4167),ee=n(4440),te=n(3119),ne=n(1944),ae=n(3294),ie=n(2562),re=function(){function e(e,t){}return e.prototype.isWIPEnabled=function(){return!1},e}(),oe=Object(R.r)("WIPDataSource",re,{}),se=function(){function e(){}return e.exposeIfNeeded=function(e,t,n){return e.isExposed(t)?e.consume(t):e.expose(t,n())},e.exposeFactoryIfNeeded=function(e,t,n){e.isDefined(t)||e.exposeFactory(t,new R.e(n))},e.exposeResources=function(t){var n=t.resourceScope,a=t.pageContext,h=t.viewId,b=t.itemResultSetOptions,g=new o.e,x=g.attach(new(n.consume(r.observablesFactoryTypeResourceKey)));e.exposeIfNeeded(n,s.i,function(){return new(n.injected(k.e))}),e.exposeIfNeeded(n,c.e,function(){return new(n.injected(_.e))}),e.exposeIfNeeded(n,f.f,function(){return a}),e.exposeIfNeeded(n,Y.t,function(){return new Y.e}),e.exposeIfNeeded(n,m.e,function(){return new W.t}),e.exposeIfNeeded(n,s.X,function(){return new C}),e.exposeFactoryIfNeeded(n,F.e,z),e.exposeIfNeeded(n,s.ue,function(){return new(n.injected(S.default))}),e.exposeFactoryIfNeeded(n,s.ne,E.e),e.exposeFactoryIfNeeded(n,P.e,M.e),e.exposeIfNeeded(n,f.o,function(){return new(n.injected(D.e))({pageContext:a,listRootFolderWebRelativeUrl:t.listRootFolderWebRelativeUrl,listFullUrl:t.listFullUrl,listId:t.listId})}),n.expose(I.t,t.listShouldRenderFilesTitle),e.exposeFactoryIfNeeded(n,s.v,I.e),e.exposeFactoryIfNeeded(n,s.P,I.e),e.exposeFactoryIfNeeded(n,s.s,I.e),e.exposeFactoryIfNeeded(n,f.s,I.e),e.exposeFactoryIfNeeded(n,s.Se,oe),n.isDefined(s.c)||n.exposeFactory(s.c,new R.e(O.e)),e.exposeFactoryIfNeeded(n,s.V,w.e),e.exposeIfNeeded(n,c.r,function(){return new(n.injected(y.e))}),e.exposeFactoryIfNeeded(n,s.S,T.a),e.exposeIfNeeded(n,d.P,function(){return x.create({})}),e.exposeFactoryIfNeeded(n,s.r,A.e),e.exposeFactoryIfNeeded(n,G.e,K.e),e.exposeIfNeeded(n,c.f,function(){return new(n.injected(v))}),e.exposeFactoryIfNeeded(n,s.fe,U.resourceKey),e.exposeIfNeeded(n,p.t,function(){return"StandaloneList"}),e.exposeFactoryIfNeeded(n,p.e,Q.n),e.exposeFactoryIfNeeded(n,u.o,Z.e),e.exposeIfNeeded(n,u.e.leftNav.isLeftNavUserExpanded,function(){return x.create(!1)}),e.exposeFactoryIfNeeded(n,s.F,L.t);var H=e.exposeIfNeeded(n,u.t,function(){return new(n.injected($.e))({defaultViewId:h,itemResultSetOptions:b})});e.exposeIfNeeded(n,d.o,function(){return H.item}),e.exposeIfNeeded(n,u.a.layoutType,function(){return H.layoutType}),e.exposeIfNeeded(n,d.s,function(){return H.itemSet}),e.exposeIfNeeded(n,d.m,function(){return H.focusItem}),e.exposeIfNeeded(n,d._,function(){return H.focusItemSet}),e.exposeIfNeeded(n,d.l,function(){return H.currentView}),e.exposeIfNeeded(n,d.a,function(){return x.create(!1)}),e.exposeIfNeeded(n,d.d,function(){return new(n.injected(ee.e))});var N=n.consume(d.d);e.exposeIfNeeded(n,d.I,function(){return new(n.injected(J.e))(Object(i.__assign)(Object(i.__assign)({},t&&t.selectionOptions||{}),{selectionModelGroup:N,enableSelectionResolution:!1}))});var B=n.consume(te.e);return g.attach(B.register(x.pureCompute(function(){var e=N.currentSelection();return!!e&&e.selectedCount()>0}))),g.attach(B.register(n.consume(ie.t))),e.exposeIfNeeded(n,ne.resourceKey,function(){return x.create(!1)}),e.exposeIfNeeded(n,ae.e,function(){return x.create(!1)}),e.exposeIfNeeded(n,d.e,function(){return new X.e}),e.exposeIfNeeded(n,d.i,function(){return x.create(!0)}),e.exposeIfNeeded(n,l.a,function(){return new(n.injected(q.e))}),g},e}();t.e=se}],Array(18),[function(e,t,n){"use strict";var a=n(0),i=n(14),r=n(69),o=n(1214),s=n(1613),c=n(146),d=n(996),l=n(97),u=n(65),f=n(181),p=n(51),m=n(170),_=n(138),h=n(83),b=n(114),g=n(2015),v=n(66),y=n(23),S=n(428),D=n(1219),I=n(1956),x=n(2498),C=n(2882),O=n(105),w=n(37),E=n(9),A=n(2220),L=n(2718),k=n(3019),M=n(3283),P=n(2269),T=n(2229),U=n(320),F=n(100),H=n(266),R=n(506),N=n(435),B=n(38),j=n(2653),V=n(10),z=new V.t({name:"titleUpdater.key",factory:new V.e(function(e){e&&(document.title=e)})}),G=n(2219),K=n(118),W=n(40),q=n(1424),Q=n(4219),Y=n(1379),J="SPColumnSize",X="-Unsaved",Z=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.defaultViewId,i=t.itemResultSetOptions;n._itemResultSetOptions=i,n._autoExecuteRequested=!1,n._useRequiredRangeSync=!1;var r=n,o=r.observables,s=r.resources;n._defaultViewId=p.e.normalizeLower(a),n._resetPartialResultRequestCount=o.create(!1),n._viewParams=s.consume(U.P),n._responsiveUI=s.consume(G.t),n._isLeftNavUserExpanded=s.consume(R.e.leftNav.isLeftNavUserExpanded),n._navigation=s.consume(c.e),n._dataStore=s.consume(P.t),n._rumOneHelper=s.consume(H.e),n._onePageNavigationDataFetch=o.create(!1);var u=s.consume(B.u.optional);u&&(u.onePageNavigationDataFetch=n._onePageNavigationDataFetch),n._pageContext=s.consume(B.f),n._itemParentHelper=s.consume(A.e),n._loaderProvider=s.consume(N.e),n._isSwitchingLayout=o.create(void 0),n._currentItemKey=o.pureCompute(n._computeCurrentItemKey,{deferEvaluation:!0}),n._focusItemKey=o.pureCompute(n._computeFocusItemKey),n.focusRange=o.create({start:0,end:0}).extend({throttle:500});var m=n._getPlaceholderItemSet();n.item=s.expose(U.o,m.item),n.item.equalityComparer=d.n,n.itemSet=s.expose(U.s,o.create(m)),n.itemSet.equalityComparer=d.n,n._children=o.createArray([]),n.isEmptyView=o.create(!1),n.isGroupThrottled=s.consume(U.h.optional)||o.create(!1),n.showErrorPage=o.create(!1),n.isRetrievingData=o.create(!0),n.error=o.create(void 0),n.error.subscribe(function(e){e&&l.e.logError(e)}),n._groupingType=o.pureCompute(n._computeGroupingType),o.compute(function(){var e=n.itemSet().content();n._children(e.items);var t=(e.groupings||[])[0],a=void 0===t?void 0:t,i=a&&a.itemGroups&&a.isAllCollapsed&&a.isAllCollapsed(),r=!n.showErrorPage()&&!n.itemSet().isPlaceholder&&0===e.items.length&&!i;n.isEmptyView(r&&!n.itemSet().isExpired)}),o.compute(function(){n.item(n.itemSet().item())}),n.currentView=o.create(void 0),s.expose(U.l,n.currentView),n._itemProvider=s.consume(T.resourceKey),n._urlDataSource=s.consume(F.ue),n.queryType=o.compute(n._computeQueryType,{deferEvaluation:!0}),n.requiredRange=o.create({start:0,end:0}).extend({throttle:500}),n.requiredRangeSync=o.create({start:0,end:0}),n.itemsPerGroup=s.consume(B.r.optional)||o.create(-1),n.requiredGroup=o.create(void 0),n.expandAll=o.create(!1),n.layoutType=n._getLayoutType(),n.supportsNestedGroups=o.pureCompute(n._computeSupportsNestedGroups),n.canModifySchema=o.pureCompute(n._computeCanModifySchema),n.title=o.compute(n._computeTitle,{deferEvaluation:!0}),n.focusItem=o.pureCompute(n._computeFocusItem),n.focusItemSet=o.pureCompute(n._computeFocusItemSet),o.backgroundCompute(n._computeUpdateFocusItemSetContent,{deferEvaluation:!0}),n.isOneUp=o.pureCompute(n._computeIsOneUp),n._useItemsScope=s.consume(j.e),o.backgroundCompute(n._computeSetDocumentTitle),n._dataManagerDeferred=n._getDataManagerDeferred(),n._getItemContext=o.pureCompute(n._computeGetItemContext),n._getItemContext.equalityComparer=g.e,o.compute(n._computeHandleLayoutUpdates);var _=o.compute(n._computeItemSet).extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});return o.compute(function(){n._currentItemKey(),_()}),n.platform=s.consume(f.e),n._loaderProvider.waitForPLT().then(function(){n._setupAutoExecuteRequests(),n._doDeferredWork()}),o.backgroundCompute(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),o.backgroundCompute(function(){var e=n._dataManagerDeferred(),t=n.itemSet();t.content();var a=t.isPlaceholder,i=!!t.item().error;e&&(i||!a)&&e.inNewFolderDataFetch&&e.firstDataFetchComplete(!0)}),n}return Object(a.__extends)(t,e),t.prototype.setLayoutIteration=function(e){var t=this;this.subscribe(e,function(e){t._handlePageLoad()})},t.prototype.onLayoutRenderComplete=function(){this._handlePageLoad()},t.prototype.updateSort=function(e,t){},t.prototype.getCrumbs=function(e){var t=this._dataManagerDeferred&&this._dataManagerDeferred();return t?t.getCrumbs(e):[]},t.prototype.getDefaultLayoutForView=function(){var e=this._itemProvider.getItemSync({parentKey:this._currentItemKey()}).item,t=e.peek();t.isPlaceholder&&e();var n=this._getRootItem(t),a=n&&n.list,o=this._getItemQueryType(t);if(o===w.e.Subsites)return x.u;if(o===w.e.DocumentLibraries)return x.s;if(o===w.e.Recent)return x.r;if(a&&void 0!==a.isDocumentLibrary&&!a.isDocumentLibrary&&!a.isPromotedLinks)return x.i;var s=this._responsiveUI,c=this._getContextualLayoutTypes(n)[o],d=Number(this._pageContext.webTemplate)===r.t.mySite||a&&a.templateType===i.n.mySiteDocumentLibrary;if(c)return this._getCorrectedLayoutType(c);if(s.compareSize(s.formFactorSize(),"Medium")<=0||t&&t.displayType===w.e.Photos)return x.s;if(a){if(a.templateType===i.n.pictureLibrary||a.isPromotedLinks||a.templateType===i.n.publishingAsset)return x.s;if(d)return x.r;if(a.isDocumentLibrary)return x.i}return d?x.r:x.i},t.prototype.getMorePartialResult=function(){1===this.itemSet.peek().content.peek().partialResultStatus&&(m.e.logData({name:"LargeList.GetMorePartialResult"}),this._resetPartialResultRequestCount&&this._resetPartialResultRequestCount(!0))},t.prototype.setRequiredRange=function(e,t){t?(this._useRequiredRangeSync=!0,this.requiredRangeSync(e)):(this._useRequiredRangeSync=!1,this.requiredRange(e))},t.prototype.getRequiredRange=function(e){return e?this.requiredRangeSync.peek():this.requiredRange.peek()},t.prototype.cacheLayoutContext=function(){var e=this.item.peek(),t=this._urlDataSource.getKeyParams(e.key),n=this._dataManagerDeferred.peek(),a=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if((n&&!n.inNewFolderDataFetch||this._isSwitchingLayout.peek())&&e&&!e.isPlaceholder){var i=e&&e.displayType===w.e.Photos?w.e.Photos:this._urlDataSource.getQueryType(t),r=this._getContextualLayoutTypes(a);r[i]=this.layoutType.peek(),this._dataStore.setValue(this._getLayoutLocalStorageKey(a),r,b.e.local),this._isSwitchingLayout(void 0)}},t.prototype.getColumnWidthsFromLocalStorage=function(e,t){var n=t?X:"";try{return JSON.parse(localStorage.getItem("".concat(J).concat(n,"-").concat(e))||"")||{}}catch(e){return l.e.log(e,"Error parsing localStorage for column widths"),{}}},t.prototype.setColumnWidthsToLocalStorage=function(e,t,n){var a=this.getColumnWidthsFromLocalStorage(e,!0);a[t]=n.toString(),localStorage.setItem("".concat(J).concat(X,"-").concat(e),JSON.stringify(a))},t.prototype.onColumnReorder=function(e,t){var n=this.currentView.peek();if(n){var a=n.getEffectiveFieldNames().indexOf(t);n.updateField(e,a),this.currentView.valueHasMutated&&this.currentView.valueHasMutated()}},t.prototype._getItemQueryType=function(e){var t=this._urlDataSource.getKeyParams(e.key);return e&&e.displayType===w.e.Photos?w.e.Photos:this._urlDataSource.getQueryType(t)},t.prototype._handlePageLoad=function(e){var t=this._dataManagerDeferred.peek();if(t)if(t.firstDataFetchComplete.peek())if(t.pltLogComplete){var n=this.itemSet.peek().content.peek().items;n&&(n.length>0||e)&&this.async.setTimeout(function(){s.e.logData(),q.n()},0)}else this._rumOneHelper.mark("pageLoadComplete before setTimeout"),this.async.setTimeout(this._pageLoadComplete,0);else t.listViewMounted(!0)},t.prototype._computeItemSet=function(){var e=this._dataManagerDeferred&&this._dataManagerDeferred();e&&this._getItemContext&&e.computeItemSet(this.itemSet,this._getItemContext,this._useRequiredRangeSync)},t.prototype._getContextualLayoutTypes=function(e){var t,n=this._dataStore.getValue(this._getLayoutLocalStorageKey(e),b.e.local);return Object(a.__assign)(((t={version:2})[w.e.Files]="",t[w.e.Recent]="",t[w.e.SharedWithMe]="",t[w.e.Photos]="",t),n&&2===n.version?n:{})},t.prototype._getDataManagerDeferred=function(){var e,t=this,n=this.observables.create(),a=this.observables.pureCompute(function(){if(t._useItemsScope.peek())t._useItemsScope();else{var e=t.resources.consume(Q.e.optional);if(e)return e;t.trackPromise(u.n.resolve(t.resources.consumeAsync(Q.e.local.bypass))).then(function(e){n(e)})}return n()});return a.equalityComparer=d.n,this.observables.pureCompute(function(){var n=a();if(n&&(e&&(e.dispose(),e=void 0),!t._useItemsScope()))return(e=t.scope.attach(new S.e)).attach({dispose:function(){t.itemSet(t._getPlaceholderItemSet())}}),e.attach(t._createDataManagerDeferred(n))})},t.prototype._createDataManagerDeferred=function(e){return new e({defaultViewId:this._defaultViewId,expandAll:this.expandAll,isOneUp:this.isOneUp,focusRange:this.focusRange,requiredRange:this.requiredRange,requiredRangeSync:this.requiredRangeSync,requiredGroup:this.requiredGroup,supportsNestedGroups:this.supportsNestedGroups,resetPartialResultRequestCount:this._resetPartialResultRequestCount,currentItemKey:this._currentItemKey,currentView:this.currentView,groupingType:this._groupingType,itemResultSetOptions:this._itemResultSetOptions,error:this.error,showErrorPage:this.showErrorPage,isRetrievingData:this.isRetrievingData,queryType:this.queryType,onePageNavigationDataFetch:this._onePageNavigationDataFetch,handlePageLoad:this._handlePageLoad.bind(this)})},t.prototype._computeGetItemContext=function(){var e=this._dataManagerDeferred&&this._dataManagerDeferred();if(e)return e.computeGetItemContext(this.itemSet.peek(),this._getItemContext.peek(),this._useRequiredRangeSync)},t.prototype._computeHandleLayoutUpdates=function(){this._currentItemKey();var e=this._dataManagerDeferred();e&&(e.resetLayoutOnDataFetch(!0),e.inNewFolderDataFetch=!0),this._isLeftNavUserExpanded(!1)},t.prototype._computeQueryType=function(){var e=this._urlDataSource.getKeyParams(this._currentItemKey());return this._urlDataSource.getQueryType(e)},t.prototype._computeTitle=function(){var e=this.currentView(),t=this.item();return this._getItemName(e,t)},t.prototype._computeSetDocumentTitle=function(){var e=this.currentView(),t=this.unwrapObservable(this.focusItem()),n=this.item(),a=t||n;this.resources.consume(z)(this._getDocumentTitle(e,a))},t.prototype._getItemName=function(e,t){var n=t&&t.name||"";if(t&&this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(t.key))===w.e.DocumentLibraries)return I.r;if(Number(this._pageContext.webTemplate)!==r.t.mySite)if(e&&Object(Y.t)(e.viewType))n=e.title;else if(!n){var a=this._getRootItem(t);n=a&&a.name||""}return n},t.prototype._getDocumentTitle=function(e,t){var n=this._getItemName(e,t),a=this._pageContext,i="";return Object(K.i)(a)?n?y.format(I.h,n):I._:(Number(a.webTemplate)!==r.t.mySite?(i+=a.webTitle,n&&(i+=" - "+n),e&&e.title&&(i+=" - "+e.title)):i=n?y.format(I.y,n):I.v,i)},t.prototype._computeGroupingType=function(){return this.layoutType()===x.s&&Object(W.isFeatureEnabled)(W.UseTilesList)?1:0},t.prototype._getLayoutLocalStorageKey=function(e){var t=this._pageContext,n="SPO.Files.FilesQueryType."+t.webAbsoluteUrl,a=e&&e.list&&e.list.id||t.listId;return a&&(n+="."+a),n},t.prototype._computeFocusItemIndex=function(){var e=this._focusItemKey(),t=this._children();if(t)for(var n=0,a=t.length;n<a;n++){var i=this.peekUnwrapObservable(t[n]);if(i&&i.key===e)return n}return-1},t.prototype._computeFocusItemSet=function(){var e=this.itemSet(),t=new k.e(e.key,e.context);return t.item=e.item,t.content(this._getFocusItemSetContent(e.content.peek())),t.schema=e.schema,t.isPlaceholder=e.isPlaceholder,t},t.prototype._computeUpdateFocusItemSetContent=function(){var e=this.itemSet(),t=this.focusItemSet(),n=e.content();t&&t.content(this._getFocusItemSetContent(n))},t.prototype._getFocusItemSetContent=function(e){var t=this,n=this._urlDataSource,a=new M.e(e.items.length);return a.items=e.items.map(function(e){if(!e)return e;var a=e.peek().key;if(!a)return e;var i=n.getKeyParams(a);return delete i[E.n.uniqueParamKey],delete i[E.n.queryTypeParamKey],t._itemProvider.getItemSync({ownerId:n.getOwnerId(a),queryType:w.e.Files,parentKey:n.getKey(i),ignoreChildren:!0}).item}),a.groupings=e.groupings,a},t.prototype._computeFocusItem=function(){var e=this._focusItemKey();if(e){var t=this._computeFocusItemIndex();return t>-1?this._children()[t]:this._itemProvider.getItemSync({parentKey:e}).item}},t.prototype._computeIsOneUp=function(){return!!this._focusItemKey()},t.prototype._setupAutoExecuteRequests=function(){var e=this.queryType(),t=this._viewParams();if(!this._autoExecuteRequested&&e===w.e.Files){var n=t[E.n.policyTipKey]||t[E.n.policyTipKey.toLowerCase()],a=t[E.n.sharingKey]||t[E.n.sharingKey.toLowerCase()],i=t[E.n.managePermissionsKey]||t[E.n.managePermissionsKey.toLowerCase()];n?(this._autoExecuteRequested=!0,this._showAutoExecuteAction(0,n)):a?(this._autoExecuteRequested=!0,this._showAutoExecuteAction(1,a)):i&&(this._autoExecuteRequested=!0,this._showAutoExecuteAction(2,i))}},t.prototype._showAutoExecuteAction=function(e,t){var i,r,o=this,s=this.itemSet.peek().content.peek().items.filter(function(e){var n=e.peek().properties;return!!n&&n.ID===t}),c=this.resources;t&&(r=c.consume(T.resourceKey).getSpecifiedItems({itemKeys:[t],recurseInFolders:!0}).then(function(e){return e.children})),r.then(function(r){1===e&&m.e.logData({name:"Sharing.AutoExecute"}),2===e&&(m.e.logData({name:"ManagePermissions.AutoExecute"}),i={engagementSource:"QueryParameter"}),s[0]?(0===e&&m.e.logData({name:"PolicyTip.LaunchFromEmail.ItemInView"}),i=Object(a.__assign)(Object(a.__assign)({},i),{item:s[0]})):2===e?i=Object(a.__assign)(Object(a.__assign)({},i),{item:o.createObservable(r[0])}):(0===e&&m.e.logData({name:"PolicyTip.LaunchFromEmail.ItemOutsideView"}),i={itemKey:t}),1===e&&(i={overrideItem:r[0],focusItemResourceKey:C.n});var d,l=function(){var t=o._viewParams.peek();0===e?delete t[E.n.policyTipKey]:1===e?delete t[E.n.sharingKey]:2===e&&delete t[E.n.managePermissionsKey],o._navigation.updateViewParams(t,{ignoreHistory:!0})};d=0===e?u.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(645)]).then(n.bind(null,4137))).then(D.e):2===e?u.n.resolve(n.e(630).then(n.bind(null,3984)).then(D.e)):u.n.resolve(n.e(794).then(n.bind(null,4986))).then(D.e),o.trackPromise(d),d.then(function(e){new(c.injected(e))(i).execute(null).done(l,l)})})},t.prototype._pageLoadComplete=function(){var e=this._dataManagerDeferred.peek();if(e&&!e.pltLogComplete){var t=v.n.now();e.pltLogComplete=!0;var n=this.queryType.peek(),a=this._urlDataSource.getPageType(this._viewParams.peek()),i=this.focusItem.peek()?O.e[O.e.OneUp]:"".concat(O.e[a]||"Default","-").concat(w.e[n]||"Default");this._loaderProvider.pageLoaded(i),new _.e({name:i,extraData:{layoutType:this.layoutType.peek()},startTimeOverride:v.n.getResponseEnd()}).end({resultType:h.e.Success}),this._rumOneHelper.logRUMOneForListView(t),this.events.raise("pageLoadComplete")}},t.prototype._doDeferredWork=function(){var e=this,t=this.resources;this.trackPromise(u.n.resolve(Promise.resolve().then(n.bind(null,6021))).then(D.e)).then(function(n){var a=new(t.injected(n));e._itemProvider.registerProjection(a.key,a)})},t.prototype._computeCurrentItemKey=function(){var e=this._viewParams(),t=this._urlDataSource,n=t.getCurrentItemKey(e),a=t.getKeyParams(n);return void 0!==this._queryTypeOverride&&(a[E.n.queryTypeParamKey]=this._queryTypeOverride),t.getKey(a)},t.prototype._computeSupportsNestedGroups=function(){if(Number(this._pageContext.webTemplate)===r.t.mySite)return!1;if(this.queryType()!==w.e.Files)return!1;var e=this.layoutType();return e===x.i||e===x.r||e===x.n},t.prototype._computeCanModifySchema=function(){var e=this.currentView(),t=this._viewParams(),n=this.item(),a=this._getRootItem(n,!0),i=a&&a.list&&a.list.permissions;return!(!e||!i||!i.manageLists&&!i.managePersonalViews||t[E.n.needsAttentionViewKey])},t.prototype._getRootItem=function(e,t){var n=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list");return t?this.unwrapObservable(n):this.peekUnwrapObservable(n)},t.prototype._computeFocusItemKey=function(){return this._urlDataSource.getFocusItemKey(this._viewParams())},t.prototype._computeRequestFocusItem=function(){var e=this._focusItemKey(),t=this.focusItem(),n=t&&t();e&&n&&n.isPlaceholder&&this.trackPromise(this._itemProvider.getItem({parentKey:e,ignoreChildren:!0}))},t.prototype._getLayoutType=function(){var e=this;return this.observables.compute({read:function(){return e._isSwitchingLayout()||e.getDefaultLayoutForView()},write:function(t){e._isSwitchingLayout(t)},pure:!0})},t.prototype._getCorrectedLayoutType=function(e){var t=this._itemProvider.getItemSync({parentKey:this._currentItemKey()}).item,n=t.peek();n.isPlaceholder&&t();var a=this._getRootItem(n),o=a&&a.list,s=o&&o.isDocumentLibrary,c=this._pageContext.listBaseTemplate,d=void 0===c?"":c,l=Number(this._pageContext.webTemplate)===r.t.mySite||o&&o.templateType===i.n.mySiteDocumentLibrary;return x.m(e,{isCustomList:(s||void 0===s&&Object(i.i)(d))&&!l,isPlaceholder:n.isPlaceholder})},t.prototype._getPlaceholderItemSet=function(){var e=new L.e,t=new k.e;return t.item=this.observables.create(e),t},t}(o.default);t.e=Z}],Array(34),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(473),i=n(69);function r(e){if(e.featureInfo){var t=new a.e(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===i.t.sitePagePublishing}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"n",function(){return o});var a=n(10),i=n(136),r=n(3114);n.d(t,"e",function(){return r.e}),n.d(t,"t",function(){return r.a});var o=new a.t({name:"MoveCopyProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(526)]).then(n.bind(null,4575)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(996),o=function(e){function t(n){var a=e.call(this,n)||this;return a._clearFocusIsUserInput=function(){a.isDisposed||(a._focusIsUserInput=!1)},a._keyForItem=new Map,a._focusIsUserInput=!1,a.mode=n.mode||0,a.maximumSelectedCount=n.maximumSelectedCount,a.getItemKey=n.getItemKey,a._canSelectItem=n.canSelectItem||s,a._selectionModelGroup=n.selectionModelGroup,a._allSelectables={},a._items=[],a.selectedCount=a.createObservable(),a.selection=a.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.isAllSelected=a.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),a.focusedItem=a.createObservable(),a.focusedItem.equalityComparer=r.n,a.isActive=a.createObservable(!0),a.clear(!0),a._clearFocusIsUserInput=a.async.throttle(a._clearFocusIsUserInput,0,{trailing:!0}),a._selectionModelId="".concat(++t._nextSelectionModelId),a._selectionModelGroup&&a._selectionModelGroup.registerSelectionModel(a,a._selectionModelId),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear(),this._getItemKey=function(n){var a=t.get(n);return a||(a=e(n),t.set(n,a)),a}},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId),this._allSelectables={},this._keyForItem.clear()},t.prototype.clear=function(e){this.isSelectedDefaultState=!1,this._keysExempt={},this._exemptCount=0,e&&(this._focusIndex=-1,this._anchorIndex=-1,this._anchorKey=null,this._focusIsUserInput=!1,this.focusedItem(null)),this.selection.removeAll(),this.isAllSelected(!1),this._updateAllSelectables(),this._updateSelectedCount()},t.prototype.setItems=function(e,t){this._items=e,this._selectableItems=this._items,t&&this.clear(!0),this._onItemsChanged(!0)},t.prototype.setAllFocusableItems=function(e){this._items=e,this._focusIndex=-1,this._onItemsChanged(!1)},t.prototype.getItems=function(){return this._items},t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)},t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)},t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,a=e;n<a.length;n++){var i=a[n],r=this._keyToIndex[i];if(r>=0){var o=this._items[r];this.canSelectItem(o)&&(this._keysExempt[i]=o,t.push(o))}}this._exemptCount=t.length,this.isSelectedDefaultState=!1,this.selection(t),this._updateIsAllSelected(),this._updateSelectedCount(),this._updateAllSelectables(),this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)},t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null},t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)},t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)},t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)},t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))},t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])},t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,a=void 0!==n&&n,i=t.isFocusInput,r=void 0===i||i,o=this.focusedItem.peek(),s=this.getItemKey(e),c=this._keyToIndex[s];if(this._focusIsUserInput=r,e!==o){var d=this.getItemKey(o);this._updateSelectable(d,{focusState:0,isFocused:!1})}c>=0?(d=this.getItemKey(e),this._focusIndex=c,this.focusedItem(e||null),d&&this._updateSelectable(d,{focusState:r?2:1,isFocused:!0})):this.focusedItem(null),a||(this._anchorIndex=c||-1,this._anchorKey=s),this._clearFocusIsUserInput()},t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={}),this.setItemFocus(this._items[e],t)},t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),a=this._allSelectables[n];if(a&&a.length)for(var i=0;i<a.length;i++){var r=a[i];if(r.onInvoke)return r.onInvoke(e)}return!0},t.prototype.setIsActive=function(e){this.isActive(e)},t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var a=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),r=Math.max(a,i),o=[];if(t.length&&r>=0)for(var s=Math.min(a,i);s<=r;s++)o.push(t[s]);this._setItemsSelected(o,!0)}}},t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])},t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var a=n[t];this._canSelectItem(a)&&e.push(a)}this.selection(e),this._keysExempt={},this._exemptCount=0,this._updateIsAllSelected(),this._updateAllSelectables(),this._updateSelectedCount(),this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()},t.prototype.registerSelectable=function(e,t){var n,a=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e),this._allSelectables[n]||(this._allSelectables[n]=[]),this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],r=this.focusedItem.peek()===i,o=r?this._focusIsUserInput?2:1:0,s=this.isItemSelected(i);return this._updateSelectable(n,{focusState:o,isFocused:r,isSelected:s}),{dispose:function(){if(a._allSelectables&&a._allSelectables[n]){var e=a._allSelectables[n];if(1===e.length)delete a._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}},t.prototype.getFocusIndex=function(){return this._focusIndex},t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var a=t[n];this.isItemSelected(a)&&!this.getItemKey(a)&&e.push(n)}return e},t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup},t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)},t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null},t.prototype._setItemSelectedCore=function(e,t,n){var a=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return a.canSelectItem(e)}))return;1===this.mode&&t&&this.clear(),this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var r,o=this.selection.peek();r=t?o.concat([e]):o.filter(function(e){return a.getItemKey(e)!==i}),this.selection(r),this._updateSelectable(i,{isSelected:this.isItemSelected(e)}),this._exemptCount+=t?1:-1,this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}},t.prototype._setItemsSelected=function(e,t){var n,a=this,i=this.selection.peek(),r=[],o=[];e.forEach(function(e){var n=a.getItemKey(e);n&&n in a._keyToIndex&&t!==a.isItemSelected(e)&&a.canSelectItem(e)&&(r.push(n),t&&o.push(e),a._keysExempt[n]?delete a._keysExempt[n]:a._keysExempt[n]=e)}),n=t?i.concat(o):i.filter(function(e){return-1===r.indexOf(a.getItemKey(e))}),this.selection(n),r.forEach(function(e){a._updateSelectable(e,{isSelected:t}),a._exemptCount+=t?1:-1}),this._updateIsAllSelected(),this._updateSelectedCount(),this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)},t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)},t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];for(var o in t){var s=t[o],c=r[o];this.isObservable(c)&&c(s)}}},t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})},t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={},this._keyForItem.clear(),e&&(this._selectableItemsMap={});var n=this._items,a=[],i=this.getItemKey(this.focusedItem.peek()),r=this._anchorKey;if(n){for(var o=0,s=function(s){var d=n[s],l=c.observables.ignore(function(){return t.getItemKey(d)});if(l&&(c._keyToIndex[l]=s,e&&(c._selectableItemsMap[l]=!0),i&&i===l&&(c._focusIndex=s),r&&r===l&&(c._anchorIndex=s)),c.isItemSelected(d)){if(c.onAddItem&&!1===c.onAddItem(d))return o++,c._keysExempt[l]=d,"continue";a.push(d)}},c=this,d=0;d<n.length;d++)s(d);this._exemptCount+=o,this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1,this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1}),this.selection(a),this._updateIsAllSelected(),this._updateSelectedCount()}},t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)},t._nextSelectionModelId=1,t}(i.default);function s(e){return!0}t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(136),i=function(){function e(e,t){this._itemRefreshMessages={},this._itemKeysRefreshed=[]}return e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null},e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var a=n[t];this._itemRefreshMessages[a.id]=a}},e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}},e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)},e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)},e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]},e.dependencies={},e}(),r=Object(a.r)("RefreshMessageHelper",i)},function(e,t,n){"use strict";var a=n(737);n.d(t,"e",function(){return a.t}),n.d(t,"t",function(){return a.n}),n.d(t,"n",function(){return a.a}),n.d(t,"a",function(){return a.i})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(10),i=new a.t({name:"".concat("MalwareDetection.key",".allowInfectedFileDownloads"),factory:new a.e(!1)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(10),i=new a.t({name:"".concat("BlockDownloadPolicy.key",".m365GroupsBlockDownloadsExperienceEnabled"),factory:new a.e(!1)})},function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(170),i=n(9),r=n(37),o=n(100),s=n(2299),c=n(4206),d=n(38),l=n(226),u=n(265),f=n(3185),p=n(14),m=n(1368),_=n(151),h=n(1450),b=n(859),g=n(507),v=n(10),y=n(136),S=n(1449),D=n(12),I=n(4819),x=D.e.isActivated("1E9F2B0E-270E-4F40-9918-01DD9B46C5F0","7/2/2021","Use the page context from the list response for Web data"),C=D.e.isActivated("1d0ede26-6eb5-4fcb-be71-789d486af357","11/10/2022","Use the page context from the list response for Web data"),O=!1,w=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._pageContext=t.pageContext,this._itemUrlHelper=t.itemUrlHelper,this._vroomUrlHelper=t.vroomUrlHelper}return e.prototype.processResponse=function(e){var t=e.response,n=e.response,a=n.WebUrl,i=n.HttpRoot,r=n.ListData,o=n.rootFolder,s=n.ListSchema,d=(void 0===s?{}:s).Collapse,l=void 0===d?"FALSE":d,u=e.pageContext,p=e.requestKey,m=e.observer,_=this._urlDataSource.getKeyParams(p),h="TRUE"===l,b=this._itemUrlHelper.getItemUrlParts(p),g=this._itemUrlHelper.getUrlParts({path:b.serverRelativeListUrl,listUrl:b.fullListUrl});(a||i)&&this._processWeb({list:t,pageContext:u,requestKeyParts:_,observer:m});var v=this._processList({list:t,pageContext:u,listUrlParts:g,requestKeyParts:_,observer:m}).listRootItemKey,y=[];if(o){var S=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:_,observer:m});y.push.apply(y,S.parentItemUrls)}r&&!h&&(S=this._processListData({listData:r,listUrlParts:g,parentKey:p,requestKeyParts:_,observer:m}),y.push.apply(y,S.parentItemUrls));var D={};if(t.ParentInfo)for(var I=0,x=t.ParentInfo.ParentFolderInfo;I<x.length;I++){var C=x[I];D[C.ServerRelativeUrl]=f.t.fromHexString(C.Permissions)}for(var O=0,w=Object(c.e)(y);O<w.length;O++){var E=w[O];this._processParentItem({itemUrl:E,listUrlParts:g,parentInfo:D,requestKeyParts:_,observer:m})}return{listRootItemKey:v}},e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,a=e.requestKeyParts,i=e.listUrlParts,r=e.observer,o=[],c="",d=0,l=t;d<l.length;d++){var u=l[d],f=u.FileRef,p=this._processRow({row:u,observer:r,requestKeyParts:a,listUrlParts:i}).key;o.push.apply(o,this._getParentItemUrls({listUrlParts:i,itemUrl:f})),r.update([new s.e(p).succeed({set:{parent:{key:n},after:{key:c}}})]),c=p}return{parentItemUrls:o}},e.prototype._processRow=function(e){var t,n,a,o=e.row,c=e.row.FileRef,d=e.listUrlParts,u=e.requestKeyParts,f=e.observer,p=this._itemUrlHelper.getUrlParts({path:c,listUrl:d.fullListUrl});if((t={})[i.n.idParamKey]=p.serverRelativeItemUrl,t[i.n.listUrlKey]=p.normalizedListUrl,a=t,this._isFolder(o)){var m={},_=this._urlDataSource.getQueryType(u),h=u[i.n.typeFiltersKey];_!==r.e.Search&&(m[i.n.queryTypeParamKey]=u[i.n.queryTypeParamKey]),h&&(m[i.n.typeFiltersKey]=h),l.e(a,m),u[i.n.metadataSearchIdKey]&&l.e(a,((n={})[i.n.metadataSearchIdKey]=u[i.n.metadataSearchIdKey],n))}var b=this._urlDataSource.getKey(a),g=this._getParentKeyForListItem({listUrlParts:d,itemUrl:c,requestKeyParts:u}),v={key:b};return g&&(v.parentKey=g),f.update([new s.e(b).succeed({item:v})]),{key:b}},e.prototype._processRootFolder=function(e){var t,n,a,r=e.list,o=e.listUrlParts,c=e.requestKeyParts,d=e.observer,l=r.rootFolder,f=this._itemUrlHelper.getUrlParts({path:l,listUrl:o.fullListUrl}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.serverRelativeItemUrl,t[i.n.listUrlKey]=f.normalizedListUrl,t[i.n.queryTypeParamKey]=c[i.n.queryTypeParamKey],t[i.n.queryParamKey]=c[i.n.queryParamKey],t[i.n.typeFiltersKey]=c[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=c[i.n.metadataSearchIdKey],t)),_=this._getParentKeyForListItem({listUrlParts:o,itemUrl:l,requestKeyParts:c}),h={key:p,type:u.e.Folder,newWOPIDocumentEnabled:m.optional(r.NewWOPIDocumentEnabled)};if(_&&(h.parentKey=_),r.ListData){if(n=r.ListData.FolderId,"Sharepoint.DocumentSet"===r.ListData.CurrentFolderProgId){h.isDocSet=!0;var b=r.FolderContentTypeId,g=void 0,v=void 0;if(r.AvailableContentTypes)for(var y=0,S=r.AvailableContentTypes;y<S.length;y++){var D=S[y],I=D.contentTypeId;if(I&&0===I.indexOf("0x0120D520")){if(C){h.contentTypeId=I,a=D.displayName;break}if(b===I){h.contentTypeId=I,a=D.displayName;break}I&&0===I.indexOf("0x0120D520")&&(g||(g=I,v=D.displayName))}C||h.contentTypeId||(h.contentTypeId=g,a=v)}}if(r.ListData.CurrentFolderSpItemUrl){var x=this._vroomUrlHelper.getUrlParts(r.ListData.CurrentFolderSpItemUrl);h.itemId=m.optional(x.itemId),h.graph={itemId:m.optional(x.itemId),driveId:m.optional(x.driveId)}}}if(a&&h.contentTypeId?h.properties={ID:m.optional(n),ContentType:a,ContentTypeId:h.contentTypeId}:h.properties={ID:m.optional(n)},!this._isListRoot({itemUrl:l,listUrlParts:o})){var O=l.split("/").slice(-1)[0];h.name=O,h.displayName=O}return d.update([new s.e(p).succeed({item:h})]),{parentItemUrls:this._getParentItemUrls({listUrlParts:o,itemUrl:l})}},e.prototype._processWeb=function(e){var t,n=e.list,a=e.requestKeyParts,o=e.observer,c=n.HttpRoot,d=n.SiteTitle,l=n.WebUrl||c&&b.i(decodeURIComponent(c)),f=this._itemUrlHelper.getUrlParts({path:l,webUrl:l}),p=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=f.normalizedItemUrl,t[i.n.queryTypeParamKey]=r.e.DocumentLibraries,t[i.n.typeFiltersKey]=a[i.n.typeFiltersKey],t)),m={serverRelativeUrl:l},_={key:p,type:u.e.Folder,subsite:m},h=!x&&e.pageContext||this._pageContext.webAbsoluteUrl===l&&this._pageContext;h&&(_.name=d,_.displayName=d,m.webTemplateId=Number(h.webTemplate),m.serverRelativeUrl=h.webAbsoluteUrl,m.id=h.webId,m.siteCollectionId=h.siteId,m.title=h.webTitle,m.icon=h.webLogoUrl),o.update([new s.e(p).succeed({item:_})])},e.prototype._processList=function(e){var t,n,o,c,d,l,f=e.list,_=e.listUrlParts,h=e.requestKeyParts,v=e.observer,y=f.ListTitle,D=f.HttpRoot,I=f.ListUrl,C=f.listUrlDir,w=I||C&&decodeURIComponent(C),E=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=_.serverRelativeItemUrl,t[i.n.listUrlKey]=_.normalizedListUrl,t[i.n.queryTypeParamKey]=h[i.n.queryTypeParamKey],t[i.n.queryParamKey]=h[i.n.queryParamKey],t[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=h[i.n.metadataSearchIdKey],t)),A=f.AllowCreateFolder,L=f.EnableMinorVersions,k=f.verEnabled,M=f.AllowGridMode,P=f.DisableGridEditing,T=f.ListTemplateType,U=f.BasePermissions,F=void 0===U?{}:U,H=F.ManageLists,R=void 0===H?void 0:H,N=F.ManagePersonalViews,B=void 0===N?void 0:N,j=F.OpenItems,V=void 0===j?void 0:j,z=F.UseClientIntegration,G=void 0===z?void 0:z,K=f.ListSchema,W=void 0===K?{}:K,q=W.DefaultItemOpen,Q=void 0===q?void 0:q,Y=W[".driveAccessTokenV21"],J=void 0===Y?void 0:Y,X=W[".driveAccessToken"],Z=void 0===X?void 0:X,$=W[".driveUrl"],ee=void 0===$?void 0:$,te=W[".driveUrlV21"],ne=void 0===te?void 0:te,ae=f.ExcludeFromOfflineClient,ie=f.WebExcludeFromOfflineClient,re=f.listBaseType,oe=Z,se=J,ce=ee,de=ne,le=!x&&e.pageContext||w===this._pageContext.listUrl&&this._pageContext,ue=null==le?void 0:le.driveInfo;f.isFromServiceWorkerCache&&ue&&(ue[".driveAccessToken"]&&(oe=ue[".driveAccessToken"]),ue[".driveAccessTokenV21"]&&(se=ue[".driveAccessTokenV21"]),ue[".driveUrl"]&&(ce=ue[".driveUrl"]),ue[".driveUrlV21"]&&(de=ue[".driveUrlV21"])),oe&&(o={accessToken:(d=Object(g.e)(oe)).access_token,proofToken:d.prooftoken,tokenUrl:ce}),se&&(c={accessToken:(d=Object(g.e)(se)).access_token,proofToken:d.prooftoken,tokenUrl:de});var fe=f.WebUrl||D&&b.i(decodeURIComponent(D));if(fe){var pe=this._itemUrlHelper.getUrlParts({path:fe,webUrl:fe});l=this._urlDataSource.getKey(((n={})[i.n.idParamKey]=pe.normalizedItemUrl,n[i.n.queryTypeParamKey]=r.e.DocumentLibraries,n[i.n.typeFiltersKey]=h[i.n.typeFiltersKey],n))}var me="string"==typeof Q?"0"===Q:void 0;me&&(O||(a.e.logData({name:"List.openInClient"}),O=!0));var _e=ce&&this._vroomUrlHelper.getUrlParts(ce)||void 0;o&&Object(S.e)({authToken:o.accessToken,proofToken:o.proofToken})&&(o=void 0),c&&Object(S.e)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0);var he="number"==typeof re?Object(p.a)(String(re)):void 0;return v.update([new s.e(E).succeed({item:{key:E,parentKey:m.optional(l),itemId:m.backup("root"),graph:{itemId:m.backup("root"),driveId:m.optional((null==_e?void 0:_e.driveId)||void 0),sessionToken:m.optional(o),sessionTokenV21:m.optional(c)},type:u.e.Folder,name:m.optional(y),displayName:m.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:m.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:m.optional(f.listName),allowGridMode:"boolean"==typeof M?M:m.backup(!0),allowCreateFolder:m.optional(A),disableCommenting:"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof P?P:m.backup(!1),enableMinorVersions:m.optional(L),enableVersions:m.optional(k),templateType:m.optional("string"==typeof T?Number(T):void 0),isDocumentLibrary:m.optional(he),isPromotedLinks:m.optional("string"==typeof T?Object(p.o)(T):void 0),isForceCheckout:m.optional(f.isForceCheckout),isModerated:m.optional(f.isModerated),newWOPIDocumentEnabled:m.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:m.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:m.optional(R),managePersonalViews:m.optional(B),openItems:m.optional(V),useClientIntegration:m.optional(G)},openInClient:m.optional(me),excludeFromOfflineClient:m.optional("boolean"==typeof ae||"boolean"==typeof ie?ae||ie:void 0),contentTypesEnabled:m.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:m.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:m.optional(f.canUserCreateMicrosoftForm),itemCount:m.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:m.optional(f.ListData.RowLimit),listUrlDir:w,createdFromExcel:m.optional(f.CreatedFromExcel),createdFromExisting:m.optional(f.CreatedFromExisting)},properties:{commandsSupported:m.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]),{listRootItemKey:E}},e.prototype._processParentItem=function(e){var t,n=e.itemUrl,a=e.listUrlParts,r=e.parentInfo,o=e.requestKeyParts,c=e.observer,d=this._itemUrlHelper.getUrlParts({path:n,listUrl:a.fullListUrl}),l=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=d.serverRelativeItemUrl,t[i.n.listUrlKey]=d.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t)),f={key:l,parentKey:this._getParentKeyForListItem({listUrlParts:a,itemUrl:n,requestKeyParts:o}),queryType:this._urlDataSource.getQueryType(o)};if(this._isListRoot({itemUrl:n,listUrlParts:a}))f.list={};else{var p=b.a(n);f.name=p,f.displayName=p,f.type=u.e.Folder,f.isDropEnabled=!0,f.folder={},r&&r[n]&&(f.permissions=r[n])}c.update([new s.e(l).succeed({item:f})])},e.prototype._getParentKeyForListItem=function(e){var t,n,a=e.listUrlParts,r=e.itemUrl,o=e.requestKeyParts;if(a.serverRelativeListUrl!==r){if(!D.e.isActivated("556c889b-eaaf-4e07-a746-6f7c7eee8553","8/18/2021","Show a more user-friendly error when the item does not have a FileRef field")&&!r)throw new Error(I.e);var s=r.split("/").slice(0,-1).join("/"),c=this._itemUrlHelper.getUrlParts({path:s,listUrl:a.fullListUrl});n=this._urlDataSource.getKey(((t={})[i.n.idParamKey]=c.serverRelativeItemUrl,t[i.n.listUrlKey]=c.normalizedListUrl,t[i.n.queryTypeParamKey]=o[i.n.queryTypeParamKey],t[i.n.queryParamKey]=o[i.n.queryParamKey],t[i.n.typeFiltersKey]=o[i.n.typeFiltersKey],t[i.n.metadataSearchIdKey]=o[i.n.metadataSearchIdKey],t))}return n},e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,a=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var r="",o=0,s=n.substring(i.length).split("/").slice(1,-1);o<s.length;o++){var c=s[o];r+="/".concat(c);var d="".concat(i).concat(r);a.push(d)}return a},e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t},e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||a&&-1!==a.indexOf("onenote"))}else t=!1;return t},e.dependencies={urlDataSource:o.ue,pageContext:d.f,itemUrlHelper:_.c,vroomUrlHelper:h.e,resources:v.r},e}(),E=Object(y.r)("ListItemResultProcessor",w)},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"i",function(){return f});var a=n(15),i=!a.e.isActivated("921101b5-51e4-495d-a1a2-ea550afabfce","09/23/2022","Check parent link in getFixedUrl"),r=a.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url"),o=a.e.isActivated("7afcff20-1e17-485f-b4c3-cd152373050a","10/31/2022","Use regex to replace forms view link from parent url"),s=a.e.isActivated("48c4b3b1-6347-4a7e-a358-106d941a4bae","11/7/2022","Do not add curly braces"),c=a.e.isActivated("f5ce5bac-9b76-4614-9f5d-37e9e7c35b47","11/30/2022","always fix url regardless of file extension");function d(e){var t=e.path,n=e.parentLink,a=e.filename,o=e.isContainer,s=e.fileExtension,d=e.shouldAllowDisplayFormUrl;if(!n||!a)return t;var u=t,f=l(n),p=o&&!(c&&!r&&"one"===s)&&a&&t&&(t.indexOf(a)<0||i&&t.indexOf(f)<0)&&-1===t.toLowerCase().indexOf("docsethome.aspx");return(!t||!d&&t.indexOf("/Forms/DispForm.aspx?ID=")>=0||p)&&(u="".concat(f,"/").concat(a)),u}function l(e){return e?o?e.replace("/Forms/All.aspx","").replace("/Forms/AllItems.aspx",""):e.replace(/\/Forms\/[^\/]*\.aspx$/i,"").replace(/\/[^\/]*\.aspx$/i,""):e}function u(e){var t=e.lastModifiedTime,n=e.modifierDates,a=e.lastModifiedTimeForRetention,i=t;return n?i=n.split(";")[0]:a&&(i=new Date(t).valueOf()-new Date(a).valueOf()>0?t:a),i}function f(e,t){return e&&t&&(s?"".concat(e,"/_layouts/15/viewer.aspx?sourcedoc={").concat(t,"}"):"".concat(e,"/_layouts/15/viewer.aspx?sourcedoc=").concat(t))||""}},function(e,t,n){"use strict";var a=n(4825);t.e=a.e},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n("knockout-lib"),r=n(1214),o=n(136),s=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=a._controls=a.observables.createArray([]),o=document.createElement("div");o.style.display="none";var s=document.createElement("div");return s.setAttribute("data-bind","component: $data"),document.body.appendChild(o),i.applyBindingsToNode(o,{template:{nodes:[s],foreach:r}}),a}return Object(a.__extends)(t,e),t.prototype.requestControl=function(e){var t={name:e.name,params:Object(a.__assign)({resources:this.resources},e.params)};return this._controls.push(t),t},t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)},t}(r.default),c=Object(o.r)("HiddenDomProvider",s)},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(10),i=new a.t({name:"".concat("ListItemsDataSourceParams.key",".useFolderScopedSearch"),factory:new a.e(!0)}),r=new a.t({name:"".concat("ListItemsDataSourceParams.key",".listShouldRenderFilesTitle"),factory:new a.e(void 0)})},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(1214),r=n(65),o=n(136),s=n(609),c=n(151),d=n(1374),l=n(9),u=n(320),f=n(2220),p=n(5573),m=n(3848),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._apiUrlHelper=n.apiUrlHelper,a._dataRequestor=a.scope.attach(new n.dataRequestorType({qosName:"PolicyTipDataSource"})),a._itemParentHelper=n.itemParentHelper,a._itemUrlHelper=n.itemUrlHelper,a._viewParams=n.viewParams,a._sharingContextInformation=n.sharingContextInformation,a}return Object(a.__extends)(t,e),t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?r.n.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})},t.prototype.getPolicyTip=function(e){if(this._isPseudo())return r.n.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:p.n.allowWithJustification,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return r.n.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return r.n.wrap(null);var n=t.MatchedConditionDescriptions,a=t.OverrideOptions,i=void 0===a?p.n.none:a,o=t.GeneralText,s=t.AppliedActionsText,c=Date.parse(t.LastProcessedTime);return{issueDescriptions:n&&n.results,overrideOption:Number(i),policyInfoUrl:t.ComplianceUrl,explanationText:o&&s?"".concat(o," ").concat(s):o||s||"",lastScanned:isNaN(c)?void 0:new Date(c)}})},t.prototype.updatePolicy=function(e){if(this._isPseudo())return r.n.wrap(e.action===p.e.override?p.t.overridden:e.action===p.e.reportFalsePositive?p.t.falsePositiveReportedAndOverridden:p.t.none);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,n=t&&t.OverridePolicyTip;return"number"==typeof n?n:null})},t.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)if(this._sharingContextInformation.uniqueId){var n=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",a={guid:this._sharingContextInformation.uniqueId};t=this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(n,a).segment("ListItemAllFields")}else t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var i=this._itemUrlHelper.getItemUrlParts(e.key),r=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(i).method("Lists",r).method("GetItemById",e.properties.ID)}return t},t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId},t.prototype._isPseudo=function(){return"1"===this._viewParams.peek()[l.n.pseudoPolicyTipKey]},t}(i.default),h=Object(o.r)("PolicyTipDataSource",_,{apiUrlHelper:s.e,dataRequestorType:d.t,itemParentHelper:f.e,itemUrlHelper:c.c,viewParams:u.P,sharingContextInformation:m.e.optional})},function(e,t,n){"use strict";n.d(t,"t",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"DataManagerDeferred.key",loader:new i.t(function(){return n.e(514).then(n.bind(null,3713)).then(function(e){return e.typeResourceKey.local})})});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"ItemsScopeItemContent.key",loader:new i.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e(379)]).then(n.bind(null,5471)).then(function(e){return e.knockoutResourceKey.local})})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"PushChannelProvider.key",loader:new i.t(function(){return n.e(617).then(n.bind(null,4682)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("RootItemsTypeFilter.key")},function(e,t,n){"use strict";function a(e){return!!e.canUserUseSyntex}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("searchUpscopeProvider")},function(e,t,n){"use strict";n.r(t),n.d(t,"ItemsScopeItemSelectionHelper",function(){return D}),n.d(t,"typeResourceKey",function(){return I});var a=n(0),i=n(65),r=n(1214),o=n(136),s=n(2502),c=n(399),d=n(857),l=n(132),u=n(77),f=n(2862),p=n(442),m=n(5),_=n(2718),h=n(549),b=n(116),g=n(100),v=n(16),y=n(3839),S=n(813),D=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=t.allowMultiSelect,r=void 0!==i&&i,o=t.canFallback,s=void 0!==o&&o,c=t.overrideItem,d=t.ignoreSelection,p=void 0!==d&&d,h=n.itemsScopeItemKey,b=n.itemCacheObservablesFactory,g=n.itemCacheStore,v=n.urlDataSource,y=n.itemCacheEvaluationContext;return a._itemCacheStore=g,a._itemsScopeItemKey=h,a._placeholder=a.observables.create(new _.e),a._urlDataSource=v,a._itemCacheEvaluationContext=y,a._currentKnockoutStoreItem=a.scope.attach(b.pureCompute(function(e){var t=Object(u.e)(e,{itemsScopeItemKey:h});return e.demandItemFacet(m.f,t),e.demandItemFacet(f.t,t)||a._placeholder},{evaluationContext:a._itemCacheEvaluationContext})),a.currentItem=a.observables.pureCompute(function(){var e=a._currentKnockoutStoreItem();return e&&e()}),a._selectedKnockoutStoreItems=a.scope.attach(b.pureCompute(function(e){return c?[[void 0,c]]:function(e,t){void 0===t&&(t={});var n=t.itemsScopeItemKey,a=t.allowMultiSelect,i=void 0!==a&&a,r=t.ignoreSelection,o=void 0!==r&&r,s=t.canFallback,c=void 0!==s&&s,d=Object(l.e)(e,{itemsScopeItemKey:n}),p=Object(u.e)(e,{itemsScopeItemKey:n}),m=d&&d.length>0;if(!i&&d&&d.length>1)return[];for(var _=[],h=0,b=m&&!o||!c?d||[]:p?[p]:[];h<b.length;h++){var g=b[h],v=e.demandItemFacet(f.t,g);v&&_.push([g,v])}return _}(e,{itemsScopeItemKey:h,allowMultiSelect:r,canFallback:s,ignoreSelection:p})},{evaluationContext:a._itemCacheEvaluationContext})),a.selection=a.observables.pureCompute(function(){return a._selectedKnockoutStoreItems().map(function(e){return e[1]})}),a.firstItem=a.observables.pureCompute(function(){var e=a._selectedKnockoutStoreItems()[0],t=(void 0===e?[]:e)[1],n=void 0===t?void 0:t;return n&&n()}),a}return Object(a.__extends)(t,e),t.prototype.filterItems=function(e){var t=this._selectedKnockoutStoreItems(),n=this.observables;if(!t.length)return!1;for(var a=0,i=t;a<i.length;a++){var r=i[a][1],o=n.unwrap(r);if(!o)return!0;if(!e(o))return!1}return!0},t.prototype.resolveSelection=function(){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=this._selectedKnockoutStoreItems.peek(),[4,n.e(790).then(n.bind(null,3266))];case 1:return t=a.sent().oneDriveItemFacet,[4,this._itemCacheStore.dispatch(Object(S.e)(function(n){for(var a=0,i=e;a<i.length;a++){var r=i[a][0];n.demandItemFacet(t,r)}}))];case 2:return a.sent(),[2,e.map(function(e){return e[1].peek()})]}})})},t.prototype.resolveFirst=function(){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(e=this._selectedKnockoutStoreItems.peek()[0])?(t=e[0],i=e[1],[4,n.e(790).then(n.bind(null,3266))]):[2,void 0];case 1:return r=a.sent().oneDriveItemFacet,[4,this._itemCacheStore.dispatch(Object(S.e)(function(e){e.demandItemFacet(r,t)}))];case 2:return a.sent(),[2,i.peek()]}})})},t.prototype.selectItems=function(e){var t=this._urlDataSource,n=this._itemsScopeItemKey;this._itemCacheStore.dispatch(function(a){var i=a(Object(b.e)(function(n){for(var a=n.demandItemFacet(h.e,v.c),i=[],r=0,o=e;r<o.length;r++){var s=o[r],c=h.e.evaluate(a)(n,{viewParams:t.getKeyParams(s.key)}).itemKey;c&&i.push(c)}return i}));a(Object(p.t)({itemsScopeItemKey:n,selectedItemKeys:i,currentSelectionKey:void 0}))})},t.prototype.clearSelection=function(){this._itemCacheStore.dispatch(Object(p.e)({itemsScopeItemKey:this._itemsScopeItemKey}))},t.prototype.selectAll=function(){},t}(r.default),I=Object(o.o)("ItemSelectionHelper",D,Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{itemCacheStore:d.e,itemCacheObservablesFactory:s.e,itemsScopeItemKey:c.e,urlDataSource:g.ue,itemCacheEvaluationContext:y.e.optional}))},function(e,t,n){"use strict";n.d(t,"t",function(){return L}),n.d(t,"e",function(){return k});var a=n(996),i=n(10),r=n(136),o=n(77),s=n(2502),c=n(399),d=n(2718),l=n(3019),u=n(2862),f=n(302),p=n(39),m=n(4228),_=n(4229),h=n(4449),b=n(3283),g=n(428),v=n(1214),y=n(245),S=n(549),D=n(16),I=n(100),x=n(132),C=n(1434),O=new i.t({name:"".concat("ItemCacheDataManager",".enableOneUpLensRouting"),factory:new i.e(!0)}),w=new d.e,E=[],A=function(){function e(e,t){var n=this;this._computeParentItemInner=function(e){var t=Object(o.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return e.demandItemFacet(u.t,t)||n._emptyItem},this._computeParentItem=function(){var e=n._parentItemObservable,t=e&&e();return t&&t()},this._computeExpandedKeys=function(e){var t=Object(p.e)(e,n._itemsScopeItemKey),a=Object(_.t)(e,{itemSetKey:t});return Object(h.e)(e,{itemKeys:a})},this._computeItems=function(e){if(k(e,{itemsScopeItemKey:n._itemsScopeItemKey,urlDataSource:n._urlDataSource,enableOneUpLensRouting:n._enableOneUpLensRouting}))return E;var t=n.expandedChildKeys(),a=Object(x.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return Object(m.n)(e,t,a)},this._computeCurrentItemSet=function(){var e=n._emptyItem,t=n._parentItemObservable(),a=new l.e;return a.item=t,a.isPlaceholder=t===e,a},this._computeOnItemSetContentChange=function(){var e=n.currentItemSet(),t=new b.e;t.items=n._itemsObservable(),e.content(t)},this._computeViewParams=function(e){return e.demandItemFacet(f.e,n._itemsScopeItemKey)};var i=t.itemsScopeItemKey,r=t.itemCacheObservablesFactory,s=t.urlDataSource,c=t.enableOneUpLensRouting,d=t.observablesFactoryType;this._itemsScopeItemKey=i,this._urlDataSource=s,this._enableOneUpLensRouting=c,this._scope=new g.e;var v=this._scope.attach(new d({owner:this}));this._parentItemObservable=this._scope.attach(r.pureCompute(this._computeParentItemInner)),this._parentItemObservable.equalityComparer=a.n;var y=v.pureCompute(this._computeParentItem);y.equalityComparer=a.n,this.currentItem=y,this.expandedChildKeys=this._scope.attach(r.pureCompute(this._computeExpandedKeys)),this.expandedChildKeys.equalityComparer=a.e,this._itemsObservable=this._scope.attach(r.pureCompute(this._computeItems)),this._itemsObservable.equalityComparer=a.e,this._emptyItem=v.create(w),this.currentItemSet=v.pureCompute(this._computeCurrentItemSet),v.compute(this._computeOnItemSetContentChange),(this.viewParams=this._scope.attach(r.pureCompute(this._computeViewParams))).equalityComparer=a.n}return e.prototype.dispose=function(){this._scope.dispose()},e.dependencies={itemsScopeItemKey:c.e,itemCacheObservablesFactory:s.e,observablesFactoryType:v.observablesFactoryTypeResourceKey,urlDataSource:I.ue,enableOneUpLensRouting:O},e}(),L=Object(r.r)("ItemCacheDataManager",A);function k(e,t){var n,a=t.itemsScopeItemKey,i=t.urlDataSource;if(t.enableOneUpLensRouting){var r=Object(C.e)(e,{itemsScopeItemKey:a});n=null==r?void 0:r.focusItemKey}else{var o=e.demandItemFacet(f.e,a),s=i.getFocusItemKey(o),c=s&&i.getKeyParams(s);if(!c)return;var d=e.demandItemFacet(S.e,D.c);n=S.e.evaluate(d)(e,{viewParams:c,isNavigation:!1}).itemKey}return n?Object(y.e)(e,{itemKey:n}):void 0}},function(e,t,n){"use strict";n.d(t,"n",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u});var a=n(52),i=n(7),r=n(2862),o=n(407),s={suppressGetItems:!0};function c(e,t,n){return e.demandItemFacet(t,n,s)}function d(e,t,n){for(var s=new Set(n),d=[],l=0,u=t.length;l<u;l++){var f=t[l],p=c(e,i.a,f)||c(e,a.r,f),m=s.has(f);d[l]=p||!m?void 0:e.demandItemFacet(r.t,f)}return Object(o.t)(d)}function l(e,t){for(var n=[],s=0,d=t.length;s<d;s++){var l=t[s],u=c(e,i.a,l)||c(e,a.r,l);n[s]=u?void 0:e.demandItemFacet(r.t,l)}return Object(o.t)(n)}function u(e,t){var n=e.demandItemFacet(r.t,t.focusItemKey),s=t.itemKeys,d=t.fetchRadius,l=void 0===d?2:d;if(!n||!s.length)return o.e;for(var u=[],f=0,p=s.length;f<p;f++){var m=s[f];c(e,i.a,m)||c(e,a.r,m)?u[f]=void 0:u[f]=e.demandItemFacet(r.t,m)}var _=u.indexOf(n);if(_<0)return o.e;var h=Math.max(0,_-l),b=Math.min(_+l,u.length-1);for(f=h;f<=b;f++)u[f]||e.demandItemFacet(i.e,s[f]);return Object(o.t)(u)}},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(362),i=n(7),r=n(407),o=new(n(126).e)("childItemKeys",function(e,t){var n=t.itemKey,r=e.demandItemFacet(a.e,n),o=e.demandItemFacet(i.e,n),s=o&&o.itemKeys;return a.e.evaluate(r)(e,{itemKey:n,itemKeys:s}).itemKeys});function s(e,t){return Object(r.t)(e.demandItemFacet(o,t.itemSetKey))}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(80);function r(e){var t=this,r=e.isAvailable,o=e.getKnockoutAction,s=e.isToggled;return Object(i.e)(function(){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e(817)]).then(n.bind(null,2428))];case 1:return[2,(0,e.sent().createItemsScopeActionFromKnockout)(o,{isExecutorOnly:!0})]}})})},r,s)}}],Array(51),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n("react-lib"),r=n(4544),o=n(4905),s=n(164),c=n(5874),d=n(94),l=n(170),u=n(1382),f=n(1047),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){l.e.logData({name:"".concat(t._getEngagementNamePrefix(),".Close"),extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()},t._onTeachingBubbleSeen=function(){l.e.logData({name:"".concat(t._getEngagementNamePrefix(),".Rendered"),extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()},t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid},t._getEngagementNamePrefix=function(){return t.props.teachingBubbleCampaign.isCoachmark?"Coachmark":"TeachingBubble"},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,a=t.onAnimationOpenStart,l=t.directionalHint;e=n.automateExperimentBodyCopy&&Object(u.a)()?n.automateExperimentBodyCopy:n.bodyCopy;var p=n.teachingBubbleContentAs?Object(f.e)(n.teachingBubbleContentAs,r.e):r.e,m=n.teachingBubbleContentAs?Object(f.e)(n.teachingBubbleContentAs,o.e):o.e;return n.isCoachmark?i.createElement(c.e,{target:this.props.target,positioningContainerProps:{directionalHint:l||n.directionalHint||s.e.bottomCenter},styles:n.coachMarkStyles,onAnimationOpenStart:a,persistentBeak:n.persistentBeak,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},i.createElement(p,{headline:n.title,illustrationImage:n.illustrationImage,styles:n.teachingBubbleStyles,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:d.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!n.disableCondensedHeadline},e)):i.createElement(m,{target:this.props.target,headline:n.title,hasCloseIcon:!0,closeButtonAriaLabel:d.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!0,calloutProps:{onLayerMounted:this._onTeachingBubbleSeen}},e)},t}(i.PureComponent)}],Array(34),[function(e,t,n){"use strict";var a=n(0),i=n(65),r=n("knockout-lib"),o=n(2201),s=n(320),c=n(506),d=n(2789),l=n(2225),u=n(1219),f=function(e){function t(t){var n=e.call(this,t)||this;return n.group=t.group,n.selectionModel=n.resources.consume(s.I),n.isSelected=r.observable(!1),n.isFocused=r.observable(!1),n.isFocused.subscribe(function(e){n.onFocusChange(e)}),n.tabindex=n.createPureComputed(function(){return n.isFocused()?0:-1}),n._updateSelectionSubscription(t.key),n.addBindingHandlers({keyboard:l.e,delayedHasFocus:d.e}),n}return Object(a.__extends)(t,e),t.filterAndExpandGroup=function(e,t,a,r){var o=null;if(t.fieldSchema){var d=e.consume(c.t);d.requiredGroup(null),d.expandAll(!0),i.n.resolve(Promise.resolve().then(n.bind(null,3091))).then(u.e).then(function(n){var i=e.consume(s.s),c=i&&i.peek().content.peek().groupings,l=c&&c.length&&c[0].itemGroups,u=n.getFilterDetails(t,l),f=e.consume(s.e);o=new(e.injected(f.FilterAction))({field:u.fields,value:u.values,isFilterOn:!0,clearExistingFilters:d.supportsNestedGroups&&d.supportsNestedGroups.peek()}),r&&r(o),o.execute(a)})}return a&&(a.stopPropagation(),a.preventDefault()),!1},t.prototype.filterByGroupAndExpand=function(e,n){return t.filterAndExpandGroup(e.resources,e.group,n,function(t){e.addDisposable(t)})},t.prototype.onFocusChange=function(e){},t.prototype.onInvoke=function(e){return!0},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._updateSelectionSubscription(null)},t.prototype._updateSelectionSubscription=function(e){this._selectionSubscription&&(this._selectionSubscription.dispose(),this._selectionSubscription=null),this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,this))},t}(o.e);t.e=f}],Array(57),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return E});var a=n(0),i=n(1214),r=n(5570),o=n(51),s=n(429),c=n(97),d=n(65),l=n(2810),u=n(93),f=n(96),p=n(60),m=n(3723),_=n(2655),h=n(2370),b=n(2299),g=n(863),v=n(609),y=n(151),S=n(1374),D=n(38),I=n(136),x=new(n(10).t)({name:"ShortcutUpdater.key",loader:new I.t(function(){return n.e(468).then(n.bind(null,5774)).then(function(e){return e.resourceKey})})}),C=n(1367),O=n(300),w=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._shortcutResolverQueue=new l.e,a._pageContext=n.pageContext,a._apiUrlHelper=n.apiUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._identityDataSource=n.identityDataSource,a._dataRequestor=new(a.scope.attached(n.dataRequestorType))({qosName:"ShortcutLinkDataSource"}),a}return Object(a.__extends)(t,e),t.isSharePointUrl=function(e){var t=new u.t(e).getHost().toLowerCase();return t.indexOf("spoppe.com")>=0||t.indexOf("sharepoint.com")>=0||t.indexOf("sharepoint.cn")>=0},t.prototype.isInternal=function(e,t){if(t&&t!==o.e.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var n=new u.t(e).getHost().toLowerCase(),a=new u.t(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(n===a)return!0;var i=void 0,r=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(a);if(!r)return!1;if(void 0!==r[2])i=r[1]+r[3];else if(void 0!==r[3])i=r[1]+"-my"+r[3];else if(void 0!==r[4])return!1;return n===i},t.prototype.createShortcut=function(e,t,n){var a=this._itemUrlHelper.getItemUrlParts(e),i=this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetFolderByServerRelativePath",{decodedUrl:a.serverRelativeItemUrl}).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:i.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(n)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?d.n.wrapError(_.e.ShortcutErrors.InvalidCharacterError):d.n.wrapError(_.e.ShortcutErrors.UnknownError)})},t.prototype.getShortcutTargetData=function(e){var n,a,i=this,r=e.url,c=e.avoidGetFileByUrlCall,l=e.parentKey,u=e.targetSiteUrl,f=d.n.resolve(void 0);if(u)n=new s.t({webAbsoluteUrl:u}).build(),f=this._getAuthTokenForSite(u),a=decodeURIComponent(r);else{var p=l?this._itemUrlHelper.getItemUrlParts(l):this._itemUrlHelper.getUrlParts({path:r});l&&p.isCrossDomain?(n=new s.t({webAbsoluteUrl:p.fullWebUrl}).build(),f=this._getAuthToken({parentKey:l})):n=this._apiUrlHelper.build(),a=p.fullItemUrl}return n=n.method("SP.Utilities.ShortcutLink.GetShortcutLink",a),f.then(function(e){return i._dataRequestor.getData({url:n.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0,authToken:e}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==o.e.Empty?e.d.siteId:null,webId:e.d.webId!==o.e.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==o.e.Empty?e.d.uniqueId:null,isInternal:i.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(e){return e.uniqueId||c?d.n.wrap(e):t.isSharePointUrl(e.url)?i.getFileByUrl(e.url).then(function(t){var n=!!t&&t.UniqueId&&o.e.normalizeLower(t.UniqueId);return n&&(e.uniqueId=n),e}):d.n.wrap(e)})})},t.prototype.generateShortcutsOpenUrl=function(e,t,n,a,i,r){if(a&&i&&r&&-1===n.toLowerCase().indexOf("guestaccess.aspx")){var o="",s="?";if(n){var c=n.indexOf("?");-1!==c&&(s=n.substring(c)+"&")}return o=e+"/"+t+"/ShortcutLink.aspx",o+=s+"siteid="+f.e.encodeURIComponent(a),(o+="&webid="+f.e.encodeURIComponent(i))+"&uniqueid="+f.e.encodeURIComponent(r)}return n},t.prototype.enqueueParseShortcut=function(e,t){var n=this,a=this._itemUrlHelper.getItemUrlParts(e);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var i=new(n.managed(h.default));return n.getShortcutTargetData({url:a.fullItemUrl,avoidGetFileByUrlCall:!0,parentKey:e}).then(function(a){var r,o=n.generateShortcutsOpenUrl(n._pageContext.webAbsoluteUrl,n._pageContext.layoutsUrl,a.url,a.siteId,a.webId,a.uniqueId),s={key:e,shortcutInfo:{shortcutLinkRewritten:!0},urls:(r={},r[g.t.shortcutTarget]=o,r)};a.uniqueId&&(s.thumbnail=m.previewImageUrl(a,n._pageContext.webAbsoluteUrl,n._pageContext)),i.update([new b.e(e).succeed({item:s})]),i.flush(),n.resources.consume(C.f)&&t&&n.resources.consumeAsync(x).then(function(n){n.updateItemShortcutValues(e,t,a)})}).then(function(){i.dispose()},function(e){return i.dispose(),d.n.wrapError(e)})}))},t.prototype.getFileByUrl=function(e){var t,n=this,a=this._itemUrlHelper.getUrlParts({path:e});if(a.isCrossDomain||a.siteRelation===y.t.sameSite)t=d.n.wrap(e);else{var i=this._apiUrlHelper.contextInfoUrl(a.fullItemUrl);t=this._dataRequestor.getData({url:i,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return t.then(function(t){var a=n._apiUrlHelper.build().webByUrl({path:t,webUrl:t}).method("GetFileByUrl",e);return n._dataRequestor.getData({url:a.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(t){return n._parseGetFileResponse(t,e)})})},t.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"},t.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new p.e(t).authority,TimeCreated:Object(r.t)(e.d.TimeCreated),TimeLastModified:Object(r.t)(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}},t.prototype._getAuthToken=function(e){var t=d.n.resolve(void 0),n=this._itemUrlHelper.getItemUrlParts(e.parentKey);return n&&n.fullWebUrl&&n.isCrossDomain&&(t=this._identityDataSource.getSharePointToken(new p.e(n.fullItemUrl).authority).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})),t},t.prototype._getAuthTokenForSite=function(e){return this._identityDataSource.getSharePointToken(e).then(function(e){return e.accessToken}).catch(function(e){c.e.logError(e)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:D.f,apiUrlHelper:v.e,itemUrlHelper:y.c,dataRequestorType:S.t,identityDataSource:O.a}),t}(i.default),E=(t.default=w,Object(I.r)("ShortcutLinkDataSource",w))}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3718);function i(e){if(e&&e.length>0){var t=e[e.length-1],n=e[e.length-2];if(r(t.key||"")||n&&r(n.key||""))return!0}return!1}function r(e){return e===a.t.clientRecycleBin||"-1"===e}},,function(e,t,n){"use strict";var a=n("knockout-lib");n(2558),n(3017),window.__ko=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(0),i=n(91),r=Object(i.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e(817)]).then(n.bind(null,5486))];case 1:return[2,e.sent().WithKnockoutResourcesAndItemCacheData]}})})})},function(e,t,n){"use strict";var a=function(){function e(){}return e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]},e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t,window.name=JSON.stringify(n)},e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];return delete t[e],window.name=JSON.stringify(t),n},e.prototype._getNormalizedWindowName=function(){var e,t;try{t=JSON.parse(window.name)||{}}catch(e){t={}}return"object"!=typeof t&&((e={}).value=t,t=e),t},e}();t.e=a},function(e,t,n){"use strict";n.d(t,"n",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"t",function(){return f});var a=n(4),i=n("react-lib"),r=n(835),o=n(149),s=n(419),c=n(3837);function d(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=e;return o.isSlot?0===(n=i.Children.toArray(n)).length?o(t):o(Object(a.e)(Object(a.e)({},t),{children:n})):i.createElement.apply(i,Object(a.o)([e,t],n))}function l(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,d,l,u){if(i.isValidElement(n))return n;var f=function(e,t){var n,a;return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,a=n):a=t,a}(o,n),p=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];for(var i={},o=[],d=0,l=n;d<l.length;d++){var u=l[d];o.push(u&&u.className),Object(c.e)(i,u)}return i.className=Object(r.e)([e,o],{rtl:Object(s.e)(t)}),i}(l,u,t,f);if(d){if(d.component){var m=d.component;return i.createElement(m,Object(a.e)({},p))}if(d.render)return d.render(p,e)}return i.createElement(e,Object(a.e)({},p))}}var u=Object(o.t)(function(e){return l(e)});function f(e,t){var n={},a=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return p(t[e],n,a[e],a.slots&&a.slots[e],a._defaultStyles&&a._defaultStyles[e],a.theme)};i.isSlot=!0,n[e]=i}};for(var r in t)i(r);return n}function p(e,t,n,a,i,r){return void 0!==e.create?e.create(t,n,a,i):u(e)(t,n,a,i,r)}},function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(65),o=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,c=void 0===o?a.create(!0):o,d=t.onExecute,l=void 0===d?s:d;return n.count=r,n.isAvailable=c,n._onExecute=l.bind(t.operation),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=s},t.prototype.execute=function(){return this._onExecute()},t}(i.default);function s(){return r.n.wrap()}t.e=o},function(e,t,n){"use strict";n(1822);var a=n(934),i=n("knockout-lib"),r=function(){function e(e,t){var n=this;this._source=e,this._getKey=t,this._groupsByKeyId={},this.groups=i.observableArray(),this._initializeGroups(),Object(a.e)(this.groups,function(){n._mapping.dispose()})}return e.group=function(t,n){return new e(t,n).groups},e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),a=JSON.stringify(n),r=e._groupsByKeyId[a];return r?r.values.push(t):(r={key:n,values:i.observableArray([t])},e._groupsByKeyId[a]=r,e.groups.push(r)),{mappedValue:a,dispose:function(){r.values.peek().length>1?r.values.remove(t):(delete e._groupsByKeyId[a],e.groups.remove(r))}}}})},e}();t.e=r},function(e,t,n){"use strict";var a=n(253),i=function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(a.t)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(1214),r=n(136),o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._recordsByThumbnailKey={},a._bucketsByImageKey={};var i=a.observables;a.lastAccessedDate=i.create(new Date);var r=n.pruneThumbnailsExtenders,o=void 0===r?{rateLimit:{timeout:6e5}}:r;return i.backgroundCompute(a._pruneThumbnails).extend(o),a}return Object(a.__extends)(t,e),t.prototype.getCoveragePercent=function(e,t){var n=l(e),a=l(t);return Math.sqrt(a/n)},t.prototype.register=function(e,t,n,a){void 0===n&&(n=t),void 0===a&&(a=!0);var i=this.lastAccessedDate;i(new Date);var r=d(this.getCoveragePercent(e,n)),o=c(e),s=c(t),l=this._recordsByThumbnailKey,u=this._bucketsByImageKey,f=l[o]||{lastAccessed:void 0,buckets:{}};f.lastAccessed=i.peek();var p=f.buckets[r];(!p||this.getCoveragePercent(p.size,n)>1)&&(p&&delete u[p.key],p=f.buckets[r]={key:s,size:n,image:t,isLoaded:a,lastAccessed:i.peek()}),u[s]=p,l[o]=f},t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey,i=a[n];i?i.isLoaded=!0:a[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}},t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey[n];return a&&(a.lastAccessed=t.peek()),!!a&&a.isLoaded},t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=t);var a=c(e),i=this._recordsByThumbnailKey[a],r=this.lastAccessedDate;if(r(new Date),i){var o=i.buckets;i.lastAccessed=r.peek();var s=d(t),l=d(n),u=-1/0,f=!1;for(var p in o){var m=Number(p);m<=s&&m>=l&&o[m].isLoaded&&(u=Math.max(u,m),f=!0)}var _=f&&o[u];return _&&_.image}},t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e),u(this._bucketsByImageKey,e)},t}(i.default),s=Object(r.r)("ThumbnailCache",o);function c(e){var t=e.url,n=e.width,a=e.height;return JSON.stringify({url:t,width:n,height:a})}function d(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function u(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n("react-lib"),r=n("react-dom-lib"),o=n(149),s=n(124),c=0,d=Object(o.e)(function(e){return"".concat(++c)});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(s.e)(function(e,t){n(function(n){var i,o=d(t);return Object(a.__assign)(Object(a.__assign)({},n),((i={})[o]=r.createPortal(e,t),i))})}),c=Object(s.e)(function(e){n(function(t){var n=t,i=d(e);return n[i],Object(a.__rest)(n,["symbol"==typeof i?i:i+""])})}),l=i.useRef(),u=l.current||(l.current={render:o,unmount:c}),f=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[u,f]},[u,f])}},,function(e,t,n){"use strict";n.d(t,"e",function(){return D});var a=n(2221),i=n(237),r=n(56),o=n(399),s=n(15),c=n(857),d=n(270),l=n(77),u=n(43),f=n(305),p=n(38),m=n(302),_=n(3063),h=n(320),b=n(1261),g=n(3839),v=n("react-lib"),y=n(10),S=s.e.isActivated("5abccc76-54e5-4c12-98dd-8dcd1fd81022","2/3/2022","Re-expose itemsScopeItemKey for Details Pane");function D(e,t,n){var D=Object(i.i)(function(e){var t=Object(r.e)(e).itemsScopeItemKey,n=Object(l.e)(e),a=Object(u.e)(e,n),i=Object(f.e)(e);return[t,e.demandItemFacet(m.e,t),a,i]},[]),I=D[0],x=D[1],C=D[2],O=D[3],w=Object(i.n)(),E=e.consume(c.e),A=e.consume(p.u.optional),L=Object(_.t)(x,{inline:!0}),k=v.useMemo(function(){return S||A||!C||O&&O.webAbsoluteUrl===C.webAbsoluteUrl&&O.listUrl===C.listUrl?void 0:{pageContext:C,store:E,itemsScopeItemKey:I,viewParamsObservable:L}},[O,C,E,I,L]);return{childResource:Object(b.t)(function(){var i=new y.n(e);return!s.e.isActivated("39107185-9E15-471B-BECB-F5ACE7B98951","02/08/2022","Override ItemCache evaluation context for shimmed components")&&n&&i.expose(g.e,w),t&&i.block(a.e),k&&(i.expose(c.e,k.store),i.expose(d.e,k.store),i.expose(o.e,k.itemsScopeItemKey),i.expose(p.f,k.pageContext),i.expose(h.P,k.viewParamsObservable)),[i]},[e,t,k])[0]}}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(2213),r=n(65),o=n(83),s=n(2529),c=n(2718),d=n(320),l=n(265),u=n(2221),f=n(226),p=n(1830),m=!n(15).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),_=new c.e,h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Open";var i=t.item,r=t.openRelation,o=void 0===r?0:r,s=t.ignoreHistory,c=void 0!==s&&s,l=t.itemSet,f=t.openLocal,p=void 0!==f&&f,m=t.urlType,_=void 0===m?"default":m,h=t.preserveAction,b=void 0!==h&&h,g=t.nonFoldersOnly,v=void 0!==g&&g;a._openRelation=o,a._nonFoldersOnly=v,a._urlType=a.wrapObservable(_),a._itemSelectionHelper=new(a.child(u.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o}),a.item=a.createComputed(a._computeItem,{deferEvaluation:!0,pure:!0});var y=a.resources.consume(d.e);return a._navigateToItemAction=new(a.managed(y.NavigateToItemAction))({item:a.item,itemSet:l,parentItem:a._itemSelectionHelper.currentItem,urlType:a._urlType,forceInSameWindow:p,isRedirect:c,shouldPreserveAction:b}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()},t.prototype.onExecute=function(e,t){var n=this.item.peek();return n?(n.type===l.e.Folder&&t&&t.data&&(t.data.folder=!0),t.data.extraData||(t.data.extraData={}),f.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0}),this._navigateToItemAction.execute(e).then(function(){var e=m&&n.extension?Object(p.e)(n.extension):n.extension||"",t={fileType:l.e[n.type||l.e.Unknown],extension:e};return r.n.resolve({resultType:o.e.Success,extraData:t})})):r.n.resolve({resultType:o.e.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this.item})},t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case l.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case l.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}},t.prototype._computeItem=function(){var e=this._itemSelectionHelper.firstItem();return(3===this._openRelation?e&&e.UNSAFE_parent:e)||_},t}(i.e);t.t=h},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(40),r=new a.t({name:"EnableDarkThemeForOneUpMediaResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableDarkThemeForOneUpMediaViewer))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(40),r=new a.t({name:"EnableNewOneUpCommandBarResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableNewOneUpCommandBar))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"ShortcutLinkDataSource.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,4383)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function r(e){return!!e&&i[e.toLowerCase()]}function o(e){return a.indexOf(e)>=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("vroom.dataContext")},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(10),i=new a.t({name:"DetailsListSchemaDataSource.key",factory:new a.e({postProcessSchema:function(e,t){return t}})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n(691),i=new a.n("Click",a.a.event),r=new a.n("KeyPress",a.a.event),o=new a.n("Drop",a.a.event)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3);function i(e){return Object(a.co)(a.H)&&!!e&&!!e.extension&&".clipchamp"===e.extension.toLowerCase()}},function(e,t,n){"use strict";var a=n(0),i=n(4425),r=n(2267),o=n(2602),s=n(4830),c=n(40),d=function(e){function t(t){var n=e.call(this,t)||this;return n._itemCommandHelper=n.resources.consume(r.t),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return!!t&&!!this._itemCommandHelper.isCommandSupported(t,o.r)&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(t,n){if(c.isOneDrive){var a=this.item.peek();this.resources.consumeAsync(s.e).then(function(e){e.isInRecentView(a)&&e.fireOpenItemEvent(a)})}return e.prototype.onExecute.call(this,t,n)},t}(i.t);t.e=d},function(e,t,n){"use strict";var a=n(0),i=n(65),r=n(36),o=n(226),s=n(213),c=n(83),d=n(146),l=n(181),u=n(2455),f=n(40),p=n(38),m=n(320),_=n(2213),h=n(100),b=n(2267),g=n(151),v=n(2220),y=n(3117),S=n(4830),D=n(2221),I=n(2529),x=n(1830),C=!n(15).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),O=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInOfficeClient";var i=t.url,r=t.appMap,o=t.callback,s=t.isTemplate,c=void 0!==s&&s,u=t.retryWithWac,f=void 0!==u&&u;return a._url=i,a._callback=o,a._appMap=r,a._isTemplate=c,a._retryWithWac=f,a._navigation=a.resources.consume(d.e),a._platform=a.resources.consume(l.e),a._itemUrlHelper=a.resources.consume(g.c),a._itemParentHelper=a.resources.consume(v.e),a._itemCommandHelper=a.resources.consume(b.t),a._actionMap=a.resources.consume(m.e),a._pageContext=a.resources.consume(p.f),a._urlDataSource=a.resources.consume(h.ue),a._itemSelectionHelper=new(a.child(D.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();if(!(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)||!t||!this._itemCommandHelper.isCommandSupported(t,y.n))return!1;var n=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),a=!0;return n&&n.list&&n.list.permissions&&(a=!(!n.list.permissions.useClientIntegration||!r.e.hasItemPermission(t,r.e.openItems))),a&&!(!t.openUrl||!t.appMap)&&t.itemStatus!==s.t.ConditionalAccessBlocked&&t.itemStatus!==s.t.ConditionalAccessViewOnly},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,i.n,function(){var n,r,s,d,l,p,m,_,h,b,g,v,y,D=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(n=a.sent())?(f.isOneDrive&&this.resources.consumeAsync(S.e).then(function(e){e.isInRecentView(n)&&e.fireOpenItemEvent(n)}),r=function(){if(D._callback)D._callback();else{var t=D._actionMap;new(D.managed(t.OpenInOfficeOnlineAction))({item:D.observables.create(n)}).execute(e)}},s=function(e){D._callback?D._callback():D._doNavigation(e)},t.data.extraData||(t.data.extraData={}),d=this._pageContext.userDisplayName,l=this._pageContext.userLoginName,p=l&&-1!==l.lastIndexOf("@")?l.substring(0,l.lastIndexOf("@")):void 0,m=void 0,n&&n.sharingType&&(_=n&&n.sharingType,m=_===u.e.Shared||_===u.e.Public||_===u.e.PublicUnlisted),h=n.extension?n.extension.toLowerCase():void 0,o.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0,fileType:C&&h?Object(x.e)(h):h,isInODB:n.itemFromServer&&n.itemFromServer.SiteTitle&&d?-1!==n.itemFromServer.SiteTitle.indexOf(d):void 0,isInODBv2:n.openUrl&&p?-1!==n.openUrl.toLowerCase().indexOf(p.toLowerCase()):void 0,isItemShared:m}),b=this._itemSelectionHelper.currentItem.peek(),g=this._itemUrlHelper.getItemUrlParts(b.key),v=g.fullItemUrl,y="",this._url&&this._appMap&&(this._isTemplate&&this._urlDataSource.getOpenTemplateInOfficeClientUrl?y=this._urlDataSource.getOpenTemplateInOfficeClientUrl(this._appMap,this._url):v&&(y=this._urlDataSource.getNewInOfficeClientUrl(this._appMap,this._url,v))),y||(y=this._urlDataSource.getOpenInOfficeClientUrl(n,this._navigation.viewParams)),this._retryWithWac?"function"!=typeof navigator.msLaunchUri||this._platform.isWinPhone?s(y):navigator.msLaunchUri(y,null,r):s(y),[2,i.n.resolve({resultType:c.e.Success})]):[2,i.n.resolve({resultCode:"EmptySelection",resultType:c.e.Failure})]}})})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(I.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._doNavigation=function(e){this._navigation.navigateTo({url:e,frameId:null})},t}(_.e);t.e=O},function(e,t,n){"use strict";var a=n(0),i=n(83),r=n(65),o=n(2231),s=n(664),c=n(2322),d=n(2217),l=n(2984),u=n(547),f=n(320),p=n(100),m=n(2279),_=n(151),h=n(2529),b=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenShortcut",a._shortcutProvider=a.resources.consume(l.resourceKey.optional),a._dialogProvider=a.resources.consume(o.e),a._urlDataSource=a.resources.consume(p.ue),a._itemUrlHelper=a.resources.consume(_.c),a._url=a.createPureComputed(a._computeTargetUrl),a._actionMap=a.resources.consume(f.e),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._shortcutProvider&&!!this.unwrapObservable(this.item)&&!!this._url.peek()},t.prototype.onExecute=function(e){var t,n,a,o=this,l=this.item.peek();if(this.resources.consume(u.e).logData({name:"ShortcutLink.ItemRow.Click",isIntentional:!0}),l.shortcutInfo&&l.shortcutInfo.shortcutLinkRewritten)return new(this.managed(this._actionMap.NavigationAction))({url:this._url,target:this.wrapObservable("_blank")}).execute(e);l.external?(a=null===(t=this.item.peek().itemFromServer)||void 0===t?void 0:t.SPWebUrl,n=this.item.peek().properties.path):n=this._itemUrlHelper.getItemUrlParts(l.key).fullItemUrl;var f=this._shortcutProvider;return f?f.getShortcutTargetData(n,!0,void 0,a).then(function(t){var n=t.url,a="web=1";return t.isInternal&&n.indexOf(a)<0&&(n+="".concat(n.indexOf("?")>0?"&":"?").concat(a)),(t.isInternal?r.n.wrap():o._dialogProvider.requestDialog({title:s.confirmNavigateDialogTitle,component:{name:c.e.tagName,params:{text:s.openShortcutNavigateToExternalWarning}},actions:[{name:s.navigationDialogConfirmButtonLabel,execute:function(){return r.n.wrap(2)},isAvailable:o.observables.create(!0),icon:new d.e("Forward"),isDefault:!0}]}).wait()).then(function(){return new(o.managed(o._actionMap.NavigationAction))({url:o.wrapObservable(n),target:o.wrapObservable("_blank")}).execute(e)})},function(t){return new(o.managed(o._actionMap.NavigationAction))({url:o._url,target:o.wrapObservable("_blank")}).execute(e),r.n.wrap({resultType:i.e.Failure})}):r.n.wrap({resultType:i.e.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.e,{item:this.item})},t.prototype._computeTargetUrl=function(){return this._urlDataSource.getDefaultClickUrl(this.item(),{})},t}(m.e);t.e=b},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"StandaloneList.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(447)]).then(n.bind(null,3556)).then(function(e){return e.resourceKey.local})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(65);function i(e){var t;return function(){return t||(t=a.n.resolve(e()).then(function(e){return e.default}).catch(function(e){return t=void 0,a.n.reject(e)}))}}},function(e,t,n){"use strict";var a=n(0),i=n("knockout-lib"),r=function(e){function t(){var t=e.call(this,{})||this;return t._store=i.observable({}),t._store.extend({notify:"always"}),t.currentSelection=t.createPureComputed(t._computeCurrentSelection),t}return Object(a.__extends)(t,e),t.prototype.registerSelectionModel=function(e,t){var n=this._store.peek();if(n[t])throw"Duplicate selectionModelId: "+t;n[t]=e,this._store(n)},t.prototype.unregisterSelectionModel=function(e){var t=this._store.peek();return!!t[e]&&(delete t[e],this._store(t),!0)},t.prototype.clearOtherSelectionModels=function(e){var t=this._store.peek();for(var n in t)n!==e&&t[n].clear()},t.prototype._computeCurrentSelection=function(){var e=this._store();for(var t in e)if(e[t].selectedCount()>0)return e[t];return null},t}(n(1214).default);t.e=r},function(e,t,n){"use strict";var a=n(10),i=n(136),r=new a.t({name:"SpotlightHost.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(446)]).then(n.bind(null,5481)).then(function(e){return e.resourceKey.local})})});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"ItemColumnDataSource.key",loader:new i.t(function(){return n.e(466).then(n.bind(null,5330)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3363),i=(new a.e("play"),new a.e("rotate"),new a.e("editCaption"),new a.e("editTags"),new a.e("removeTags"),new a.e("viewOriginal"));new a.e("applyOfficeLens"),new a.e("removeOfficeLens"),new a.e("addToAlbum"),new a.e("removeFromAlbum"),new a.e("addPhotosToAlbum")},function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a=n(0),i=n(1214),r=n(10),o=n(2370),s=n(265),c=n(37),d=n(69),l=n(14),u=n(100),f=n(9),p=n(151),m=n(2269),_=n(4223),h=n(1433),b=n(1952),g=n(1012),v={itemTaskObserverType:o.resourceKey,itemUrlHelper:p.c,itemsStore:m.t,observablesFactoryType:i.observablesFactoryTypeResourceKey,rootItemsTypeFilter:_.e.optional,urlDataSource:u.ue,webDataSource:h.e},y=new r.t({name:"".concat("RootItems.key",".rootItems"),factory:{dependencies:v,create:function(e){var t=e.itemUrlHelper,n=e.itemsStore,i=e.rootItemsTypeFilter,r=e.urlDataSource,u=new g.e,m=u.attach(new e.observablesFactoryType).create();return u.trackPromise(e.webDataSource.getMyOneDriveUrl()).then(function(u){var _,h,g=t.getUrlParts({path:u,webUrl:u}),v=t.getUrlParts({path:"".concat(u,"/Documents"),listUrl:"".concat(u,"/Documents"),webUrl:u}),y=new e.itemTaskObserverType,S=r.getKey(((_={})[f.n.idParamKey]=g.normalizedItemUrl,_[f.n.queryTypeParamKey]=c.e.DocumentLibraries,_)),D=r.getKey(Object(a.__assign)(((h={})[f.n.idParamKey]=v.serverRelativeItemUrl,h[f.n.listUrlKey]=v.normalizedListUrl,h),r.saveItemTypeFilter(i))),I=r.getKey(Object(a.__assign)(Object(a.__assign)({},r.getKeyParams(r.getRootItemKey(c.e.Recent))),r.saveItemTypeFilter(i)));y.update([new o.Task(S).succeed({item:{key:S,subsite:{webTemplateId:d.t.mySite,serverRelativeUrl:g.fullItemUrl}}}),new o.Task(D).succeed({item:{key:D,name:o.Graft.backup(v.siteRelation===p.t.sameSite?b.n:b.u),displayName:o.Graft.backup(v.siteRelation===p.t.sameSite?b.n:b.u),type:s.e.Folder,parentKey:S,list:{templateType:l.n.mySiteDocumentLibrary},folder:{}}}),new o.Task(I).succeed({item:{key:I,name:o.Graft.backup(b.i),displayName:o.Graft.backup(b.i),type:s.e.Folder,folder:{}}})]),y.flush(),m({files:n.getItem(D),recent:n.getItem(I)})}),{instance:m,disposable:u}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(15);function i(e,t,n){var i;a.t.isActivated("c697dc4c-a759-483d-8f1c-569d265f6a95","1/18/2021","remove window history optional entry url, as it could be different origin and will throw exception")&&(i=e),window.history.pushState({returnUrl:n},"",i),t.navigateTo(e)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("imageEditorDataSource")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("InfoPaneManager.key")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(52),i=n(7),r=n(407),o=n(4229);function s(e,t){var n=t.maxLevels,s=[],c=function(t,r){for(var d=0,l=t;d<l.length;d++){var u=l[d];if(("number"!=typeof n||r<n)&&e.demandItemFacet(a.r,u,{suppressGetItems:!0})){var f=e.isItemFacetResolved(i.e,u),p=e.demandItemFacet(a.e,u,{suppressGetItems:!0}),m="number"==typeof p?p:1,_=e.demandItemFacet(o.e,u,{suppressGetItems:!f});if(_)c(_,r+1);else for(var h=0;h<m;h++)s.push(u)}else s.push(u)}};return c(t.itemKeys,0),Object(r.t)(s)}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n(609),r=n(2741),o=n(136),s=n(4864),c=n(10),d=n(2988),l=n(38),u=n(146),f=n(51),p=n(2395),m=n(97),_=n(1222),h=n(40),b=n(2803),g=n(15),v="Intelligent Document Content Types",y=function(e){function t(t,n){var a,i=this;return(i=e.call(this,n.pageContext)||this)._defaultListViewAsDefaultKSEnabled=g.e.isActivated("4db47ade-4d1b-4ca4-8a6d-1b92f9eda86a","07/21/2022","Pass ListViewAsDefault as default view option to model publication API"),i.extractFileName=function(e){var t=e.split("/");return t[t.length-1]},i._apiUrlHelper=n.apiUrlHelper,i._navigation=n.navigation,i._pageContext=n.pageContext,i._vroomDataRequestor=n.vroomDataRequestor,i._resources=n.resources,i._isRunModelFlatFileStructureSupportEnabled=Object(h.isFeatureEnabled)(h.RunModelFlatFileStructureSupport),i._shouldSupportFolderLevelClassificationWithCustomization=Object(h.isFeatureEnabled)(h.RunModelFolderClassificationSupportEnabled)&&Object(h.isFeatureEnabled)(h.RunModelCustomizationSupportEnabled),i._tokenProvider=null===(a=i._resources)||void 0===a?void 0:a.consume(b.e.optional),i}return Object(a.__extends)(t,e),t.prototype.getModelPublishInfo=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/GetByModelUniqueIdAndPublicationType('").concat(e,"')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getModelPublishInfo",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0",Scenario:"Syntex_ModelManagement"}})},t.prototype.unpromoteModel=function(e,t,n){var a={promotions:[{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t}]},i="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/batchUnpromote"),r=JSON.stringify(a);return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"batchUnpromote",additionalPostData:r,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0",Scenario:"Syntex_ModelManagement"}})},t.prototype.unpublishModel=function(e,t,n,a,i,r){var o={publications:[{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a}],modelSiteUrl:i,modelWebServerRelativeUrl:r},s="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications/batchremove"),c=JSON.stringify(o);return this.dataRequestor.getData({url:s.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"UnPublishModel",additionalPostData:c,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getServerRelativeUrlFromListId=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/rootfolder");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return console.log(JSON.parse(e)),JSON.parse(e).ServerRelativeUrl},qosName:"getserverrelativeurl",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getAllLists=function(e){var t="".concat(e,"/_api/web/Lists?$Select=Id,Title,BaseTemplate,BaseType,Hidden");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getallist",method:"GET",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.publishModel=function(e,t,n,a,i,r,o,s){this._defaultListViewAsDefaultKSEnabled||s||(s="ListViewAsDefault");var c={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningPublicationsEntityData"},Publications:{results:[o?{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a,TargetTableListServerRelativeUrl:o,ViewOption:s}:{ModelUniqueId:e,TargetSiteUrl:n,TargetWebServerRelativeUrl:t,TargetLibraryServerRelativeUrl:a,ViewOption:s}]},ModelSiteUrl:i,ModelWebServerRelativeUrl:r},d="".concat(this._pageContext.webAbsoluteUrl,"/_api/machinelearning/publications"),l=JSON.stringify(c);return this.dataRequestor.getData({url:d.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"PublishModel",additionalPostData:l,method:"POST",additionalHeaders:{accept:"application/json;odata=nometadata","OData-Version":"3.0"}})},t.prototype.getAnalyzedContent=function(e,t,n,i){var r=this;return this._getOAuthToken().then(function(o){return Object(a.__awaiter)(r,void 0,void 0,function(){var r,s,c,d,l;return Object(a.__generator)(this,function(a){return r=o.endPoint,s=o.token,c=i?"PrebuiltModelId":"trainingModelId",d="".concat(r,"/analyze?extension=").concat(e,"&provider=spoModel&profile=FormClassificationDiscovery&docid=").concat(t,"&").concat(c,"=").concat(n),l={accept:"application/json","content-type":"application/json",Authorization:"Bearer ".concat(s)},[2,this.dataRequestor.getData({url:d,parseResponse:function(e){var t,n,a,r;return i?null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.FormRecognizer)||void 0===n?void 0:n.FormClassifications:null===(r=null===(a=JSON.parse(e))||void 0===a?void 0:a.FormClassification)||void 0===r?void 0:r.FormClassifications},qosName:"getAnalyzedContent",method:"GET",additionalHeaders:l})]})})})},t.prototype.getAnalyzedContentMerged=function(e,t,n,i,r){var o=this;return this._getOAuthToken().then(function(s){return Object(a.__awaiter)(o,void 0,void 0,function(){var o,c,d,l;return Object(a.__generator)(this,function(a){return o=s.endPoint,c=s.token,n&&(n="&trainingModelId=".concat(n)),i&&(i="&PrebuiltModelId=".concat(i)),r&&(r="&AIBModelId=".concat(r)),d="".concat(o,"/analyze?extension=").concat(e,"&provider=spoModel&profile=FormClassificationDiscovery&docid=").concat(t).concat(n).concat(i).concat(r),l={accept:"application/json","content-type":"application/json",Authorization:"Bearer ".concat(c)},[2,this.dataRequestor.getData({url:d,parseResponse:function(e){var t,n,a,i,r,o,s=[],c=null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.FormRecognizer)||void 0===n?void 0:n.FormClassifications,d=null===(i=null===(a=JSON.parse(e))||void 0===a?void 0:a.FormClassification)||void 0===i?void 0:i.FormClassifications,l=null===(o=null===(r=JSON.parse(e))||void 0===r?void 0:r.FormProcessing)||void 0===o?void 0:o.FormClassifications;return c&&(s=s.concat(c)),d&&(s=s.concat(d)),l&&(s=s.concat(l)),s},qosName:"getAnalyzedContent",method:"GET",additionalHeaders:l})]})})})},t.prototype.getModels=function(e,t,n,a,i){var r=i?"14":"6",o=n||a?"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',modeltypes='").concat(r,"',publicationtypes='6')?$select=*,ManagementAllowed"):"".concat(e,"/_api/machinelearning/getmodels(guid'").concat(t,"')?$select=*,ManagementAllowed");return i&&(o=n||a?"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',modeltypes='").concat(r,"',publicationtypes='6')?$select=*,ManagementAllowed,ExtractorFieldMapping,ModelTypeAsString"):"".concat(e,"/_api/machinelearning/getmodels(listid='").concat(t,"',includeManagementNotAllowedModels=true)?$select=*,ManagementAllowed,ExtractorFieldMapping,ModelTypeAsString")),this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getModels",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getWebFields=function(e){var t="".concat(e,"/_api/web/fields?$select=Id,Title,TypeAsString&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFields",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getWebFieldsByContentTypeId=function(e,t){var n="".concat(e,"/_api/web/ContentTypes('").concat(t,"')/Fields?$select=Title,InternalName,TypeAsString&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getWebFieldsByContentTypeId",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getContentTypeIdByName=function(e,t){var n="".concat(e,"/_api/web/AvailableContentTypes?$select=Id,Title,TypeAsString&$filter=Name eq '").concat(t,"'");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value[0].Id.StringValue},qosName:"getContentTypeIdByName",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getSiteContentTypes=function(e,t,n,a){void 0===a&&(a=v);var i=e.substr(0,e.indexOf(t)),r=i.replace("https://","");n=n.replace("{","").replace("}","");var o="".concat(i,"/_api/V2.0/sites/").concat(r,",").concat(n,"/ContentTypes");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e).value;return a&&(t=t.filter(function(e){return e.group===a})),t},qosName:"getSiteContentTypes",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getColumnsForSiteContentType=function(e,t,n,a){var i=e.substr(0,e.indexOf(t)),r=i.replace("https://","");n=n.replace("{","").replace("}","");var o="".concat(i,"/_api/V2.0/sites/").concat(r,",").concat(n,"/ContentTypes/").concat(a,"/columnLinks");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e).value.map(function(e){return f.e.normalizeLower(e.id)})},qosName:"getColumnsForSiteContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getViewIds=function(e,t){var n="".concat(e,"/_api/Web/Lists(guid'").concat(t,"')/views");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e).value,n=[];return t.forEach(function(e){return n.push(e.ListViewXml)}),n},qosName:"getViewIds",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getMachineTeachingModelsForList=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/machinelearning/modelid', SchemaXml) eq true");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getMachineTeachingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getFormProcessingModelsForList=function(e,t){var n="".concat(e,"/_api/web/Lists(guid'").concat(t,"')/contenttypes?$filter=substringof('http://schemas.microsoft.com/sharepoint/v3/formprocessing/models', SchemaXml) eq true");return this.dataRequestor.getData({url:n.toString(),parseResponse:function(e){return JSON.parse(e).value},qosName:"getFormProcessingModelsForList",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getModelDetails=function(e,t,n){var a="".concat(e,"/_api/v2.1/drives/").concat(t,"/items/").concat(n," ");return this._vroomDataRequestor.send({path:a.toString(),apiName:"modelDetails",qosExtraData:{qosName:"getModelDetails"},requestType:"GET",allowCookies:!0,getErrorAsMessage:!0,expectedErrorCodes:{403:!0}})},t.prototype.getContentTypeColumnTypes=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getWebFields(e)];case 1:return t=a.sent(),n={},t.forEach(function(e){return n[e.Title]=e.TypeAsString}),[2,n]}})})},t.prototype.getModelContentTypeFields=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getContentTypeIdByName(e,t)];case 1:return n=a.sent(),[4,this.getWebFieldsByContentTypeId(e,n)];case 2:return[2,a.sent()]}})})},t.prototype.getModelDetailsManageModelKillSwitchActivated=function(e,t,n){var a="".concat(e,"/_api/v2.1/drives/").concat(t,"/items/").concat(n," ");return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"getModelDetailsManageModelKillSwitchActivated",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getUserInformation=function(e,t,n){var a="$filter=ModelUsageModelName eq '".concat(n,"' and ModelUsageTargetListID eq '").concat(t,"'"),i="".concat(e,"/_api/web/lists/modelusage/items?").concat("$select=Author/Name,Author/Title&$expand=Author/Id","&").concat(a);return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return JSON.parse(e).value[0]},qosName:"getUserInformation",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.getModelSettings=function(e,t,n){var a="".concat(e,"/_api/machinelearning/models/getbyuniqueid('").concat(t,"')");return this.dataRequestor.getData({url:a.toString(),parseResponse:function(e){var t=JSON.parse(e),a=JSON.parse(t.ModelSettings),i=t.Schemas;return n?{modelSettings:a,schema:i}:a},qosName:"getModelSettings",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.runModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("workItems");return this.runModelBatchRequest(t.toString(),function(e){return e},"runModel",function(){return e})},t.prototype.createOrUpdateModel=function(e,t,n,a,i){void 0===i&&(i=v);var r={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:a,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e,Schemas:""},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.dataRequestor.getData({url:o.toString(),parseResponse:function(e){return JSON.parse(e)},qosName:"createContentTypeAndModel",additionalPostData:JSON.stringify(r),method:"POST"})},t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl),t.push(this._pageContext.layoutsUrl),t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)},t.prototype.navigateToModelHomePage=function(e){var t="?v=modelHome"+"&modelUniqueId=".concat(e),n=[];n.push(this._pageContext.webAbsoluteUrl),n.push(this._pageContext.layoutsUrl),n.push("training.aspx");var a=n.join("/")+t;this._navigation.navigateTo({url:a,frameId:"_blank"})},t.prototype.getModelIdByContentType=function(e){var t=this._apiUrlHelper.build().toString();return t="".concat(t,"/machinelearning/models/getbytitle('").concat(e,"')"),this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){return JSON.parse(e).UniqueId},qosName:"getModelIdByContentType",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.importModel=function(e){var t=this._apiUrlHelper.build().segment("machinelearning").segment("models").segment(e?"import('".concat(e,"')"):"import('BenefitsChangeNotice.cmp')");return this.dataRequestor.getData({url:t.toString(),parseResponse:function(e){var t,n;return(null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.UniqueId)||""},qosName:"createContentImportModel",method:"Post"})},t.prototype.checkIfModelExists=function(e){var t=this._pageContext,n=t.webAbsoluteUrl,a=t.webServerRelativeUrl,i="".concat(n,"/_api/web/GetFileByServerRelativeUrl('").concat(a,"/Model/").concat(e,"')");return this.dataRequestor.getData({url:i.toString(),parseResponse:function(e){return!0},qosName:"checkIfModelExists",method:"GET",additionalHeaders:{accept:"application/json","content-type":"application/json"}})},t.prototype.runModelBatchRequest=function(e,t,n,a){var i=this;if(!a)return Promise.reject("failed");for(var r=f.e.generate(),o="multipart/mixed; boundary=batch_".concat(r),s=[],c=Math.ceil(a().length/30),d=0;d<c;d++){var l=a().slice(30*d,30*(d+1)),u=this.getConvertedData(l,e,r);s.push(this.dataRequestor.getData({url:p.e.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:t,qosName:"".concat(this.getDataSourceName(),".").concat(n),additionalPostData:u,method:"POST",contentType:o}).then(function(e){return p.e.getBatchResponseText(e)}).catch(function(e){var t;m.e.log("[ccui] fetching content type failed "+(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.value)),Promise.reject(e)}))}return this._shouldSupportFolderLevelClassificationWithCustomization?Promise.all(s).then(function(e){return[].concat.apply([],e).reduce(function(e,t){var n,a,r;if(t){var o=JSON.parse(t);return i._isRunModelFlatFileStructureSupportEnabled?e[null===(n=null==o?void 0:o.d)||void 0===n?void 0:n.TargetUniqueId]=null===(a=null==o?void 0:o.d)||void 0===a?void 0:a.StatusCode:e[i.extractFileName(o.d.TargetServerRelativeUrl)]=null===(r=null==o?void 0:o.d)||void 0===r?void 0:r.StatusCode,e}},{})}):Promise.all(s).then(function(e){var t=[].concat.apply([],e);return new Set(t.map(function(e){var t,n,a;if((null===(t=null==(e=JSON.parse(e))?void 0:e.d)||void 0===t?void 0:t.Created)&&(null===(n=null==e?void 0:e.d)||void 0===n?void 0:n.TargetServerRelativeUrl)&&201===(null===(a=null==e?void 0:e.d)||void 0===a?void 0:a.StatusCode))return i._isRunModelFlatFileStructureSupportEnabled?e.d.TargetUniqueId:i.extractFileName(e.d.TargetServerRelativeUrl)}))})},t.prototype._getOAuthToken=function(){var e,t;return Object(a.__awaiter)(this,void 0,void 0,function(){var n=this;return Object(a.__generator)(this,function(i){return[2,null===(t=null===(e=this._resources)||void 0===e?void 0:e.consumeAsync(s.e))||void 0===t?void 0:t.then(function(e){return e.getMicroServiceEndPoints("media")}).then(function(e){return Object(a.__awaiter)(n,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,null===(n=this._tokenProvider)||void 0===n?void 0:n.getToken(e,!0)];case 1:return t=a.sent()||"",[2,{endPoint:e,token:t}]}})})}).catch(function(e){return console.log(e),d.n("FetchOAuthTokenForAnalyze"),{endPoint:"",token:""}})]})})},t.prototype.getConvertedData=function(e,t,n){if(void 0===t&&(t=""),void 0===n&&(n=""),!e)return e;var a=p.e.defaultBatchAcceptData,i=[],r=[],o=[],s=p.e.defaultBatchRequestPostData,c=1;return e.forEach(function(e){o.push("".concat(c++)),i.push(t),r.push(JSON.stringify(e))}),p.e.getBatchContentExtended(n,i,"POST",s,r,a)},t.dependencies={pageContext:l.f,apiUrlHelper:i.e,navigation:u.e,vroomDataRequestor:_.e,resources:c.r},t}(r.e),S=Object(o.r)("ContentCenterDataSource",y)},function(e,t,n){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i.apply(this,arguments)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function d(e,t,n){return d=c()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&s(i,n.prototype),i},d.apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return d(e,arguments,o(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),s(a,e)},l(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function p(e){var t=c();return function(){var n,a=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return f(this,n)}}function m(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var a=m(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},_.apply(this,arguments)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}var g=Object.create(null);g.open="0",g.close="1",g.ping="2",g.pong="3",g.message="4",g.upgrade="5",g.noop="6";var v=Object.create(null);Object.keys(g).forEach(function(e){v[g[e]]=e});for(var y={type:"error",data:"parser error"},S="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),D="function"==typeof ArrayBuffer,I=function(e,t,n){var a,i=e.type,r=e.data;return S&&r instanceof Blob?t?n(r):x(r,n):D&&(r instanceof ArrayBuffer||(a=r,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer))?t?n(r):x(new Blob([r]),n):n(g[i]+(r||""))},x=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",O="undefined"==typeof Uint8Array?[]:new Uint8Array(256),w=0;w<C.length;w++)O[C.charCodeAt(w)]=w;var E="function"==typeof ArrayBuffer,A=function(e,t){if("string"!=typeof e)return{type:"message",data:k(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:L(e.substring(1),t)}:v[n]?e.length>1?{type:v[n],data:e.substring(1)}:{type:v[n]}:y},L=function(e,t){if(E){var n=function(e){var t,n,a,i,r,o=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var d=new ArrayBuffer(o),l=new Uint8Array(d);for(t=0;t<s;t+=4)n=O[e.charCodeAt(t)],a=O[e.charCodeAt(t+1)],i=O[e.charCodeAt(t+2)],r=O[e.charCodeAt(t+3)],l[c++]=n<<2|a>>4,l[c++]=(15&a)<<4|i>>2,l[c++]=(3&i)<<6|63&r;return d}(e);return k(n,t)}return{base64:!0,data:e}},k=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},M=String.fromCharCode(30);function P(e){if(e)return function(e){for(var t in P.prototype)e[t]=P.prototype[t];return e}(e)}P.prototype.on=P.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},P.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},P.prototype.off=P.prototype.removeListener=P.prototype.removeAllListeners=P.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,a=this._callbacks["$"+e];if(!a)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<a.length;i++)if((n=a[i])===t||n.fn===t){a.splice(i,1);break}return 0===a.length&&delete this._callbacks["$"+e],this},P.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(n){a=0;for(var i=(n=n.slice(0)).length;a<i;++a)n[a].apply(this,t)}return this},P.prototype.emitReserved=P.prototype.emit,P.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},P.prototype.hasListeners=function(e){return!!this.listeners(e).length};var T="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function U(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.reduce(function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t},{})}var F=setTimeout,H=clearTimeout;function R(e,t){t.useNativeTimers?(e.setTimeoutFn=F.bind(T),e.clearTimeoutFn=H.bind(T)):(e.setTimeoutFn=setTimeout.bind(T),e.clearTimeoutFn=clearTimeout.bind(T))}var N,B=function(e){r(i,e);var n=p(i);function i(e,a,r){var o;return t(this,i),(o=n.call(this,e)).description=a,o.context=r,o.type="TransportError",o}return a(i)}(l(Error)),j=function(e){r(i,e);var n=p(i);function i(e){var a;return t(this,i),(a=n.call(this)).writable=!1,R(u(a),e),a.opts=e,a.query=e.query,a.readyState="",a.socket=e.socket,a}return a(i,[{key:"onError",value:function(e,t,n){return _(o(i.prototype),"emitReserved",this).call(this,"error",new B(e,t,n)),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,_(o(i.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=A(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){_(o(i.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",_(o(i.prototype),"emitReserved",this).call(this,"close",e)}}]),i}(P),V="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),z={},G=0,K=0;function W(e){var t="";do{t=V[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function q(){var e=W(+new Date);return e!==N?(G=0,N=e):e+"."+W(G++)}for(;K<64;K++)z[V[K]]=K;function Q(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function Y(e){for(var t={},n=e.split("&"),a=0,i=n.length;a<i;a++){var r=n[a].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}var J=!1;try{J="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}var X=J;function Z(e){var t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||X))return new XMLHttpRequest}catch(e){}if(!t)try{return new(T[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function $(){}var ee=null!=new Z({xdomain:!1}).responseType,te=function(e){r(o,e);var n=p(o);function o(e){var a;if(t(this,o),(a=n.call(this,e)).polling=!1,"undefined"!=typeof location){var i="https:"===location.protocol,r=location.port;r||(r=i?"443":"80"),a.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port,a.xs=e.secure!==i}var s=e&&e.forceBase64;return a.supportsBinary=ee&&!s,a}return a(o,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var a=0;this.polling&&(a++,this.once("pollComplete",function(){--a||n()})),this.writable||(a++,this.once("drain",function(){--a||n()}))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split(M),a=[],i=0;i<n.length;i++){var r=A(n[i],t);if(a.push(r),"error"===r.type)break}return a})(e,this.socket.binaryType).forEach(function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var n=e.length,a=new Array(n),i=0;e.forEach(function(e,r){I(e,!1,function(e){a[r]=e,++i===n&&t(a.join(M))})})}(e,function(e){t.doWrite(e,function(){t.writable=!0,t.emitReserved("drain")})})}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=q()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var a=Q(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(a.length?"?"+a:"")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(e,{xd:this.xd,xs:this.xs},this.opts),new ne(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,a=this.request({method:"POST",data:e});a.on("success",t),a.on("error",function(e,t){n.onError("xhr post error",e,t)})}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",function(t,n){e.onError("xhr poll error",t,n)}),this.pollXhr=t}}]),o}(j),ne=function(e){r(i,e);var n=p(i);function i(e,a){var r;return t(this,i),R(u(r=n.call(this)),a),r.opts=a,r.method=a.method||"GET",r.uri=e,r.async=!1!==a.async,r.data=void 0!==a.data?a.data:null,r.create(),r}return a(i,[{key:"create",value:function(){var e=this,t=U(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var n=this.xhr=new Z(t);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var a in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(a)&&n.setRequestHeader(a,this.opts.extraHeaders[a])}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=function(){4===n.readyState&&(200===n.status||1223===n.status?e.onLoad():e.setTimeoutFn(function(){e.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(t){return void this.setTimeoutFn(function(){e.onError(t)},0)}"undefined"!=typeof document&&(this.index=i.requestsCount++,i.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=$,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete i.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),i}(P);function ae(){for(var e in ne.requests)ne.requests.hasOwnProperty(e)&&ne.requests[e].abort()}ne.requestsCount=0,ne.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",ae):"function"==typeof addEventListener&&addEventListener("onpagehide"in T?"pagehide":"unload",ae,!1));var ie="function"==typeof Promise&&"function"==typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},re=T.WebSocket||T.MozWebSocket,oe="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),se=function(e){r(i,e);var n=p(i);function i(e){var a;return t(this,i),(a=n.call(this,e)).supportsBinary=!e.forceBase64,a}return a(i,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=oe?{}:U(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=oe?new re(e,t,n):t?new re(e,t):new re(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(n){var a=e[n],i=n===e.length-1;I(a,t.supportsBinary,function(e){try{t.ws.send(e)}catch(e){}i&&ie(function(){t.writable=!0,t.emitReserved("drain")},t.setTimeoutFn)})},a=0;a<e.length;a++)n(a)}},{key:"doClose",value:function(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=q()),this.supportsBinary||(e.b64=1);var a=Q(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(a.length?"?"+a:"")}},{key:"check",value:function(){return!!re}}]),i}(j),ce={websocket:se,polling:te},de=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,le=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ue(e){var t=e,n=e.indexOf("["),a=e.indexOf("]");-1!=n&&-1!=a&&(e=e.substring(0,n)+e.substring(n,a).replace(/:/g,";")+e.substring(a,e.length));for(var i,r,o=de.exec(e||""),s={},c=14;c--;)s[le[c]]=o[c]||"";return-1!=n&&-1!=a&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1),"/"==t.slice(-1)&&n.splice(n.length-1,1),n}(0,s.path),s.queryKey=(i=s.query,r={},i.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(r[t]=n)}),r),s}var fe=function(n){r(s,n);var o=p(s);function s(n){var a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,s),a=o.call(this),n&&"object"===e(n)&&(r=n,n=null),n?(n=ue(n),r.hostname=n.host,r.secure="https"===n.protocol||"wss"===n.protocol,r.port=n.port,n.query&&(r.query=n.query)):r.host&&(r.hostname=ue(r.host).host),R(u(a),r),a.secure=null!=r.secure?r.secure:"undefined"!=typeof location&&"https:"===location.protocol,r.hostname&&!r.port&&(r.port=a.secure?"443":"80"),a.hostname=r.hostname||("undefined"!=typeof location?location.hostname:"localhost"),a.port=r.port||("undefined"!=typeof location&&location.port?location.port:a.secure?"443":"80"),a.transports=r.transports||["polling","websocket"],a.readyState="",a.writeBuffer=[],a.prevBufferLen=0,a.opts=i({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),a.opts.path=a.opts.path.replace(/\/$/,"")+"/","string"==typeof a.opts.query&&(a.opts.query=Y(a.opts.query)),a.id=null,a.upgrades=null,a.pingInterval=null,a.pingTimeout=null,a.pingTimeoutTimer=null,"function"==typeof addEventListener&&(a.opts.closeOnBeforeunload&&(a.beforeunloadEventListener=function(){a.transport&&(a.transport.removeAllListeners(),a.transport.close())},addEventListener("beforeunload",a.beforeunloadEventListener,!1)),"localhost"!==a.hostname&&(a.offlineEventListener=function(){a.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",a.offlineEventListener,!1))),a.open(),a}return a(s,[{key:"createTransport",value:function(e){var t=i({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=i({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new ce[e](n)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){t.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(e){return t.onClose("transport close",e)})}},{key:"probe",value:function(e){var t=this,n=this.createTransport(e),a=!1;s.priorWebsocketSuccess=!1;var i=function(){a||(n.send([{type:"ping",data:"probe"}]),n.once("packet",function(e){if(!a)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",n),!n)return;s.priorWebsocketSuccess="websocket"===n.name,t.transport.pause(function(){a||"closed"!==t.readyState&&(u(),t.setTransport(n),n.send([{type:"upgrade"}]),t.emitReserved("upgrade",n),n=null,t.upgrading=!1,t.flush())})}else{var i=new Error("probe error");i.transport=n.name,t.emitReserved("upgradeError",i)}}))};function r(){a||(a=!0,u(),n.close(),n=null)}var o=function(e){var a=new Error("probe error: "+e);a.transport=n.name,r(),t.emitReserved("upgradeError",a)};function c(){o("transport closed")}function d(){o("socket closed")}function l(e){n&&e.name!==n.name&&r()}var u=function(){n.removeListener("open",i),n.removeListener("error",o),n.removeListener("close",c),t.off("close",d),t.off("upgrading",l)};n.once("open",i),n.once("error",o),n.once("close",c),this.once("close",d),this.once("upgrading",l),n.open()}},{key:"onOpen",value:function(){if(this.readyState="open",s.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(function(){e.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var a=this.writeBuffer[n].data;if(a&&(t+="string"==typeof(e=a)?function(e){for(var t=0,n=0,a=0,i=e.length;a<i;a++)(t=e.charCodeAt(a))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(a++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,a){if("function"==typeof t&&(a=t,t=void 0),"function"==typeof n&&(a=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},n=function n(){e.off("upgrade",n),e.off("upgradeError",n),t()},a=function(){e.once("upgrade",n),e.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){e.upgrading?a():t()}):this.upgrading?a():t()),this}},{key:"onError",value:function(e){s.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,a=e.length;n<a;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}]),s}(P);fe.protocol=4,fe.protocol;var pe,me="function"==typeof ArrayBuffer,_e=Object.prototype.toString,he="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===_e.call(Blob),be="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===_e.call(File);function ge(e){return me&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))||he&&e instanceof Blob||be&&e instanceof File}function ve(t,n){if(!t||"object"!==e(t))return!1;if(Array.isArray(t)){for(var a=0,i=t.length;a<i;a++)if(ve(t[a]))return!0;return!1}if(ge(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return ve(t.toJSON(),!0);for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&ve(t[r]))return!0;return!1}function ye(t,n){if(!t)return t;if(ge(t)){var a={_placeholder:!0,num:n.length};return n.push(t),a}if(Array.isArray(t)){for(var i=new Array(t.length),r=0;r<t.length;r++)i[r]=ye(t[r],n);return i}if("object"===e(t)&&!(t instanceof Date)){var o={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o[s]=ye(t[s],n));return o}return t}function Se(t,n){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<n.length)return n[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(var a=0;a<t.length;a++)t[a]=Se(t[a],n);else if("object"===e(t))for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=Se(t[i],n));return t}!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(pe||(pe={}));var De=function(){function e(n){t(this,e),this.replacer=n}return a(e,[{key:"encode",value:function(e){return e.type!==pe.EVENT&&e.type!==pe.ACK||!ve(e)?[this.encodeAsString(e)]:(e.type=e.type===pe.EVENT?pe.BINARY_EVENT:pe.BINARY_ACK,this.encodeAsBinary(e))}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==pe.BINARY_EVENT&&e.type!==pe.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=function(e){var t=[],n=e.data,a=e;return a.data=ye(n,t),a.attachments=t.length,{packet:a,buffers:t}}(e),n=this.encodeAsString(t.packet),a=t.buffers;return a.unshift(n),a}}]),e}(),Ie=function(n){r(s,n);var i=p(s);function s(e){var n;return t(this,s),(n=i.call(this)).reviver=e,n}return a(s,[{key:"add",value:function(e){var t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");(t=this.decodeString(e)).type===pe.BINARY_EVENT||t.type===pe.BINARY_ACK?(this.reconstructor=new xe(t),0===t.attachments&&_(o(s.prototype),"emitReserved",this).call(this,"decoded",t)):_(o(s.prototype),"emitReserved",this).call(this,"decoded",t)}else{if(!ge(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,_(o(s.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,n={type:Number(e.charAt(0))};if(void 0===pe[n.type])throw new Error("unknown packet type "+n.type);if(n.type===pe.BINARY_EVENT||n.type===pe.BINARY_ACK){for(var a=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var i=e.substring(a,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){for(var r=t+1;++t&&","!==e.charAt(t)&&t!==e.length;);n.nsp=e.substring(r,t)}else n.nsp="/";var o=e.charAt(t+1);if(""!==o&&Number(o)==o){for(var c=t+1;++t;){var d=e.charAt(t);if(null==d||Number(d)!=d){--t;break}if(t===e.length)break}n.id=Number(e.substring(c,t+1))}if(e.charAt(++t)){var l=this.tryParse(e.substr(t));if(!s.isPayloadValid(n.type,l))throw new Error("invalid payload");n.data=l}return n}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(t,n){switch(t){case pe.CONNECT:return"object"===e(n);case pe.DISCONNECT:return void 0===n;case pe.CONNECT_ERROR:return"string"==typeof n||"object"===e(n);case pe.EVENT:case pe.BINARY_EVENT:return Array.isArray(n)&&n.length>0;case pe.ACK:case pe.BINARY_ACK:return Array.isArray(n)}}}]),s}(P),xe=function(){function e(n){t(this,e),this.packet=n,this.buffers=[],this.reconPack=n}return a(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=function(e,t){return e.data=Se(e.data,t),e.attachments=void 0,e}(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}(),Ce=Object.freeze({__proto__:null,protocol:5,get PacketType(){return pe},Encoder:De,Decoder:Ie});function Oe(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var we=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Ee=function(e){r(i,e);var n=p(i);function i(e,a,r){var o;return t(this,i),(o=n.call(this)).connected=!1,o.receiveBuffer=[],o.sendBuffer=[],o.ids=0,o.acks={},o.flags={},o.io=e,o.nsp=a,r&&r.auth&&(o.auth=r.auth),o.io._autoConnect&&o.open(),o}return a(i,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[Oe(e,"open",this.onopen.bind(this)),Oe(e,"packet",this.onpacket.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(we.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];n.unshift(e);var i={type:pe.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){var r=this.ids++,o=n.pop();this._registerAckCallback(r,o),i.id=r}var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var n=this,a=this.flags.timeout;if(void 0!==a){var i=this.io.setTimeoutFn(function(){delete n.acks[e];for(var a=0;a<n.sendBuffer.length;a++)n.sendBuffer[a].id===e&&n.sendBuffer.splice(a,1);t.call(n,new Error("operation has timed out"))},a);this.acks[e]=function(){n.io.clearTimeoutFn(i);for(var e=arguments.length,a=new Array(e),r=0;r<e;r++)a[r]=arguments[r];t.apply(n,[null].concat(a))}}else this.acks[e]=t}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth(function(t){e.packet({type:pe.CONNECT,data:t})}):this.packet({type:pe.CONNECT,data:this.auth})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case pe.CONNECT:if(e.data&&e.data.sid){var t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case pe.EVENT:case pe.BINARY_EVENT:this.onevent(e);break;case pe.ACK:case pe.BINARY_ACK:this.onack(e);break;case pe.DISCONNECT:this.ondisconnect();break;case pe.CONNECT_ERROR:this.destroy();var n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,n=b(this._anyListeners.slice());try{for(n.s();!(t=n.n()).done;)t.value.apply(this,e)}catch(e){n.e(e)}finally{n.f()}}_(o(i.prototype),"emit",this).apply(this,e)}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];t.packet({type:pe.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach(function(t){return e.emitEvent(t)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(t){e.notifyOutgoingListeners(t),e.packet(t)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach(function(e){return e()}),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:pe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=b(this._anyOutgoingListeners.slice());try{for(n.s();!(t=n.n()).done;)t.value.apply(this,e.data)}catch(e){n.e(e)}finally{n.f()}}}}]),i}(P);function Ae(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Ae.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Ae.prototype.reset=function(){this.attempts=0},Ae.prototype.setMin=function(e){this.ms=e},Ae.prototype.setMax=function(e){this.max=e},Ae.prototype.setJitter=function(e){this.jitter=e};var Le=function(n){r(o,n);var i=p(o);function o(n,a){var r,s;t(this,o),(r=i.call(this)).nsps={},r.subs=[],n&&"object"===e(n)&&(a=n,n=void 0),(a=a||{}).path=a.path||"/socket.io",r.opts=a,R(u(r),a),r.reconnection(!1!==a.reconnection),r.reconnectionAttempts(a.reconnectionAttempts||1/0),r.reconnectionDelay(a.reconnectionDelay||1e3),r.reconnectionDelayMax(a.reconnectionDelayMax||5e3),r.randomizationFactor(null!==(s=a.randomizationFactor)&&void 0!==s?s:.5),r.backoff=new Ae({min:r.reconnectionDelay(),max:r.reconnectionDelayMax(),jitter:r.randomizationFactor()}),r.timeout(null==a.timeout?2e4:a.timeout),r._readyState="closed",r.uri=n;var c=a.parser||Ce;return r.encoder=new c.Encoder,r.decoder=new c.Decoder,r._autoConnect=!1!==a.autoConnect,r._autoConnect&&r.open(),r}return a(o,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new fe(this.uri,this.opts);var n=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;var i=Oe(n,"open",function(){a.onopen(),e&&e()}),r=Oe(n,"error",function(n){a.cleanup(),a._readyState="closed",t.emitReserved("error",n),e?e(n):a.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;0===o&&i();var s=this.setTimeoutFn(function(){i(),n.close(),n.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&s.unref(),this.subs.push(function(){clearTimeout(s)})}return this.subs.push(i),this.subs.push(r),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(Oe(e,"ping",this.onping.bind(this)),Oe(e,"data",this.ondata.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this)),Oe(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}},{key:"ondecoded",value:function(e){var t=this;ie(function(){t.emitReserved("packet",e)},this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n||(n=new Ee(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var a=n[t];if(this.nsps[a].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach(function(e){return e()}),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var a=this.setTimeoutFn(function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(function(n){n?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",n)):t.onreconnect()}))},n);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),o}(P),ke={};function Me(t,n){"object"===e(t)&&(n=t,t=void 0);var a,i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,a=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),a=ue(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";var i=-1!==a.host.indexOf(":")?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+i+":"+a.port+t,a.href=a.protocol+"://"+i+(n&&n.port===a.port?"":":"+a.port),a}(t,(n=n||{}).path||"/socket.io"),r=i.source,o=i.id,s=i.path,c=ke[o]&&s in ke[o].nsps;return n.forceNew||n["force new connection"]||!1===n.multiplex||c?a=new Le(r,n):(ke[o]||(ke[o]=new Le(r,n)),a=ke[o]),i.query&&!n.query&&(n.query=i.queryKey),a.socket(i.path,n)}return i(Me,{Manager:Le,Socket:Ee,io:Me,connect:Me}),Me}()}],Array(85),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("floodgate.appId")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(895),i=n(4545),r=n(4904),o=Object(a.e)(i.e,r.e,void 0,{scope:"TeachingBubbleContent"})},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(4),i=n("react-lib"),r=n(494),o=n(134),s=n(671),c=n(1234),d=n(1966),l=n(1967),u=n(1031),f=n(3447),p=n(2158),m=Object(r.e)(),_=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),n._onKeyDown=function(e){n.props.onDismiss&&e.which===o.e.escape&&n.props.onDismiss()},Object(s.e)(n),n.state={},n}return Object(a.a)(t,e),t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)},t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)},t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e,t,n,r,o,s=this.props,_=s.children,h=s.illustrationImage,b=s.primaryButtonProps,g=s.secondaryButtonProps,v=s.headline,y=s.hasCondensedHeadline,S=s.hasCloseButton,D=void 0===S?this.props.hasCloseIcon:S,I=s.onDismiss,x=s.closeButtonAriaLabel,C=s.hasSmallHeadline,O=s.isWide,w=s.styles,E=s.theme,A=s.ariaDescribedBy,L=s.ariaLabelledBy,k=s.footerContent,M=s.focusTrapZoneProps,P=m(w,{theme:E,hasCondensedHeadline:y,hasSmallHeadline:C,hasCloseButton:D,hasHeadline:!!v,isWide:O,primaryButtonClassName:b?b.className:void 0,secondaryButtonClassName:g?g.className:void 0});if(h&&h.src&&(e=i.createElement("div",{className:P.imageContent},i.createElement(u.e,Object(a.e)({},h)))),v){var T="string"==typeof v?"p":"div";t=i.createElement("div",{className:P.header},i.createElement(T,{role:"heading","aria-level":3,className:P.headline,id:L},v))}if(_){var U="string"==typeof _?"p":"div";n=i.createElement("div",{className:P.body},i.createElement(U,{className:P.subText,id:A},_))}return(b||g||k)&&(r=i.createElement(f.e,{className:P.footer,horizontal:!0,horizontalAlign:k?"space-between":"end"},i.createElement(f.e.Item,{align:"center"},i.createElement("span",null,k)),i.createElement(f.e.Item,null,g&&i.createElement(c.e,Object(a.e)({},g,{className:P.secondaryButton})),b&&i.createElement(d.e,Object(a.e)({},b,{className:P.primaryButton}))))),D&&(o=i.createElement(l.e,{className:P.closeButton,iconProps:{iconName:"Cancel"},title:x,ariaLabel:x,onClick:I})),i.createElement("div",{className:P.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":L,"aria-describedby":A,"data-is-focusable":!0},e,i.createElement(p.e,Object(a.e)({isClickableOutsideFocusTrap:!0},M),i.createElement("div",{className:P.bodyContent},t,n,r,o)))},t}(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(4),i=n("react-lib"),r=n(494),o=n(671),s=n(4544),c=n(1489),d=n(164),l=Object(r.e)(),u=function(e){function t(t){var n=e.call(this,t)||this;return n.rootElement=i.createRef(),Object(o.e)(n),n.state={},n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:d.e.rightCenter},n}return Object(a.a)(t,e),t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()},t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,r=e.onDismiss,o=e.hasCloseButton,d=void 0===o?this.props.hasCloseIcon:o,u=e.isWide,f=e.styles,p=e.theme,m=e.target,_=Object(a.e)(Object(a.e)({},this._defaultCalloutProps),t),h={theme:p,isWide:u,calloutProps:Object(a.e)(Object(a.e)({},_),{theme:_.theme}),hasCloseButton:d},b=l(f,h),g=b.subComponentStyles?b.subComponentStyles.callout:void 0;return i.createElement(c.e,Object(a.e)({target:m||n,onDismiss:r},_,{className:b.root,styles:g,hideOverflow:!0}),i.createElement("div",{ref:this.rootElement},i.createElement(s.e,Object(a.e)({},this.props))))},t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:d.e.rightCenter}},t}(i.Component)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"TsInstrumentationProvider.key",loader:new i.t(function(){return n.e(535).then(n.bind(null,4140)).then(function(e){return e.resourceKey})})})}],Array(54),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2229),i=n(136),r=function(){function e(e,t){this._itemProvider=t.itemProvider}return e.prototype.updateItemSetPostUpload=function(e,t,n){if(e&&t&&t.length>0){var a=e.item.peek().key,i=this._itemProvider.computeProjectedItemSet(a+"&state=postUpload",e,{parentKey:a,itemSetProjections:{PostUpload:{uploadedItems:t,group:n}}},!0);i&&e.content({groupings:i.content.peek().groupings,items:i.content.peek().items})}},e}(),o=Object(i.r)("PostUploadProjectionHelper",r,{itemProvider:a.resourceKey})}],Array(136),[function(e,t,n){"use strict";n.d(t,"y",function(){return it}),n.d(t,"I",function(){return dt}),n.d(t,"x",function(){return ft}),n.d(t,"L",function(){return pt.e}),n.d(t,"D",function(){return mt.e}),n.d(t,"C",function(){return _t.e}),n.d(t,"O",function(){return Ct}),n.d(t,"S",function(){return jn}),n.d(t,"a",function(){return Vn}),n.d(t,"g",function(){return zn}),n.d(t,"t",function(){return Gn}),n.d(t,"v",function(){return Kn}),n.d(t,"b",function(){return Wn}),n.d(t,"A",function(){return qn}),n.d(t,"k",function(){return wt}),n.d(t,"n",function(){return At}),n.d(t,"i",function(){return Qn}),n.d(t,"u",function(){return Ht}),n.d(t,"c",function(){return jt}),n.d(t,"e",function(){return Yn}),n.d(t,"l",function(){return en}),n.d(t,"s",function(){return dn}),n.d(t,"d",function(){return ln.e}),n.d(t,"E",function(){return Jn}),n.d(t,"w",function(){return Xn}),n.d(t,"f",function(){return $n}),n.d(t,"p",function(){return bn}),n.d(t,"m",function(){return gn}),n.d(t,"_",function(){return Ln}),n.d(t,"h",function(){return Mn}),n.d(t,"r",function(){return Hn}),n.d(t,"o",function(){return Nn});var a=n(0),i=n("react-lib"),r=n(337),o=n(664),s=n(2),c=n(50),d=n(80),l=n(13),u=n(56),f=n(36),p=n(1),m=n(302),_=n(9),h=n(43),b=n(28),g=n(120),v=n(14),y=Object(l.e)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(181).then(n.bind(null,5723))];case 1:return[2,e.sent().EditNewMenuAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(b.e,n),i=a&&e.demandItemFacet(p.We,g.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl})),r=Object(h.e)(e,n),o=e.demandItemFacet(p.St,n),s=f.t.hasItemPermission({permissions:o},f.t.editListItems),c=Object(u.e)(e).itemsScopeItemKey,d=e.demandItemFacet(m.e,c);return!!r&&!r.isAnonymousGuestUser&&!(d&&d[_.n.queryParamKey])&&s&&!!i&&i.templateType!==v.t.webPageLibrary&&!!i.newWOPIDocumentEnabled}return!1})),S=n(5),D=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(174).then(n.bind(null,5724))];case 1:return[2,e.sent().AddToQuickLaunchAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(S.m,n),i=e.demandItemFacet(p.mt,n),r=e.demandItemFacet(b.e,n);return!!a&&".aspx"===a.extension&&!i&&!!r&&-1!==r.listFullUrl.toLowerCase().indexOf("sitepages")}return!1}))),I=n(320),x=n(2428),C=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OpenInOfficeOnlineAction))}),O=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OpenInOfficeClientAction))}),w=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.ReportAbuseAction))}),E=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RequestReviewAction))}),A=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.AddToBundleAction))}),L=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RemoveFromBundleAction))}),k=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(186).then(n.bind(null,5725))];case 1:return[2,e.sent().MakeHomePageAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(b.e,n),i=a&&e.demandItemFacet(p.We,g.e.serialize(a)),r=e.demandItem({permissions:p.St,isCheckedOut:S.y},n),o=r.permissions,s=r.isCheckedOut,c=f.t.hasItemPermission({permissions:o},f.t.manageWeb);return!!i&&i.templateType===v.n.webPageLibrary&&c&&!!s&&!s.byYou}return!1}))),M=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RotateAction))}),P=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.OrderPrintsAction))}),T=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.EmbedAction))}),U=n(3105),F=n(2948);function H(e){return Object(U.e)(function(t){var n=t.consume(I.e);return new(t.injected(n.VaultAction))({actionType:e})})}var R=H(F.e.Unlock),N=H(F.e.Lock),B=H(F.e.ShowFiles),j=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:1})}),V=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:2})}),z=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.SurveyAction))({actionType:3})}),G=n(439),K=function(e){return function(t){var n=t.consume(I.e);return new(t.injected(n.CreateDocumentAction))({docType:e})}},W=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Word)),q=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Excel)),Q=Object(x.createItemsScopeActionFromKnockout)(K(G.e.PowerPoint)),Y=Object(x.createItemsScopeActionFromKnockout)(K(G.e.OneNote)),J=Object(x.createItemsScopeActionFromKnockout)(K(G.e.ExcelSurvey)),X=Object(x.createItemsScopeActionFromKnockout)(K(G.e.Text)),Z=n(2031),$=n(22),ee=n(21),te=n(208),ne=n(91),ae=n(57),ie=n(116),re=n(1288),oe=n(5115),se=n(53),ce=Object(ne.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(214)]).then(n.bind(null,5954))];case 1:return[2,e.sent().ReactListFormPanel]}})})}),de=Object(l.r)()(Object(ae.t)(function(e,t){var n,r=t.itemKeys,o=t.interActiveSave,s=t.resources,c=1===r.length?r[0]:void 0,d=e.demandItemFacet(S.f,c),l=e.demandItemFacet(b.e,c);e.dispatch(oe.e);var u,f,m,_=new Array;if(l&&(f=l.webAbsoluteUrl,m=l.listFullUrl,u=g.e.serialize({webAbsoluteUrl:f,listFullUrl:m})),n=e.dispatch(Object(ie.e)(function(e){return{contentTypes:(e.demandItemFacet(p.b,u)||[]).map(function(t){return e.demandItemFacet(p.yn,t)})}})),n)for(var h=n.contentTypes,v=0;v<h.length;v++){var y=h[v],D={displayName:y.displayName,templateUrl:y.templateUrl,contentTypeId:y.contentTypeId,requiredFields:y.requiredFields,Fields:y.Fields,cTypeId:y.cTypeId,description:y.description,iconUrl:y.iconUrl,ClientFormCustomFormatter:y.ClientFormCustomFormatter};_.push(D)}var I=e.dispatch(Object(ie.e)(function(e){return e.demandItemFacet(p.We,u)})),x=e.demandItemFacet(re.e,c),C=re.e.evaluate(x)(e,{itemKey:c}).getPropertiesForm,O=Object(ee.o)(function(e){return i.createElement(ce,Object(a.__assign)({},e,{contentTypes:_,onDismiss:function(){e.reject(new te.e)},itemKey:c,displayName:d,getPropertiesForm:C,isDisplayForm:o,listProps:{webAbsoluteUrl:f,listFullUrl:m,listId:I&&I.id,itemName:I&&I.title},resources:s}))});return i.createElement($.e,{onExecute:O,engagement:{name:"ReactLaunchListFormPanel",isIntentional:!0}})}));function le(e){var t=Object(se.n)();return i.createElement(de,Object(a.__assign)({resources:t},e))}var ue,fe=n(3810),pe=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.CreateMountPointAction))}),me=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.RemoveMountPointAction))}),_e=n(88),he=n(351),be=n(217),ge=n(248),ve=n(3),ye=Object(l.n)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(183).then(n.bind(null,5727))];case 1:return[2,e.sent().LaunchFormatViewPaneAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(_e.e,n),i=a&&g.e.serialize(a),r=e.demandItemFacet(p.We,i);if(r&&r.templateType===v.t.mySiteDocumentLibrary)return!1;var o=!!r&&r.permissions,s=o&&!(!o.manageLists&&!o.managePersonalViews),c=Object(be.e)(e)===ge.e;if(a&&a.viewKey){var d=he.e.serialize(a.viewKey),l=e.demandItemFacet(p.g,d);if(Object(ve.co)(ve.$t)){if(l&&s)return!0}else if(l&&s&&!c)return!0}}return!1})),Se=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.ApproveRejectAction))}),De=n(789),Ie=n(333),xe=n(279),Ce=n(72),Oe=n(437),we=n(40),Ee=n(225),Ae=n(833),Le=n(1690),ke=n(1691),Me=n(1695),Pe=n(275),Te=n(39),Ue=n(25),Fe=n(166),He=n(10),Re=n(136),Ne=new He.t({name:"".concat("FormatViewPaneAction.key",".executeFormatViewPaneActionResourceKey"),loader:new Re.t(function(){return Promise.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(299)]).then(n.bind(null,5728))).then(function(e){return e.executeFormatViewPaneActionResourceKey})})}),Be=n(755),je=n(3737),Ve=n(610),ze=((ue={})[Ue.n.kanban]=!0,ue);function Ge(e){var t=this,n=Object(se.n)();return i.createElement($.e,{onExecute:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.consumeAsync(Ne)];case 1:return[4,e.sent()({customizeCard:{designerState:je.e.TemplateEditor,selectedTemplateId:Ve.u}})];case 2:return e.sent(),[2]}})})}})}var Ke=Object(ae.t)(function(e){var t=Object(Te.e)(e),n=Object(Fe.e)(e,{itemSetKey:t}),a=e.demandItemFacet(p.Bn,n);return a&&ze[a]?i.createElement(Be.e,null,i.createElement(Ge,null)):null}),We=n(176),qe=n(155),Qe=n(151),Ye=n(630),Je=n(5107),Xe=n(507),Ze=n(408),$e=n(29),et=n(213),tt=Object(ae.t)(function(e,t){var n=t.itemKey,r=t.resources,s=e.demandItemFacet(p.Ye,n),c=Object(h.e)(e,n),d=c?c.layoutsUrl:"",l=c&&c.listId||"",u=c?c.webAbsoluteUrl:"",m="".concat(u,"/").concat(d,"/CreateDocSetVersion.aspx?")+Object(Xe.t)({list:l,ID:s||"",IsDlg:1}),_=function(e,t){var n=t.itemKey,a=t.resources;if(!n||!a)return!1;var i=Object(h.e)(e,n),r=e.demandItemFacet(p.St,n),o=e.demandItemFacet(Ze.e,n);if(!i||i.isEmailAuthenticationGuestUser||!f.e.hasItemPermission({permissions:r},f.e.editListItems)||o===et.e.ConditionalAccessBlocked||o===et.e.ConditionalAccessViewOnly)return!1;var s=e.demandItemFacet(b.e,n),c=s&&g.e.serialize(s),d=e.demandItemFacet(p.We,c);if(!(!!d&&!!d.enableVersions))return!1;var l=a.consume(Qe.c.optional);if(l){var u=e.demandItemFacet(S.i,n);if(l.getUrlParts({path:u}).isCrossDomain)return!1}var m=e.demandItemFacet(p.x,n),_=e.demandItemFacet(p.Ye,n);return!!(Object(we.isFeatureEnabled)(we.DocumentSetsModernView)&&Object(we.isFeatureEnabled)(we.UseItemsScopeInTeamSites)&&_&&m)}(e,{itemKey:n,resources:r}),v=Object(ee.o)(function(e){return i.createElement(Je.e,{url:m,heightOffset:.7,dialogContentProps:{title:o.CaptureVersion},onDismiss:function(){e&&e.resolve&&e.resolve()},onLoad:nt})});return i.createElement($.e,Object(a.__assign)({isAvailable:_,onExecute:v},Object($e.t)(e,{itemKey:n,engagement:{name:"CaptureVersion",isIntentional:!0}})))});function nt(e){new Ye.e(void 0).setTimeout(function(){if(e&&e.contentDocument){var t=e.contentDocument.body.clientHeight;t>0&&(e.style.height=t+"px")}},10)}var at=Object(l.r)()(Object(l.a)()(tt)),it={key:new s.e("CaptureVersion").id,name:o.CaptureVersion,action:i.createElement(function(){var e=Object(se.n)();return i.createElement(at,{resources:e})},null),iconProps:{iconName:"StackIndicator"}},rt=n(1614),ot=n(1615),st=(Object(a.__assign)(Object(a.__assign)({},ot.e),{action:i.createElement(Be.e,null,i.createElement(rt.e,null)),automationId:"detailsCommand"}),n(2030)),ct=n(68),dt={key:n(1087).e,name:o.Details,ariaLabel:ct.f,action:i.createElement(st.ShowInfoPaneAction,null),automationId:"detailsMenuCommand"},lt=n(1616),ut=n(1618),ft=Object(a.__assign)(Object(a.__assign)({},ut.e),{action:i.createElement(lt.e,null)}),pt=n(1587),mt=n(1588),_t=n(1303),ht=n(892),bt=Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(173).then(n.bind(null,5729))];case 1:return[2,e.sent().AddToOneDriveAction]}})})},function(e,t){var n=t.itemKey;return!!n&&!!e.demandItemFacet(S.h,n)}),gt=Object(l.r)()(Object(l.a)()(bt));new s.e("AddToOneDrive").id,o.CreateMountPoint,i.createElement(c.t,null,i.createElement(function(){var e=Object(se.n)();return i.createElement(gt,{resources:e})},null)),ht.e.Image,window.require.toUrl("odsp-media/images/addtoonedrive/a2od.svg");var vt=n(70),yt=n(58),St=Object(yt.e)("LaunchBusinessAppsSetupWizardCommand"),Dt=n(1670),It=Object(ne.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(387).then(n.bind(null,5730))];case 1:return[2,e.sent().LaunchBusinessAppsSetupWizardCoachmarkCommand]}})})}),xt={key:St,automationId:"launchBusinessAppsSetupWizardCommand",name:ct.y,action:i.createElement(Dt.e,null),iconProps:{iconName:"Warning"}},Ct=Object(a.__assign)(Object(a.__assign)({},xt),{commandBarButtonAs:Object(vt.e)().merge(It,xt.commandBarButtonAs)}),Ot=Object(x.createItemsScopeActionFromKnockout)(function(e){var t=e.consume(I.e);return new(e.injected(t.PreviewAction))}),wt={key:n(1697).e,name:o.Preview,automationId:"Preview",action:i.createElement(Ot,null)},Et=n(411),At={key:new s.e("ComplianceDetails").id,name:o.ComplianceDetails,action:i.createElement(fe.t,null),automationId:"complianceDetails",facets:Object(a.__assign)({},Et.e.pack(!0))},Lt=n(318),kt=n(1496),Mt=n(37),Pt=Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(180).then(n.bind(null,5731))];case 1:return[2,e.sent().CreateShortcutAction]}})})},function(e,t){var n=t.itemKey;if(!t.resources||!n)return!1;var a=e.demandItemFacet(b.e,n);if(a){var i=Lt.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),r=e.demandItemFacet(p.St,n),o=f.t.hasItemPermission({permissions:r},f.t.insertListItems),s=e.demandItemFacet(p.Dn,i),c=Object(u.e)(e).itemsScopeItemKey,d=Object(Te.e)(e,c);if(d){var l=Object(kt.e)(e,d);return!!s&&!s.isAnonymousGuestUser&&!s.isEmailAuthenticationGuestUser&&Object(ve.co)(ve.hi)&&Object(ve.co)(ve.Ci)&&o&&l===Mt.e.Files}}return!1}),Tt=Object(l.i)()(Pt),Ut=Object(l.e)()(Pt),Ft={key:n(1692).e,name:o.CreateShortcut,action:i.createElement(c.e,null,i.createElement(function(){var e=Object(se.n)();return i.createElement(Tt,{resources:e})},null)),iconProps:{iconName:"Globe"},facets:Object(a.__assign)({},p.Tt.pack(We.r))},Ht=Object(a.__assign)(Object(a.__assign)({},Ft),{action:i.createElement(function(){var e=Object(se.n)();return i.createElement(Ut,{resources:e})},null)}),Rt=n(2674),Nt=n(41),Bt=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(188).then(n.bind(null,5732))];case 1:return[2,e.sent().OpenInPowerBIAction]}})})},function(e,t){var n=t.itemKey;if(n){var a=e.demandItem({fileName:S.m,itemStatus:Ze.e,openUrl:S.L,permissions:p.St},n),i=a.fileName,r=a.itemStatus,o=a.openUrl,s=a.permissions,c=f.t.hasItemPermission({permissions:s},f.t.openItems),d=Object(u.e)(e).itemsScopeItemKey,l=Object(Te.e)(e,d);if(l){var m=Object(kt.e)(e,l);return Object(ve.co)(ve.nt)&&!!i&&!!i.extension&&!!o&&(Object(Rt.e)(i.extension)===G.e.Excel||".csv"===i.extension.toLowerCase())&&r!==et.t.ConditionalAccessViewOnly&&r!==et.t.ConditionalAccessBlocked&&c&&!Object(Nt.w)(m)}}return!1}))),jt={key:n(1694).e,name:o.OpenInPowerBI,action:i.createElement(Bt,null),iconProps:{iconName:"PowerBILogo16"}},Vt=n(132),zt=n(4238),Gt=n(181),Kt=n(99),Wt=n(16),qt=n(1383),Qt=n(118),Yt=n(77),Jt=n(244),Xt=n(6),Zt=new Xt.e("openInTextEditorAction",{isAvailable:Xt.t}),$t=Object(zt.e)({isAvailable:function(e,t){var n=Object(Vt.e)(e);if(1!==n.length)return!1;var a=n[0],i=e.demandItemFacet(Kt.e,a),r=e.demandItemFacet(Zt,Wt.c),o=Zt.evaluate(r)(e,{itemKey:a}).isAvailable;if(!i)return!1;var s=Object(Yt.e)(e);return!e.demandItemFacet(Jt.e,s)&&!!function(e,t){var n=e.demandItemFacet(S.m,t),a=null==n?void 0:n.extension;if(a)return!!Object(qt.t)(a)}(e,a)&&!Object(Qt.e)()&&!function(e){var t=e.demandItemFacet(Wt.u,Wt.c);if(t)return t.consume(Gt.e).isMobile}(e)&&o&&function(e,t){var n=e.demandItemFacet(Ze.e,t);return n!==et.t.ConditionalAccessViewOnly&&n!==et.t.ConditionalAccessBlocked}(e,a)},getKnockoutAction:function(e,t){var n=e.consume(I.e);return new(e.injected(n.OpenInTextEditorAction))}}),en={key:n(1693).e,name:o.OpenInTextEditor,action:i.createElement($t,null),iconProps:{iconName:"Edit"}},tn=n(109),nn=n(554),an=n(12),rn=n(206),on=new tn.e,sn=Object(ae.t)(function(e,t){var r=t.itemKey,o=Object(h.e)(e,r),s=!an.e.isActivated("2155219B-D6C5-409E-A5A2-45340C720D12","09/01/2021","Edge view in file explorer")&&o&&o.viewInFileExplorer,c=on.isIE||s,d=!1,l=void 0;if(c){var u=e.demandItemFacet(b.e,r),f=u&&g.e.serialize(u),m=f&&e.demandItemFacet(p.We,f),_=e.demandItemFacet(p.he,r);u&&_&&(l=s?"viewinfileexplorer:".concat(new rn.e(u.listFullUrl).authority).concat(_):"".concat(u.listFullUrl,"?").concat(Object(nn.e)({rootFolder:_,ExplorerWindowUrl:_}))),c=!(!l||!m||!m.isDocumentLibrary||m.templateType===v.n.webPageLibrary||!o||o.viewOnlyExperienceEnabled||o.blockDownloadsExperienceEnabled),d=!!m&&m.templateType===v.n.mySiteDocumentLibrary}return i.createElement($.e,Object(a.__assign)({isAvailable:c,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(187).then(n.bind(null,5733))];case 1:return(0,e.sent().openInExplorerExecutor)({isODB:d,explorerWindowUrl:l,useEdgeProtocolHandler:s}),[2]}})})}},Object($e.t)(e,{itemKey:r,engagement:{name:"OpenInExplorer",isIntentional:!0}})))}),cn=Object(l.e)()(sn),dn={key:new s.e("OpenInExplorer").id,name:o.OpenInExplorer,action:i.createElement(cn,null),iconProps:{iconName:void 0,styles:{root:{display:"none!important"}}}},ln=n(1594),un=n(3186),fn=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(193).then(n.bind(null,5734))];case 1:return[2,e.sent().TeamChannelAction]}})})},function(e,t){var n=t.itemKey,a=Object(u.e)(e).itemsScopeItemKey,i=Object(Te.e)(e,a),r=e.demandItemFacet(_e.e,i),o=e.demandItemFacet(b.e,n);if(!r)return!1;if(Object(Qt.n)())return!1;var s=b.e.serialize({itemId:o?o.itemId:"",listFullUrl:r.listFullUrl,rootFolder:r.rootFolder,webAbsoluteUrl:r.webAbsoluteUrl}),c=e.demandItemFacet(p.Pt,s)||"",d=Lt.e.serialize({listFullUrl:r.listFullUrl,webAbsoluteUrl:r.webAbsoluteUrl}),l=e.demandItemFacet(p.Dn,d);return Object(un.t)(l)?Object(un.n)():Object(un.n)()&&Object(un.e)(c)}))),pn=n(445),mn=n(167),_n=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(45).then(n.bind(null,4857))];case 1:return[2,e.sent().GoToChannelAction]}})})},function(e,t){var n=t.itemKey;return!!e.demandItemFacet(mn.e,n)}))),hn=n(1320),bn={key:hn.t,name:o.Channel,action:i.createElement(fn,null),iconProps:Object(a.__assign)(Object(a.__assign)({},Object(pn.t)({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}})},gn={key:hn.e,name:o.Channel,action:i.createElement(_n,null),iconProps:Object(a.__assign)(Object(a.__assign)({},Object(pn.t)({extension:"",brand:"teams",size:16})),{styles:{root:{width:"16px",height:"16px",selectors:{img:{width:"16px",height:"16px",display:"block"}}}}})},vn=n(223),yn=n(1334),Sn=n(398),Dn=n(106),In=n(370),xn=n(305),Cn=new tn.e;function On(e,t){var n=Object(xn.e)(e);if(n&&t.itemKey){var a=function(e,t){var n=t.itemKey,a=e.demandItemFacet(vn.e,n)||e.demandItemFacet(In.e,n)||e.demandItemFacet(_e.e,n)||e.demandItemFacet(b.e,n);if(!a)return{};var i=Object(xn.e)(e);return i&&i.webAbsoluteUrl===a.webAbsoluteUrl?{}:{itemKey:vn.e.serialize(a)}}(e,{itemKey:t.itemKey}).itemKey;if(a){var i=vn.e.deserialize(a).webAbsoluteUrl;return new Sn.e({},{pageContext:n}).getUrlParts({webUrl:i}).geoRelation===Dn.e.crossGeo}}return!1}var wn=Object(l.i)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(194).then(n.bind(null,5735))];case 1:return[2,e.sent().UploadFileAction]}})})},function(e,t){return Cn.isHtml5FileUploadSupported&&Object(yn.e)(e,t)&&!On(e,t)})),En=Object(l.i)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(194).then(n.bind(null,5735))];case 1:return[2,e.sent().UploadFolderAction]}})})},function(e,t){return Cn.isFolderUploadSupported&&Object(yn.e)(e,t)&&!On(e,t)})),An=n(1322),Ln=Object(a.__assign)(Object(a.__assign)({},An.e),{name:o.UploadFile,action:i.createElement(c.e,null,i.createElement(wn,null))}),kn=n(1715),Mn=Object(a.__assign)(Object(a.__assign)({},kn.e),{name:o.UploadFolder,action:i.createElement(c.e,null,i.createElement(En,null))}),Pn=n(4215),Tn=n(69),Un=n(15),Fn=Object(l.r)()(Object(l.a)()(Object(d.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(178).then(n.bind(null,5736))];case 1:return[2,e.sent().CreateFileRequestAction]}})})},function(e,t){if(!Object(we.isFeatureEnabled)(we.FileRequestUI))return!1;var n=t.itemKey,a=e.demandItemFacet(b.e,n);if(!a)return!1;var i=Object(Te.e)(e);if(!e.demandItemFacet(_e.e,i))return!1;if(e.demandItemFacet(p.it,n))return!1;if(!e.demandItemFacet(S.h,n))return!1;var r=g.e.serialize(a),o=e.demandItemFacet(p.We,r);if(!o)return!1;var s=Object(h.e)(e,n);if(!s)return!1;var c=Number(s.webTemplate)===Tn.t.mySite,d=!Un.t.isActivated("3345e98e-9a1c-4176-96a8-c39080929c98","10/31/2022","File Request conditions have been modified - this allows feature to be enabled for Sharepoint Teams site.");if(d&&c||!d){if(o.templateType!==v.n.mySiteDocumentLibrary)return!1;if(Object(we.isFeatureEnabled)(we.PreferIsMySiteOwner)?!s.isMySiteOwner:!s.isSiteOwner)return!1;if(s.isEmailAuthenticationGuestUser)return!1}if(s.farmSettings&&s.farmSettings.ExternalService_filerequestenable&&"0"===s.farmSettings.ExternalService_filerequestenable)return!1;if(Object(we.isFeatureEnabled)(we.EnableRequestFilesLink)){if(!s.requestFilesLinkEnabled)return!1}else if(!s.isShareByLinkEnabled||s.FolderAnonymousLinkPermission!==Pn.e.Uninitialized&&s.FolderAnonymousLinkPermission!==Pn.e.AnonymousEdit)return!1;return!0}))),Hn={key:new s.e("FileRequest").id,name:o.CreateFileRequest,action:i.createElement(Fn,null),iconProps:{iconName:"FileRequest"}},Rn=n(564),Nn={key:n(1696).e,name:o.ManageAccess,action:i.createElement(c.t,null,i.createElement(Rn.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},automationId:"manageAccessCommand"},Bn={iconName:void 0,styles:{root:{display:"none!important"}}},jn={key:new s.e("CopyField").id,name:o.CopyField,action:i.createElement(Z.CopyFieldAction,null),preferMenuTargetAsEventTarget:!0,automationId:"copyFieldCommand"},Vn=Ee.n.isFeatureEnabled(we.ReactEditItemPanel)?{key:new s.e("ReactEditProperties").id,name:o.editProperties,action:i.createElement(le,null),iconProps:{iconName:"Edit"},automationId:"ReactEditProperties"}:{key:Ae.n,name:o.editProperties,action:i.createElement(Z.EditItemAction,null),iconProps:{iconName:"Edit"},automationId:"editProperties",facets:Object(a.__assign)({},p.Tt.pack(We.s))},zn=Ee.n.isFeatureEnabled(we.ReactEditItemPanel)?{key:new s.e("ReactEditProperties").id,name:"Open",action:i.createElement(le,{interActiveSave:!0}),iconProps:{iconName:"Edit"},automationId:"ReactEditProperties"}:{key:Ae.i,name:o.Open,action:i.createElement(Z.ViewItemAction,null),automationId:"viewItemCommand"},Gn={key:Ae.t,name:o.commentCommandText,action:i.createElement(Z.ViewItemAction,{preferredSection:"comments"}),iconProps:{iconName:"Comment"},engagement:{name:"CommentItemCommand",isIntentional:!0,usageType:"Click"},automationId:"CommentItemCommand",facets:Object(a.__assign)({},p.Tt.pack(We.t))},Kn={key:Ae.e,name:o.viewProperties,action:i.createElement(Z.EditItemAction,{isBulkEdit:!0}),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(qe.g))},Wn={key:Ae.a,name:o.viewProperties,action:i.createElement(Z.ViewItemAction,null),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(qe.g))},qn={key:new s.e("MakeHomePage").id,name:o.MakeHomepage,action:i.createElement(k,null),iconProps:{iconName:"Home"}},Qn=(new s.e("rotate").id,o.rotate,i.createElement(M,null),new s.e("orderPrints").id,o.OrderPrints,i.createElement(P,null),new s.e("embed").id,o.Embed,i.createElement(T,null),new s.e("vaultLock").id,o.LockVault,i.createElement(c.t,null,i.createElement(N,null)),new s.e("vaultUnlock").id,o.unlock,i.createElement(R,null),new s.e("vaultShowFiles").id,o.unlock,i.createElement(B,null),new s.e("createMountPoint").id,o.CreateMountPoint,i.createElement(pe,null),new s.e("removeMountPoint").id,o.RemoveMountPoint,i.createElement(me,null),new s.e("addToBundle").id,o.addToBundle,i.createElement(A,null),new s.e("removeFromBundle").id,o.removeFromBundle,i.createElement(L,null),new s.e("reportAbuse").id,o.reportConcern,i.createElement(w,null),new s.e("requestReview").id,o.requestReview,i.createElement(E,null),new s.e("ApproveReject").id,o.ApproveReject,i.createElement(Se,null),{key:new s.e("EditRenditions").id,name:o.EditRenditions,action:i.createElement(fe.n,null)}),Yn=(new s.e("createWord").id,xe.c,i.createElement(c.e,null,i.createElement(W,null)),Object(Ie.e)({extension:"docx",size:16}),new s.e("createExcel").id,xe.e,i.createElement(c.e,null,i.createElement(q,null)),Object(Ie.e)({extension:"xlsx",size:16}),new s.e("createPowerPoint").id,xe.o,i.createElement(c.e,null,i.createElement(Q,null)),Object(Ie.e)({extension:"pptx",size:16}),new s.e("createOneNote").id,xe.r,i.createElement(c.e,null,i.createElement(Y,null)),Object(Ie.e)({extension:"onetoc",size:16}),new s.e("createExcelSurvey").id,xe.a,i.createElement(c.e,null,i.createElement(J,null)),Object(Ie.e)({type:r.e.form,size:16}),new s.e("createTextFile").id,o.CreateText,i.createElement(c.e,null,i.createElement(X,null)),Object(Ie.e)({extension:"txt",size:16}),new s.e("shareSurvey").id,o.shareSurvey,i.createElement(c.e,null,i.createElement(j,null)),new s.e("viewSurvey").id,o.viewSurvey,i.createElement(c.e,null,i.createElement(V,null)),new s.e("editSurvey").id,o.editSurvey,i.createElement(c.e,null,i.createElement(z,null)),new s.e("survey").id,{key:Me.e,name:o.AddToQuickLaunch,action:i.createElement(D,null),iconProps:{iconName:"Pin"}}),Jn=(new s.e("openInOfficeOnline").id,i.createElement(C,null),Object(a.__assign)({},Ce.t.pack(!0)),new s.e("openInOfficeClient").id,i.createElement(O,null),Object(a.__assign)({},Ce.t.pack(!0)),Oe.e.key,Oe.e.automationId,Object(a.__assign)({},Ce.t.pack(!0)),{key:Le.e,name:o.FormatView,action:i.createElement(ye,null),iconProps:Bn,automationId:"launchFormatViewPaneCommand",facets:Object(a.__assign)(Object(a.__assign)({},Pe.t.pack(!0)),Pe.n.pack(!0))}),Xn={key:ke.e,name:o.CustomizeCard,action:i.createElement(c.e,null,i.createElement(Ke,null)),iconProps:Bn,automationId:"launchCustomizeCardPaneCommand",facets:Object(a.__assign)(Object(a.__assign)({},Pe.t.pack(!0)),Pe.n.pack(!0))},Zn={key:De.e,name:o.editNewMenu,action:i.createElement(c.e,null,i.createElement(y,null)),iconProps:{iconName:"Edit"},facets:Object(a.__assign)({},p.Tt.pack(We.c))},$n=Object(a.__assign)(Object(a.__assign)({},Zn),{action:i.createElement(y,null)})}],Array(24),[function(e,t,n){"use strict";n.r(t),n.d(t,"useOneUpTextEditorResourceKey",function(){return j}),n.d(t,"supportsOneUpResourceKey",function(){return V}),n.d(t,"resourceKey",function(){return G});var a,i=n(0),r=n(1214),o=n(37),s=n(105),c=n(507),d=n(38),l=n(100);!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={}));var u=a,f=n(93),p=n(36),m=n(9),_=n(4814),h=n(40),b=n(3835),g=n(1225),v=n(3583),y=n(1891),S=n(172),D=n(96),I=n(864),x=n(2451),C=n(151),O=n(146),w=n(181),E=n(859),A=n(2738),L=n(10),k=n(136),M=n(2220),P=n(308),T=n(41),U=n(12),F=n(1710),H=n(4414),R=n(170),N=n(90),B=n(226),j=new L.t({name:"".concat("UrlDataSource",".useOneUpTextEditor"),factory:new L.e(Object(h.isFeatureEnabled)(h.UseOneUpTextEditor))}),V=new L.t({name:"".concat("UrlDataSource",".supportsOneUp"),factory:new L.e(!0)}),z=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.navigation,r=void 0===i?a.resources.consume(O.e):i,o=n.platform,s=void 0===o?a.resources.consume(w.e):o,l=n.pageContext,u=void 0===l?a.resources.consume(d.f):l,f=n.itemUrlHelper,p=void 0===f?a.resources.consume(C.c):f,_=n.itemParentHelper,h=void 0===_?a.resources.consume(M.e):_,b=n.useOneUpTextEditor,g=void 0===b?a.resources.consume(j):b,v=n.supportsOneUp,y=void 0===v?a.resources.consume(V):v,S=n.urlDataSourceLite,D=void 0===S?a.resources.consume(P.resourceKey):S,I=n.getDefaultClickUrl,x=void 0===I?a.resources.consume(F.e):I;return a._navigation=r,a._platform=s,a._pageContext=u,a._itemUrlHelper=p,a._itemParentHelper=h,a._useOneUpTextEditor=g,a._supportsOneUp=y,a._urlDataSourceLite=D,a._getDefaultClickUrl=x,Object(N.d)()||Object(N.l)()||function(e,t){void 0===t&&(t=R.e);var n=(new H.e).removeState(m.n.windowNameJsonKey);n&&(t.logData({name:"Picker.UpdateViewParamsFromWindowName"}),e.navigateTo("?".concat(Object(c.t)(n))),e.updateViewParams(n,{ignoreHistory:!0,clearOtherParams:!1}))}(a._navigation),a}return Object(i.__extends)(t,e),t.getKey=function(e,t){return P.default.getKey(e,t)},t.getKeyParams=function(e){return P.default.getKeyParams(e)},t.getQueryUrl=function(e,t){var n={};return e!==s.e.Files&&(n[m.n.pageParamKey]=e),n[m.n.queryTypeParamKey]="".concat(t||""),"#"+c.t(n,null,!0)},t.prototype.getDefaultRootItemId=function(){return this._urlDataSourceLite.getDefaultRootItemId()},t.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.b)(e)},t.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.n)(e)},t.prototype.getMetadataSearchId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.m)(e)},t.prototype.getPageType=function(e){return void 0===e&&(e=this._navigation.viewParams),this._urlDataSourceLite.getPageType(e)},t.prototype.isCurrentQuery=function(e,t){return void 0===t&&(t=this._navigation.viewParams),e===this.getQueryType(t)},t.prototype.isRecycleBin=function(e){return Object(T.w)(e)},t.prototype.getKey=function(e){return this._urlDataSourceLite.getKey(e)},t.prototype.getKeyParams=function(e){return t.getKeyParams(e)},t.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.o)(e)||null},t.prototype.getViewerType=function(e){return function(e){var t=e[m.n.viewerKey];switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}}(e)},t.prototype.saveViewerType=function(e){return function(e){var t;return(t={})[m.n.viewerKey]=e,t}(e)},t.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),this._urlDataSourceLite.getCurrentItemKey(e)},t.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n[m.n.listUrlKey],delete a[m.n.listUrlKey],delete n[m.n.uniqueParamKey],delete a[m.n.uniqueParamKey],this.getKey(n)===this.getKey(a)},t.prototype.getRootItemKey=function(e){return void 0===e&&(e=o.e.Files),this._urlDataSourceLite.getRootItemKey(e)},t.prototype.getQueryUrl=function(e,n){return t.getQueryUrl(e,n)},t.prototype.getSearchQueryUrl=function(e){return Object(T.S)(e)},t.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e[m.n.queryParamKey]},t.prototype.getIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e[m.n.idParamKey]},t.prototype.getListUrlParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.p)(e)},t.prototype.getSearchScopeParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(T.D)(e)},t.prototype.getCommentIdParamValue=function(e){void 0===e&&(e=this._navigation.viewParams)},t.prototype.isItemCrossList=function(e){return Object(C.i)(e,this._itemUrlHelper)},t.prototype.getSearchItemId=function(e){return Object(C.a)(e,this._itemUrlHelper)},t.prototype.isSearchItemOdbRoot=function(e){return Object(C.s)(e,this._itemUrlHelper)},t.prototype.isSPSiteRoot=function(e){return Object(C.o)(e,this._itemUrlHelper)},t.prototype.isSPListRoot=function(e){return Object(C.r)(e,this._itemUrlHelper)},t.prototype.getLayoutContentType=function(e){return void 0===e&&(e=this._navigation.viewParams),""},t.prototype.getItemTypeFilter=function(e){return Object(T.d)(e)},t.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t=[],n=0,a=e.filters;n<a.length;n++){var i=a[n];"string"==typeof i?t.push(i):t.push(I.e[i])}var r=t.join(","),o={};return r&&(o[m.n.typeFiltersKey]=r),o},t.prototype.getUsersFilter=function(e){var t=e[m.n.userFiltersKey];return t&&t.split(";#")},t.prototype.saveUsersFilter=function(e){var t={};return t[m.n.userFiltersKey]=e&&e.join(";#"),t},t.prototype.getDateDurationFilter=function(e){return e[m.n.dateFilterKey]},t.prototype.saveDateDurationFilter=function(e){var t={},n="string"==typeof e?e:x.e[e];return t[m.n.dateFilterKey]=n,t},t.prototype.getOwnerId=function(){return""},t.prototype.getRootUrl=function(){return this._pageContext&&this._pageContext.listUrl||"/"},t.prototype.getSharedByUrl=function(e,t,n){return""},t.prototype.getExternalUrl=function(e){return"/externalredirector?alias="+u[e]},t.prototype.getAppSubfolder=function(){return"odb"},t.prototype.getUploadStorageUrl=function(e,t){return""},t.prototype.getTaggingOptionsUrl=function(){return""},t.prototype.getAllPhotosForPlaceUrl=function(e,t){return""},t.prototype.getSearchFilterQueryUrl=function(e){return""},t.prototype.isSearchFilterApplied=function(e){return!1},t.prototype.isSearchPassThrough=function(){return!1},t.prototype.getItemHintRedirectViewParams=function(e){return e},t.prototype.getDefaultClickUrl=function(e,t){var n,a=this;if(void 0===t&&(t={}),!e||!e.key)return"";var r=t.viewParams,o=void 0===r?this._navigation.viewParams:r,s=t.urlType,d=t.itemSet,l=t.parentItem,u=t.page,f=void 0===u?this.getPageType(o):u,p={},h=this._itemUrlHelper.getItemUrlParts(e.key),b=this._itemUrlHelper.getUrlParts({path:o[m.n.idParamKey],listUrl:o[m.n.listUrlKey]}),g=h.fullListUrl!==b.fullListUrl;if(!U.e.isActivated("EDCD3724-11E2-4CD4-A7E2-607D9D0B8440","10/26/2021","Copy view params")&&(U.e.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")||!g))for(var v=0,y=Object.keys(o);v<y.length;v++){var S=y[v];(m.a.test(S)||S===m.n.viewIdKey||S===m.n.sortFieldKey||S===m.n.groupByKey)&&(p[S]=o[S])}!Object(T.O)()&&this._isSearchView(o)&&(p=Object(i.__assign)(Object(i.__assign)({},p),this._getAdditionalSearchFilterParams(o))),t.additionalViewParams&&Object(B.e)(p,t.additionalViewParams);var D=Object(T.g)(o);if(D){var I=null===(n=D.remoteSpItem)||void 0===n?void 0:n.webAbsoluteUrl;I&&h.fullWebUrl===I&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:c.t(Object(i.__assign)(Object(i.__assign)({},c.e(e.key)),Object(T.A)(D)))}))}var x,C=this._getItemQueryParams(e.key,{viewParams:o}),O=d&&d.item.peek();x=l||O&&O.key!==e.key&&O||e.UNSAFE_parent,!Object(T.O)()&&p&&Object(B.e)(C,p);var w=Object(_.e)(e)?this.getOpenInOfficeOnlineUrl(e,o,{}):void 0,E={itemKey:e.key,viewParams:o,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,useOneUpTextEditor:this._useOneUpTextEditor,isDocSet:e.isDocSet,listId:this._listContext()&&this._listContext().listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemOpenInOfficeOnlineUrl:w,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:e.subsite,itemExtension:e.extension,itemFSObjType:e.properties&&e.properties.FSObjType,itemTranslationLanguages:e.properties&&e.properties._SPTranslatedLanguages,isUnifiedAppSupportedFile:Object(_.e)(e),welcomePageCustomized:e.properties&&e.properties.WelcomePageCustomized,getMediaUrl:function(){return a._getMediaUrl(e,{params:C,parentItem:x,page:f,isSearch:a._isSearchView(o)})},parentItemKey:x&&x.key,parentItemLink:e.parentLink,supportsOneUp:this._supportsOneUp,urlType:s,defaultRootItemId:this.getDefaultRootItemId(),additionalViewParams:p,page:f};return this._getDefaultClickUrl(E)},t.prototype.getTagUrl=function(e){return""},t.prototype.getRecycleBinQueryUrl=function(){return"".concat(this._pageContext.webAbsoluteUrl,"/").concat(this._pageContext.layoutsUrl,"/AdminRecycleBin.aspx?mysite=1")},t.prototype.getRecentQueryUrl=function(){return this.getQueryUrl(this.getPageType(),o.e.Recent)},t.prototype.getDateTimeControlIframeUrl=function(){return"".concat(Object(S.s)(this._pageContext),"/").concat(this._pageContext.layoutsUrl,"/iframe.aspx")},t.prototype.getNewFormRichTextEditorIFrameUrl=function(e,t,n){var a=t?"&ContentTypeId="+t:"",i=n?this.getKeyParams(n)[m.n.idParamKey]:this._navigation.viewParams.RootFolder,r=i?"&RootFolder="+D.e.encodeURIComponent(i):"";return"".concat(this._listContext().listUrl,"/NewForm.aspx?OnlyIncludeOneField=").concat(e)+"&ClientFormOverwriteSave=1&IsDlg=1".concat(a).concat(r)},t.prototype.getEditFormRichTextEditorIFrameUrl=function(e,t,n){var a=n?this.getKeyParams(n)[m.n.idParamKey]:this._navigation.viewParams.RootFolder,i=a?"&RootFolder="+D.e.encodeURIComponent(a):"";return"".concat(this._listContext().listUrl,"/EditForm.aspx?OnlyIncludeOneField=").concat(e)+"&ID=".concat(t,"&IsDlg=1").concat(i)},t.prototype.getEditFormUrl=function(e){return this._getListItemFormUrl(this._listContext().editFormUrl,e)},t.prototype.getDisplayFormUrl=function(e){return this._getListItemFormUrl(this._listContext().displayFormUrl,e)},t.prototype.getOneDriveAppsUrl=function(){return"https://www.onedrive.com/download"},t.prototype.handleFatalErrorDuringViewLoad=function(){},t.prototype.getAutoActionType=function(e){return v.t.none},t.prototype.getPhotoType=function(e){return null},t.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return E.e(t.fullItemUrl)},t.prototype.qualifyUrl=function(e){var t;if(0===e.indexOf("#")){var n=e.substring(1);t="".concat(this.getCurrentPageBaseUrl()).concat(window.location.pathname).concat(n?"?".concat(n):"")}else t=e;return t},t.prototype.getNavLinkClickUrl=function(e){return""},t.prototype.getApiName=function(){return"Vroom"},t.prototype.getApiBaseUrl=function(e){return this._urlDataSourceLite.getApiBaseUrl(e)},t.prototype.getSearchByDateFilterQueryUrl=function(e){return""},t.prototype.isSearchByDateFilterApplied=function(e){return!1},t.prototype.getResourcePreloadUrl=function(){return""},t.prototype.getHipCheckUrl=function(){return""},t.prototype.getVerifyAccountUrl=function(){return""},t.prototype.getCurrentPageBaseUrl=function(){return Object(T.t)()},t.prototype.getCurrentSiteUrl=function(){return this._pageContext.webAbsoluteUrl},t.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.useDefaultAction,r=void 0!==i&&i,o=A.n(e),s=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return a="ms-word"!==(e.appMap?e.appMap.toLowerCase():void 0)?Object(_.e)(e)?y.e.GetWopiDocEditUrl(o,s&&s.list.id||"",this._pageContext.env):!r&&y.e.GetWopiFrameEditUrl(o):Object(_.e)(e)?!r&&y.e.GetWopiDocEditUrl(o,s&&s.list.id||"",this._pageContext.env):!r&&y.e.GetWopiFrameEditUrl(o),this._ensureLayouts15(a||e.openUrl)},t.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a=e.appMap,i=e.properties&&e.properties.path||this.getItemUrl(e.key),r=e.extension||"",s=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(r.toLowerCase()),c=e.queryType===o.e.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap),d=p.e.hasItemPermission(e,p.e.editListItems)&&!s&&(!g.e(e)||g.n(e,this._pageContext.userId))||c;return b.e(a,i,d?b.t.Edit:b.t.View,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getOpenTemplateInOfficeClientUrl=function(e,t){return b.e(e,t,b.t.Edit,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getNewInOfficeClientUrl=function(e,t,n){return b.e(e,t,b.t.New,n,this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)},t.prototype.getNewPlaceholderItemKey=function(){var e;return c.t(((e={})[m.n.idParamKey]="placeHolder ".concat(t.placeholderId++),e))},t.prototype.getWACResourcesPreloadUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/wopihiddenframe.aspx")},t.prototype.getWopiDocUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/doc.aspx")},t.prototype.getMyRestorePageUrl=function(){var e=this;return this.resources.consumeAsync(l.ve).then(function(e){return e.getMyOneDriveUrl()}).then(function(t){return"".concat(t,"/").concat(e.getLayoutsUrl(),"/onedrive.aspx?p=").concat(s.e.Restore)})},t.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams,i=this._getItemQueryParams(e.key,{viewParams:a}),r=n||e.UNSAFE_parent,o=c.e(r&&r.key||""),d=o[m.n.idParamKey];if("root"===d){var l=c.e(e.key)[m.n.listUrlKey];l&&(d=l)}i[m.n.parentIdParamKey]=d,i[m.n.parentQueryTypeParamKey]=o[m.n.queryTypeParamKey],i[m.n.pageParamKey]=s.e.TextFileEditor,delete i[m.n.queryTypeParamKey];var u="";return!this._supportsOneUp&&e.parentLink?(delete i[m.n.parentQueryTypeParamKey],u=e.parentLink,"".concat(e.parentLink,"?").concat(c.t(i,null,!0))):(Number(a[m.n.pageParamKey])!==s.e.TextFileEditor&&(u=this.getCurrentPageBaseUrl()+window.location.pathname),"".concat(u).concat(u?"?":"#").concat(c.t(i,null,!0)))},t.prototype.getClipchampUrl=function(e){var t=this._pageContext.webAbsoluteUrl,n="".concat(t,"/_layouts/15/videoeditor.aspx?action=edit");if(!e)return n;var a=this._itemUrlHelper.getItemUrlParts(e.key);return"".concat(n,"&id=").concat(a.serverRelativeItemUrl)},t.prototype.getNewClipchampUrl=function(e){var t=this._pageContext.webAbsoluteUrl,n="".concat(t,"/_layouts/15/videoeditor.aspx?action=create");if(!e)return n;var a=this._itemUrlHelper.getItemUrlParts(e.key);return"".concat(n,"&id=").concat(a.serverRelativeItemUrl)},t.prototype.getClipchampVideoEditorUrl=function(e,t){var n=this._pageContext.webAbsoluteUrl,a="".concat(n,"/_layouts/15/videoeditor.aspx?action=create");if(!t||!e)return a;var i=e.graph.driveId,r=e.graph.itemId,o=this._itemUrlHelper.getItemUrlParts(e.parentKey),s=this._itemUrlHelper.getItemUrlParts(t.key);return"".concat(a,"&videoDriveId=").concat(i,"&videoItemId=").concat(r,"&videoParentId=").concat(o.serverRelativeItemUrl,"&id=").concat(s.serverRelativeItemUrl)},t.prototype.getCanonicalUrl=function(e){return this.getItemUrl(e)},t.prototype.getLayoutsUrl=function(){return this._pageContext.layoutsUrl},t.prototype._listContext=function(){var e=this.resources.consume(d.o);return this._listContext=function(){return e},e},t.prototype.getWebUrl=function(){return this._pageContext.webAbsoluteUrl},t.prototype._getListItemFormUrl=function(e,t){if(!this._listContext().listUrl||!e)return"";var n,a,i;t&&t.properties&&(n=t.properties.ID,a=t.properties.ContentTypeId,i=this.getKeyParams(t.parentKey)[m.n.idParamKey]);var r={Source:D.e.encodeURIComponent(window.location.href),RootFolder:D.e.encodeURIComponent(i||this._listContext().folderPath)};n&&(r[m.n.listItemIdKey]=n),a&&(r[m.n.contentTypeId]=a);var o=new f.t(e);for(var s in r)r.hasOwnProperty(s)&&o.setQueryParameter(s,r[s]);return o.toString()},t.prototype._ensureLayouts15=function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e},t.prototype._getItemQueryParams=function(e,t){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,r=(t.currentViewId,c.e(e));delete r[m.n.uniqueParamKey];var s=Object(i.__assign)({},a);return delete s[m.n.idParamKey],delete s[m.n.rootFolderParamKey],delete s[m.n.queryTypeParamKey],delete s[m.n.queryParamKey],delete s[m.n.listUrlKey],delete s[m.n.typeFiltersKey],Object(T.O)()||(delete s[m.n.dateFilterKey],delete s[m.n.userFiltersKey]),delete s[m.n.remoteItem],Object(B.e)(s,r),delete s[m.n.parentIdParamKey],delete s[m.n.parentQueryTypeParamKey],delete s[m.n.pageParamKey],r[m.n.idParamKey]===this.getDefaultRootItemId()&&(delete s[m.n.idParamKey],delete s[m.n.rootFolderParamKey]),s[m.n.listUrlKey]===a[m.n.listUrlKey]&&this.getQueryType(r)===o.e.Files&&(this._pageContext.viewId||"").replace("{","").replace("}","")!==s[m.n.viewIdKey]||delete s[m.n.viewIdKey],s[m.n.newTargetListUrlKey]===this._pageContext.listUrl&&(delete s[m.n.newTargetListUrlKey],delete s[m.n.viewPathKey]),delete s[m.n.metadataSearchIdKey],s},t.prototype._getMediaUrl=function(e,t){var n,a=t.params,r=void 0===a?{}:a,d=Object(i.__rest)(r,[]),l=t.itemSet,u=t.parentItem,f=t.page,p=t.isSearch;if(!this._supportsOneUp){var _=this._itemUrlHelper.getItemUrlParts(e.key),h=_.serverRelativeItemUrl,b=((n={})[m.n.idParamKey]=h,n[m.n.parentIdParamKey]=h.substring(0,h.lastIndexOf("/")),n);return"".concat(_.fullListUrl,"?").concat(c.t(b,null))}var g=u||(l?l.item.peek():e.UNSAFE_parent);if(!g)return"";var v=g&&g.key||"",y=c.e(v);for(var S in d[m.n.parentIdParamKey]=y[m.n.idParamKey],!Object(T.O)()&&p?(delete d[m.n.queryTypeParamKey],d[m.n.parentQueryTypeParamKey]=o.e.Search):d[m.n.parentQueryTypeParamKey]=y[m.n.queryTypeParamKey],delete y[m.n.idParamKey],delete y[m.n.queryTypeParamKey],delete y[m.n.uniqueParamKey],d){var D=d[S];(null==D||""===D&&S.indexOf("FilterValue")<0)&&delete d[S]}return!U.e.isActivated("AB4098F9-F6D7-4E52-B8EE-AE705A509AE3","2/2/2021","Stay in current page for OneUp")&&f&&f!==s.e.Files&&(d[m.n.pageParamKey]=f),"#"+c.t(d,y,!1)},t.prototype._getAdditionalSearchFilterParams=function(e){for(var t={},n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];(m.a.test(i)||i===m.n.dateFilterKey||i===m.n.typeFiltersKey||i===m.n.userFiltersKey||i===m.n.metadataSearchIdKey||i===m.n.queryParamKey)&&(t[i]=e[i])}return t[m.n.queryTypeParamKey]=o.e.Search,t},t.prototype._isSearchView=function(e){return this.getQueryType(e)===o.e.Search},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.default.dependencies),{navigation:O.e,platform:w.e,pageContext:d.f,itemUrlHelper:C.c,itemParentHelper:M.e,useOneUpTextEditor:j,supportsOneUp:V,urlDataSourceLite:P.resourceKey,getDefaultClickUrl:F.e}),t.placeholderId=0,t}(r.default),G=(t.default=z,Object(k.r)("UrlDataSource",z))},,,,,,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=n("knockout-lib"),r=n(1214),o=n(3727),s=function(e){function t(t){var n=e.call(this,t)||this;return n._itemSet=t.itemSet,n._itemsStore=t.itemsStore,n._spotlightDataSource=t.spotlightDataSource,n._cacheUpdatesObservable=n._spotlightDataSource.getCacheUpdatesObservable(),n._spotlightItems=i.observable([]),n._spotlightChangedTextObservable=i.observable(""),n._spotlightChangedTextObservable.extend({notify:"always"}),n._currentView=t.currentView,n.createComputed(n._updateSpotlightItemsOnItemSetChange),n}return Object(a.__extends)(t,e),t.prototype.editSpotlight=function(e){var t=this;return this._preemptSpotlightChange(e),this._spotlightDataSource.editSpotlight(e).then(function(n){return t._handleEditSpotlightResult(e,n)},function(n){var a={resultEnum:o.e.UnknownServerResult,order:null};return t._handleEditSpotlightResult(e,a)})},t.prototype.getSpotlightItems=function(){return this._spotlightItems},t.prototype.getSpotlightChangedTextObservable=function(){return this._spotlightChangedTextObservable},t.prototype._updateSpotlightItemInfo=function(e,t){var n=[];if(e.viewId){if(t.length>0){var a={};a[e.item.properties.ID]=e.item.key;for(var i=this._spotlightItems.peek(),r=null,o=0;o<i.length;o++){var s=i[o].peek();a[s.properties.ID]||(a[s.properties.ID]=s.key)}for(o=0;o<t.length;o++)a[t[o]]&&(r=this._itemsStore.getItem(a[t[o]]))&&n.push(r)}this._spotlightDataSource.cacheSpotlightItems(this._itemSet.peek().item,e.viewId,n)}},t.prototype._handleEditSpotlightResult=function(e,t){var n=!1;t.order?(this._updateSpotlightItemInfo(e,t.order),n=!0):this._updateSpotlightItemsOnItemSetChange();var a=t.resultEnum;return a!==o.e.Success||n?a:o.e.UnknownServerResult},t.prototype._updateSpotlightItemsOnItemSetChange=function(){this._cacheUpdatesObservable();var e=this._currentView(),t=this._itemSet().item().key;if(e){var n=this._spotlightDataSource.getSpotlightItems(t,e.id),a=this._spotlightItems.peek();if(n)if(a){if(n.length!==a.length)this._spotlightItems(n);else for(var i=0;i<n.length;i++)if(n[i].peek().key!==a[i].peek().key)return void this._spotlightItems(n)}else this._spotlightItems(n);else a&&!a.length||this._spotlightItems([])}},t.prototype._preemptSpotlightChange=function(e){if(e.item.UNSAFE_parent){var t=this._itemsStore.getItem(e.item.UNSAFE_parent.key);if(t){var n=[],a=this._spotlightDataSource.getSpotlightItems(t.peek().key,e.viewId)||[],i=e.item.properties.ID,r=!1,o=e.isAdd?this._itemsStore.getItem(e.item.key):null,s=o&&e.afterItem?e.afterItem.key:null;o&&!s&&(n.push(o),r=!0);for(var c=0;c<a.length;c++)a[c].peek().properties.ID!==i&&n.push(a[c]),o&&!r&&a[c].peek().key===s&&(n.push(o),r=!0);o&&!r&&n.unshift(o),n.length<=3&&this._spotlightDataSource.cacheSpotlightItems(t,e.viewId,n)}}},t}(r.default);t.e=s},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return m}),n.d(t,"n",function(){return _}),n.d(t,"e",function(){return h});var a,i,r,o=n(0),s=n(25),c=n(248),d=n(485),l=n(183),u=n(255),f={details:"details",compactDetails:"compactDetails",tiles:"tiles"},p=((a={})[f.details]=l.t,a[f.compactDetails]=l.e,a[f.tiles]=u.e,a),m=Object(o.__assign)(Object(o.__assign)({},f),{kanban:"kanban",calendarMonth:"month",calendarWeek:"week",playlistPlayback:"playlistPlayback"}),_=((i={})[s.n.standard]=[m.details,m.tiles],i[s.n.tiles]=[m.details,m.tiles],i[s.n.compactList]=[m.compactDetails,m.tiles],i[s.n.kanban]=[m.kanban],i[s.n.modernCalendar]=[m.calendarMonth,m.calendarWeek],i[s.n.playlistPlayback]=[m.playlistPlayback],i),h=Object(o.__assign)(Object(o.__assign)({},p),((r={})[m.kanban]=d.e,r[m.calendarWeek]=c.t,r[m.calendarMonth]=c.e,r))}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"HubLeftNavHandler.key",loader:new i.t(function(){return n.e(710).then(n.bind(null,5286)).then(function(e){return e.typeResourceKey.local})})})},function(e,t,n){"use strict";var a="__ResourceComponentLoader$componentName",i="__ResourceComponentLoader$componentId",r="__ResourceComponentLoader$childComponents",o="__ResourceComponentLoader$parentComponentViewModel",s="__ResourceComponentLoader$componentBindingElement",c=0,d=function(){function e(e){var t=this._viewModel=e.viewModel,n=t[i]="".concat(++c);t[s]=e.element,t[r]={},t[a]=e.name;for(var d=e.bindingContext;d&&(!d.$data||d.$data===t||!d.$data[r]);)d=d.$parentContext;if(d){var l=this._parentViewModel=d.$data;l[r][n]=t,t[o]=l}}return e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e[i],c=t&&t[r];n&&c&&delete c[n],e&&(delete e[o],delete e[r],delete e[s],delete e[a])},e}();t.e=d},function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(4766),r=n(265),o=n(14),s=n(9),c=n(93),d=n(136),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getAppSubfolder=function(e){return e?"odb":"splist"},t.prototype.getDefaultClickUrl=function(t,n){return void 0===n&&(n={}),t?Object(o.r)(this._listContext().listTemplateType)&&t.type===r.e.File?this.getDisplayFormUrl(t):e.prototype.getDefaultClickUrl.call(this,t,n):""},t.prototype.getRecycleBinQueryUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/RecycleBin.aspx")},t.prototype.getUriWithAdjustForCurrentRootFolder=function(e){var t=new c.t(e),n=this.getCurrentItemKey();if(n){var a=this.getKeyParams(n)[s.n.idParamKey];t.setQueryParameter("RootFolder",a)}return t},t.prototype.getNewFormUrl=function(t){var n=e.prototype._getListItemFormUrl.call(this,this._listContext().newFormUrl),a=this.getUriWithAdjustForCurrentRootFolder(n);return t&&a.setQueryParameter("ContentTypeId",t),a.toString()},t.prototype.getQuickLaunchSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/quiklnch.aspx")},t.prototype.getAreaNavigationSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/AreaNavigationSettings.aspx")},t.prototype.getTopNavSettingsUrl=function(){return"".concat(this.getWebUrl(),"/").concat(this.getLayoutsUrl(),"/topnav.aspx")},t.prototype.getWACResourcesPreloadUrl=function(){return e.prototype.getWACResourcesPreloadUrl.call(this)},t.prototype.getWopiDocUrl=function(){return e.prototype.getWopiDocUrl.call(this)},t.prototype.getSitePagesUrl=function(){return"".concat(this.getWebUrl(),"/SitePages/Forms/AllPages.aspx")},t.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},t.prototype.getNavLinkClickUrl=function(e){return this._urlDataSourceLite.getNavLinkClickUrl(e)},t}(i.default);t.e=l;var u=Object(d.r)("UrlDataSource",l)},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(40);function i(e){return!!(e&&e.openUrl&&e.appMap)}function r(e){var t=function(e,t){var n=e.appMap?e.appMap.toLowerCase():void 0;return"ms-powerpoint"===n||"ms-word"===n||"ms-visio"===n||"ms-excel"===n||!1}(e);return t&&i(e)&&!Object(a.isFeatureEnabled)(a.EnablePdfCoversionForAllTypes)}new Set(["WacFailed.DocumentIsIRMProtected","WacFailed.5243086","WacFailed.5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"])},,function(e,t,n){"use strict";var a=n(0),i=n(2203),r=n("knockout-lib"),o=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n._getComponentBindingContext(),o=i.$parentContext;return function(e){return"function"==typeof e}(a)?a({bindingContext:o,templateNodes:n.bindingContext.$componentTemplateNodes}):(r.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:i}),n.element),n.controlsDescendantBindings=!0),n}return Object(a.__extends)(t,e),t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t},t.supportsVirtualElements=!0,t}(i.t);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(46),i=n(463);function r(){return Object(i.e)({eventName:"OnePlayerAndECSLogExposure,",shortEventName:"OnePlayerAndECSLogExposure"},{experimentId:{isPrefixingDisabled:!0,type:a.e.Number},variant:{isPrefixingDisabled:!0,type:a.e.Number},isAATest:{isPrefixingDisabled:!0,type:a.e.Boolean},isOverride:{isPrefixingDisabled:!0,type:a.e.Boolean},correlationId:{isPrefixingDisabled:!0,type:a.e.String},cloudType:{isPrefixingDisabled:!0,type:a.e.String}})}function o(e,t){e.logData(t)}},function(e,t,n){"use strict";var a=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1},e}();t.e=a},,,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(226),r=n(16),o=n(189),s=n(897),c=n(329);function d(e,t,n,d){return function(l){var u;d.refreshClientForm=!0,t&&t.listUrl&&d.listId&&t.listId&&d.listId.toUpperCase()===t.listId.toUpperCase()?(i.e(e,t),n&&l(Object(o.e)({items:(u={},u[r.c]=Object(a.__assign)({},r.f.pack({itemKey:n})),u)}))):(e.listUrl=d.listUrl,e.listId=d.listId,e.listTitle=d.listTitle,e.listBaseTemplate=d.listTemplateType),Object(s.n)(void 0,{listId:Object(c.i)(d.listId)}),e.serverRequestPath=void 0}}},,,function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(226),o=n(472),s=n(345),c=function(e){function t(t,n){var a=e.call(this,void 0,n)||this;a._pageContext=t||a.resources.consume(s.e);var i=null==n?void 0:n.dataRequestorType;return a._makeDataRequestor=i?function(e){return new i(e)}:function(e){return new o.e(e,{pageContext:a._pageContext})},a.dataRequestor=a._makeDataRequestor({qosName:a.getDataSourceName()}),a}return Object(a.__extends)(t,e),t.prototype.getDataSourceName=function(){return"DataSource"},t.prototype.updateContext=function(e){r.e(this._pageContext,e),this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{dataRequestorType:o.n}),t}(i.default);t.e=c},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Uninitialized:0,Direct:1,OrganizationView:2,OrganizationEdit:3,AnonymousView:4,AnonymousEdit:5,Flexible:6}},function(e,t,n){"use strict";var a=n(859),i=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,r=i.isFolder,o=i.isListSharing,s=i.itemUrl,c=i.listId,d=i.listItemId,l=i.listUrl,u=i.resourceId,f=i.serverRelativeItemUrl,p=i.uniqueId,m=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:m}).method("Lists",c);if(p){if(c)return e.build().webByUrl({webUrl:m}).segment("lists").method("getbyid",c).method("GetItemByUniqueId",p);var _=r?"GetFolderById":"GetFileById",h={guid:p};return e.build().webByUrl({webUrl:m}).method(_,h).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",f):s?e.build().webByUrl({webUrl:m}).method("GetFileByUrl",a.t(s)).segment("ListItemAllFields"):c&&d?e.build().webByUrl({webUrl:m}).method("Lists",c).method("GetItemById",d):e.build().webByUrl({webUrl:m}).method("GetListItemByResourceId",u)}var b;b=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var g=e.build().webByItemUrl(b).method("Lists",n);return t.isRootFolder||(g=t.properties.ID?g.method("GetItemById",t.properties.ID):g.method("GetItemByUniqueId",t.properties.uniqueId)),g},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!(!t||!(e.isRootFolder?e.list&&e.list.id:t.ID||t.uniqueId))},e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){return!t.has(e.loginName)&&(t.add(e.loginName),!0)})}},e}();t.e=i},,function(e,t,n){"use strict";var a=n(0),i=n(3439),r=n(4829),o=n(4833),s=n(4834),c=n(1219);function d(e,t){return r.e(e,function(){return t().then(c.e)})}var l=function(e){function t(){var t=e.call(this)||this;return t.DefaultClickAction=o.e,t.OpenInExplorerAction=s.e,t.OpenInSharePointAction=d("./OpenInSharePointAction",function(){return n.e(310).then(n.bind(null,4605))}),t.EditSmartTemplateAction=d("./EditSmartTemplateAction/EditSmartTemplateAction",function(){return n.e(295).then(n.bind(null,5302))}),t.DeleteSmartTemplateWithProgressAction=d("./deleteSmartTemplate/DeleteSmartTemplateWithProgressAction",function(){return n.e(325).then(n.bind(null,5303))}),t.PublishSmartTemplateWithProgressAction=d("./publishSmartTemplate/PublishSmartTemplateWithProgressAction",function(){return n.e(327).then(n.bind(null,5304))}),t.UnPublishSmartTemplateWithProgressAction=d("./unpublishSmartTemplate/UnpublishSmartTemplateWithProgressAction",function(){return n.e(329).then(n.bind(null,5305))}),t.AddExistingAppViewAction=d("./AddExistingAppViewAction",function(){return n.e(279).then(n.bind(null,4606))}),t.AddToQuickLaunchAction=d("./AddToQuickLaunchAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(280)]).then(n.bind(null,4607))}),t.AddToSpotlightAction=d("./AddToSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(281)]).then(n.bind(null,4608))}),t.ApproveRejectAction=d("./ApproveRejectAction",function(){return n.e(282).then(n.bind(null,4609))}),t.CancelEditAction=d("./CancelEditAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(283)]).then(n.bind(null,3227))}),t.ChangeAppViewVisibilityAction=d("./ChangeAppViewVisibilityAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(284)]).then(n.bind(null,3768))}),t.ClearFilterAction=d("./ClearFilterAction",function(){return n.e(285).then(n.bind(null,4610))}),t.ComplianceDetailsAction=d("./ComplianceDetailsAction",function(){return n.e(286).then(n.bind(null,4611))}),t.CopyFieldAction=d("../CopyFieldAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(773)]).then(n.bind(null,4761))}),t.CopyFormAction=d("../copyForm/CopyFormAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(774)]).then(n.bind(null,4612))}),t.CreateAppViewAction=d("./CreateAppViewAction",function(){return n.e(287).then(n.bind(null,3769))}),t.CreateColumnAction=d("./CreateColumnAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(775)]).then(n.bind(null,4613))}),t.CreateItemAction=d("./CreateItemAction",function(){return n.e(288).then(n.bind(null,4614))}),t.CustomClientFormPaneAction=d("../customClientFormPane/CustomClientFormPaneAction",function(){return n.e(776).then(n.bind(null,4615))}),t.CustomizeClientFormAction=d("../customizeClientForm/CustomizeClientFormAction",function(){return n.e(777).then(n.bind(null,4616))}),t.CustomizeFormsNavigationAction=d("./CustomizeFormsNavigationAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(778)]).then(n.bind(null,4789))}),t.CustomizeViewAction=d("./CustomizeViewAction",function(){return n.e(289).then(n.bind(null,4617))}),t.DeleteViewAction=d("./DeleteViewAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(292)]).then(n.bind(null,3770))}),t.DeleteTemplateAction=d("./DeleteTemplateAction",function(){return n.e(290).then(n.bind(null,4618))}),t.EditItemAction=d("./EditItemAction",function(){return n.e(780).then(n.bind(null,3413))}),t.EditItemCancelAction=d("./EditItemCancelAction",function(){return n.e(781).then(n.bind(null,4619))}),t.EditItemSaveAction=d("./EditItemSaveAction",function(){return n.e(782).then(n.bind(null,4620))}),t.EditNewAppViewAction=d("./EditNewAppViewAction",function(){return n.e(293).then(n.bind(null,3771))}),t.EditNewMenuAction=d("../editNewMenu/EditNewMenuAction",function(){return n.e(136).then(n.bind(null,4621))}),t.EditNewMenuPaneAction=d("../editNewMenu/EditNewMenuPaneAction",function(){return n.e(137).then(n.bind(null,4622))}),t.EditRenditionsAction=d("./EditRenditionsAction",function(){return n.e(294).then(n.bind(null,4623))}),t.ExportListAction=d("./ExportListAction",function(){return n.e(297).then(n.bind(null,4624))}),t.FilterAction=d("./FilterAction",function(){return n.e(298).then(n.bind(null,4625))}),t.InvokeFirstRunExperienceAction=d("./InvokeFirstRunExperienceAction",function(){return n.e(300).then(n.bind(null,4626))}),t.LaunchApprovalDetailsDialogAction=d("../launchHubSettingsPanel/LaunchApprovalDetailsDialogAction",function(){return n.e(199).then(n.bind(null,5306))}),t.LaunchChangeTheLookPanelAction=d("../launchChangeTheLookPanel/LaunchChangeTheLookPanelAction",function(){return n.e(201).then(n.bind(null,4627))}),t.LaunchCreateAppViewPanelAction=d("./LaunchCreateAppViewPanelAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(301)]).then(n.bind(null,4749))}),t.LaunchColumnCustomizationPaneAction=d("./LaunchColumnCustomizationPaneAction",function(){return Promise.all([n.e("deferred"),n.e(783)]).then(n.bind(null,3590))}),t.LaunchFilterPanelAction=d("./LaunchFilterPanelAction",function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(302)]).then(n.bind(null,4628))}),t.LaunchFormatViewPaneAction=d("./LaunchFormatViewPaneAction",function(){return n.e(303).then(n.bind(null,4629))}),t.LaunchGroupMembershipPanelAction=d("../launchGroupMembershipPanel/LaunchGroupMembershipPanelAction",function(){return n.e(208).then(n.bind(null,4630))}),t.LaunchHubSettingsPanelAction=d("../launchHubSettingsPanel/LaunchHubSettingsPanelAction",function(){return n.e(212).then(n.bind(null,4631))}),t.LaunchListFormAction=d("../launchListForm/LaunchListFormAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(786)]).then(n.bind(null,4632))}),t.LaunchDocLibSettingPanelAction=d("../launchDocLibSettingPanel/LaunchDocLibSettingPanelAction",function(){return n.e(204).then(n.bind(null,5309))}),t.LaunchSitePermissionsPanelAction=d("../launchSitePermissionsPanel/LaunchSitePermissionsPanelAction",function(){return n.e(217).then(n.bind(null,4633))}),t.LaunchSiteSettingsPanelAction=d("../launchSiteSettingsPanel/LaunchSiteSettingsPanelAction",function(){return n.e(219).then(n.bind(null,4634))}),t.LaunchGlobalNavSettingsPanelAction=d("../launchGlobalNavSettingsPanel/LaunchGlobalNavSettingsPanelAction",function(){return n.e(206).then(n.bind(null,4635))}),t.LaunchWebTemplatesGalleryAction=d("../launchWebTemplatesGallery/LaunchWebTemplatesGalleryAction",function(){return n.e(225).then(n.bind(null,4636))}),t.LaunchVivaConnectionsSettingsPanelAction=d("../launchVivaConnectionsSettingsPanel/LaunchVivaConnectionsSettingsPanelAction",function(){return n.e(223).then(n.bind(null,4637))}),t.ListFormActivityPaneToggleAction=d("./ListFormActivityPaneToggleAction",function(){return n.e(788).then(n.bind(null,4638))}),t.MakeHomepageAction=d("./MakeHomepageAction",function(){return n.e(304).then(n.bind(null,4639))}),t.ModifyColumnAction=d("./ModifyColumnAction",function(){return n.e(305).then(n.bind(null,2739))}),t.ModifyShowInFiltersPaneAction=d("./ModifyShowInFiltersPaneAction",function(){return n.e(789).then(n.bind(null,4640))}),t.MoveLeftSpotlightAction=d("./MoveLeftSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(306)]).then(n.bind(null,4641))}),t.MoveRightSpotlightAction=d("./MoveRightSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(307)]).then(n.bind(null,4642))}),t.OpenHyperlinkAction=d("./OpenHyperlinkAction",function(){return n.e(309).then(n.bind(null,4643))}),t.OpenNeedsAttentionViewAction=d("./OpenNeedsAttentionViewAction",function(){return n.e(312).then(n.bind(null,4644))}),t.PublishAction=d("./PublishAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(313)]).then(n.bind(null,4762))}),t.RemoveFromSpotlightAction=d("./RemoveFromSpotlightAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(314)]).then(n.bind(null,4645))}),t.RenameColumnAction=d("./RenameColumnAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(793)]).then(n.bind(null,4646))}),t.SaveViewAction=d("./SaveViewAction",function(){return n.e(315).then(n.bind(null,2740))}),t.SeeAllAppsAction=d("./SeeAllAppsAction",function(){return n.e(316).then(n.bind(null,4647))}),t.SetUpApprovalFlowAction=d("../flow/SetUpApprovalFlowAction",function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(144)]).then(n.bind(null,4790))}),t.SetDefaultViewAction=d("./SetDefaultViewAction",function(){return n.e(317).then(n.bind(null,4648))}),t.ShowFiltersAction=d("./ShowFiltersAction",function(){return n.e(886).then(n.bind(null,4649))}),t.SwitchViewAction=d("./SwitchViewAction",function(){return n.e(318).then(n.bind(null,3774))}),t.SynchronizeAppViewAction=d("./SynchronizeAppViewAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(319)]).then(n.bind(null,4650))}),t.ToggleAction=d("./ToggleAction",function(){return n.e(320).then(n.bind(null,3970))}),t.TriggerSignoffFlowAction=d("../flow/TriggerSignoffFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(152)]).then(n.bind(null,4791))}),t.TriggerExtractFileMetadataFlowAction=d("../flow/TriggerExtractFileMetadataFlowAction",function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(147)]).then(n.bind(null,4651))}),t.UnPublishAction=d("./UnPublishAction",function(){return n.e(321).then(n.bind(null,4652))}),t.UploadAction=d("./UploadAction",function(){return n.e(887).then(n.bind(null,3775))}),t.UploadTemplateAction=d("./UploadTemplateAction",function(){return n.e(322).then(n.bind(null,4653))}),t.ViewItemAction=d("./ViewItemAction",function(){return n.e(323).then(n.bind(null,4654))}),t.WorkflowAction=d("./WorkflowAction",function(){return n.e(796).then(n.bind(null,4655))}),t.ShowVersionHistoryAction=d("../odb/ShowVersionHistoryAction",function(){return n.e(243).then(n.bind(null,3776))}),t.OpenChatAction=d("./OpenChatAction",function(){return n.e(308).then(n.bind(null,5310))}),t}return Object(a.__extends)(t,e),t}(i.e);t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(2213),r=n(65),o=n(601),s=n(2430),c=n(435),d=function(e){function t(t){var n=this,a=t.load,i=t.actionParams,s=(n=e.call(this,i)||this).resources.consume(c.e.optional);n.isQosLogged=!1,n.name="Deferred".concat(t.modulePath).replace(/Action|\.|\//g,""),n._action=n.createObservable();var d=new o.e;return(s?s.waitForPLT().then(a):r.n.resolve(a())).done(function(e){return d.complete(e)},function(e){return d.error(e)}),n._getActionPromise=n.trackPromise(d.getPromise().then(function(e){return new(n.managed(e))(i)})),n._getActionPromise.done(function(e){return n._action(e)}),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()},t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()},t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})},t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():s.e.none},t}(i.e);function l(e,t){var n;function i(){return n||(n=t())}return function(t){function n(n){return t.call(this,{load:i,modulePath:e,actionParams:n})||this}return Object(a.__extends)(n,t),n}(d)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"".concat("SharedRecentEvents.key",".sharedRecentEvents"),loader:new i.t(function(){return n.e(543).then(n.bind(null,5312)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a=n(0),i=n(1214),r=n(9),o=n(14),s=n(146),c=n(181),d=n(2220),l=n(151),u=n(507),f=n(100),p=n(213),m=n(2221),_=n(12),h=function(e){function t(t){var n=e.call(this,t)||this;return n._navigation=n.resources.consume(s.e),n._platformDetection=n.resources.consume(c.e),n._urlDataSource=n.resources.consume(f.ue),n._selectionHelper=new(n.child(m.e))({canFallback:!1,allowMultiSelect:!0}),n._currentItem=n._selectionHelper.currentItem,n._itemParentHelper=n.resources.consume(d.e),n._itemUrlHelper=n.resources.consume(l.c),n}return Object(a.__extends)(t,e),t.prototype.canOpenInExplorer=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem(),"list"));return!!e&&!!e.list.isDocumentLibrary&&e.list.templateType!==o.n.webPageLibrary&&e.itemStatus!==p.t.ConditionalAccessBlocked&&e.itemStatus!==p.t.ConditionalAccessViewOnly&&this._platformDetection.isIE},t.prototype.navigateToClassic=function(){var e=this._currentItem.peek(),t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=this._urlDataSource.getKeyParams(e.key)[r.n.idParamKey],a=this._itemUrlHelper.getItemUrlParts(t.key),i={ExplorerWindowUrl:n};_.e.isActivated("5924661A-1CC2-43BB-B508-25B4BEF86C42","10/20/2020","Navigate to the specific folder in case of list view threshold throttling")||(i.rootFolder=n);var o="".concat(a.fullItemUrl,"?").concat(u.t(i));this._navigation.navigateTo({url:o,frameId:"_blank"})},t}(i.default);t.e=h},function(e,t,n){"use strict";var a=n(0),i=n(65),r=n(1214),o=n(2403),s=n(2284),c=n(2264),d=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._operationProvider=n.resources.consume(s.resourceKey),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==c.e.expired,isToggled:this._operationProvider.isLocked()}},t}(r.default),l=Object(o.e)({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return i.n.resolve(Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(271)]).then(n.bind(null,5497)))}}},handlerType:d});t.e=l},function(e,t,n){"use strict";var a=n(0),i=n(5118),r=n(100),o=n(320),s=n(265),c=n(14),d=function(e){function t(t){var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(r.ue),n._actionMap=n.resources.consume(o.e),n}return Object(a.__extends)(t,e),t.prototype.onComputeAction=function(){var t=this.item(),n=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return n&&Object(c.r)(n.list.templateType)&&t.type===s.e.File?new(this.managed(this._actionMap.LaunchListFormAction))({type:3,item:t,url:this._urlDataSource.getDefaultClickUrl(t,{})}):e.prototype.onComputeAction.call(this)},t.prototype.onIsAvailable=function(){var t=this.item(),n=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return!(!n||!Object(c.r)(n.list.templateType)&&n.list.templateType!==c.t.customGrid||t.type!==s.e.File)||e.prototype.onIsAvailable.call(this)},t}(i.e);t.e=d},function(e,t,n){"use strict";var a=n(0),i=n(65),r=n(2213),o=n(83),s=n(4831),c=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OpenInExplorer",n._helper=new(n.managed(s.e)),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){return this.onIsAvailable()?(this._helper.navigateToClassic(),i.n.wrap({resultType:o.e.Success})):i.n.wrap({resultType:o.e.ExpectedFailure})},t.prototype.onIsAvailable=function(){return this._helper.canOpenInExplorer()},t}(r.e);t.e=c},function(e,t,n){"use strict";var a=function(){function e(){}return e.mainContentLoadComplete="SPOApp.mainContentLoadComplete",e.deferredResourcesInitialized="SPOApp.deferredResourcesLoaded",e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(10),i=n(136),r=n(4217);n.d(t,"t",function(){return r.e});var o=new a.t({name:"ListItemsDataSource.key",loader:new i.t(function(){return n.e(806).then(n.bind(null,5474)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"DownloadDataSource.key",loader:new i.t(function(){return n.e(463).then(n.bind(null,5488)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"".concat("MoveCopyDataSource.key",".MoveCopyDataSource"),loader:new i.t(function(){return n.e(475).then(n.bind(null,5502)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a=n(0),i=n(65),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odb/DeferredControls",getModule:function(){return i.n.resolve(n.e(750).then(n.bind(null,5313)))},isLoaded:this.createObservable(!1)},e},t}(n(1214).default);t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(40),i=new(n(10).t)({name:"MoveCopyCapabilities",factory:{dependencies:{},create:function(){return{instance:{supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:Object(a.isFeatureEnabled)(a.CopyCrossSiteFromTeamSite),supportsMoveCrossSite:Object(a.isFeatureEnabled)(a.MoveCrossSite),supportsThrottling:!0,supportsProgressCaching:!0}}}}})},function(e,t,n){"use strict";var a=n(0),i=n(3116),r=n(1214),o=n(181),s="OfflineClientInstalled",c="SharePoint.OfflineClient",d="application/x-sharepoint-webkit",l="macSharePointPlugin",u=function(e){function t(t){var n=e.call(this,t)||this;return n._platform=n.resources.consume(o.e),n}return Object(a.__extends)(t,e),t.IsBrowserPluginInstalled=function(e){var t=navigator.mimeTypes&&navigator.mimeTypes[e];return!!t&&!!t.enabledPlugin},t.prototype.TryUseOfflineClient=function(e,t,n,a,i,r,o){if(this._initOfflineClient()){try{if(!this._isOfflineAllowedByClient(e,t,a,i))return!1;this._offlineClient.TakeOffline(e,t,n,a,i,r,o)}catch(e){return!1}return!0}return!1},t.prototype._isOfflineAllowedByClient=function(e,t,n,a){return this._offlineClient.IsOfflineAllowed(e,t,n,a)},t.prototype._initOfflineClient=function(){try{if(!this._platform.isWindows7)return!1;if(!this._offlineClient)if(-1===document.cookie.indexOf(s))this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(c),i.set(s,"1");else{if("1"!==i.get(s))return!1;this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(c)}if(this._offlineClient&&void 0!==this._offlineClient&&void 0!==this._offlineClient.IsOfflineAllowed&&void 0!==this._offlineClient.TakeOffline)return!0}catch(e){i.set(s,"0"),this._offlineClient=null}return!1},t.prototype._isSupportedMacBrowser=function(){return this._platform.isMac&&(this._platform.isFirefox||this._platform.isSafari||this._platform.isChrome)},t.prototype._createMacPlugin=function(){var e=null;if(this._isSupportedMacBrowser()&&!this._platform.isChrome&&null===(e=document.getElementById(l))&&this._isMacPluginInstalled()){var n;n=this._platform.isSafari&&t.IsBrowserPluginInstalled(d)?d:t.MAC_PLUGIN_MIME_TYPE;var a=document.createElement("object");a.id=l,a.type=n,a.width="0",a.height="0",a.style.visibility="hidden",document.body.appendChild(a),e=document.getElementById(l)}return e},t.prototype._isMacPluginInstalled=function(){var e=t.IsBrowserPluginInstalled(d),n=t.IsBrowserPluginInstalled(t.MAC_PLUGIN_MIME_TYPE);return!(!this._platform.isSafari||!e)||n},t.MAC_PLUGIN_MIME_TYPE="application/x-sharepoint",t}(r.default);t.e=u},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(1214),r=n(146),o=n(136),s=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._navigation=n.navigation,a}return Object(a.__extends)(t,e),t.prototype.updateSort=function(e,t){var n,a=this._navigation,i=((n={}).sortField=e,n.isAscending=t,n);a.updateViewParams(i)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{navigation:r.e}),t}(i.default),c=Object(o.r)("SortManager",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"Error.key",loader:new i.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred"),n.e(354)]).then(n.bind(null,3007)).then(function(e){return e.resourceKey.local})})})},function(e,t,n){"use strict";var a=n(0),i=n(232),r="metadatanavsettings=",o=function(e){function t(){var t=e.call(this,"SmartFiltersStore")||this;return t._filterSectionInfoStoreKeys=[],t}return Object(a.__extends)(t,e),t.prototype.setFilterSectionInfos=function(e){var t=this._getStoreKey(e.parentKey,e.viewId,e.viewParams);-1===this._filterSectionInfoStoreKeys.indexOf(t)&&this._filterSectionInfoStoreKeys.push(t),this.setValue(t,e)},t.prototype.getFilterSectionInfos=function(e,t,n){return this.getValue(this._getStoreKey(e,t,n))},t.prototype.updateFilterSectionInfos=function(e,t,n,a){var i=!1,r=this._getStoreKey(e,t,n),o=this.getValue(r);if(o&&o.sectionInfos){for(var s=0;s<o.sectionInfos.length;s++){var c=a[o.sectionInfos[s].fieldName];c&&(o.sectionInfos[s]=c,i=!0)}this.setValue(r,o)}return i},t.prototype.setMetadataNavigationSettings=function(e,t){var n=r+e;this.setValue(n,t)},t.prototype.getMetadataNavigationSettings=function(e){var t=r+e;return this.getValue(t)},t.prototype.invalidate=function(e){for(var t=0,n=this._filterSectionInfoStoreKeys;t<n.length;t++){var a=n[t],i=this.getValue(a);i&&i.parentKey&&i.parentKey===e&&this.remove(a)}},t.prototype.invalidateAll=function(){for(var e=0,t=this._filterSectionInfoStoreKeys;e<t.length;e++){var n=t[e];this.remove(n)}},t.prototype._getStoreKey=function(e,t,n){return e+t},t}(i.e);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("correlationId")},function(e,t,n){"use strict";function a(e){return e.indexOf("&web=1")>=0||e.indexOf("?web=1")>=0?e:e.indexOf("?")>=0?"".concat(e,"&web=1"):"".concat(e,"?web=1")}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return v});var a=n(0),i=n(172),r=n(15),o=n(1959),s={id:"spListFolder",name:o.t},c={id:"spList",name:o.r},d={id:"spDocLibFolder",name:o.t},l={id:"spDocLib",name:o.i},u={id:"spSiteSite",name:o.o},f={id:"spHubSite",name:o.a},p={id:"spSiteHub",name:o.e},m={id:"spHubHub",name:o.n},_={id:"org",name:o.D},h=[u,p],b=[u],g=[f,m];function v(e,t,n,o,u,f){void 0===o&&(o=i.i.Default),void 0===u&&(u=!1);var p=u?[_]:function(e,t,n,o){var s,c=r.t.isActivated("318eed5c-1325-48a3-8743-35c69f2daf95","10/07/2021","Remove whole org scope option from scoping control when user is guest");switch(e){case i.i.Default:s=t?g:n?h:b;break;case i.i.Site:s=n?h:b;break;case i.i.Hub:s=g;break;case i.i.Tenant:s=[];break;default:throw new Error("Invalid SearchScopeType")}return o&&!c?s:Object(a.__spreadArray)(Object(a.__spreadArray)([],s,!0),[_],!1)}(o,t,n,f);switch(e){case"spListFolder":return[s,c].concat(p);case"spList":return[c].concat(p);case"spDocLibFolder":return[d,l].concat(p);case"spDocLib":return[l].concat(p);default:throw new Error("Invalid scope")}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(9);function i(e){var t=e[a.n.metadataSearchIdKey];if(t){var n=sessionStorage.getItem(t);if(n)return JSON.parse(n)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("TextViewerHelper")},function(e,t,n){"use strict";var a=n(297);Object(a.n)(JSON.parse('[{"rawString":".IFrameDialog_f1ffb820 .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_f1ffb820 iframe{border:none;width:100%}"},{"rawString":".librariesDropdown_5d61535c{font-size:16px;display:inline-flex;outline:transparent;background-color:"},{"theme":"themeLighter","defaultValue":"#deecf9"},{"rawString":";color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border:none;border-radius:2px;padding-top:4px;padding-bottom:4px;padding-left:6px;padding-right:6px;margin-right:4px}.librariesDropdownWithFocus_5d61535c:focus{outline:1px solid "},{"theme":"black","defaultValue":"#000000"},{"rawString":";box-shadow:none!important}.librariesDropdownNotOpen_5d61535c:hover{background-color:"},{"theme":"themeLight","defaultValue":"#c7e0f4"},{"rawString":";color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.librariesDropdownOpen_5d61535c,.librariesDropdown_5d61535c:active{background-color:"},{"theme":"themeTertiary","defaultValue":"#71afe5"},{"rawString":"}.librariesDropdownOpen_5d61535c .librariesDropdownChevron_5d61535c,.librariesDropdown_5d61535c:active .librariesDropdownChevron_5d61535c{color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}.librariesDropdownOpen_5d61535c .librariesDropdownIcon_5d61535c,.librariesDropdown_5d61535c:active .librariesDropdownIcon_5d61535c{color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}.librariesDropdownChevron_5d61535c{font-size:12px;margin-top:2px}[dir=ltr] .librariesDropdownChevron_5d61535c{margin-left:5px}[dir=rtl] .librariesDropdownChevron_5d61535c{margin-right:5px}"},{"rawString":".messageBarContainer{margin-bottom:40px}"},{"rawString":".Text_dde26d97{font-weight:600}"},{"rawString":".od-ListState-button{display:inline-block;vertical-align:middle;width:20px;height:28px}[dir=ltr] .od-ListState-button{margin-left:10px}[dir=rtl] .od-ListState-button{margin-right:10px}.od-ListState-button.isSPList{height:34px;padding-top:9px}.xlg .od-ListState-button.isSPList,.xxlg .od-ListState-button.isSPList,.xxxlg .od-ListState-button.isSPList,.xxxxlg .od-ListState-button.isSPList{margin-top:10px}.od-ListState-button.isErrorStatus{height:25px}.od-ListState-button.insideBreadcrumb{margin:0 3px;width:20px}.od-ListState-icon{font-size:small;cursor:default;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ListState-icon.isListHome{vertical-align:-webkit-baseline-middle}.od-ListState-icon:hover{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}.od-ListState-icon.hasAction{cursor:pointer;color:#d47500}@media print{.od-ListState-button{display:none}}"},{"rawString":".od-TopBar{position:relative}@media screen and (-ms-high-contrast:active){.od-TopBar{border-top:1px solid "},{"theme":"white","defaultValue":"#fff"},{"rawString":";border-bottom:1px solid "},{"theme":"white","defaultValue":"#fff"},{"rawString":"}}@media screen and (-ms-high-contrast:black-on-white){.od-TopBar{border-top:1px solid "},{"theme":"black","defaultValue":"#000"},{"rawString":";border-bottom:1px solid "},{"theme":"black","defaultValue":"#000"},{"rawString":"}}.lg .od-TopBar,.md .od-TopBar,.sm .od-TopBar{border-bottom:1px solid "},{"theme":"bodyDivider","defaultValue":"#edebe9"},{"rawString":"}.od-TopBar-item{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";height:44px}[dir=ltr] .od-TopBar-item--winApp{margin-left:228px!important}[dir=rtl] .od-TopBar-item--winApp{margin-right:228px!important}html[dir=ltr] .od-TopBar-item{float:left}html[dir=rtl] .od-TopBar-item{float:right}.md .od-TopBar-item,.sm .od-TopBar-item{height:48px}.od-theme--darkTransparent .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od-TopBar-search{height:auto;background-color:transparent;width:228px}.lg .od-TopBar-search,.md .od-TopBar-search,.sm .od-TopBar-search{width:auto}[dir=ltr] .lg .od-TopBar-search,[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:0}[dir=rtl] .lg .od-TopBar-search,[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:0}[dir=ltr] .md .od-TopBar-search,[dir=ltr] .sm .od-TopBar-search{margin-right:4px}[dir=rtl] .md .od-TopBar-search,[dir=rtl] .sm .od-TopBar-search{margin-left:4px}.od-TopBar-search .od-SearchBox{transition:width 367ms cubic-bezier(.1, .9, .2, 1),background-color 0s cubic-bezier(.1, .9, .2, 1) 0s}.od-TopBar-search .od-SearchBox .od-SearchBox--active{transition-delay:0s,0s}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{transition-delay:0s,367ms}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active){overflow:hidden;border-width:0;width:49px;border-color:transparent}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active) .od-SearchBox-search:after{visibility:hidden}.lg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox:not(.od-SearchBox--active){width:180px}.od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{transition-delay:0s,0s}.lg .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox.od-SearchBox--active{width:165px}.md .od-TopBar-search.od-TopBar-search--isCollapsed,.sm .od-TopBar-search.od-TopBar-search--isCollapsed{width:50px}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search{position:absolute;z-index:1;visibility:hidden}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-SearchBox{visibility:visible}.md .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active,.sm .od-TopBar-search.od-TopBar-search--isCollapsed .od-Search--active{left:0;right:0}.lg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox,.xxxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox{transition:background-color 0s cubic-bezier(.1, .9, .2, 1) 0s}.lg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-TopBar-search.od-TopBar-search--isLeftNavDisabled .od-SearchBox:not(.od-SearchBox--active){width:auto}.sm .od-TopBar-search{width:50px}.xlg .od-TopBar-header,.xxlg .od-TopBar-header,.xxxlg .od-TopBar-header,.xxxxlg .od-TopBar-header{width:100%}html[dir=ltr] .xlg .od-TopBar-header,html[dir=ltr] .xxlg .od-TopBar-header,html[dir=ltr] .xxxlg .od-TopBar-header,html[dir=ltr] .xxxxlg .od-TopBar-header{float:right}html[dir=rtl] .xlg .od-TopBar-header,html[dir=rtl] .xxlg .od-TopBar-header,html[dir=rtl] .xxxlg .od-TopBar-header,html[dir=rtl] .xxxxlg .od-TopBar-header{float:left}html[dir=ltr] .od-TopBar-commandBar{float:none}html[dir=rtl] .od-TopBar-commandBar{float:none}html[dir=ltr] .xlg .od-TopBar-commandBar,html[dir=ltr] .xxlg .od-TopBar-commandBar,html[dir=ltr] .xxxlg .od-TopBar-commandBar,html[dir=ltr] .xxxxlg .od-TopBar-commandBar{clear:right}html[dir=rtl] .xlg .od-TopBar-commandBar,html[dir=rtl] .xxlg .od-TopBar-commandBar,html[dir=rtl] .xxxlg .od-TopBar-commandBar,html[dir=rtl] .xxxxlg .od-TopBar-commandBar{clear:left}.od--hasSelection .od-TopBar-item{transition:background-color 467ms cubic-bezier(.1, .9, .2, 1);background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-theme--darkTransparent .od--hasSelection .od-TopBar-item{background-color:rgba(0,0,0,.7)}.od--hasSelection .od-TopBar-search:hover{background-color:"},{"theme":"neutralQuaternary","defaultValue":"#d2d0ce"},{"rawString":"}html[dir=ltr] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-right-width:0}html[dir=rtl] .od-TopBar-leftNavExpander+.od-TopBar-search .od-SearchBox{border-left-width:0}"},{"rawString":".lg .od-Search-overlay .od-SearchResults,.xlg .od-Search-overlay .od-SearchResults,.xxlg .od-Search-overlay .od-SearchResults,.xxxlg .od-Search-overlay .od-SearchResults,.xxxxlg .od-Search-overlay .od-SearchResults{position:absolute;top:45px}.od-Search--maximized{position:absolute;left:0;right:0;bottom:0;overflow:auto}.od-Search--maximized .od-SearchBox{border-color:transparent}"},{"rawString":".od-SearchBox{width:100%;color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";border-color:"},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":";position:relative;box-sizing:border-box;height:44px}html[dir=ltr] .od-SearchBox{border-right-width:0}html[dir=rtl] .od-SearchBox{border-left-width:0}@media screen and (-ms-high-contrast:active){.od-SearchBox{border-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";z-index:304}}@media screen and (-ms-high-contrast:black-on-white){.od-SearchBox{border-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}}.od-SearchBox .ms-Icon--Cancel,.od-SearchBox .ms-Icon--Search{margin-top:14px;font-family:FabricMDL2Icons}.od-SearchBox button.ms-Icon{background:0 0;padding:0;border:none;line-height:16px}.od-SearchBox button.ms-Icon::-moz-focus-inner{padding:0;border:0}html[dir=ltr] .od-SearchBox{border-right-style:solid}html[dir=rtl] .od-SearchBox{border-left-style:solid}html[dir=ltr] .od-SearchBox{border-right-width:1px}html[dir=rtl] .od-SearchBox{border-left-width:1px}.md .od-SearchBox,.sm .od-SearchBox{height:44px}.md .od-SearchBox .ms-Icon--Search,.sm .od-SearchBox .ms-Icon--Search{margin-top:12px;line-height:20px}.sm .od-SearchBox{height:44px}.lg .od-SearchBox,.md .od-SearchBox,.sm .od-SearchBox{height:44px}.xlg .od-SearchBox,.xxlg .od-SearchBox,.xxxlg .od-SearchBox,.xxxxlg .od-SearchBox{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";height:45px}.xlg .od-SearchBox:not(.od-SearchBox--active),.xxlg .od-SearchBox:not(.od-SearchBox--active),.xxxlg .od-SearchBox:not(.od-SearchBox--active),.xxxxlg .od-SearchBox:not(.od-SearchBox--active){background-color:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-SearchBox-search{display:block;box-sizing:border-box;height:100%;position:relative}.od-SearchBox-search:after{content:\\"\\";display:block;position:absolute;height:0;left:0;right:0;bottom:0;border-bottom:1px solid "},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";margin:0}input.od-SearchBox-input[type=text]{display:block;width:100%;padding:8px 8px 8px 41px;background-color:transparent;box-sizing:border-box;outline:0;line-height:22px;border:none;-webkit-appearance:none;-webkit-border-radius:0;height:44px;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:"},{"theme":"mediumFontWeight","defaultValue":"400"},{"rawString":";padding:8px 8px 8px 48px}html[dir=rtl] input.od-SearchBox-input[type=text]{padding:8px 41px 8px 8px}html[dir=rtl] input.od-SearchBox-input[type=text]{padding:8px 48px 8px 8px}input.od-SearchBox-input[type=text]::-ms-clear{display:none}input.od-SearchBox-input[type=text]::placeholder{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";opacity:1;font-size:"},{"theme":"mediumFontSize","defaultValue":"14px"},{"rawString":";font-weight:"},{"theme":"mediumFontWeight","defaultValue":"400"},{"rawString":"}input.od-SearchBox-input[type=text]:placeholder{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";opacity:1;font-size:14px}.md input.od-SearchBox-input[type=text],.sm input.od-SearchBox-input[type=text]{height:48px}.od-SearchBox-iconSearchWrapper{display:block;top:0}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-left:17px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-right:17px}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-right:6px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-left:6px}[dir=ltr] .md .od-SearchBox-iconSearchWrapper,[dir=ltr] .sm .od-SearchBox-iconSearchWrapper{padding-left:15px}[dir=rtl] .md .od-SearchBox-iconSearchWrapper,[dir=rtl] .sm .od-SearchBox-iconSearchWrapper{padding-right:15px}.od-SearchBox-iconArrowWrapper{display:none;top:12px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-left:16px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-right:16px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-right:7px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-left:7px}.od-SearchBox-iconClearWrapper{display:none;top:0}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-left:11px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-right:11px}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-right:12px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-left:12px}[dir=ltr] .od-SearchBox-iconClearWrapper{right:0}[dir=rtl] .od-SearchBox-iconClearWrapper{left:0}.od-SearchBox--active{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":"}.od-SearchBox--active,.od-SearchBox:hover{color:"},{"theme":"neutralDark","defaultValue":"#201f1e"},{"rawString":"}.od-SearchBox--active .od-SearchBox-search:before{content:\\"\\";position:absolute;top:0;bottom:0;left:0;right:0;margin:6px 0}html[dir=ltr] .od-SearchBox--active .od-SearchBox-search:before{border-right:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}html[dir=rtl] .od-SearchBox--active .od-SearchBox-search:before{border-left:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.lg .od-SearchBox--active .od-SearchBox-search:after,.md .od-SearchBox--active .od-SearchBox-search:after,.sm .od-SearchBox--active .od-SearchBox-search:after{border-bottom:0}[dir=ltr] .od-SearchBox--active .od-SearchBox-input{padding-left:16px}[dir=rtl] .od-SearchBox--active .od-SearchBox-input{padding-right:16px}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-left:48px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-right:48px}.od-SearchBox--active .od-SearchBox-iconSearchWrapper{display:none}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-left:40px}.od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{display:block}.od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-left:73px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-right:73px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-left:10px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-right:10px}.od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{right:0}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{left:0}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:11px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:11px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:12px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:12px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-right:68px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-left:68px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:6px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:6px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:5px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:5px}.od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-iconArrowWrapper{display:block}.od-SearchBox-iconWrapper{height:45px;cursor:pointer;position:absolute;z-index:1}.od-SearchBox-iconWrapper button{cursor:pointer}.sm .od-SearchBox-iconWrapper{height:44px}.od-SearchBox .ms-Icon::before{font-size:16px;color:"},{"theme":"themeDarkAlt","defaultValue":"#106ebe"},{"rawString":"}.md .od-SearchBox .ms-Icon::before,.sm .od-SearchBox .ms-Icon::before{font-size:20px}"},{"rawString":"@charset \\"UTF-8\\";.od-SearchResults-suggestion{display:flex;align-items:center;margin:0 -16px;padding:8px 16px;min-height:30px;cursor:pointer}.od-SearchResults-suggestion .od-SearchResults-result-glyph,.od-SearchResults-suggestion .od-SearchResults-result-icon{flex:0 0 48px;height:48px;margin:0;text-align:center;line-height:48px}.sm .od-SearchResults-suggestion .od-SearchResults-result-glyph,.sm .od-SearchResults-suggestion .od-SearchResults-result-icon{flex:0 0 20px;height:20px;line-height:20px}.od-SearchResults-suggestion .od-IconGlyph{color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":";font-size:34px}.sm .od-SearchResults-suggestion .od-IconGlyph{font-size:20px}.od-SearchResults-suggestion .od-SearchResults-result-title{position:static;display:flex;flex-direction:column;justify-content:center;margin:0 0 0 16px}html[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{margin:0 16px 0 0}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-right:0}.od-SearchResults-suggestion .od-SearchResults-result-title-text{display:inline;font-size:14px;font-weight:400}.od-SearchResults-suggestion .od-SearchResults-result-metadata{display:flex;font-size:12px;font-weight:400;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-right:0}.od-SearchResults-suggestion .ms-dotSeparatorBefore{margin-left:4px}.od-SearchResults{background-color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";border:1px solid transparent;padding:0 16px;box-sizing:border-box;box-shadow:0 0 5px 0 "},{"theme":"blackTranslucent40","defaultValue":"rgba(0,0,0,.4)"},{"rawString":";width:432px;overflow-y:auto}.md .od-SearchResults,.sm .od-SearchResults{width:100%}.od-SearchResults-hasStatus>.od-SearchResults-status{font-size:15px;font-weight:400;display:block}.od-SearchResults-status{display:none;margin:10px auto}.od-SearchResults-hasStatus>.od-SearchResults-resultsBox{display:none}.od-SearchResults-resultsBox{box-sizing:border-box;width:100%}.od-SearchResults-result{text-decoration:none;position:relative;margin-bottom:2px}.od--isNonMobile .od-SearchResults-result-link:hover,.od--isNonMobile .od-SearchResults-suggestion:hover{background:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":";outline:1px solid transparent}.od--isNonMobile .od-SearchResults-result-link:hover.is-selected,.od--isNonMobile .od-SearchResults-suggestion:hover.is-selected{background:"},{"theme":"themeLightAlt","defaultValue":"#beddf4"},{"rawString":"}.od-SearchResults-result-link--focused{background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":"}.od-focus--enabled .od-SearchResults-result-link--focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px dashed transparent}.od-SearchResults-expanded-result i,.od-SearchResults-result-highlight{font-weight:600;font-weight:600}.od-SearchResults-expanded-result i{font-style:normal}.od-SearchResults-result-icon{height:24px;width:24px;margin-top:5px;display:inline-block;position:relative}.od-SearchResults-result-parentFolder{display:inline-block;color:"},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}.od-SearchResults-result-title{font-size:15px;font-weight:400;box-sizing:border-box;pointer-events:none}[dir=ltr] .od-SearchResults-result-title{padding-left:40px}[dir=rtl] .od-SearchResults-result-title{padding-right:40px}.od-SearchResults-result-metadata,.od-SearchResults-result-summary{box-sizing:border-box}[dir=ltr] .od-SearchResults-result-metadata,[dir=ltr] .od-SearchResults-result-summary{padding-left:52px}[dir=rtl] .od-SearchResults-result-metadata,[dir=rtl] .od-SearchResults-result-summary{padding-right:52px}.od-SearchResults-result-metadata,.od-SearchResults-result-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-SearchResults-result-title{position:absolute;top:0;width:100%}[dir=ltr] .od-SearchResults-result-title{left:0}[dir=rtl] .od-SearchResults-result-title{right:0}.od-SearchResults-result-title-text{vertical-align:top;display:inline-block;overflow:hidden;text-overflow:ellipsis;max-width:100%}[dir=ltr] .od-SearchResults-result-title-text{margin-right:6px}[dir=rtl] .od-SearchResults-result-title-text{margin-left:6px}.od-SearchResults-result-link{text-decoration:none;display:block;height:34px;line-height:34px;margin:0 -16px;padding:0 16px;cursor:pointer}.od-SearchResults-result-folderLink{text-decoration:none}.od-SearchResults-upscope-result{text-align:center;margin-bottom:0}.od-SearchResults-upscope-result .od-SearchResults-result-link{display:inline-block;width:100%;height:48px;line-height:48px}.od-SearchResults-upscope-result .ms-Icon--Search{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}[dir=ltr] .od-SearchResults-upscope-result .ms-Icon--Search{margin-right:8px}[dir=rtl] .od-SearchResults-upscope-result .ms-Icon--Search{margin-left:8px}.od-SearchResults-upscope-result .od-SearchResults-result-title{position:relative;top:-2px}[dir=ltr] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-right:0}.od-SearchResults-progressBox{position:absolute;width:100%;top:2px}[dir=ltr] .od-SearchResults-progressBox{left:0}[dir=rtl] .od-SearchResults-progressBox{right:0}.od-SearchResults-separator-line{margin:0 -16px;border:0;border-bottom:1px solid "},{"theme":"neutralLight","defaultValue":"#edebe9"},{"rawString":"}.ms-noList ol,.ms-noList ul,ol.ms-noList,ul.ms-noList{list-style-type:none;margin-top:0;margin-bottom:0}[dir=ltr] .ms-noList ol,[dir=ltr] .ms-noList ul,[dir=ltr] ol.ms-noList,[dir=ltr] ul.ms-noList{padding-left:0}[dir=rtl] .ms-noList ol,[dir=rtl] .ms-noList ul,[dir=rtl] ol.ms-noList,[dir=rtl] ul.ms-noList{padding-right:0}.ms-dotSeparatorAfter::after{content:\\"\\"}.ms-dotSeparatorBefore::before{content:\\"\\"}.ms-enquote::before{content:open-quote}.ms-enquote::after{content:close-quote}"},{"rawString":".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"},{"rawString":".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"},{"rawString":".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1, .25, .75, .9)}"},{"rawString":".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:first-child{animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:first-child{margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:first-child{margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"},{"rawString":".od-Overlay{height:0;width:0;overflow:hidden}"},{"rawString":".od-ListGroupHeader{height:32px;line-height:32px;margin-top:20px;font-size:21px;font-weight:100;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":";position:relative;padding:4px 0}.od-ListGroupHeader:hover{background-color:"},{"theme":"themeLighterAlt","defaultValue":"#e6f2fb"},{"rawString":"}.od-ListGroupHeader:hover .od-ListGroupHeader-check{opacity:1}.od-ListGroupHeader.is-focused{background:"},{"theme":"themeLighter","defaultValue":"#d7eaf9"},{"rawString":";box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od-ListGroupHeader.is-focused .od-ListGroupHeader-check{opacity:1}[dir=ltr] .od-ListGroupHeader.showCheckbox{padding-left:0}[dir=rtl] .od-ListGroupHeader.showCheckbox{padding-right:0}.od-ListGroupHeader.dropping{box-shadow:inset 0 0 0 3px "},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.od-ListGroupHeader-title{display:inline-block;cursor:pointer;outline:0}[dir=ltr] .od-ListGroupHeader-title{padding-left:14px}[dir=rtl] .od-ListGroupHeader-title{padding-right:14px}[dir=ltr] .od-ListGroupHeader-title{margin-left:-6px}[dir=rtl] .od-ListGroupHeader-title{margin-right:-6px}.od-ListGroupHeader-loading{padding:0 20px}.od-ListGroupExpandButton.ms-Icon{height:32px;line-height:32px;text-align:center;transform:rotate(-180deg);transform-origin:50% 50%;width:32px;vertical-align:top;padding:4px 0;margin-top:-4px;outline:0}.od-ListGroupExpandButton.ms-Icon:hover{background-color:"},{"theme":"themeLightAlt","defaultValue":"#beddf4"},{"rawString":"}.od-ListGroupHeader.is-collapsed .od-ListGroupExpandButton{transform:rotate(0)}.od-ListGroupHeader-check{display:inline-block;vertical-align:top;padding:7px 14px 7px 8px;font-size:14px;font-weight:400;opacity:0}html[dir=rtl] .od-ListGroupHeader-check{padding:7px 8px 7px 14px}.od-ListGroupHeader-check:hover{opacity:1}"},{"rawString":".ItemCheck{display:none;position:relative;width:18px;height:18px;cursor:default;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.can-select .ItemCheck{display:block}.ItemCheck:before{background:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";content:\\"\\";width:16px;height:16px;position:absolute;border-radius:50%;left:1px;top:1px}.ItemCheck-circle{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;line-height:18px;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":"}.ItemCheck-check{font-size:16px;position:absolute;left:1.5px;top:0;color:"},{"theme":"neutralTertiaryAlt","defaultValue":"#c8c6c4"},{"rawString":";opacity:0;width:16px;height:16px;line-height:16px}.od--isNonMobile .ItemCheck:hover .ItemCheck-check{opacity:1}.is-selected .ItemCheck:before{background:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-circle{color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":"}.is-selected .ItemCheck .ItemCheck-check{color:"},{"theme":"white","defaultValue":"#fff"},{"rawString":";opacity:1}"},{"rawString":".od-ListGroupSeeMore{font-size:14px;line-height:34px;color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}.od-ListGroupSeeMore.needPadding{padding:0 80px}.od-ListGroupSeeMore.is-focused{box-shadow:0 0 0 1px "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":" inset;outline:1px solid transparent}.od-ListGroupSeeMore span{padding:4px 8px;cursor:pointer}"},{"rawString":"#obf-TPromptContainer:focus{outline:1px solid "},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}#obf-ToastContainer{background-color:"},{"theme":"menuBackground","defaultValue":"#fff"},{"rawString":";border:1px solid "},{"theme":"neutralSecondaryAlt","defaultValue":"#8a8886"},{"rawString":"}#obf-ToastContainer #obf-TFormComment{background-color:"},{"theme":"menuBackground","defaultValue":"#fff"},{"rawString":"}#obf-ToastContainer #obf-TFormTitle,#obf-ToastContainer #obf-TPromptTitle{color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon>span{background-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon{border-color:"},{"theme":"themePrimary","defaultValue":"#0078d4"},{"rawString":"}#obf-ToastContainer #obf-TFormRating,#obf-ToastContainer #obf-TPromptText,#obf-ToastContainer #obf-ToastCancel svg path{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":";fill:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}#obf-ToastContainer .obf-Link{color:"},{"theme":"themeDark","defaultValue":"#005a9e"},{"rawString":"}#obf-ToastContainer .obf-TextInput{color:"},{"theme":"neutralPrimary","defaultValue":"#323130"},{"rawString":"}#obf-ToastContainer .obf-TextInput::placeholder{color:"},{"theme":"neutralSecondary","defaultValue":"#605e5c"},{"rawString":"}#obf-ToastContainer .obf-Link:focus,#obf-ToastContainer .obf-SubmitButton:focus{outline-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}#obf-ToastContainer .obf-ChoiceGroup input:focus+label{outline-color:"},{"theme":"black","defaultValue":"#000"},{"rawString":"}#obf-ToastContainer .obf-SubmitButton[disabled],#obf-ToastContainer .obf-SubmitButton[disabled]:active,#obf-ToastContainer .obf-SubmitButton[disabled]:focus,#obf-ToastContainer .obf-SubmitButton[disabled]:hover{background-color:"},{"theme":"neutralQuaternaryAlt","defaultValue":"#e1dfdd"},{"rawString":";color:"},{"theme":"neutralTertiary","defaultValue":"#a19f9d"},{"rawString":"}"},{"rawString":".od-Banner{display:flex;position:relative;border:1px solid "},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":";background:"},{"theme":"neutralLighter","defaultValue":"#f3f2f1"},{"rawString":"}.od-Banner.od-Banner-hide{display:none}.od-Banner-imageContainer{display:flex;flex-direction:column;align-items:center}.od-Banner-imageContainer.od-Banner-imageBottom{justify-content:flex-end}.od-Banner-imageContainer.od-Banner-imageCenter{justify-content:center}.sm .od-Banner-imageContainer{display:none}.md .od-Banner-imageContainer{display:none}.od-Banner-messageContainer{padding:15px}.od-Banner-messageContainer--vertical{display:flex;width:100%}.od-Banner-header{margin:5px 0;font-size:21px;font-weight:100}.od-Banner-message{font-size:14px;font-weight:400}.od-Banner-message--vertical{position:absolute;transform:translate(0,-50%);top:50%}.od-Banner-button--horizontal{margin-top:10px}[dir=ltr] .od-Banner-button--vertical{margin-left:auto}[dir=rtl] .od-Banner-button--vertical{margin-right:auto}.od-Banner-close.ms-Button.ms-Button--icon{position:absolute;top:12px;padding:0}[dir=ltr] .od-Banner-close.ms-Button.ms-Button--icon{right:12px}[dir=rtl] .od-Banner-close.ms-Button.ms-Button--icon{left:12px}.od-Banner-icon{margin:auto 5px auto 0;vertical-align:-3px}html[dir=rtl] .od-Banner-icon{margin:auto 0 auto 5px}"},{"rawString":".od-TeamChannelBanner{display:flex;margin:auto;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(0.455,0.03,0.515,0.955);animation-duration:1.1s}@media (prefers-reduced-motion:reduce){.od-TeamChannelBanner{animation:none}}"}]'))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"AuthTokenMonitor.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,5336)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return u});var a=n(136),i=n(40),r=n(38),o=n(14),s=n(69),c=n(4853),d=n(1461),l=function(){function e(e,t){this._pageContext=t.pageContext,this._listContext=t.listContext,this._rumoneHelper=t.rumoneHelper}return e.arePowerAppsFormsEnabled=function(){var t=Object(i.isFeatureEnabled)(i.PowerAppListForms)&&Object(i.isFeatureEnabled)(i.PowerApps);return e.arePowerAppsFormsEnabled=function(){return t},t},e.prototype.isPowerAppsSupportedScenario=function(){var t=Number(this._pageContext.webTemplate)===s.t.mySite;if(!e.arePowerAppsFormsEnabled()||!this._checkPowerAppState())return!1;switch(Number(this._pageContext.listBaseTemplate)){case o.n.documentLibrary:return!t;case o.n.genericList:default:return!0}},e.prototype.mayHavePowerAppsForm=function(){return this._checkPowerAppState()},e.prototype.ensurePowerAppSdkPreloaded=function(){var t=e.arePowerAppsFormsEnabled();if(!this._powerAppSdkLoaded&&t){var n="PowerappPreloadLastTime";if(c.resourceNeedsPreload(n,864e5))if(c.setPreloadDone(n),this._rumoneHelper.rumone.addEUPLBreakdown("powerAppSdkPreload",{data:!0,needFlatten:!0}),Object(i.isFeatureEnabled)(i.PowerAppsAndAndProcessSimpleTestEnvironment))c.preload("https://apps.test.powerapps.com/sdk/preload");else{var a=this._pageContext.farmSettings&&this._pageContext.farmSettings.ExternalService_powerappsappshostname;a||(a="apps.powerapps.com"),c.preload("https://".concat(a,"/sdk/preload"))}this._powerAppSdkLoaded=!0}},e.prototype._checkPowerAppState=function(){return!Object(i.isFeatureEnabled)(i.CustomActionPreFetch)||!this._listContext||!1!==this._listContext.checkPowerAppState},e.dependencies={pageContext:r.f,rumoneHelper:d.n,listContext:r.o.optional},e}(),u=Object(a.r)("PowerAppsVerifier",l)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceNeedsPreload",function(){return c}),n.d(t,"setPreloadDone",function(){return d}),n.d(t,"preload",function(){return l});var a=n(240),i=n(232),r=n(114),o=new a.e,s=new i.e("ResourceReloader");function c(e,t){var n=s.getValue(e,r.e.local);return void 0===n||Date.now()-n>t}function d(e){s.setValue(e,Date.now(),r.e.local)}function l(e,t,n){void 0===t&&(t=1e4),void 0===n&&(n="scriptPreloadingHelper"),o.setTimeout(function(){var t=document.createElement("iframe");t.id=n,t.name=n,t.style.visibility="hidden",t.style.position="absolute",t.style.top=t.style.left=t.style.height=t.style.width="0",document.body.appendChild(t),(t=document.getElementById(n)).src=e},t)}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("openSyncIssuesAction",{action:a.t,isAvailable:a.t})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(6),i=new a.e("startSignInRequestAction",{action:a.t,isAvailable:a.t})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3);function i(e){return Object(a.co)(a.H)&&!!e&&!!e.extension&&-1!==[".mp4",".mov",".webm",".avi",".wmv"].indexOf(e.extension.toLowerCase())}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(36),i=n(3);function r(e){return a.e.hasItemPermission(e,a.e.insertListItems)&&Object(i.co)(i.H)}},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(189),r=n(145),o=n(16),s=n(4863),c=Object(r.t)(function(e){return function(t){var n;t(Object(i.e)({items:(n={},n[o.c]=Object(a.__assign)({},s.e.pack({bannerState:e.bannerState})),n)}))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("localModelCreationWarning")},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(4865),r=n(136),o=n(38),s=function(e){function t(t,n){return e.call(this,n.pageContext)||this}return Object(a.__extends)(t,e),t}(i.e),c=Object(r.r)("MicroserviceEndPointDataSource.key",s,{pageContext:o.f})},function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){return e.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:t})||this}return Object(a.__extends)(t,e),t.prototype.getMicroServiceEndPoints=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/microservicemanager/getserviceurls?service='").concat(e,"'");return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})},t.prototype.getAllMicroServiceEndPoints=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/microservicemanager/getserviceurls?service='").concat(e,"'");return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetAllServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results})},t}(n(1363).t);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"KOToItemCacheOperationProvider.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e(817)]).then(n.bind(null,5060)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return F});var a=n(0),i=n("react-lib"),r=n(39),o=n(88),s=n(120),c=n(28),d=n(1),l=n(786),u=n(228),f=n(631),p=n(77),m=n(640),_=n(352),h=n(57),b=n(14),g=n(43),v=n(757),y=n(21),S=n(91),D=n(116),I=n(63),x=n(3),C=n(22),O=n(207),w=n(29),E=n(4239),A=n(2657),L=Object(u.t)(function(){return{type:"file",extFilters:Object(x.co)(x.y)?[".docx",".dotx"]:[".docx"],selectionMode:"single"}})(l.e),k=Object(S.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(170).then(n.bind(null,5343))];case 1:return[2,e.sent().SmartTemplateFilePickerWrapper]}})})}),M=Object(S.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(168).then(n.bind(null,4691))];case 1:return[2,e.sent().AddSmartTemplateErrorDialog]}})})});function P(e){var t=e.onContinue,n=e.onCancel,r=Object(a.__rest)(e,["onContinue","onCancel"]),o=i.useState(),s=o[0],c=o[1];return s?i.createElement(M,{errorText:s.message,onRetryClick:function(){c(void 0)},onCancelClick:function(){n()}}):i.createElement(L,Object(a.__assign)({},r,{onContinue:function(e){for(var n=!0,a=0,i=e;a<i.length;a++){var r=i[a];".docx"===r.name.slice(r.name.length-5)||Object(x.co)(x.y)&&".dotx"===r.name.slice(r.name.length-5)||(n=!1)}n?t(e):c(new Error(E.i))},onCancel:n}))}var T=Object(h.e)(function(){return{fileSelector:P}})(f.e),U=Object(m.n)({uploadItemsAction:_.e}),F=Object(h.t)(function(e,t){var l,u=Object(r.e)(e),f=Object(p.e)(e),m=Object(g.e)(e,u);if(!f||!u||!m)return null;var _=e.demandItemFacet(o.e,u),h=_&&s.e.serialize(_),v=e.demandItemFacet(d.We,h),y=_?_.webAbsoluteUrl:"",S=(null==_?void 0:_.listFullUrl)?_.listFullUrl:"",D=(null==v?void 0:v.id)?v.id.replace("{","").replace("}",""):"",I=m.canUserUseSyntex;if(!(S&&y&&D&&v&&v.isDocumentLibrary&&v.templateType===b.t.documentLibrary&&(null===(l=null==v?void 0:v.permissions)||void 0===l?void 0:l.manageLists)&&v.newWOPIDocumentEnabled&&I))return null;var C=void 0;Object(x.Vi)()||n.e(558).then(n.bind(null,2854)).then(function(e){C=e.TemplatizationCustomerPromiseHelper.getInstance(m.CorrelationId)});var E=e.demandItemFacet(c.e,f);if(!E)return null;var A=E.listFullUrl;if(!A)return null;var L=new O.e("".concat(A,"/Forms")).path,k=c.e.serialize(Object(a.__assign)(Object(a.__assign)({},E),{rootFolder:L}));return i.createElement(H,Object(a.__assign)({currentItemKey:f,currentItemSetKey:u,pageContext:m,formsItemKey:k,isFREShown:t.isFREShown||!1,templatizationCxPHelper:C},Object(w.t)(e,{itemKey:f,engagement:{name:"AddSmartTemplate"}})))});function H(e){var t=this,n=Object(v.e)(),r=n[0],o=n[1];if(e.currentItemKey)return i.createElement(i.Fragment,null,r,i.createElement(C.e,Object(a.__assign)({onExecute:function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,s=this;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return e.templatizationCxPHelper&&e.templatizationCxPHelper.startEditTemplateCustomerPromise(Object(A.a)("CreateNewTemplate")),t=function(t){return Object(a.__awaiter)(s,void 0,void 0,function(){var r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=function(){return{targetItemKey:e.formsItemKey,onItemUploaded:function(e){return function(n){var a=e.progressItemKey,i=n(Object(D.e)(function(e){var t;return null===(t=e.demandItemFacet(I.r,a))||void 0===t?void 0:t.itemKey}));t(i)}}}},[4,o(i.createElement(U,{value:{uploadItemsAction:r}},i.createElement(T,{itemKey:e.currentItemKey})),n)];case 1:return a.sent(),[2]}})})},r=function(n){return Object(a.__awaiter)(s,void 0,void 0,function(){return Object(a.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(y.o)(function(n){return i.createElement(k,Object(a.__assign)({},e,{wizardProps:n,templatizationCxPHelper:e.templatizationCxPHelper,executeUploadFilePickerAction:t}))})(n)];case 1:return r.sent(),[2]}})})},[4,r(n)];case 1:return c.sent(),[2]}})})}},e)))}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(189),r=n(145),o=n(16),s=n(4874),c=Object(r.t)(function(e){return function(t){var n;t(Object(i.e)({items:(n={},n[o.c]=Object(a.__assign)({},s.e.pack(e.modelPublishDetails)),n)}))}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("modelPublishedBanner")}],Array(28),[function(e,t,n){"use strict";var a=n(0),i=n(134),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.e(694).then(n.bind(null,4698)).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.e(580).then(n.bind(null,5360))];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(4),i=n(425),r=n(1131),o=n(661),s=n(360),c=n(48),d=n(149),l={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},u=Object(d.t)(function(){return Object(i.e)({"0%":{opacity:0,animationTimingFunction:r.t.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})}),f=function(e,t){var n=t||{},a=n.calloutWidth,i=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:a||"calc(100% + 1px)",animationName:""+u(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:i||456}]},p=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},m=function(e){var t,n,i,r=e.hasCondensedHeadline,d=e.hasSmallHeadline,u=e.hasCloseButton,m=e.hasHeadline,_=e.isWide,h=e.primaryButtonClassName,b=e.secondaryButtonClassName,g=e.theme,v=e.calloutProps,y=void 0===v?{className:void 0,theme:g}:v,S=!r&&!d,D=g.palette,I=g.semanticColors,x=g.fonts,C=Object(o.e)(l,g),O=Object(s.t)(g,{outlineColor:"transparent",borderColor:"transparent"});return{root:[C.root,x.medium,y.className],body:[C.body,u&&!m&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[C.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[C.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:D.white,fontSize:x.small.fontSize,selectors:{":hover":{background:D.themeDarkAlt,color:D.white},":active":{background:D.themeDark,color:D.white},":focus":{border:"1px solid "+I.variantBorder}}}],content:Object(a.o)([C.content],f(_),[_&&{display:"flex"}]),footer:[C.footer,{display:"flex",flex:"auto",alignItems:"center",color:D.white,selectors:(t={},t["."+C.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(a.o)([C.header],p(C,r,d),[u&&{marginRight:24},(r||d)&&[x.medium,{fontWeight:c.t.semibold}]]),headline:[C.headline,{margin:0,color:D.white,fontWeight:c.t.semibold},S&&[{fontSize:x.xLarge.fontSize}]],imageContent:[C.header,C.image,_&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[C.primaryButton,h,O,{backgroundColor:D.white,borderColor:D.white,color:D.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+C.buttonLabel]=x.medium,n[":hover"]={backgroundColor:D.themeLighter,borderColor:D.themeLighter,color:D.themePrimary},n[":focus"]={backgroundColor:D.themeLighter,border:"1px solid "+D.black,outline:"1px solid "+D.white,outlineOffset:"-2px"},n[":active"]={backgroundColor:D.white,borderColor:D.white,color:D.themePrimary},n)}],secondaryButton:[C.secondaryButton,b,{backgroundColor:D.themePrimary,borderColor:D.white,whiteSpace:"nowrap",selectors:(i={},i["."+C.buttonLabel]=[x.medium,{color:D.white}],i[":hover"]={backgroundColor:D.themeDarkAlt,borderColor:D.white},i[":focus"]={backgroundColor:D.themeDark,border:"1px solid "+D.black,outline:"1px solid "+D.white,outlineOffset:"-2px"},i[":active"]={backgroundColor:D.themePrimary,borderColor:D.white},i)}],subText:[C.subText,{margin:0,fontSize:x.medium.fontSize,color:D.white,fontWeight:c.t.regular}],subComponentStyles:{callout:{root:Object(a.o)(f(_,y),[x.medium]),beak:[{background:D.themePrimary}],calloutMain:[{background:D.themePrimary}]}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(895),i=n(4546),r=n(4904),o=Object(a.e)(i.e,r.e,void 0,{scope:"TeachingBubble"})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1631),i=n(136),r=n(38),o=Object(i.r)("PageContextEngagementHandler",a.e,{pageContext:r.f})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"CoachmarkProvider.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,2947)).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(10),i=n(136),r=new a.t({name:"PowerAppHostLoader.key",loader:new i.t(function(){return Promise.resolve().then(n.bind(null,5489)).then(function(e){return e.resourceKey.local})})})}],Array(55),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(65),i=n(172),r=n(1663),o=n(93),s=function(){function e(e,t){var n=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider,this._graphUserInfoDataSource=t.graphUserInfoDataSource,this._userInfoDataSource=t.userInfoDataSource,this._isTeamsRelevant=Object(i.l)(n)}return e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):a.n.resolve()},e.prototype.canTeamify=function(){var e=this,t=this._pageContext;return this._isTeamsRelevant&&t.isSiteAdmin?t.isTeamsConnectedSite?a.n.resolve(!1):this._groupsProvider.getTeamifyBannerHidden().then(function(t){return!t&&e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})}):a.n.resolve(!1)},e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue(r.t.teamsTeachingBubble)).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})},e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var n=new o.t(t.toLowerCase());t=decodeURIComponent(n.getStringWithoutQueryAndFragment());for(var a=0,i=e;a<i.length;a++){var r=i[a],s=decodeURIComponent((r.url||"").toLowerCase());if(s.substring(0,t.length)===t||-1!==s.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return r}}},e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,e)},e}()}],Array(98),[function(e,t,n){"use strict";n.d(t,"e",function(){return $});var a=n(0),i=n(1214),r=n(9),o=n(863),s=n(3723),c=n(37),d=n(93),l=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],u=n(997),f=n(859),p=n(2406),m=n(2455),_=n(2328),h=n(10),b=n(136),g=new h.t({name:"ListItemTrendingStatusProcessor.key",loader:new b.t(function(){return n.e(739).then(n.bind(null,5673)).then(function(e){return e.resourceKey})})}),v=n(213),y=n(265),S=n(1365),D=n(1331),I=n(4428),x=n(2655),C=n(3185),O=n(40),w=n(2640),E=n(3724),A=n(96),L=n(51),k=n(14),M=n(100),P=n(4429),T=n(38),U=n(4430),F=n(146),H=n(2299),R=n(1368),N=n(151),B=n(1450),j=n(1017),V=n(226),z=n(2135),G=n(1392),K=n(97),W=n(1416),q=n(3587),Q=n(36),Y=n(1247),J=n(12).e.isActivated("D6DFF276-FF92-454E-AC05-F916D87BD82F","03/08/2022","Update the openUrl for items in a links list with the correct URL from server"),X=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._urlDataSource=n.urlDataSource,a._listContext=n.listContext,a._navigation=n.navigation,a._microServiceDataSource=n.microServiceDataSource,a._vroomUrlHelper=n.vroomUrlHelper,a._itemUrlHelper=n.itemUrlHelper,a._vroomDataContext=n.vroomDataContext,a._shortcutLinkDataSource=n.shortcutLinkDataSource,a._allowWrsVisio=!1,a._htmlDecodeDiv=document.createElement("textarea"),a}return Object(a.__extends)(t,e),t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){throw K.e.log(e,"ListItemBuilder.getItemResult"),e}},t.prototype._getItemResult=function(e){var t,n,i,l,h,b=e.itemFromServer;if(!b)return null;var I,M=e.microServiceDataSource||this._microServiceDataSource,T=this._urlDataSource,U=e.requestKey,F=e.parentItemKey,N=e.queryType,B=void 0===N?T.getQueryType():N,j=e.groupBy,K=e.itemGroups,W=e.contentTypes,Y=e.supportsNestedGroups,X=e.isItemDataOnly,$=e.listTemplateType,ee=void 0===$?this._listContext.listTemplateType:$,te=e.observer,ne=e.isMetaDataSearch,ae=T.getKeyParams(U),ie=this._itemUrlHelper.getUrlParts({path:b.id||b.FileRef||b.ServerRelativeUrl,listUrl:ae[r.n.listUrlKey]});(t={})[r.n.idParamKey]=ie.serverRelativeItemUrl,t[r.n.listUrlKey]=ie.normalizedListUrl,I=t;var re=b.File_x0020_Type,oe=re?"."+re:"",se=this._parseMediaServiceMetadata(b.MediaServiceFastMetadata),ce=this._parseMediaServiceMetadata(b.MediaServiceMetadata),de=this._getItemType({itemFromServer:b,listTemplateType:ee,microServiceDataSource:M,mediaServiceFastMetadata:se});if(de===y.e.Folder){var le=ae[r.n.idParamKey]===I[r.n.idParamKey],ue=T.getItemTypeFilter(ae),fe={};le?((n={})[r.n.queryTypeParamKey]=ae[r.n.queryTypeParamKey],n[r.n.queryParamKey]=ae[r.n.queryParamKey],n[r.n.typeFiltersKey]=ae[r.n.typeFiltersKey],fe=n):(B!==c.e.Search&&((i={})[r.n.queryTypeParamKey]=B,fe=i),ue&&V.e(fe,T.saveItemTypeFilter(ue))),V.e(I,fe),ne&&V.e(I,((l={})[r.n.metadataSearchIdKey]=ae[r.n.metadataSearchIdKey],l))}var pe=T.getKey(I),me={key:pe,extension:oe},_e=b.id||b.FileRef;me.id=_e;var he,be,ge=C.t.fromHexString(b.PermMask),ve=Q.e.hasPermission(ge,Q.e.openItems),ye=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,Se=b[".spItemUrl"];if(Se){var De=this._vroomUrlHelper.getUrlParts(Se);he=De.itemId,be=De.driveId}else he=b["name.FileSystemItemId"]||(b.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,_e);var Ie=b[".etag"];Ie&&(me.eTag=Ie),me.itemId=R.optional(he);var xe=ee===k.t.mySiteDocumentLibrary;me.graph=R.optional(he&&{itemId:he,driveId:be,driveType:ee?xe?"business":"documentLibrary":void 0});var Ce=Number(b._ip_UnifiedCompliancePolicyUIAction)||_.e.none;"1"===this._navigation.viewParams[r.n.pseudoPolicyTipKey]&&(Ce=Number(b.ID)%6),me.policyTip=R.optional(Ce);var Oe=Object(P.t)(oe);if((Oe||".ai"===oe||".eps"===oe||".psd"===oe)&&M.getThumbnail({fileExtension:oe,item:b,itemKey:pe,mediaServiceMetadata:se})&&(de=y.e.Media),q.t(oe)?me.htmlConversion={}:q.e(oe)&&(we=M.getHtmlConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}))&&(de=y.e.Media,me.htmlConversion={url:"".concat(we,"&inlineImages=true")}),Object(O.isFeatureEnabled)(O.EnableZipFilePreviewing)&&(".zip"===oe||".rar"===oe)){var we=M.getZipMetaDataUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),Ee=M.getDownloadZipContentsUrl(b);we&&Ee&&(de=y.e.Media,me.zip={zipMetaDataUrl:we,downloadZipContentsUrl:Ee})}var Ae,Le,ke,Me,Pe,Te,Ue={},Fe=M.getDownloadAsZipUrl(b),He=Object(O.isFeatureEnabled)(O.EnableOpenInImmersiveReader)&&M.getImmersiveReaderUrl({fileExtension:oe,item:b});Fe&&(Ue[o.t.downloadAsZip]=Fe),He&&(Ue[o.t.immersiveReaderUrl]=He),Se&&(Ue[o.t.itemUrl]=Se);var Re=this._listContext,Ne=Number(b.File_x0020_Size)||Number(b.FileSizeDisplay)||void 0,Be=se&&se.video,je=".ts"===oe&&Ne<1<<19&&!Be;je&&(de=y.e.File);var Ve=se&&se.media,ze=ie.fullItemUrl,Ge=ze?f.e(ze):void 0;if(de===y.e.Folder)Ae=b.ProgId&&"sharepoint.documentset"===b.ProgId.toLowerCase();else if(de!==y.e.Media&&!se||Object(k.o)(ee))de===y.e.File&&Re&&void 0!==Re.isDocLib&&!Re.isDocLib&&(Le={});else{var Ke=u.n(oe),We=se&&se.photo||(Oe||"photo"===Ke?{}:void 0),qe=Be||("video"===Ke?{}:void 0),Qe=se&&se.audio||("audio"===Ke?{}:void 0);We&&(ke={originalUrl:R.optional("photo"===Ke?Ge:void 0),width:We.width||0,height:We.height||0},Object(O.isFeatureEnabled)(O.Image360Viewer)&&he&&(Me=this._getImage360(b,se,We,ce))),qe&&(Pe={fourCC:R.optional(qe.fourCC||(".mp4"===oe.toLowerCase()?"H264":void 0)),bitrate:R.optional(qe.encodingBitrate),width:qe.frameWidth||0,height:qe.frameHeight||0,duration:Z(Ve&&Ve.duration),audioFormat:R.optional(Qe&&Qe.format),manifestMetadata:qe.manifestMetadata,altManifestMetadata:qe.altManifestMetadata}),Qe&&(Te={duration:Z(Ve&&Ve.duration)})}var Ye=Ve&&Ve.title;me.caption=R.optional(Ye),me.photo=R.optional(ke),me.image360=R.optional(Me),me.video=R.optional(Pe),me.audio=R.optional(Te),me.listItem=R.optional(Le),F&&(me.parentKey=F),me.isDocSet=R.optional(Ae),ie.serverRelativeItemUrl===ie.serverRelativeListUrl&&(me.isRootFolder=!0);var Je,Xe=z.e.getItemName(b,de,Re);me.name=R.optional(Xe),me.displayName=R.optional(Xe);var Ze,$e=!0;if(b.Modified&&"21"===this._pageContext.webTemplate&&Object(O.isFeatureEnabled)(O.RequestDatesInUtc))try{var et=new Date(b.Modified);me.dateModifiedTime=et,me.dateModifiedValue=et.getTime(),Je=Object(S.c)(et),$e=!1}catch(e){}if($e&&(me.dateModifiedValue=R.optional(b.Modified),Je=b["Modified.FriendlyDisplay"]?Object(D.e)(b["Modified.FriendlyDisplay"]):b.Modified?"".concat(b.Modified):""),me.dateModified=R.optional(Je||void 0),me.permissions=R.optional(ge),K&&j&&j.length>0)if(Y){K[0]||(K[0]=[]);var tt=K[0]&&K[0].length>0?K[0][K[0].length-1]:null,nt=j[0],at=j[1];if(nt&&"1"===b[nt+".newgroup"]){var it=tt?tt.startIndex+tt.count:0,rt=Object(G.t)(Re,b,nt,0,!1,it),ot=this._convertToODNGroup(rt);K[0].push(ot),tt=ot}if(at&&"1"===b[at+".newgroup"]){var st=tt&&tt.children&&tt.children.length>0?tt.children[tt.children.length-1]:null;it=st?st.startIndex+st.count:tt?tt.startIndex:0,Object(G.t)(Re,b,at,1,!1,it,tt);var ct=tt.children.pop();tt.children.push(this._convertToODNGroup(ct))}}else for(var dt=0;dt<j.length;dt++){var lt=j[dt];if(lt){var ut=K[dt]&&K[dt].length>0?K[dt][K[dt].length-1]:null;"1"===b[lt+".newgroup"]&&(it=ut?ut.startIndex+ut.count:0,ot=Object(G.t)(Re,b,lt,dt,!1,it),K[dt]||(K[dt]=[]),K[dt].push(this._convertToODNGroup(ot)))}}if(W&&W.length>0&&b.ContentTypeId)for(var ft=0,pt=W;ft<pt.length;ft++){var mt=pt[ft];if(b.ContentTypeId===mt.contentTypeId&&(Ze=!1,mt.requiredFields))for(var _t=0,ht=mt.requiredFields.split(",");_t<ht.length;_t++){var bt=b[ht[_t]];if(!bt||Array.isArray(bt)&&0===bt.length){Ze=!0;break}}}me.hasMissingMetadata=R.optional(Ze),me.contentTypeId=R.optional(b.ContentTypeId);var gt,vt,yt,St,Dt,It=b.folder,xt=[];if(It){if(me.folder={},me.isDropEnabled=!0,gt=[],It.children){for(var Ct=0,Ot=It.children,wt=Ot.length,Et=0,At=0;At<wt;At++){var Lt=this.getItemResult({requestKey:U,queryType:B,itemFromServer:Ot[At],groupBy:j,itemGroups:xt,contentTypes:W,listTemplateType:ee,supportsNestedGroups:Y,isItemDataOnly:X,observer:te,isMetaDataSearch:ne,pageContext:e.pageContext});Lt&&(gt[At]=Lt.item,Et<10&&Lt.itemType===y.e.Media&&Ct++,Et++)}wt>0&&(Ct>=10||Ct>=wt)&&(me.displayType=c.e.Photos)}}else{if(yt=(yt=b["serverurl.progid"])?yt.substring(1):J||ee!==k.t.links?Ge:b.URL,Ue[o.t.original]=yt,Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutItem({key:pe,extension:oe})&&(de=y.e.Shortcut,b._ShortcutUrl?(me.shortcutInfo={shortcutLinkRewritten:!0},Ue[o.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,b._ShortcutUrl,b._ShortcutSiteId,b._ShortcutWebId,b._ShortcutUniqueId),b._ShortcutUniqueId&&(vt=s.previewImageUrl({url:b._ShortcutUrl,siteId:b._ShortcutSiteId,webId:b._ShortcutWebId,uniqueId:b._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))):(me.shortcutInfo=R.backup({shortcutLinkRewritten:!1}),this._shortcutLinkDataSource.enqueueParseShortcut(pe,e.itemFromServer.ID),Ue[o.t.shortcutTarget]=d.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+A.e.encodeURIComponent(b.FileRef))),Ue[o.t.open]=yt,St=b["File_x0020_Type.mapapp"]||b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],ie.isCrossDomain&&ie.isCrossList){var kt=b[".fileType"],Mt=w.s(kt||"");St=void 0===Mt?kt?void 0:St:Mt,"OneNote.Notebook"===b.HTML_x0020_File_x0020_Type&&(St="onenote|UsePlain"),"pdf"===b.File_x0020_Type&&(St=void 0)}me.size=R.optional(Ne),me.totalSize=R.optional(Number(b.SMTotalSize)||void 0),vt||(vt=this._getThumbnail({itemFromServer:b,listTemplateType:ee,extension:oe,key:pe,type:de,mediaServiceFastMetadata:se,microServiceDataSource:M,pageContext:e.pageContext})),me.openUrl=yt;var Pt=b["IconOverlay.mapoly"];Pt&&(me.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Pt),me.thumbnail=vt;var Tt=this._getPdfConversionFacet({extension:oe,blockDownload:ye,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});Tt&&(me.pdfConversion=Tt);var Ut=this._get3dFacet({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});if(Ut&&(me.model3d=Ut),de===y.e.Folder){var Ft=Number(b.ItemChildCount)+Number(b.FolderChildCount);me.childCount=Ft;var Ht=Number(b.SMTotalFileCount);me.folder={totalCount:Ht>0?Ht:Ft,childCount:Ft},me.isDropEnabled=!0}var Rt=b.ServerRedirectedEmbedUrl;Rt&&(this._itemUrlHelper.getUrlParts({path:Rt}).isCrossDomain||(Dt=Rt))}me.previewIFrameUrl=Dt,me.type=de,me.appMap=R.optional(St),this._pageContext.blockDownloadsExperienceEnabled&&(me.type===y.e.Media||yt&&St)?me.itemStatus=v.t.ConditionalAccessViewOnly:this._pageContext.blockDownloadsExperienceEnabled&&de!==y.e.Folder?me.itemStatus=v.t.ConditionalAccessBlocked:this._pageContext.viewOnlyExperienceEnabled&&(me.itemStatus=v.t.ConditionalAccessViewOnly);var Nt={};for(var Bt in b)b.hasOwnProperty(Bt)&&(Nt[Bt]=b[Bt]);var jt=L.e.normalizeLower(b.UniqueId)||void 0;jt&&(Nt.uniqueId=jt);var Vt=b.RemoteItem;me.remoteItem=Vt&&JSON.parse(Vt),me.reputationProperties=this.getReputationProperties(b);var zt,Gt=Xe;oe&&(Gt=Xe.substring(0,Xe.toLowerCase().lastIndexOf(oe.toLowerCase()))),me.sharingRole=p.e.Owner,zt=Number(b.PrincipalCount)>0?m.e.Shared:void 0===b.PrincipalCount?O.isOneDrive?void 0:m.e.Unknown:m.e.Private,me.sharingType=R.optional(zt),Nt.FileName=Gt;var Kt=u.a({extension:oe,isDocSet:Ae,listItem:Le,sharingType:zt,type:de,textEditorMimeType:je?"text/typescript":void 0,panorama:Me,isMountPoint:!!Vt});me.iconName=Kt;var Wt,qt,Qt="ms-powerpoint"===St,Yt="ms-visio"===St,Jt="ms-word"===St;if(yt&&(Jt||"ms-excel"===St||Qt||Yt)){var Xt=this._getOfficeBundleFacet({isWord:Jt,extension:oe,itemUrlParts:ie,isPowerPoint:Qt,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se});!Xt||Yt&&!this._allowWrsVisio||(me.officeBundle=Xt),Xt&&(Jt||Qt)&&(Ue[o.t.viewInBrowser]=M.getPdfConversionUrl({fileExtension:oe,item:b,mediaServiceMetadata:se},!0)),me.wopiFrameUrl=yt}me.defaultSubText=E.e(E.t(b.Editor)),me.isPlaceholder=!b.PermMask,me.queryType=B,me.displayType=R.backup(me.queryType),me.isDraggable=me.queryType===c.e.Files,b.folder||(Nt.modifiedByUser=E.a(b.Editor)),Nt.MediaServiceOCR=E.i(b.MediaServiceOCR),me.properties=Nt,me.lifeCycleStatus=R.optional(this._getItemLifeCycleStatus(b)),me.comments={settings:(Wt=b._CommentFlags,qt={},qt.isCommentDisabled=function(e){return void 0===e||null==e||(1&e)>0}(Wt),qt)},me.urls=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Ue),this._getVideoUrl({extension:oe,itemFromServer:b,microServiceDataSource:M,mediaServiceFastMetadata:se})),((h={})[o.t.mediaBaseUrl]=M.getMediaBaseUrl({fileExtension:oe,item:b,mediaServiceMetadata:se}),h)),me.searchProperties={isMetadataSearch:ne},null==te||te.update([new H.e(pe).succeed({item:me})]),te&&Object(O.isFeatureEnabled)(O.ItemAnalytics)&&Object(O.isFeatureEnabled)(O.EnableTrendingSignalInListView)&&pe&&this.resources.consumeAsync(g).then(function(e){e.queueNewItem(pe)});var Zt=this._getGroupings({itemFromServer:b,supportsNestedGroups:Y,groupBy:j,groups:xt}),$t=Zt.groupings,en=Zt.totalChildren;return{item:{key:pe},itemPatch:me,itemType:de,children:gt,groupings:$t,totalChildren:en,nextRequestToken:b.nextRequestToken}},t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;return 0!==n&&3!==n&&(t.isMalwareDetected=!0),t},t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,a=e.supportsNestedGroups,i=e.groupBy,r=e.groups,o=null,s=this._listContext.groupLevel,c=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==s)if(n.groups){var d=[],l=0;if(a){var u=Object(G.e)(n.groups,this._listContext,i),f=u.groups,p=u.totalCount;d=f.map(function(e){return t._convertToODNGroup(e)}),l=p}else for(var m=0,_=n.groups;m<_.length;m++){var h=_[m],b=i[s];if(h[b+".newgroup"]){var g=Object(G.t)(this._listContext,h,b,s,!0,l);d.push(this._convertToODNGroup(g)),l+=g.count}}d&&d.length>0&&(o=[{name:void 0,itemGroups:d,isAllCollapsed:this.createObservable(!0)}],c=l)}else r&&r.length>0&&r[s]&&r[s].length>0&&(o=[{name:void 0,itemGroups:r[s],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:c}},t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,a=[],i=n.folder.children,r=n.nextRequestToken?2:0,o=i.length+r,s=0;s<o;s++){var c=i[s];if(c&&this._getItemTypeOneNoteOrFolder(c)!==y.e.Folder){t=s;break}}return(void 0===t&&o>0||t>0)&&a.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})}),void 0!==t&&a.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})}),a.length?[{name:"FoldersDocumentsPhotos",itemGroups:a,isAllCollapsed:this.createObservable(!1)}]:void 0},t.prototype._getImage360=function(e,t,n,a){var i,r=t&&t.panorama,o=!1;if(r&&"equirectangular"===r.projectionType?(i={projectionType:r.projectionType},o=!0):e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0),o&&a){var s=a.panorama;if(s)i={projectionType:R.optional(r.projectionType||void 0),croppedAreaImageHeightPixels:R.optional(s.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:R.optional(s.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:R.optional(s.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:R.optional(s.croppedAreaTopPixels||void 0),fullPanoHeightPixels:R.optional(s.fullPanoHeightPixels||void 0),fullPanoWidthPixels:R.optional(s.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:R.optional(s.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:R.optional(s.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:R.optional(s.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:R.optional(s.initialViewPitchDegrees||void 0),initialViewRollDegrees:R.optional(s.initialViewRollDegrees||void 0),poseHeadingDegrees:R.optional(s.poseHeadingDegrees||void 0),posePitchDegrees:R.optional(s.posePitchDegrees||void 0),poseRollDegrees:R.optional(s.poseRollDegrees||void 0)};else{var c=a.photo;if(c&&c.cameraModel){var d=c.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(d)>=0&&(i={projectionType:"equirectangular"})}}}return i},t.prototype.getReputationProperties=function(e){for(var t={},n=0,a=l;n<a.length;n++){var i=a[n];t[i]=R.optional(e[i])}return t},t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&Y.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}},t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=W.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}},t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,a=e.itemUrlParts,i=e.isPowerPoint,r=e.itemFromServer,o=e.microServiceDataSource,s=e.mediaServiceFastMetadata,c=a.isCrossDomain;if(!c&&("21"===this._pageContext.webTemplate||Object(O.isFeatureEnabled)(O.EnableWrsPreviewOutsideODB))){var d,l,u,f=!c&&(t&&Object(O.isFeatureEnabled)(O.EnableWordWrsPreview)||i&&Object(O.isFeatureEnabled)(O.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:r,mediaServiceMetadata:s}):"",m=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:r,mediaServiceMetadata:s}),_=!1,h="",b=r[".ctag"],g=s&&s.officeBundle;return g&&(d=g.ctag,u=g.version,_=g.fatalError||!1,g.generationTime&&(l=new Date(g.generationTime)),h=g.errorInfo||""),{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:m,bundleCTag:d,bundleVersion:u,hasBundleGenerationFailed:_,bundleErrorInfo:h,generationTime:l,cTag:b,enableDefaultClick:f}}},t.prototype._getThumbnail=function(e){if(e.type!==y.e.Folder){var t=e.itemFromServer;if(Object(k.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(P.e)(e.extension)){if(this._listContext.remoteParentWeb){var a=new d.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(d.e.authority),i=encodeURI(t.FileRef);return s.previewImageUrlFromUrl(A.e.encodeURIComponent(a+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var r=e.pageContext;return r&&r.webAbsoluteUrl&&r.siteId&&r.webId?s.previewImageUrlFromProps(r.siteId,r.webId,t.UniqueId,r.webAbsoluteUrl,r):s.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}},t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};return t&&(n[o.t.video]=t),n},t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.microServiceDataSource,i=e.mediaServiceFastMetadata,r=this._getItemTypeOneNoteOrFolder(t);if(r===y.e.Unknown){var o=t.File_x0020_Type,s=o?".".concat(o):"";if(Object(O.isFeatureEnabled)(O.ShortcutLink)&&x.e.isShortcutFileType(o))return y.e.Shortcut;if(Object(O.isFeatureEnabled)(O.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:s,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:a})))return y.e.Media;if(this._get3dFacet({itemFromServer:t,extension:s,microServiceDataSource:a,mediaServiceFastMetadata:i}))return y.e.Media;if("audio"===u.n(s))return y.e.Media;if(i)return y.e.Media;if((r=u.i(s))===y.e.Unknown)return Object(k.r)(n)?y.e.File:Object(k.o)(n)?y.e.Media:r}return r||y.e.File},t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=y.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],a=e["File_x0020_Type.mapapp"];t=a&&"onenote"===a.substring(0,7)||n&&-1!==n.indexOf("onenote")?y.e.OneNote:y.e.Folder}else t=y.e.Unknown;return t},t.prototype._convertToODNGroup=function(e){var t=this,n=e;return n.state=this.createObservable({isCollapsed:e.isCollapsed}),n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)})),n},t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;return"&"===e[1]&&(this._htmlDecodeDiv.innerHTML=e,t=this._htmlDecodeDiv.innerText),JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{pageContext:T.f,urlDataSource:M.ue,listContext:T.o,navigation:F.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:N.c,vroomDataContext:U.e.optional,shortcutLinkDataSource:I.e}),t}(i.default);function Z(e){return"number"==typeof e?e/1e4:e}var $=Object(b.r)("ListItemBuilder",X)},,function(e,t,n){"use strict";var a=n("knockout-lib"),i=n(5070),r=n(2202),o=n(0),s=n(5318),c=function(e){function t(t){var n=e.call(this,t)||this;return n.seeMoreText=s.e,n.needPadding=t.needPadding,n.seeMoreAriaLabel=s.e,n}return Object(o.__extends)(t,e),t.prototype.onSeeMore=function(t,n){return e.prototype.filterByGroupAndExpand.call(this,t,event)},t}(n(4325).e),d=(r.e({tagName:"ms-listGroup-seeMore",template:'<div class="od-ListGroupSeeMore" data-bind="css:{needPadding:needPadding,\'is-focused\':isFocused},attr:{tabindex:tabindex,\'aria-label\':seeMoreAriaLabel},delayedHasFocus:isFocused,click:onSeeMore,keyboard:{mappings:{Enter:onSeeMore},context:$data}"><span data-bind="text:seeMoreText"></span></div>',viewModel:c,synchronous:!0}),function(){function e(){}return e.getGroup=function(t,n){var a;if(t&&t.length&&t[0].itemGroups)for(var i=0,r=t[0].itemGroups;i<r.length;i++){var o=r[i];if(o){var s=o.startIndex+o.count-1;if(o.startIndex<=n&&s>=n){if(o.children)return e.getGroup([{name:"",itemGroups:o.children}],n);a=o;break}}}return a},e.getHeaderDetails=function(t,n,r,o,s){var c="",d=null,l=20,u="";return t&&"SPListGroup"===t.groupingType&&(l=60,u="header-"+t.groupingId+"_"+t.count+"_itemcount_"+t.startIndex,c=i.e.tagName,d={group:t,cellsInGroup:n,resources:r,isGrid:s,requiredGroup:o,isSelected:a.observable(!1),isFocused:a.observable(!1),key:e.normalizeHeaderKey(u)}),{viewType:c,viewData:d,headerHeight:l,key:u}},e.shouldFetchNextGroup=function(t,n,a,i){var r=t.peek().content.peek().groupings,o=t.peek().content.peek().items;if(r&&r.length&&r[0].itemGroups){var s=e._getLastGroup(r[0].itemGroups);if(n&&n.groupingId===s.groupingId){var c=a===i||a===n.count,d=o&&void 0===o[o.length-1];return c&&d}}return!1},e.getNextGroup=function(t,n){if(t&&t.length&&t[0].itemGroups){var a=e._getLastGroup(t[0].itemGroups);return{groupingId:"__next__",startIndex:a.startIndex+a.count,count:n}}return null},e.updateHeader=function(e,t){e.viewData.cellsInGroup=t,e.key=e.key.replace("itemcount",String(t))},e.normalizeHeaderKey=function(e){var t=e.indexOf("_");return e.substring(0,t-1)},e.getSeeMoreComponent=function(e,t,n,a,i,r,o){var s="seeMore-"+e.groupingId;return{key:s,item:null,cellIndex:n||-1,index:-1,viewType:"ms-listGroup-seeMore",viewData:{group:e,key:s,resources:t,needPadding:o},left:a||0,top:i||0,width:r||0,height:36}},e._getLastGroup=function(e){var t=e[e.length-1];return t.isPlaceholder&&(t=e[e.length-2]),t},e}());t.e=d},,,,function(e,t,n){"use strict";n(2937);var a=n(2202),i=n(0),r=n("knockout-lib"),o=n(5317),s=n(320),c=n(506),d=n(2630),l=n(23),u=n(2629),f=function(e){function t(t){var n=e.call(this,t)||this;n._requiredGroup=t.requiredGroup;var a=n.group.name?n.group.name:o.s;n.headerText=l.format(o.a,a,n.group.count),n.loadingText=o.o,n._cellsInGroup=t.cellsInGroup,n._itemSet=n.resources.consume(s.s),n.isCollapsed=n.createComputed(function(){return!!n.group.state&&n.group.state().isCollapsed}),n._itemsLoaded=n.createComputed(function(){return!!n._itemSet().content().items[n.group.startIndex]}),n.showLoading=n.createComputed(function(){return!n._itemsLoaded()&&!n.isCollapsed()});var i=l.pluralSelect(n.group.count,l.format(o.r,n.group.count),l.format(o.i,n.group.count));n.headerAriaLabel=l.format(o.e,a,i,n.isCollapsed.peek()?o.t:o.n),n.isDroppingTarget=r.observable(!1),n.isDroppable=r.observable(n._canDropItems()),n._dropHelper=n.resources.consume(d.e);var f=n.resources.consume(c.t);return n._parentItem=f.item,n.isDroppable.peek()&&n.addBindingHandlers({dragAndDrop:u.e}),n.showCheckbox=!t.isGrid,n._itemSet=n.resources.consume(s.s),n}return Object(i.__extends)(t,e),t.prototype.onToggleCollapse=function(e,t){return e._toggleGroup(),t.stopPropagation(),t.preventDefault(),!1},t.prototype.onToggleSelect=function(e,t){return e._toggleSelect(),t.stopPropagation(),t.preventDefault(),!1},t.prototype.enterGroup=function(t,n){return e.prototype.filterByGroupAndExpand.call(this,t,event)},t.prototype.onFocusChange=function(e){e&&this._toggleSelect()},t.prototype.onKeyLeftRight=function(e,t){return e.onToggleCollapse(e,t)},t.prototype.onReceiveDrop=function(e){return this.group.state.peek().isCollapsed&&this._toggleGroup(!0),e.metadata={group:this.group},e.itemSet=this._itemSet.peek(),this._dropHelper.processDrop(e,this._parentItem.peek(),!0)},t.prototype.onMayReceiveDrop=function(e){var t=null;return 1!==e.type&&0!==e.type||(t={targetName:this.group.name}),t},t.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)},t.prototype._toggleGroup=function(e){var t=this.group;if(t.state){var n=!e&&!t.state.peek().isCollapsed;t.state({isCollapsed:n}),n||this._itemsLoaded.peek()||this._requiredGroup(t)}},t.prototype._toggleSelect=function(){for(var e=this._itemSet.peek().content.peek().items,t=this.group.startIndex;t<this.group.startIndex+this._cellsInGroup;t++)e[t]&&this.selectionModel.setItemSelected(e[t],!0)},t.prototype._canDropItems=function(){var e="TRUE"===this.group.fieldSchema.ReadOnly,t=null!==this.group.fieldValue;return!e&&t},t}(n(4325).e),p=a.e({tagName:"ms-listGroup-header",template:'<div class="od-ListGroupHeader" data-bind="css:{dropping:isDroppingTarget,\'is-collapsed\':isCollapsed,showCheckbox:showCheckbox,\'is-focused\':isFocused},attr:{tabindex:tabindex,\'aria-label\':headerAriaLabel},delayedHasFocus:isFocused,click:onToggleSelect,keyboard:{mappings:{Left:onKeyLeftRight,Right:onKeyLeftRight,Enter:enterGroup},context:$data},dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}">\x3c!--ko if:showCheckbox--\x3e<ms-item-check class="od-ListGroupHeader-check can-select" data-bind="css:{\'is-selected\':isFocused}"></ms-item-check>\x3c!--/ko--\x3e<i class="od-ListGroupExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true,click:onToggleCollapse,attr:{tabindex:-1}"></i><div class="od-ListGroupHeader-title" href="#" data-bind="text:headerText,click:enterGroup,attr:{tabindex:-1}"></div><span class="od-ListGroupHeader-loading" data-bind="visible:showLoading,text:loadingText"></span></div>',viewModel:f,synchronous:!0});t.e=p},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return S});var a=n(0),i=n("react-lib"),r=n(428),o=n(1214),s=n(435),c=n(2947),d=n(2173),l=n(4290),u=n(53),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._target=Object(i.createRef)(),t._onMenuClicked=function(e,n){var a=t.props,i=a.hideCoachmark,r=a.onMenuClick;r&&r(e,n),i&&i()},t._onClick=function(e,n){var a,i=t.props,r=i.hideCoachmark,o=i.onClick;return o&&(a=o(e,n)),r&&r(),a},t._getCoachmark=function(){var e=t.props,n=e.isCoachmarkVisible,a=e.teachingBubbleCampaign,r=e.onCoachmarkAnimationOpen,o=e.onDismissTeachingBubble;if(n)return i.createElement(l.e,{target:t._target.current,teachingBubbleCampaign:a,onDismiss:o,onAnimationOpenStart:r,onTeachingBubbleSeen:t._onTeachingBubbleSeen})},t._onTeachingBubbleSeen=function(){var e=t.props.resources.consume(s.D.optional);e&&e.markBubbleAsSeen(t.props.teachingBubbleCampaign);var n=t.props.onTeachingBubbleSeen;n&&n()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=void 0===t?d.e:t,r=Object(a.__rest)(e,["defaultRender"]),o=n;return i.createElement(i.Fragment,null,i.createElement("div",{ref:this._target},i.createElement(o,Object(a.__assign)({},r,{onClick:this._onClick,onMenuClick:this._onMenuClicked}))),this._getCoachmark())},t}(i.PureComponent),p=Object(u.i)()(f),m=n(2284),_=n(170),h=n(1002),b=n(57),g=n(228),v=function(e){function t(t){var n=e.call(this,t)||this;n._hideCoachmark=function(){var e=n.state.teachingBubble;e&&n._observables.wrap(e.isVisible)(!1)},n._onDismissTeachingBubble=function(){var e=n.state.teachingBubble;e&&(n._hideCoachmark(),n._isReminderFlowCoachmark&&_.e.logData({name:"ReminderFlowCoachmark.Close"}),n._teachingBubbleProvider.markBubbleAsDismissed(e.campaign()))},n._getCurrentTeachingBubble=function(){return n._observables.unwrap(n._coachmarkProvider.getCurrentTeachingBubble())},n._hideToastNotifications=function(){var e=n.props.resources.consume(m.resourceKey.optional);e&&e.cleanup(!0)},n._onTeachingBubbleSeen=function(){n._isReminderFlowCoachmark()&&_.e.logData({name:"ReminderFlowCoachmark.Rendered"})},n._isReminderFlowCoachmark=function(){var e=n.state.teachingBubble;if(!e)return!1;var t=e.campaign();return t&&t.campaignGuid===h.FLOW_REMIND_ME.campaignGuid};var a=t.resources;return n._scope=new r.e,n._coachmarkProvider=a.consume(c.resourceKey.optional),n._observables=n._scope.attach(new(a.consume(o.observablesFactoryTypeResourceKey))({owner:n})),n.state={isCoachmarkVisible:!1,teachingBubble:n._getCurrentTeachingBubble()},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state,t=e.isCoachmarkVisible,n=e.teachingBubble;return i.createElement(p,Object(a.__assign)({isCoachmarkVisible:t,teachingBubbleCampaign:n&&n.campaign(),hideCoachmark:this._hideCoachmark,onCoachmarkAnimationOpen:this._hideToastNotifications,onDismissTeachingBubble:this._onDismissTeachingBubble,onTeachingBubbleSeen:this._onTeachingBubbleSeen},this.props))},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){e._observables.unwrap(e._coachmarkProvider.getCurrentTeachingBubble())&&e._computeShowCoachmark()})},t.prototype._computeShowCoachmark=function(){var e=this,t=this._getCurrentTeachingBubble();if(t){var n=this._observables.unwrap(t.isVisible),a=t.campaign(),i=this.state.isCoachmarkVisible;this._isCampaignCompatible(a)?(this._teachingBubbleProvider||(this._teachingBubbleProvider=this.props.resources.consume(s.D.optional)),this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(a,!1).then(function(a){e.setState({isCoachmarkVisible:a&&n,teachingBubble:t})})):i&&this.setState({isCoachmarkVisible:!1})}},t.prototype._isCampaignCompatible=function(e){var t=this.props.coachmarkCampaign;return t===e||t===(e&&e.compatibleCampaign)},t}(i.Component),y=Object(u.i)()(v);function S(e,t){var n=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n._update=function(t,a){if(t.doesCoachmarkApply!==a.doesCoachmarkApply){var i=n.props.coachmarkProvider;t.doesCoachmarkApply?i.isVisible.peek()||i.setCampaign(e):i.isVisible.peek()&&e===i.currentCampaign.peek()&&i.hideCampaign()}},n}return Object(a.__extends)(n,t),n.prototype.componentDidMount=function(){this._update(this.props,{doesCoachmarkApply:!1})},n.prototype.render=function(){return i.createElement(y,Object(a.__assign)({},this.props))},n.prototype.componentDidUpdate=function(e){this._update(this.props,e)},n}(i.PureComponent),r=Object(b.e)(function(e){return{doesCoachmarkApply:t(e,{})}})(function(e){return function(t){return Object(u.i)()(Object(g.t)(function(t){return{coachmarkCampaign:e,coachmarkProvider:t.resources.consume(c.resourceKey.optional)}})(t))}}(e)(n));return r}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a,i,r,o=n(895),s=n(4),c=n("react-lib"),d=n(494),l=n(671),u=n(1036),f=n(195),p=n(98),m=n(1836),_=n(1967),h=n(496),b=n(3461),g=Object(d.e)(),v=function(e){function t(t){var n,a=e.call(this,t)||this;return a.ICON_MAP=((n={})[b.e.info]="Info",n[b.e.warning]="Info",n[b.e.error]="ErrorBadge",n[b.e.blocked]="Blocked2",n[b.e.severeWarning]="Warning",n[b.e.success]="Completed",n),a._getRegionProps=function(){var e=!!a._getActionsDiv()||!!a._getDismissDiv(),t={"aria-describedby":a.state.labelId,role:"region"};return e?t:{}},a._onClick=function(e){a.setState({expandSingleLine:!a.state.expandSingleLine})},Object(l.e)(a),a.state={labelId:Object(u.e)("MessageBar"),showContent:!1,expandSingleLine:!1},a}return Object(s.a)(t,e),t.prototype.render=function(){var e=this.props.isMultiline;return this._classNames=this._getClassNames(),e?this._renderMultiLine():this._renderSingleLine()},t.prototype._getActionsDiv=function(){return this.props.actions?c.createElement("div",{className:this._classNames.actions},this.props.actions):null},t.prototype._getDismissDiv=function(){var e=this.props,t=e.onDismiss,n=e.dismissIconProps;return t?c.createElement(_.e,{disabled:!1,className:this._classNames.dismissal,onClick:t,iconProps:n||{iconName:"Clear"},title:this.props.dismissButtonAriaLabel,ariaLabel:this.props.dismissButtonAriaLabel}):null},t.prototype._getDismissSingleLine=function(){return this.props.onDismiss?c.createElement("div",{className:this._classNames.dismissSingleLine},this._getDismissDiv()):null},t.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?c.createElement("div",{className:this._classNames.expandSingleLine},c.createElement(_.e,{disabled:!1,className:this._classNames.expand,onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel,"aria-expanded":this.state.expandSingleLine})):null},t.prototype._getIconSpan=function(){var e=this.props.messageBarIconProps;return c.createElement("div",{className:this._classNames.iconContainer,"aria-hidden":!0},e?c.createElement(h.e,Object(s.e)({},e,{className:Object(f.e)(this._classNames.icon,e.className)})):c.createElement(h.e,{iconName:this.ICON_MAP[this.props.messageBarType],className:this._classNames.icon}))},t.prototype._renderMultiLine=function(){return c.createElement("div",Object(s.e)({className:this._classNames.root},this._getRegionProps()),c.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv())},t.prototype._renderSingleLine=function(){return c.createElement("div",Object(s.e)({className:this._classNames.root},this._getRegionProps()),c.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine()))},t.prototype._renderInnerText=function(){var e=Object(p.s)(this.props,p.c,["className"]);return c.createElement("div",{className:this._classNames.text,id:this.state.labelId,role:"status","aria-live":this._getAnnouncementPriority()},c.createElement("span",Object(s.e)({className:this._classNames.innerText},e),c.createElement(m.e,null,c.createElement("span",null,this.props.children))))},t.prototype._getClassNames=function(){var e=this.props,t=e.theme,n=e.className,a=e.messageBarType,i=e.onDismiss,r=e.actions,o=e.truncated,s=e.isMultiline,c=this.state.expandSingleLine;return g(this.props.styles,{theme:t,messageBarType:a||b.e.info,onDismiss:void 0!==i,actions:void 0!==r,truncated:o,isMultiline:s,expandSingleLine:c,className:n})},t.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case b.e.blocked:case b.e.error:case b.e.severeWarning:return"assertive"}return"polite"},t.defaultProps={messageBarType:b.e.info,onDismiss:void 0,isMultiline:!0},t}(c.Component),y=n(71),S=n(661),D=n(48),I=n(360),x={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},C=((a={})[b.e.error]="errorBackground",a[b.e.blocked]="errorBackground",a[b.e.success]="successBackground",a[b.e.warning]="warningBackground",a[b.e.severeWarning]="severeWarningBackground",a[b.e.info]="infoBackground",a),O=((i={})[b.e.error]="rgba(255, 0, 0, 0.3)",i[b.e.blocked]="rgba(255, 0, 0, 0.3)",i[b.e.success]="rgba(48, 241, 73, 0.3)",i[b.e.warning]="rgba(255, 254, 57, 0.3)",i[b.e.severeWarning]="rgba(255, 0, 0, 0.3)",i[b.e.info]="Window",i),w=((r={})[b.e.error]="errorIcon",r[b.e.blocked]="errorIcon",r[b.e.success]="successIcon",r[b.e.warning]="warningIcon",r[b.e.severeWarning]="severeWarningIcon",r[b.e.info]="infoIcon",r),E=Object(o.e)(v,function(e){var t,n,a,i,r,o=e.theme,c=e.className,d=e.onDismiss,l=e.truncated,u=e.isMultiline,f=e.expandSingleLine,p=e.messageBarType,m=void 0===p?b.e.info:p,_=o.semanticColors,h=o.fonts,g=Object(y.u)(0,y.a),v=Object(S.e)(x,o),E={fontSize:D.n.xSmall,height:10,lineHeight:"10px",color:_.messageText,selectors:(t={},t[y.e]=Object(s.e)(Object(s.e)({},Object(y.l)()),{color:"WindowText"}),t)},A=[Object(I.t)(o,{inset:1,highContrastStyle:{outlineOffset:"-6px",outline:"1px solid Highlight"},borderColor:"transparent"}),{flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":E,":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}}];return{root:[v.root,h.medium,m===b.e.error&&v.error,m===b.e.blocked&&v.blocked,m===b.e.severeWarning&&v.severeWarning,m===b.e.success&&v.success,m===b.e.warning&&v.warning,u?v.multiline:v.singleline,!u&&d&&v.dismissalSingleLine,!u&&l&&v.expandingSingleLine,{background:_[C[m]],color:_.messageText,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(n={".ms-Link":{color:_.messageLink,selectors:{":hover":{color:_.messageLinkHovered}}}},n[y.e]=Object(s.e)(Object(s.e)({},Object(y.l)()),{background:O[m],border:"1px solid WindowText",color:"WindowText"}),n)},u&&{flexDirection:"column"},c],content:[v.content,{display:"flex",width:"100%",lineHeight:"normal"}],iconContainer:[v.iconContainer,{fontSize:D.n.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"}],icon:{color:_[w[m]],selectors:(a={},a[y.e]=Object(s.e)(Object(s.e)({},Object(y.l)()),{color:"WindowText"}),a)},text:[v.text,Object(s.e)(Object(s.e)({minWidth:0,display:"flex",flexGrow:1,margin:8},h.small),{selectors:(i={},i[y.e]=Object(s.e)({},Object(y.l)()),i)}),!d&&{marginRight:12}],innerText:[v.innerText,{lineHeight:16,selectors:{"& span a":{paddingLeft:4}}},l&&{overflow:"visible",whiteSpace:"pre-wrap"},!u&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!u&&!l&&{selectors:(r={},r[g]={overflow:"visible",whiteSpace:"pre-wrap"},r)},f&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:v.dismissSingleLine,expandSingleLine:v.expandSingleLine,dismissal:[v.dismissal,A],expand:[v.expand,A],actions:[u?v.actions:v.actionsSingleline,{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",selectors:{"& button:nth-child(n+2)":{marginLeft:8}}},u&&{marginBottom:8},d&&!u&&{marginRight:0}]}},void 0,{scope:"MessageBar"})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n("react-lib"),i=n(320),r=n(132),o=n(4238),s=n(5),c=n(4434),d=Object(o.e)({isAvailable:function(e,t){var n=Object(r.e)(e);if(n.length>1)return!1;var a=n[0];if(a){var i=e.demandItem({fileName:s.m},a).fileName;return Object(c.e)(i)}return!1},getKnockoutAction:function(e,t){var n=e.consume(i.e);return new(e.injected(n.OpenInClipchampAction))}}),l=n(664),u=n(58),f=Object(u.e)("openInClipchamp"),p=n(892),m={key:f,name:l.OpenInClipchamp,action:a.createElement(d,null),iconProps:{iconType:p.e.Image,imageProps:{src:window.require.toUrl("odsp-media/images/clipchamp/clipchamp_256x.svg"),width:"16px",height:"16px"}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n("react-lib"),i=n(320),r=n(132),o=n(4238),s=n(5),c=n(4860),d=Object(o.e)({isAvailable:function(e,t){var n=Object(r.e)(e);if(n.length>1)return!1;var a=n[0];if(a){var i=e.demandItem({fileName:s.m},a).fileName;return Object(c.e)(i)}return!1},getKnockoutAction:function(e,t){var n=e.consume(i.e);return new(e.injected(n.EditInClipchampAction))}}),l=n(664),u=n(58),f=Object(u.e)("editInClipchamp"),p=n(892),m={key:f,name:l.EditInClipchamp,action:a.createElement(d,null),iconProps:{iconType:p.e.Image,imageProps:{src:window.require.toUrl("odsp-media/images/clipchamp/clipchamp_256x.svg"),width:"16px",height:"16px"}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n("react-lib"),i=n(0),r=n(16),o=n(53),s=n(38),c=n(91),d=n(3118),l=n(100),u=n(97),f=n(13),p=n(57),m=n(5),_=n(22),h=n(21),b=Object(p.t)(function(e,t){var o,f,p,b,g=e.demandItemFacet(r.u,r.c),v=e.dispatch,y=t.itemKey,S=(null===(f=null===(o=e.demandItem({fileName:m.m},y))||void 0===o?void 0:o.fileName)||void 0===f?void 0:f.name)||"",D=(null===(b=null===(p=e.demandItem({fileName:m.m},y))||void 0===p?void 0:p.fileName)||void 0===b?void 0:b.extension)||"";if(!g)return null;var I=t.resources.consume(s.f),x=function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var e,a,r,o,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Promise.resolve().then(n.bind(null,881))];case 1:return e=i.sent().getSessionToken,[4,v(e({scopes:["InformationProtection.Read.All"],endpoint:t}))];case 2:return[2,null==(a=i.sent())?void 0:a.accessToken];case 3:return r=i.sent(),u.e.logError(r,{eventName:"fetchGraphToken",feature:"CreateModelPanel",errorCode:null===(o=null==r?void 0:r.errorData)||void 0===o?void 0:o.code,correlationId:null===(s=null==r?void 0:r.errorData)||void 0===s?void 0:s.correlationId,status:null===(c=null==r?void 0:r.errorData)||void 0===c?void 0:c.status}),[2,""];case 4:return[2]}})})},C=Object(h.o)(function(e){var t=Object(c.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(579)]).then(n.bind(null,4767))];case 1:return[2,e.sent().default]}})})});function r(){e&&e.resolve&&e.resolve(),g&&g.consumeAsync(l.L).then(function(e){e.invalidateCurrentItemSet()})}return a.createElement(t,{isCopyModel:!0,modelName:S,extension:D,getAuthToken:x,screenReaderAlert:d.e.alert,pageContext:I,onDismiss:r,onComplete:r})});return a.createElement(_.e,{engagement:{isIntentional:!0,name:"CopyModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!!y,onExecute:C})}),g=Object(f.r)()(Object(f.a)()(b)),v=n(664),y=n(58),S=Object(y.e)("copyModel"),D=n(50),I={key:S,name:v.CopyModelText,action:a.createElement(D.t,null,a.createElement(function(){var e=Object(o.n)();return a.createElement(g,{resources:e})},null)),iconProps:{iconName:"Copy"}}},function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n("react-lib"),i=n(664),r=n(58),o=Object(r.e)("renameModel"),s=n(0),c=n(53),d=n(38),l=n(91),u=n(3118),f=n(13),p=n(57),m=n(5),_=n(16),h=n(100),b=n(1),g=n(22),v=n(21),y=Object(p.t)(function(e,t){var i,r,o,c,f=e.demandItemFacet(_.u,_.c),p=t.itemKey,y=(null===(r=null===(i=e.demandItem({fileName:m.m},p))||void 0===i?void 0:i.fileName)||void 0===r?void 0:r.name)||"",S=(null===(c=null===(o=e.demandItem({fileName:m.m},p))||void 0===o?void 0:o.fileName)||void 0===c?void 0:c.extension)||"";if(!f)return null;var D=e.demandItemFacet(b.Ye,p),I=t.resources.consume(d.f),x=Object(v.o)(function(e){var t=Object(l.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(579)]).then(n.bind(null,4767))];case 1:return[2,e.sent().default]}})})});function i(){e&&e.resolve&&e.resolve(),f&&f.consumeAsync(h.L).then(function(e){e.refreshItemsInCurrentItemSet([D||""])})}return a.createElement(t,{isRenameModel:!0,modelName:y,extension:S,screenReaderAlert:u.e.alert,pageContext:I,onDismiss:i,onComplete:i})});return a.createElement(g.e,{engagement:{isIntentional:!0,name:"RenameModelPanelOpen",currentPage:"ModelListPage"},isAvailable:!!p,onExecute:x})}),S=Object(f.r)()(Object(f.a)()(y)),D=n(50),I={key:o,name:i.RenameModel,action:a.createElement(D.t,null,a.createElement(function(){var e=Object(c.n)();return a.createElement(S,{resources:e})},null)),iconProps:{iconName:"rename"}}},,,function(e,t,n){"use strict";var a=n(0),i=n(65),r=n(1214),o=n(240),s=n(601),c=n(1195),d=n(138),l=n(83),u=[1,0],f=new o.e,p=function(){function e(){this._started=!1,this._done=!1,this._bundleGroups={},this._queuedBundles=[]}return Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!1,configurable:!0}),e.prototype.start=function(){var e=this;this._started||(this._started=!0,f.setTimeout(function(){return e._next()},1e3))},e.prototype.queueLoad=function(e,t,n){var a=this._getGroup(e,n),i=this._generateModuleRequest(a,e,t,n);return this._queueBundle(a),i.signal.getPromise()},e.prototype.waitFor=function(e,t){var n=this._getGroup(e,t);return this._generateModuleRequest(n,e,0,t).signal.getPromise()},e.prototype.loadNow=function(e,t){var n=this._getGroup(e,t),a=this._generateModuleRequest(n,e,0,t);return n.isResolved||this._requestBundle(n).done(),a.signal.getPromise()},e.prototype._getGroup=function(e,t){var n=window.require.toUrl(e),a=this._bundleGroups[n];return a||(a=this._createGroup(e,n,t),this._bundleGroups[n]=a),a},e.prototype._createGroup=function(e,t,n){var a=window.require.specified(t),i={bundleUrl:t,requestedPath:e,getModule:n,modules:a?null:{},isResolved:a,isQueued:!1};if(!a)for(var r=0,o=u;r<o.length;r++){var s=o[r];i.modules[s]=[]}return i},e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new s.e,isResolved:!1}},e.prototype._addNewModule=function(e,t,n,a){var i=this._createModuleRequest(t,a);return e.modules[n].push(i),i},e.prototype._generateModuleRequest=function(e,t,n,a){var i;return e.isResolved?(i=this._createModuleRequest(t,a),this._resolveModule(i)):i=this._addNewModule(e,t,n,a),i},e.prototype._queueBundle=function(e){e.isQueued||(this._queuedBundles.push(e),e.isQueued=!0,this._done&&(this._done=!1,this._next()))},e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var n=this._requestBundle(t);n&&n.then(function(){f.setTimeout(function(){return e._next()},500)}).done()}}},e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0},e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return i.n.wrap();for(var n=[],a=0,r=e.modules[t];a<r.length;a++){var o=r[a];this._resolveModule(o),n.push(o.signal.getPromise())}return i.n.all(n).then(function(){},function(){})},e.prototype._processBundle=function(e){for(var t=this,n=function(n,a){return a.then(function(){return t._processBundlePriorityLevel(e,n)})},a=i.n.wrap(),r=0,o=u;r<o.length;r++)a=n(o[r],a);return a.then(function(){e.isResolved=!0,e.modules=null})},e.prototype._requestBundle=function(e){var t=this,n=new d.e({name:"DeferredBundleLoad"});return Object(c.e)({path:e.requestedPath,getModule:e.getModule}).then(function(){return n.end({resultType:l.e.Success,extraData:{path:e.requestedPath,url:e.bundleUrl}}),t._processBundle(e)},function(t){n.end({resultType:l.e.Failure,error:t,extraData:{path:e.requestedPath,url:e.bundleUrl}})})},e.prototype._resolveModule=function(e){e.isResolved=!0,e.path&&Object(c.e)({path:e.path,getModule:e.getModule}).then(function(t){e.signal.complete(t)})},e}(),m=n(100),_=n(97),h=function(e){function t(t){var n=e.call(this,t)||this;return n._resources=[],n._finished=new s.e,n.finishedProcessing=n._finished.getPromise(),n.isLoaded=n.createObservable(!1),n.createBackgroundComputed(n._computeShouldProcess),n}return Object(a.__extends)(t,e),t.prototype.expose=function(e,t){this._resources.push({key:e,getModule:t}),this.isLoaded.peek()&&this._processResources()},t.prototype._processResources=function(){for(var e=this,t=i.n.resolve(),n=0,a=this._resources;n<a.length;n++){var r=a[n];t=this._processResource(t,r)}t.then(function(){e._resources.length=0,e._finished.complete()})},t.prototype._processResource=function(e,t){var n=this;return e.then(function(){return t.getModule()}).then(function(e){try{var a=new(n.managed(e.default))({});n.resources.expose(t.key,a)}catch(n){_.e.logError(n,{rawResult:"(".concat(typeof e,"): ").concat(e.default),resourceKey:"(".concat(t.key.id,"): ").concat(t.key.name)})}})},t.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()},t}(r.default),b=n(73),g=n(297),v=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._queue=new p;var a=n._pageLoadMonitor=n.resources.consume(b.e),i=n.isPageLoaded=n.observables.create(a.isPageLoaded),r=n.isPageRenderingComplete=n.observables.create(a.isPageRenderingComplete);if(a.isPageLoaded?n._onPageLoaded():a.waitForPLT().then(function(){i(a.isPageLoaded),n._onPageLoaded()}),a.isPageRenderingComplete||a.waitForPageRenderingComplete().then(function(){r(a.isPageRenderingComplete)}),n.resources.isExposed(m.i)){var o=n.resources.consume(m.i);n._bundles=o.getBundles()}else n._bundles={};return n}return Object(a.__extends)(t,e),t.prototype.pageLoaded=function(e){Object(g.e)(0),this._pageLoadMonitor.pageLoaded(e)},t.prototype.pageRenderingIsComplete=function(e){this._pageLoadMonitor.pageRenderingIsComplete(e)},t.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)},t.prototype.queueBundle=function(e,t){var n=this.getBundleInfo(e);this.queueLoad(n.path,t||n.getModule).then(function(){n.isLoaded(!0)})},t.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),n=new(this.managed(h))({});return t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){n.finishedProcessing.then(function(){t.isLoaded(!0)}),n.isLoaded(!0)}),n},t.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)},t.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)},t.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];return t||(t={path:"",getModule:function(){return i.n.as(void 0)},isLoaded:this.createObservable(!1)},this._bundles[e]=t),t}},t.prototype.waitForPLT=function(){return this._pageLoadMonitor.waitForPLT()},t.prototype.waitForPageRenderingComplete=function(){return this._pageLoadMonitor.waitForPageRenderingComplete()},t.prototype._onPageLoaded=function(){this._queue.hasStarted||this._queue.start()},t}(r.default);t.e=v}],Array(18),[function(e,t,n){"use strict";var a=n(0),i=n(2255),r=n(2264),o=n(4416),s=n(65),c=n(1214),d=n("knockout-lib");function l(e,t){var n,a=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),r=e.subscribe(function(){a(e.peek()-n)});return a(e.peek()),{dispose:function(){i.dispose(),r.dispose(),a(-e.peek())}}}var u=n(4417),f=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(a.__extends)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(u.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n,a,i,o,s,c,u=e.createPureComputed(function(){return r.e[t.state()]}),f=e.addDisposable(l(t.progress.minimum,e.progress.minimum)),p=e.addDisposable(l(t.progress.maximum,e.progress.maximum)),m=e.addDisposable(l(t.progress.current,e.progress.current)),_=e.addDisposable((n=u,a=e.states,o=function(e,t){var n=a.peek();void 0!==e&&n[e]--,void 0!==t&&(n[t]=(n[t]||0)+1),a.valueHasMutated()},s=n.subscribe(function(){i=n.peek()},null,"beforeChange"),c=n.subscribe(function(){o(i,n.peek())}),o(void 0,n.peek()),{dispose:function(){s.dispose(),c.dispose(),o(n.peek(),void 0)}})),h=e.addDisposable(function(e,t){var n=e.peek(),a=e.subscribe(function(){n=e.peek()},null,"beforeChange"),i=d.computed(function(){!t()&&e()&&t(e())}),r=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){i.dispose(),r.dispose(),a.dispose()}}}(t.error,e.error)),b=e.addDisposable(l(t.count,e.count)),g=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){u.dispose(),f.dispose(),p.dispose(),m.dispose(),_.dispose(),g.dispose(),h.dispose(),b.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?r.e.started:e.created?r.e.created:e.failed?r.e.failed:e.completed?r.e.completed:e.canceled?r.e.canceled:r.e.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return s.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||s.n.wrap()}))}}))},t}(c.default);t.e=f},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("searchBoxDataSource")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(10).t)("scopingControlDataSource")},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n("react-lib"),r=n(2146),o=n(2161),s=n(738),c=n(2167),d=n(541),l=function(e){function t(t){var n=e.call(this,t)||this;return n._onClose=function(){n.setState({isOpen:!1})},n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e),n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0}),n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)},n.state={isOpen:!0,isIFrameLoaded:!1},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})},t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(a.__rest)(t,["url","heightOffset"])),u=this.state.isIFrameLoaded;return i.createElement(o.e,Object(a.__assign)({className:"IFrameDialog_f1ffb820",hidden:!this.state.isOpen,type:s.e.close},l),i.createElement(r.e,null,!u&&i.createElement(c.e,{size:d.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:u?"block":"none"},onLoad:this._iframeOnLoad})))},t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose,t.commitPopup=this._onClose}this._iframeElement=e},t}(i.Component)},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(982);function i(e,t){t?e.updateViewParams(t,{clearOtherParams:!0}):(delete e.viewParams[a.n.queryTypeParamKey],delete e.viewParams[a.n.queryParamKey],delete e.viewParams[a.n.searchScopeKey],delete e.viewParams[a.n.metadataSearchIdKey],e.updateViewParams({}))}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(11),i=n(731),r=n(28),o=n(0),s=n("react-lib"),c=n(91),d=Object(c.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(55)]).then(n.bind(null,4332))];case 1:return[2,e.sent().PropertiesForm]}})})});function l(e,t){return{getPropertiesForm:function(e){return s.createElement(d,Object(o.__assign)({},e))}}}var u=n(1288),f=Object(a.t)(function(){return function(e){e(Object(i.e)(r.e,u.e)(l))}})},,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="Unsupported",t}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!1},t}(n(2213).e),r=i;t.e=function(){this.AddCoverPhotoAction=r,this.AddExistingAppViewAction=r,this.AddFlowAction=r,this.AddPhotosToAlbumAction=r,this.EditSmartTemplateAction=r,this.DeleteSmartTemplateAction=r,this.DeleteSmartTemplateWithProgressAction=r,this.PublishSmartTemplateAction=r,this.PublishSmartTemplateWithProgressAction=r,this.UnPublishSmartTemplateAction=r,this.UnPublishSmartTemplateWithProgressAction=r,this.ActivateUniversalAnnotationAction=r,this.AddToAlbumAction=r,this.AddToBundleAction=r,this.AddToFolderAction=r,this.AddToFolderAction=r,this.AddToQuickLaunchAction=r,this.AddToSharedListAction=r,this.AddToSpotlightAction=r,this.AlertAction=r,this.ApplyOfficeLensAction=r,this.ApproveRejectAction=r,this.AuthenticationPolicyWarningAction=r,this.AutoExecuteAction=r,this.CancelEditAction=r,this.ChangeAppViewVisibilityAction=r,this.ChangeFolderTypeAction=r,this.CheckInAction=r,this.CheckOutAction=r,this.ClearFilterAction=r,this.ClearSelectionAction=r,this.ComplianceDetailsAction=r,this.ContentTypeNavigationAction=r,this.LaunchConfigureFlowsPanelAction=r,this.CopyFieldAction=r,this.CopyFormAction=r,this.CreateAlbumAction=r,this.CreateAlbumFromFolderAction=r,this.CreateAppViewAction=r,this.CreateColumnAction=r,this.CreateCustomDocumentAction=r,this.CreateDocumentAction=r,this.CreateFileRequestAction=r,this.CreateFolderAction=r,this.CreateItemAction=r,this.CreateMountPointAction=r,this.CreateNewFolderAction=r,this.CreateSitePageAction=r,this.CustomActionNavigationAction=r,this.CustomizeClientFormAction=r,this.CustomizeFormsNavigationAction=r,this.CustomizeViewAction=r,this.DefaultClickAction=r,this.DeleteAction=r,this.DeleteTemplateAction=r,this.DeleteAppAction=r,this.DeleteViewAction=r,this.DiscardAutoAlbumAction=r,this.DownloadAction=r,this.OpenSWAAction=r,this.DownloadZipContentsAction=r,this.EditAction=r,this.EditInClipchampAction=r,this.EditItemAction=r,this.EditItemCancelAction=r,this.EditItemSaveAction=r,this.EditNewAppViewAction=r,this.EditNewMenuAction=r,this.EditNewMenuPaneAction=r,this.EditPdfAction=r,this.EditRenditionsAction=r,this.EditTagsAction=r,this.EmbedAction=r,this.EmptyRecycleBinAction=r,this.ExportListAction=r,this.ExternalNavigateAction=r,this.FeedbackAction=r,this.FileHandlerOpenAction=r,this.FileHandlerCreateAction=r,this.FilterAction=r,this.FilterSearchAction=r,this.FilterSearchByDateAction=r,this.GetLinkAction=r,this.GroupItemsAction=r,this.ImplicitSaveAutoAlbumAction=r,this.InvokeFirstRunExperienceAction=r,this.LanguagePickerAction=r,this.LaunchApprovalDetailsDialogAction=r,this.LaunchChangeTheLookPanelAction=r,this.LaunchColumnCustomizationPaneAction=r,this.LaunchColumnManagementPanelAction=r,this.LaunchCreateAppViewPanelAction=r,this.LaunchCreateGroupPanelAction=r,this.LaunchCreateListDialog=r,this.LaunchCreateShortcutPanel=r,this.LaunchDocLibSettingPanelAction=r,this.LaunchFilterPanelAction=r,this.LaunchFlowWidgetPanelAction=r,this.LaunchFormatViewPaneAction=r,this.LaunchGroupifyPanelAction=r,this.LaunchGroupMembershipPanelAction=r,this.LaunchListCreationPanelAction=r,this.LaunchListFormAction=r,this.LaunchMoveCopyPanelAction=r,this.LaunchPdfExtractionAction=r,this.LaunchSitePermissionsPanelAction=r,this.LaunchSiteSettingsPanelAction=r,this.LaunchGlobalNavSettingsPanelAction=r,this.LaunchWebTemplatesGalleryAction=r,this.LaunchUserExpirationPanelAction=r,this.LaunchVivaConnectionsSettingsPanelAction=r,this.ListFormActivityPaneToggleAction=r,this.MakeHomepageAction=r,this.VaultAction=r,this.ModifyColumnAction=r,this.ModifyShowInFiltersPaneAction=r,this.MoveCopyAction=r,this.MoveLeftSpotlightAction=r,this.MoveRightSpotlightAction=r,this.NavigateToItemAction=r,this.NavigateToSharePointHomeAction=r,this.NavigationAction=r,this.NewClipchampAction=r,this.OneDriveSortAction=r,this.OpenAction=r,this.OpenChatAction=r,this.OpenAppAction=r,this.OpenDocSetAction=r,this.OpenHyperlinkAction=r,this.OpenInExplorerAction=r,this.OpenInfoPathAction=r,this.OpenInImageEditorAction=r,this.OpenInOfficeClientAction=r,this.OpenInOfficeOnlineAction=r,this.OpenInImmersiveReaderAction=r,this.OpenInSharePointAction=r,this.OpenInDesktopAction=r,this.OpenInTextEditorAction=r,this.OpenInClipchampAction=r,this.OpenInHtmlViewerAction=r,this.OpenNeedsAttentionViewAction=r,this.OpenPdfInBrowserAction=r,this.OpenInPowerBIAction=r,this.OpenShortcutAction=r,this.OpenSiteAction=r,this.OrderPrintsAction=r,this.PinToMruAction=r,this.PlayAudioAction=r,this.PlaySlideShowAction=r,this.PolicyTipAction=r,this.PreviewAction=r,this.PrintPdfAction=r,this.PublishAction=r,this.RedeemAction=r,this.RedeemCodeAction=r,this.RemoveCoverPhotoAction=r,this.RemoveFromAlbumAction=r,this.RemoveFromBundleAction=r,this.RemoveFromRecentAction=r,this.RemoveFromSharedListAction=r,this.RemoveFromSpotlightAction=r,this.RemoveMountPointAction=r,this.RemoveOfficeLensAction=r,this.RemoveTagAction=r,this.RemoveTagFromItemAction=r,this.RenameAction=r,this.RenameColumnAction=r,this.ReportAbuseAction=r,this.RequestReviewAction=r,this.RestoreAction=r,this.RestoreAllAction=r,this.RestoreFilesAction=r,this.RotateAction=r,this.SaveAction=r,this.SaveAutoAlbumAction=r,this.SaveSortOrderAction=r,this.SaveViewAction=r,this.SeeAllAppsAction=r,this.SelectAction=r,this.SelectAllAction=r,this.SetAlbumCoverPhotoAction=r,this.SetDefaultViewAction=r,this.SetFocusAction=r,this.SetPhotosRootAction=r,this.SetUpApprovalFlowAction=r,this.SetUpReminderFlowAction=r,this.ShareAction=r,this.ShareByLinkAction=r,this.ShowExistingFlowsAction=r,this.ShowFiltersAction=r,this.ShowItemAnalyticsAction=r,this.ShowSuggestedFilesAction=r,this.ShowKeyPointsAction=r,this.ShowKeyboardMapAction=r,this.ShowMalwareDetectedAction=r,this.ShowOperationsAction=r,this.ShowPermissionsAction=r,this.ShowPropertiesAction=r,this.ShowRunReportAction=r,this.ShowSelectionAction=r,this.ShowVersionHistoryAction=r,this.SignOutAction=r,this.StopSlideShowAction=r,this.SurveyAction=r,this.SwitchPhotoFolderLayoutTypeAction=r,this.SwitchSharingLinkAction=r,this.SwitchViewAction=r,this.SyncAction=r,this.SynchronizeAppViewAction=r,this.LaunchTeamChannelAction=r,this.ToggleAction=r,this.ToggleDebugWindowAction=r,this.ToggleIsLeftNavUserExpandedAction=r,this.ToggleListLayoutAction=r,this.ToggleSelectionModeAction=r,this.TriggerFlowAction=r,this.TriggerFlowByIdAction=r,this.TriggerODBConvertToPdfFlowAction=r,this.TriggerODBRequestSignOffFlowAction=r,this.TriggerSignoffFlowAction=r,this.TriggerExtractFileMetadataFlowAction=r,this.UndoCheckOutAction=r,this.UnPublishAction=r,this.UpdateCaptionAction=r,this.UpdatePermissionsAction=r,this.UploadAction=r,this.UploadTemplateAction=r,this.QuotaBlockAction=r,this.ViewInFolderAction=r,this.ViewItemAction=r,this.ViewOriginalAction=r,this.WorkflowAction=r}},function(e,t,n){"use strict";var a=n(0),i=n(181),r=n(2213),o=n(83),s=n(320),c=n(265),d=n(100),l=n(435),u=n(65),f=n(996),p=n(105),m=n(2221),_=n(2529),h=n(4433),b=n(2722),g=n(547),v=new b.e("Open",b.t.intent),y=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="DefaultClick",a.isQosLogged=!1;var i=t.item,r=t.userInvokedItem,o=void 0!==r&&r,c=t.hideIfDefaultIsDownload,u=void 0!==c&&c,p=t.sourceEngagement,_=void 0===p?"":p,h=a,g=h.resources,y=h.observables;return g.expose(b.n,g.consume(b.n).withPart(v)),a._itemSelectionHelper=new(a.child(m.e))({overrideItem:i,allowMultiSelect:!1,canFallback:!1}),a.item=a._itemSelectionHelper.firstItem,a.sourceEngagement=_,a.userInvokedItem=o,a.hideIfDefaultIsDownload=u,a.actionMap=g.consume(s.e),a.urlDataSource=g.consume(d.ue),a.viewParams=g.consume(s.P),a._isFilePickerPage=y.pureCompute(a._computeIsFilePickerPage),a._action=y.pureCompute(a._computeAction),a._action.equalityComparer=f.n,a._instrumentationProvider=g.consume(l.r),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()},t.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var a=this._instrumentationProvider;a&&n&&a.userClickItem(n);var i=t.peekUnwrap(this._action);return i&&i.execute(e)||u.n.resolve({resultType:o.e.ExpectedFailure})},t.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})},t.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===p.e.FilePicker},t.prototype._computeAction=function(){var e,t=this._lastAction;t&&(t.dispose(),this._lastAction=void 0);var n=this.item();return this._isFilePickerPage()&&n&&n.type!==c.e.Folder||(e=this.onComputeAction()),this._lastAction=e,e},t.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var a;if(e)switch(e.type){case c.e.File:a="FileOpen.".concat(n);break;case c.e.Folder:a="FolderOpen.".concat(n);break;case c.e.App:a="AppOpen.".concat(n);break;case c.e.Subsite:a="SubsiteOpen.".concat(n);break;default:a="Open.".concat(n)}else a="Open.".concat(n);this.resources.consume(g.e).withPart(h.e).withPart(_.e,{item:e}).logData({name:a,extraData:{action:t?t.type:"unknown"}})}},t}(r.e),S=n(2220),D=n(213),I=n(37),x=n(40),C=n(38),O=n(2655),w=n(2386),E=n(4814),A=n(118),L=n(3292),k=n(90),M=n(4434),P=function(e){function t(t){var n=e.call(this,t)||this;return n._pageContext=n.resources.consume(C.f),n.itemParentHelper=n.resources.consume(S.e),n._defaultClickType=n.createPureComputed(n._computeDefaultClickType),n._fileHandlerProvider=n.resources.consume(w.e.optional),n._isOneDriveWinApp=Object(A.e)(),n._isTeamsPageApp=Object(k.d)(),n._isPWA=n.resources.consume(i.e).isPWA,n}return Object(a.__extends)(t,e),t.prototype.onComputeAction=function(){var t,n=this._defaultClickType();switch(n){case 1:t=new(this.managed(this.actionMap.OpenShortcutAction))({item:this.item});break;case 2:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,retryWithWac:!0});break;case 14:t=new(this.managed(this.actionMap.OpenInTeamsPreviewAction))({openRelation:2,item:this.item});break;case 3:t=new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({useDefaultAction:!0,item:this.item});break;case 4:t=new(this.managed(this.actionMap.OpenSiteAction))({item:this.item});break;case 5:t=new(this.managed(this.actionMap.AuthenticationPolicyWarningAction));break;case 8:t=new(this.managed(this.actionMap.ExternalNavigateAction))({item:this.item});break;case 6:case 11:var a=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"});t=6===n?a:new(this.managed(this.actionMap.OpenInfoPathAction))({fallbackOpenAction:a,item:this.item});break;case 7:t=new(this.managed(this.actionMap.FileHandlerOpenAction))({item:this.item});break;case 9:t=new(this.managed(this.actionMap.OpenHyperlinkAction))({item:this.item});break;case 10:t=new(this.managed(this.actionMap.ShowMalwareDetectedAction))({item:this.item});break;case 12:t=new(this.managed(this.actionMap.OpenInDesktopAction))({openRelation:2,item:this.item,actionType:L.e.DefaultClick});break;case 13:t=new(this.managed(this.actionMap.OpenPdfInBrowserAction))({item:this.item});break;case 15:t=new(this.managed(this.actionMap.OpenDocSetAction))({item:this.item});break;case 16:t=new(this.managed(this.actionMap.OpenInClipchampAction))({item:this.item});break;case 0:t=e.prototype.onComputeAction.call(this)}return t},t.prototype._computeDefaultClickType=function(){return this.item()?this._malwareDetected()?10:this._blockedByConditionalAccess()?5:this._openInOneDriveWinApp()?12:this._openInTeamsPreview()?14:this._openAsShortcut()?1:this._openAsSite()?4:this._openInClient()?2:this._openInOfficeOnline()?3:this._external()?8:this._infoPath()?11:this._nativePdf()?13:this._preview()?6:this._openWithFileHandler()?7:this._openAsHyperlink()?9:this._openDocSet()?15:this._openInClipchamp()?16:0:0},t.prototype._openAsShortcut=function(){var e=this.item();return Object(x.isFeatureEnabled)(x.ShortcutLink)&&O.e.isShortcutItem(e)},t.prototype._openAsHyperlink=function(){var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list;return n&&n.isPromotedLinks},t.prototype._openInClient=function(){if(!this._openInOffice())return!1;var e=this.item(),t=this.unwrapObservable(this.itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!t&&(t.list.openInClient||"ms-project"===e.appMap||"ms-publisher"===e.appMap)},t.prototype._openInOfficeOnline=function(){if(this._isOneDriveWinApp||this._isTeamsPageApp||this._isPWA)return!1;var e=this.item();return Object(E.e)(e)},t.prototype._openInOffice=function(){var e=this.item();return Object(E.t)(e)},t.prototype._openAsSite=function(){var e=this.item();return!!e&&e.subsite&&this._pageContext.isNoScriptEnabled},t.prototype._blockedByConditionalAccess=function(){var e=this.item();return e.itemStatus===D.t.ConditionalAccessBlocked&&e.type!==c.e.Folder},t.prototype._external=function(){var e=this.item();return!(this._isOneDriveWinApp||e.appMap&&".pdf"!==e.extension||!e.external)},t.prototype._infoPath=function(){var e=this.item(),t=e.properties&&e.properties.ProgId;return!!t&&0===t.toLowerCase().indexOf("infopath.document")},t.prototype._nativePdf=function(){var e=this.item(),t=e&&e.extension;return!!t&&".pdf"===t.toLowerCase()&&Object(x.isFeatureEnabled)(x.DefaultPdfToNative)},t.prototype._preview=function(){var e=this.item();if(this._isOneDriveWinApp&&e&&e.type!==c.e.Folder)return!0;if(e.preview)return!0;var t=this._fileHandlerProvider;return!!t&&!!t.getDefaultPreviewHandler(e.extension)},t.prototype._openWithFileHandler=function(){var e=this._fileHandlerProvider;if(!e)return!1;var t=this.item();return!!t.graph&&!!e.getDefaultOpenHandler(t.extension)},t.prototype._malwareDetected=function(){var e=this.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},t.prototype._openInOneDriveWinApp=function(){var e=this.item();if(Object(x.isFeatureEnabled)(x.EnableOneUpInSwmPwa)){if(this._isOneDriveWinApp){if(e.type===c.e.Folder&&e.queryType===I.e.SharedWithMe||e.queryType===I.e.Search||e.queryType===I.e.DetailsPane)return!0;if(e.type===c.e.Shortcut)return!0}return!1}return this._isOneDriveWinApp&&(e.type===c.e.Shortcut||e.queryType!==I.e.Files&&e.queryType!==I.e.SharedByMe&&e.queryType!==I.e.Recent)},t.prototype._openInTeamsPreview=function(){if(this._isTeamsPageApp){var e=this.item();return e.type!==c.e.Folder&&e.type!==c.e.Shortcut&&e.queryType!==I.e.DetailsPane}return!1},t.prototype._openDocSet=function(){var e=this.item();return e.isDocSet&&e.properties&&e.properties.WelcomeViewId},t.prototype._openInClipchamp=function(){var e=this.item();return Object(M.e)(e)},t}(y);t.e=P}],Array(57),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={public:"Public",private:"Private"};t.t=a},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(4),i=n("react-lib"),r=n(582),o=n(689),s=n(380),c=n(4415),d=n(3837);function l(e,t){void 0===t&&(t={});var n=t.factoryOptions,l=(void 0===n?{}:n).defaultProp,f=function(n){var c,d,l,f,p=(c=t.displayName,d=i.useContext(o.e),l=t.fields,f=["theme","styles","tokens"],s.e.getSettings(l||f,c,d.customizations)),m=t.state;m&&(n=Object(a.e)(Object(a.e)({},n),m(n)));var _=n.theme||p.theme,h=u(n,_,t.tokens,p.tokens,n.tokens),b=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return r.e.apply(void 0,a.map(function(a){return"function"==typeof a?a(e,t,n):a}))}(n,_,h,t.styles,p.styles,n.styles),g=Object(a.e)(Object(a.e)({},n),{styles:b,tokens:h,_defaultStyles:b,theme:_});return e(g)};return f.displayName=t.displayName||e.name,l&&(f.create=Object(c.e)(f,{defaultProp:l})),Object(d.e)(f,t.statics),f}function u(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r={},o=0,s=n;o<s.length;o++){var c=s[o];c&&(c="function"==typeof c?c(e,t):c,Array.isArray(c)&&(c=u.apply(void 0,Object(a.o)([e,t],c))),Object(d.e)(r,c))}return r}},,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(a||(a={}))},function(e,t,n){"use strict";var a;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(3725),r=n(2261),o=n(69),s=n(172),c=n(609),d=n(2741),l=n(2742),u=n(40),f=n(65),p=n(3337),m=n(4215),_=n(2691),h=n(2406),b=n(96),g=n(265),v=n(2582),y=n(5184),S=n(5185),D=v.n,I=v.f,x=v.c,C=function(e){function t(t){var n=e.call(this,t)||this;n._apiUrlHelper=n.resources.consume(c.e),n._sharingDataSourceHelper=new(n.managed(p.e));var a=Object(s.s)(n._pageContext);return n._getPermissionsUrl=a+"/_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection",n._getSharingSettingsUrl=a+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection",n}return Object(a.__extends)(t,e),t.prototype.getRawResponse=function(e){var t,n=e.item,a="GetSharingInformationOld",i={};return this._sharingDataSourceHelper.canUseSecurable(n)?t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n).segment("GetSharingInformation").oDataParameter("$Expand","permissionsInformation,pickerSettings").toString():(t=this._getSharingSettingsUrl,i.useSimplifiedRoles=!0,i.objectUrl=this._sharingDataSourceHelper.getFileUrl(n),a="SP.Web.GetObjectSharingSettings"),this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:a,additionalPostData:JSON.stringify(i),method:"POST",noRedirect:!0})},t.prototype.getSettings=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseSettings(n,e.item)},function(e){return t._parseError(e)})},t.prototype.getPermissions=function(e){var t=this;return this._sharingDataSourceHelper.canUseSecurable(e.item)?e.getRawResponse().then(function(n){return t._parsePermissions(n,e.item)}):this._getPermissions(e.item).then(function(n){return t._parsePermissions(n,e.item)})},t.prototype.getBestSharingLink=function(e,t){var n=this;return e.getLinks().then(function(e){return e&&e.length>0?f.n.wrap(n._getDefaultSharingLink(e,t)):null},function(e){return null})},t.prototype.getLinks=function(e){var t=this;return e.getRawResponse().then(function(n){return t._parseLinks(n,e.item)})},t.prototype.doSharingScopesContainLinks=function(){return!1},t.prototype.mappingSharingRole=function(e){var t;switch(e){case 0:t=h.e.None;break;case 3:t=h.e.Owner;break;case 5:t=h.e.Submitter;break;default:t=e}return t},t.prototype.getDataSourceName=function(){return"SharingDataDataSource"},t.prototype._getPermissions=function(e){var t,n,a=this._sharingDataSourceHelper.canUseSecurable(e);return t=a?this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e).segment("GetObjectSharingInformation").oDataParameter("$Expand","SharedWithUsersCollection").toString():this._getPermissionsUrl,this.dataRequestor.getData({url:t,parseResponse:function(e){return JSON.parse(e).d},qosName:"GetItemPermissions",additionalPostData:(n={excludeCurrentUser:!1,excludeSiteAdmin:!1,excludeSecurityGroups:!1,retrieveAnonymousLinks:!0,retrieveUserInfoDetails:!0,checkForAccessRequests:!0,retrievePermissionLevels:!0},a||(n.objectUrl=this._sharingDataSourceHelper.getFileUrl(e)),JSON.stringify(n)),method:"POST",noRedirect:!0})},t.prototype._parsePermissions=function(e,t){var n=[],a=[];this._sharingDataSourceHelper.canUseSecurable(t)?n=this._processAllPrincipals(e,t,e.canAddExternalPrincipal||e.canAddInternalPrincipal):(e.SharedWithUsersCollection&&e.SharedWithUsersCollection.results&&(a=e.SharedWithUsersCollection.results),n=this._processPeople(a,t,e.CanManagePermissions));for(var i=0,r=n;i<r.length;i++){var o=r[i];o.entityType===l.e.group&&o.email&&(o.image=this._getGroupImage(o.email))}var s=this.mappingSharingRole(e.currentRole)===h.e.Owner&&t.type!==g.e.Folder&&t.type!==g.e.OneNote;return[{item:t,people:n,hasPendingAccessRequests:e.HasPendingAccessRequests,pendingAccessRequestsLink:e.PendingAccessRequestsLink,canUnshare:e.CanBeUnshared||s}]},t.prototype._getGroupImage=function(e){return e?Object(i.t)({userLoginName:e}):null},t.prototype._parseError=function(e){var t={};return t.sharingApiErrorMessage=e.message.value,t},t.prototype._parseSettings=function(e,t){var n={};if(n.canSendEmail=e.canSendEmail,n.pickerProperties={},n.itemUrl=this._sharingDataSourceHelper.getFileUrl(t),n.networkLinksEnabled=!1,n.mailSettings={defaultCharacterLimit:500},this._sharingDataSourceHelper.canUseSecurable(t)){n.itemId=t.properties.ID||t.properties.uniqueId,n.itemName=t.displayName,n.canManagePermissions=this.mappingSharingRole(e.currentRole)===h.e.Owner,n.canManageReadWriteLink=this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links),n.canManageOrganizationalReadWriteLink=this._isLinkKindEnabled(m.e.OrganizationEdit,e.permissionsInformation.links),n.canManageLinks=this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.OrganizationEdit,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.OrganizationView,e.permissionsInformation.links),n.canSendLink=this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links)||this._isLinkKindEnabled(m.e.AnonymousEdit,e.permissionsInformation.links),n.supportsSharingPropagation=t.type===g.e.Folder,n.anonymousLinksEnabled=this._isLinkKindEnabled(m.e.AnonymousView,e.permissionsInformation.links),n.organizationLinksEnabled=this._isLinkKindEnabled(m.e.OrganizationView,e.permissionsInformation.links),n.showAdditionalExternalWarning=e.showExternalSharingWarning,n.sharedWithMany=this._isSharedWithMany(e),n.hasInheritedLink=e&&e.permissionsInformation&&e.permissionsInformation.hasInheritedLinks,n.blockPeoplePickerAndSharing=e.blockPeoplePickerAndSharing,n.canCurrentUserShareExternally=e.canAddExternalPrincipal,n.defaultLinkType=e.defaultLinkKind,e.permissionsInformation&&e.permissionsInformation.principals&&e.permissionsInformation.principals.results&&(n.sharedWith=this._processAllPrincipals(e,t,n.canManagePermissions));var a=t.properties.listId||this._sharingDataSourceHelper.getParentListId(t),i=[e.webUrl],r=t.properties.ID;null!==r&&(r=t.properties.ID.toString()),this._setAdvancedLink(a,i,r,n),e.pickerSettings&&this._setPickerProperties(e.pickerSettings,e.pickerSettings.PrincipalAccountType,n);var o=[],s={};s.name=D,s.value="role:1073741827",o.push(s);var c={};if(c.name=I,c.value="role:1073741826",o.push(c),Object(u.isFeatureEnabled)(u.ReviewPermissionUI)&&t.appMap&&"ms-word"===t.appMap){var d={};d.name=x,d.value="roletype:Reviewer",o.push(d)}n.sharingRoles=o,this._setAnonymousLinkExpirationInDays(e.anonymousLinkExpirationRestrictionDays,n)}else{if(n.itemId=e.ItemId,n.itemName=e.ItemName,n.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions,n.canManageLinks=this._canManageLinks(e),n.canManageReadWriteLink=e.CanCurrentUserManageReadWriteLink,n.canManageOrganizationalReadWriteLink=e.CanCurrentUserManageOrganizationReadWriteLink,n.canSendEmail=e.CanSendEmail,n.canSendLink=e.CanSendLink,n.pickerProperties={},n.supportsSharingPropagation=e.SupportsAclPropagation,n.anonymousLinksEnabled=e.CanCurrentUserRetrieveReadonlyLink,n.organizationLinksEnabled=e.CanCurrentUserRetrieveOrganizationReadonlyLink,n.showAdditionalExternalWarning=e.ShowExternalSharingWarning,n.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany,n.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing,n.canCurrentUserShareExternally=e.CanCurrentUserShareExternally,n.defaultLinkType=this._getMostPermissiveLinkKind(n,e.DefaultShareLinkType),e.ObjectSharingInformation&&e.ObjectSharingInformation.SharedWithUsersCollection&&e.ObjectSharingInformation.SharedWithUsersCollection.results&&(n.sharedWith=this._processPeople(e.ObjectSharingInformation.SharedWithUsersCollection.results,t,e.CanManagePermissions)),i=[e.WebUrl],this._setAdvancedLink(e.ListId,i,e.ItemId,n),e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,n),o=[],e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var l=0;l<e.SimplifiedRoles.results.length;l++){var f={};f.name=e.SimplifiedRoles.results[l].Key,f.value=e.SimplifiedRoles.results[l].Value,o.push(f)}n.sharingRoles=o,this._setAnonymousLinkExpirationInDays(e.RequiredAnonymousLinkExpirationInDays,n)}return n.showAdvanced=n.canManagePermissions,n},t.prototype._setAnonymousLinkExpirationInDays=function(e,t){var n=parseInt(e,10);t.requiredAnonymousLinkExpirationInDays=NaN!==n?n:0},t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e,n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)},t.prototype._setAdvancedLink=function(e,t,n,a){t.push("/_layouts/15/user.aspx"),t.push("?List="+b.e.encodeURIComponent(e)),e&&t.push("&obj=",b.e.encodeURIComponent(e),",",b.e.encodeURIComponent(n),",LISTITEM"),Number(this._pageContext.webTemplate)===o.t.group&&(t.push("&noredirect=true"),a.advancedUrlOpenInPlace=!0),a.advancedUrl=t.join("")},t.prototype._getMostPermissiveLinkKind=function(e,t){var n=t,a=(n=n===m.e.Uninitialized?m.e.AnonymousEdit:n)===m.e.AnonymousEdit||n===m.e.AnonymousView,i=n===m.e.OrganizationEdit||n===m.e.OrganizationView;if(a){if(e.anonymousLinksEnabled&&e.canManageReadWriteLink)return n;if(e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return m.e.OrganizationEdit}else if(i&&e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return n;return m.e.Direct},t.prototype._parseLinks=function(e,t){var n=this,a=[];if(e.permissionsInformation&&e.permissionsInformation.links){[{linkDetails:{Url:e.directUrl,IsActive:!0,LinkKind:m.e.Direct}}].concat(e.permissionsInformation.links.results).forEach(function(e){if(!e.isInherited){var i=n._initSharingLinkFromServerData(e.linkDetails);i.item=t,i.isInherited=e.isInherited,i.linkMembers=n._convertPrincipalToPeople(e.linkMembers),i.shareId=e.linkDetails?e.linkDetails.ShareId:"",i.kind=e.linkDetails?e.linkDetails.LinkKind:y.e.uninitialized,i.linkInvitees=n._getLinkInvitees(e.linkDetails),a.push(i)}});var i=e.canAddExternalPrincipal||e.canAddInternalPrincipal;a=a.filter(function(e){return!!((n.mappingSharingRole(e.role)!==h.e.Edit||i)&&(n.mappingSharingRole(e.role)!==h.e.View||i)||e.url&&e.isActive)&&!!(i||e.url&&e.isActive)&&!(n.mappingSharingRole(e.role)===h.e.View&&e.type===_.e.View&&!i||n.mappingSharingRole(e.role)===h.e.Edit&&e.type===_.e.Edit&&!i)})}return a},t.prototype._getLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var a=[],i=0,r=n.results;i<r.length;i++){var o=r[i];a.push(o.invitee)}return a.map(function(e){return{userId:e.userId,name:e.name,email:e.email,image:t._getGroupImage(e.email),isExternal:e.isExternal}})},t.prototype._processPeople=function(e,t,n){var a=this;return e.map(function(e){var t={userId:e.LoginName,name:e.Name,email:e.Email,job:e.JobTitle,department:e.Department,image:e.Picture,sip:e.SipAddress,isExternal:e.isExternal};0===t.image.length&&(t.image=a._placeholderImage);var i={};return e.IsSiteAdmin?i.role=h.e.Owner:void 0!==e.CustomRoleNames&&""!==e.CustomRoleNames?(i.role=h.e.Custom,i.customRole=e.CustomRoleNames):e.HasEditPermission?i.role=h.e.Edit:e.HasViewPermission&&(i.role=h.e.View),i.isChangeable=n,t.sharingInfo=i,e.IsDomainGroup?t.entityType=l.e.group:e.IsExternalUser&&(t.entityType=l.e.externalUser),t})},t.prototype._getAllSharedUsers=function(e){for(var t=e.permissionsInformation.siteAdmins.results,n=e.permissionsInformation.principals.results,a={},i=0,r=t;i<r.length;i++)a[(c=r[i]).principal.loginName]=!0;for(var o=0,s=n;o<s.length;o++){var c;a[(c=s[o]).principal.loginName]||t.push(c)}return t},t.prototype._processAllPrincipals=function(e,t,n){var a=this;return this._getAllSharedUsers(e).map(function(e){var t=e.principal,i={userId:t.loginName,name:t.name,email:t.email,job:t.jobTitle,image:a._getGroupImage(t.email),principalType:t.principalType,isExternal:t.isExternal},o={};return o.role=a.mappingSharingRole(e.role),o.isChangeable=n,i.sharingInfo=o,t.principalType===r.e.securityGroup||t.principalType===r.e.sharePointGroup?i.entityType=l.e.group:t.isExternal&&(i.entityType=l.e.externalUser),i})},t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,a=e.split(",");n<a.length;n++){var i=a[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t},t.prototype._convertPrincipalToPeople=function(e){var t=this;return(e&&e.results||[]).map(function(e){return{userId:e.loginName,name:e.name,email:e.email,job:e.jobTitle,image:t._getGroupImage(e.email)}})},t.prototype._initSharingLinkFromServerData=function(e){if(!e)return null;var t={};switch(e.LinkKind){case m.e.Direct:t={type:_.e.Direct,role:h.e.None,displayPriority:0,tag:"Direct",supportsExpiration:!1};break;case m.e.OrganizationView:t={type:_.e.Organization,role:h.e.View,displayPriority:1,tag:"OrganizationView",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.OrganizationEdit:t={type:_.e.Organization,role:h.e.Edit,displayPriority:2,tag:"OrganizationEdit",supportsExpiration:!1,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.AnonymousView:t={type:_.e.View,role:h.e.View,displayPriority:3,tag:"AnonymousView",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.AnonymousEdit:t={type:_.e.Edit,role:h.e.Edit,displayPriority:4,tag:"AnonymousEdit",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.Flexible:var n=h.e.None;n=e.IsEditLink?h.e.Edit:e.IsReviewLink?h.e.Review:h.e.View,t={type:_.e.Edit,role:n,displayPriority:5,tag:"Flexible",supportsExpiration:!0,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload};break;case m.e.Uninitialized:default:t={}}return t.audience=this._getSharingLinkAudience(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),Object(a.__assign)({role:h.e.None,url:e.Url,isActive:e.IsActive,expiration:t.supportsExpiration?this._sharingDataSourceHelper.getExpirationFromSharingLinkInfo(e.Expiration):null},t)},t.prototype._getSharingLinkAudience=function(e,t,n){return e===y.e.anonymousEdit||e===y.e.anonymousView?S.e.anyone:e===y.e.organizationEdit||e===y.e.organizationView?S.e.organization:e===y.e.direct?S.e.specificPeople:e===y.e.flexible?t?S.e.anyone:!1===n?S.e.organization:S.e.specificPeopleFlex:void 0},t.prototype._getDefaultSharingLink=function(e,t){if(!e||e.length<1)return null;var n,a,i;t===m.e.Direct?(a=_.e.Direct,i=h.e.None):t===m.e.OrganizationView?(a=_.e.Organization,i=h.e.View):t===m.e.OrganizationEdit?(a=_.e.Organization,i=h.e.Edit):t===m.e.AnonymousView?(a=_.e.View,i=h.e.View):t===m.e.AnonymousEdit&&(a=_.e.Edit,i=h.e.Edit);for(var r=0,o=e;r<o.length;r++){var s=o[r];if(s.type===_.e.Direct&&(n=s),s.type===a&&s.role===i)return s}return n},t.prototype._isLinkKindEnabled=function(e,t){return t.results.some(function(t){return t.linkDetails.LinkKind===e})},t.prototype._canManageLinks=function(e){return e.CanCurrentUserManageReadWriteLink||e.CanCurrentUserManageOrganizationReadWriteLink||e.CanCurrentUserManageReadonlyLink||e.CanCurrentUserManageOrganizationReadonlyLink},t.prototype._isSharedWithMany=function(e){if(this._getAllSharedUsers(e).length>30)return!0;for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.principal.principalType===r.e.securityGroup||a.principal.principalType===r.e.sharePointGroup)return!0}return!1},t}(d.e);t.default=C},function(module,__webpack_exports__,__webpack_require__){"use strict";var LoggingContext=function(){function LoggingContext(){this._root={}}return LoggingContext.prototype.set=function(e,t,n){this._root[e]||(this._root[e]={}),this._root[e][t]=n},LoggingContext.prototype.delete=function(bucket,property){var toDeleteString='this._root["'+bucket+'"]';property&&(toDeleteString+='["'+property+'"]');try{eval("delete "+toDeleteString)}catch(e){}},LoggingContext.prototype.get=function(e){var t=this,n={};if(e)e.forEach(function(e){t._root[e]&&i(t._root,e,n)});else for(var a in this._root)i(this._root,a,n);return n;function i(e,t,n){for(var a in e[t])n[t+"_"+a]=e[t][a]}},LoggingContext}();__webpack_exports__.e=LoggingContext},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("knockout-lib"),r=n(232),o="userInfo",s=function(e){function t(){return e.call(this,"UserInfoStore")||this}return Object(a.__extends)(t,e),t.prototype.getUserInfo=function(){var e=this.getValue(o);return e||(e=i.observable(null),this.setValue(o,e)),e},t}(r.e);t.default=s},,,,,function(e,t){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,r="ArrayBuffer"in e;if(r)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};m.prototype.append=function(e,t){e=u(e),t=f(t);var n=this.map[e];this.map[e]=n?n+","+t:t},m.prototype.delete=function(e){delete this.map[u(e)]},m.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},m.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},m.prototype.set=function(e,t){this.map[u(e)]=f(t)},m.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},m.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),p(e)},m.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},m.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),p(e)},n&&(m.prototype[Symbol.iterator]=m.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},v.call(y.prototype),v.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},D.error=function(){var e=new D(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];D.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new D(null,{status:t,headers:{location:e}})},e.Headers=m,e.Request=y,e.Response=D,e.fetch=function(e,t){return new Promise(function(n,i){var r=new y(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,a={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new m,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),a=n.shift().trim();if(a){var i=n.join(":").trim();t.append(a,i)}}),t)};a.url="responseURL"in o?o.responseURL:a.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new D(i,a))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"include"===r.credentials&&(o.withCredentials=!0),"responseType"in o&&a&&(o.responseType="blob"),r.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function m(e){this.map={},e instanceof m?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function b(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(r&&a&&s(e))this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!r||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var e,t,n,a=_(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var n,a,i=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new m(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new m(t.headers)),this.method=(a=(n=t.method||this.method||"GET").toUpperCase(),d.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function S(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(i))}}),t}function D(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new m(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)}],Array(45),[function(e,t,n){"use strict";n.r(t),n.d(t,"UserExpirationUtils",function(){return l}),n.d(t,"resourceKey",function(){return u});var a=n(0),i=n(38),r=n(9),o=n(146),s=n(1219),c=n(1214),d=n(136),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._navigation=n.navigation,a}return Object(a.__extends)(t,e),t.prototype.autoOpenPanelBaseOnQueryParams=function(){this._checkPermissions()&&this._urlContainsUserExpirationParam()&&(this._openUserExpirationPanel(),this._removeUserExpirationUrlParam())},t.prototype._urlContainsUserExpirationParam=function(){return!(!this._navigation.viewParams||!this._navigation.viewParams[r.n.userExpirationPanelKey]&&!this._navigation.viewParams[r.n.userExpirationPanelKey.toLowerCase()])},t.prototype._checkPermissions=function(){return this._pageContext.isSiteAdmin},t.prototype._removeUserExpirationUrlParam=function(){if(this._navigation.viewParams){var e=Object(a.__assign)({},this._navigation.viewParams);(e[r.n.userExpirationPanelKey]||e[r.n.userExpirationPanelKey.toLowerCase()])&&(delete e[r.n.userExpirationPanelKey],delete e[r.n.userExpirationPanelKey.toLowerCase()],this._navigation.updateViewParams(e,{ignoreHistory:!0,clearOtherParams:!0}))}},t.prototype._openUserExpirationPanel=function(){var e=this;Promise.resolve(Promise.all([n.e("deferred"),n.e(600)]).then(n.bind(null,4574))).then(s.e).then(function(t){new(e.resources.injected(t))({}).execute(null)})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},c.default.dependencies),{pageContext:i.f,navigation:o.e}),t}(c.default),u=Object(d.r)("UserExpirationUtils",l)},,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(170),i=n(15),r=n(2909),o=function(){function e(){}return e.registerContentElement=function(t){e===Object(r.n)()?t!==e._contentElement&&(e._contentElement&&e._contentElement.removeEventListener("scroll",e._onScroll),e._contentElement=t,t?e._manageEventAttachment():(e._isShyMode=!1,e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}}))):Object(r.n)().registerContentElement(t)},e.registerCallbacks=function(t){if(e===Object(r.n)()){if(e._callbacks.indexOf(t)<0){e._callbacks.push(t),e._totalHeightDifference+=t.heightDifference;try{e._contentElement&&(e._contentElement.scrollTop-=t.heightDifference),this._isShyMode&&t.onShy()}catch(e){}return e._manageEventAttachment(),!0}return!1}Object(r.n)().registerCallbacks(t)},e.unregisterCallback=function(t){if(e===Object(r.n)()){var n=e._callbacks.indexOf(t);if(n>=0){var a=e._callbacks[n];try{e._isShyMode&&(e._contentElement&&(e._contentElement.scrollTop+=a.heightDifference),a.onUnshy())}catch(e){}return e._totalHeightDifference-=a.heightDifference,e._callbacks.splice(n,1),e._manageEventAttachment(),!0}return!1}Object(r.n)().unregisterCallback(t)},e.unshy=function(){e===Object(r.n)()?(e._onShyEventSent=!1,e._isShyMode=!1,e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})):Object(r.n)().unshy()},e._manageEventAttachment=function(){if(e.enabled&&e._contentElement){var t=!i.t.isActivated("A2EE05E1-7A4E-4A5B-97D2-8BF10F0BC846","9/02/20","no scrollTop adjustment for anchor navigation");e._contentElement.removeEventListener("scroll",e._onScroll),e._contentElement.removeEventListener("mousedown",e._onMouseDown),e._contentElement.removeEventListener("mouseup",e._onMouseUp),t&&window.removeEventListener("hashchange",e._onHashChange),e._callbacks.length&&(e._contentElement.addEventListener("scroll",e._onScroll),e._contentElement.addEventListener("mousedown",e._onMouseDown),e._contentElement.addEventListener("mouseup",e._onMouseUp),t&&window.addEventListener("hashchange",e._onHashChange))}},e._onScroll=function(t){e._queueScrollEvent=!0,e._isMouseDown||(window.clearTimeout(e._handleScrollTimeoutId),e._handleScrollTimeoutId=window.setTimeout(e._handleScroll,25))},e._onMouseDown=function(t){e._isMouseDown=!0},e._onMouseUp=function(t){e._isMouseDown=!1,e._queueScrollEvent&&e._handleScroll()},e._onHashChange=function(t){e._hashChangedRecently=!0,window.clearTimeout(e._handleHashChangeTimeoutId),e._handleHashChangeTimeoutId=window.setTimeout(function(){e._hashChangedRecently=!1},500)},e._handleScroll=function(){if(e._queueScrollEvent){e._queueScrollEvent=!1;var t=e._contentElement.scrollTop-e._lastScrollPosition;t>=0&&!e._isShyMode?(e._scrolledAmountConsecutively>=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t,e._scrolledAmountConsecutively>e.scrollThresholdDown&&e._contentElement.scrollTop-e._totalHeightDifference>e.scrollThresholdDown&&(e._onShyEventSent||(e._onShyEventSent=!0,Math.random()<.01&&a.e.logData({name:"ShyConductor.OnShy"})),e._isShyMode=!0,e._callbacks.forEach(function(e){try{e.onShy()}catch(e){}}),e._hashChangedRecently?a.e.logData({name:"ShyConductor.HashNavNoAutoscrollShy"}):e._contentElement.scrollTop-=e._totalHeightDifference)):t<0&&e._isShyMode&&(e._scrolledAmountConsecutively<=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t,(-e._scrolledAmountConsecutively>e.scrollThresholdUp||e._contentElement.scrollTop<e.scrollThresholdDown)&&(e._isShyMode=!1,e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}}),e._hashChangedRecently?a.e.logData({name:"ShyConductor.HashNavNoAutoscrollUnshy"}):e._contentElement.scrollTop+=e._totalHeightDifference)),e._lastScrollPosition=e._contentElement.scrollTop}},e.scrollThresholdDown=300,e.scrollThresholdUp=500,e.enabled=!0,e._callbacks=[],e._totalHeightDifference=0,e._isShyMode=!1,e._lastScrollPosition=0,e._scrolledAmountConsecutively=0,e._isMouseDown=!1,e._queueScrollEvent=!1,e._hashChangedRecently=!1,e._onShyEventSent=!1,e}();t.default=o,Object(r.n)()||(window[r.e]=o)}],Array(49),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return s});var a=n(38),i=n(2803),r=n(136),o=n(5676),s=Object(r.r)("GraphUserInfoDataSource",o.e,{oAuthTokenProvider:i.e,pageContext:a.f})}],Array(35),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return h});var a=n(0),i=n(1214),r=n(136),o=n(1009),s=n(2803),c=n(2269),d=n(1026),l=n(38),u=n(40),f=18e5,p=108e5,m=Object(u.isFeatureEnabled)(u.UseSelfIssuedTokenForSPOWebAuth)&&Object(u.isFeatureEnabled)(u.UseIdentityAuthForVroom),_=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._authTokenFetcher=n.authTokenFetcher,a._itemsStore=n.itemsStore,a._pageContext=n.pageContext,a._tokenList=new Set,a._callTimesCount=0,a._serverLocalTimeDelta=0,setInterval(a._cleanCallTimesCount.bind(a),216e5),a}return Object(a.__extends)(t,e),t.prototype.trackListToken=function(e){if(!m){if(!this._tokenList.has(e)&&(this._tokenList.add(e),!this._serverLocalTimeDelta)){var t=this._getAccessToken(e);this._serverLocalTimeDelta=this._computeClockSkew(t)}this._scheduleListTokenCheck()}},t.prototype._scheduleListTokenCheck=function(){var e=this;if(this._pageContext.isSPO){var t=this._getRecentExpire();this.async.clearTimeout(this._timeoutId),this._timeoutId=this.async.setTimeout(function(){e._checkListToken()},t)}},t.prototype._getRecentExpire=function(){var e=this,t=p;return this._tokenList.forEach(function(n){var a=e._getAccessToken(n),i=a?1e3*Number(Object(o.a)(a).exp)-e._getCurrentServerTime()-f:p;t=Math.min(i,t)}),t},t.prototype._checkListToken=function(){var e=this;this._tokenList.forEach(function(t){var n=e._itemsStore.getItem(t),a=n&&n.peek(),i=Object(o.a)(a&&a.graph&&a.graph.sessionToken&&a.graph.sessionToken.accessToken);i&&1e3*Number(i.exp)-e._getCurrentServerTime()<f?e._callTimesCount<10&&(e._updateListToken(t),e._callTimesCount=Number(e._callTimesCount)+1):e._scheduleListTokenCheck()})},t.prototype._updateListToken=function(e){var t=this;this._authTokenFetcher.getAuthToken(e).then(function(){t._scheduleListTokenCheck()})},t.prototype._getAccessToken=function(e){var t=this._itemsStore.getItem(e),n=t&&t.peek();return n&&n.graph&&n.graph.sessionToken&&n.graph.sessionToken.accessToken},t.prototype._computeClockSkew=function(e){return e?1e3*Number(Object(o.a)(e).nbf)-Date.now():0},t.prototype._getCurrentServerTime=function(){return Date.now()+this._serverLocalTimeDelta},t.prototype._cleanCallTimesCount=function(){this._callTimesCount=0},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{authTokenFetcher:d.e,oAuthTokenProvider:s.e,itemsStore:c.t,pageContext:l.f}),t}(i.default);t.default=_;var h=Object(r.r)("AuthTokenMonitor",_)}],Array(26),[function(e,t,n){"use strict";n.r(t),n.d(t,"TeamChannelHeaderBase",function(){return b}),n.d(t,"TeamChannelHeader",function(){return g});var a=n(0),i=n("react-lib"),r=n(320),o=n(13),s=n(3186),c=n(57),d=n(1),l=n(2782),u=n(53),f=n(146),p=n(41),m=n(105),_=n(12),h=n(3),b=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.progId,n=e.resources,a=n.consume(r.e),o=!1;if(Object(h.co)(h.U))return null;if(!_.e.isActivated("0951DA6B-4128-449F-A9B1-98173899A776","01/21/2021","Hide TeamChannelHeader for file picker ")){var c=n.consume(f.e.optional);o=!!c&&Object(p._)(c.viewParams)===m.e.FilePicker}return!o&&Object(s.e)(t)?i.createElement(l.default,{actionMap:a,resources:n}):null},t}(i.PureComponent),g=Object(o.e)()(Object(c.e)(function(e,t){return{progId:e.demandItemFacet(d.Pt,t.itemKey)}})(Object(u.i)()(b)))}],Array(101),[function(e,t,n){"use strict";n.r(t),n.d(t,"loadTransitionResources",function(){return Hi}),n.d(t,"resourceKey",function(){return Ri});var a,i,r,o=n(0),s=n("knockout-lib"),c=(n(2558),n(3017),n(38)),d=n(320),l=n(100),u=n(871),f=n(506),p=n(435),m=n(1439),_=n(5498),h=n(5186),b=n(1214),g=n(172),v=n(4827),y=n(1952),S=n(1401),D=n(138),I=n(83),x=n(93),C=n(36),O=n(69),w=n(2624),E=n(2669),A=n(3718),L=n(3832),k=n(4811),M=n(65),P=n(10),T=n(136),U=new P.t({name:"TeamsProvider.key",loader:new T.t(function(){return Promise.resolve().then(n.bind(null,5675)).then(function(e){return e.resourceKey})})}),F=n(547),H=n(1219),R=n(90),N=n(40),B=n(15),j=n(4410),V=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n,i=a.observables,r=a.resources,o=n._pageContext=r.consume(c.f);n._notificationLinks=i.createArray([]),n._linkGroupsInitialized=!1,n._linkGroups=i.createArray([]),n._actionMap=n.resources.consume(d.e),n._isAdminRecycleBin=!B.t.isActivated("c84ba3b3-db41-43d4-adbb-15f9d87a9c68")&&(null==o?void 0:o.isSiteAdmin),n._addSharedWithUsNode=Object(g.l)(o)&&!!o.listUrl&&!Object(N.isFeatureEnabled)(N.RemoveSharedWithUs),n._isLeftNavOpenInNewWindowEnabled=Object(N.isFeatureEnabled)(N.LeftNavOpenInNewWindow),n._isLinkTargetKSActivated=Object(E.a)(),n.useReactLeftNav=!0;var s=r.consume(l.S).getIdentity();n.isEditable=i.create(C.e.hasIdentityPermission(s,C.e.manageLists)),n.isEditable.peek()&&new w.default(o).getReadOnlyState().then(function(e){return n.isEditable(!e)});var u=!(o.viewOnlyExperienceEnabled||o.blockDownloadsExperienceEnabled||o.disableBackToClassic||t.disableBackToClassic||Object(R.l)());return B.t.isActivated("bf798799-2196-49a2-964e-fe917af19943")||(u=u&&Number(o.webTemplate)!==O.t.sitePagePublishing),u&&n._notificationLinks.push({text:v.e,url:"#",action:new(n.managed(n._actionMap.BackToClassicAction))({resources:r,url:t.backToClassicUrl||i.create(""),cookieName:"splnu",cookieValue:o.listId}),isActive:i.create(!1),isFocused:i.create(!1),engagementName:"BackToClassic",renderAs:6,altText:v.t}),Object(g.l)(o)&&r.consume(p.e).waitForPageRenderingComplete().then(function(){return M.n.resolve(r.consumeAsync(U))}).then(function(e){return n._teamsProvider=e,e.getTeamsUrl()}).then(function(e){e?(n._teamsUrl=e,n._tryAddTeamsCoachmark()):n._tryAddTeamifyBanner()}),n}return Object(o.__extends)(t,e),t.prototype.getNotificationLinks=function(){return this._notificationLinks},t.prototype.getHandlerTypeKeys=function(){return this._pageContext.hubSiteId?[k.e]:[]},t.prototype.getReactLinkGroups=function(){var e=this;if(!this._linkGroupsInitialized){var t=new D.e({name:"LeftNav.DataSource"}),n={links:this._getLeftNavNodes(!0),key:L.n.quickLaunch,hasEditLink:this.isEditable.peek(),augmentLinks:function(t){e._augmentQuickLaunch(t)}};t.end({resultCode:"Success",resultType:I.e.Success});var a=[n];if(!this._pageContext.isHubSite){var i=new D.e({name:"TopNav.DataSource"});a.push({links:this._getLeftNavNodes(!1),key:L.n.globalNav,hideAbove:"Large"}),i.end({resultCode:"Success",resultType:I.e.Success})}this._linkGroups(a),this._linkGroupsInitialized=!0,this._tryAddTeamsCoachmark()}return this._linkGroups},t.prototype.addSharedWithUsNode=function(e){this._linkGroupsInitialized||this.getReactLinkGroups();var t=this._linkGroups.peek().filter(function(e){return e.key===L.n.quickLaunch})[0];if(t)for(var n=t.links,a=new x.t(e).getPath(),i=0;i<n.length;i++)if(-1!==n[i].url.indexOf(a)){var r={name:y.c,key:A.t.clientSharedWithUs,url:"#view=3",engagementName:"SharedWithUs",altText:S.u};n.splice(i+1,0,r),this._linkGroups.valueHasMutated();break}},t.prototype._getLeftNavNodes=function(e){var t=this._pageContext.navigationInfo;if(t){if(e){var n=this._getNavLinks(t.quickLaunch);return this._augmentQuickLaunch(n),n}var a=this._getNavLinks(t.topNav);return this._augmentGlobalNav(a),a}return[]},t.prototype._getNavLinks=function(e,t){var n=this;return e&&e.length?e.map(function(e){var t=n._getLink({name:e.Title,url:e.Url,key:e.Id.toString(),isDocLib:e.IsDocLib,listTemplateType:e.ListTemplateType,audiences:e.AudienceIds||void 0,openInNewWindow:e.OpenInNewWindow});return e.Children&&(t.links=n._getNavLinks(e.Children,!0)),t}):[]},t.prototype._augmentQuickLaunch=function(e,t){if(e){for(var n=this._pageContext,a=Object(g.s)(n),i=a+"".concat(this._isAdminRecycleBin?"/_layouts/15/AdminRecycleBin.aspx":"/_layouts/15/RecycleBin.aspx"),r=0;r<e.length;r++){var o=e[r];o.key===A.t.quickLaunchHome&&Number(n.webTemplate)===O.t.group&&n.groupId&&!n.groupHasHomepage&&(o.url=a+"/_layouts/15/groupstatus.aspx?target=home"),o.key!==A.t.quickLaunchRecent?this._augmentQuickLaunch(o.links,!0):(e.splice(r,1),r--)}if(!t&&e.length){this._addSharedWithUsNode&&e.splice(3,0,this._getLink({name:y.c,key:A.t.clientSharedWithUs,url:"#view=3",engagementName:"SharedWithUs",altText:S.u}));var s=e[e.length-1],c=n&&Number(n.webTemplate)===O.t.sitePagePublishing,d=B.t.isActivated("16da45d2-f27f-4d40-b0fb-63520cb5589d")||!c;if(!Object(j.e)(e)&&d){var l=s.key===A.t.clientEdit?e.length-1:e.length;e.splice(l,0,this._getLink({name:y.o,url:i,key:A.t.clientRecycleBin,automationId:"RecycleBin",title:S.d}))}}}},t.prototype._augmentGlobalNav=function(e,t){if(e){t||(t=this._getSubsitesUrls());for(var n=0;n<e.length;n++){var a=e[n],i=a.key===A.t.globalNavHome,r=-1!==t.indexOf(a.url);i||r?(e.splice(n,1),n--):this._augmentGlobalNav(a.links,t)}}},t.prototype._getSubsitesUrls=function(){var e=this._pageContext.navigationInfo,t=e&&e.quickLaunch;if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.Id===Number(A.t.subsites))return(i.Children||[]).map(function(e){return e.Url})}return[]},t.prototype._getLink=function(e){var t=this._isLeftNavOpenInNewWindowEnabled?e.openInNewWindow:void 0,n=this._isLinkTargetKSActivated?E.t.isRelativeUrl:E.t.shouldLinkOpenInSameWindow;return Object(o.__assign)({isExpanded:!1,target:(null!=t?t:!n(e.url))?"_blank":""},e)},t.prototype._tryAddTeamifyBanner=function(){var e=this;this._teamsProvider.canTeamify().then(function(t){t&&M.n.resolve(Promise.resolve().then(n.bind(null,2798))).then(H.e).then(function(t){M.n.resolve(Promise.resolve().then(n.bind(null,5674))).then(function(n){var a={pageContext:e._pageContext,className:"LeftNav-teamifyBanner",teamifyStrings:n.teamifyStrings};e._notificationLinks.unshift({isActive:e.observables.create(!1),isFocused:e.observables.create(!1),renderAs:10,component:{name:t.tagName,params:a}})})})})},t.prototype._tryAddTeamsCoachmark=function(){var e=this,t=this._teamsProvider;if(t&&this._teamsUrl){var n=this._linkGroups.peek().filter(function(e){return e.key===L.n.quickLaunch})[0];n&&n.links&&n.links.length&&t.shouldShowTeamsCoachmark().then(function(a){if(a){var i=t.findTeamsLink(n.links,e._teamsUrl);i&&(i.id="TeamsNavLink",i.coachmarkProps={id:i.id,teachingBubbleHeadline:v.a,teachingBubbleContent:v.n,onDismiss:function(){e.resources.consume(F.e).logData({name:"TeamsTeachingBubble.Dismiss.Click",isIntentional:!0}),t.setTeamsBubbleFlag(!0),i.coachmarkProps=void 0}},e._linkGroups.valueHasMutated())}})}},t}(b.default),z=V,G=function(e){function t(t){var n=e.call(this,t)||this;return n._connectionUrl="",n._connectionUrl=Object(g.s)(n._pageContext)+"/_api/Site/ShareByLinkEnabled",n}return Object(o.__extends)(t,e),t.prototype.getShareByLinkInfo=function(){return this.dataRequestor.getData({url:this._connectionUrl,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{isExternalSharingTipEnabled:!!t.d.ShareByLinkEnabled}:null},qosName:"GetShareByLinkInfo"})},t.prototype.getDataSourceName=function(){return"ShareByLinkDataSource"},t}(n(2741).e),K=n(609),W=n(151),q=n(1374),Q=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._dataRequestor=new(n.child(q.t))({qosName:"FolderItemCountDataSource"}),n._apiUrlHelper=n.resources.consume(K.e),n._itemUrlHelper=n.resources.consume(W.c),n}return Object(o.__extends)(t,e),t.prototype.getFolderItemCountInfo=function(e){return this._dataRequestor.getData({url:this._getQueryUrl(e),qosName:"GetFolderItemCountInfo"}).then(function(e){var t=(void 0===e?{}:e).d,n=(void 0===t?{}:t).ItemCount,a=void 0===n?void 0:n;return"number"==typeof a?{itemCount:a}:void 0})},t.prototype._getQueryUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl).segment("ItemCount").toString()},t}(b.default),Y=n(4432),J=n(2220),X=n(3726),Z=n(14),$=n(44),ee=n(112),te=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(o.__extends)(t,e),t.prototype.createActivityColumn=function(){return{key:"activity",name:ee.ActivityColumnName,fieldType:$.t.Activity,minWidth:140,width:300,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,isIcon:!1,sortable:!1,filterable:!1,isSorted:!1,isFocused:this.observables.create(!1),isAscending:!1}},t}(b.default),ne=Object(T.r)("ActivityColumnBuilder",te,Object(o.__assign)({},b.default.dependencies)),ae=n(1537),ie=n(37),re=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._itemParentHelper=n.itemParentHelper,a._activityColumnBuilder=n.activityColumnBuilder,a._isActivityFieldEnabled=n.isActivityFieldEnabled,a._isActivityFieldVisible=n.isActivityFieldVisible,a._pageContext=n.pageContext,a}return Object(o.__extends)(t,e),t.prototype.postProcessSchema=function(e,t){var n=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return n&&n.list.isDocumentLibrary&&e.queryType===ie.e.Files&&(Object(X.e)(t)||n.list.templateType===Z.n.mySiteDocumentLibrary||Number(this._pageContext.webTemplate)===O.t.mySite)&&this._isActivityFieldEnabled&&this._isActivityFieldVisible()&&(t=Object(o.__spreadArray)(Object(o.__spreadArray)([],t,!0),[this._activityColumnBuilder.createActivityColumn()],!1)),t},t}(b.default),oe=Object(T.r)("DetailsListSchemaDataSource",re,Object(o.__assign)(Object(o.__assign)({},b.default.dependencies),{itemParentHelper:J.e,activityColumnBuilder:ne,isActivityFieldEnabled:ae.e,isActivityFieldVisible:ae.t.lazy,pageContext:c.f})),se=n(2692),ce=n(1662),de=n(1664),le=n(2502),ue=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._dataSource=n.resources.consume(l.$),n}return Object(o.__extends)(t,e),t.prototype.getShareByLinkInfo=function(){return this._dataSource.getShareByLinkInfo().then(function(e){return e})},t}(b.default),fe=n(1602),pe=n(1444),me=n(1597),_e=n(5187),he=n(146),be=n(5188),ge=n(1012),ve=n(1667),ye=n(371),Se=n(4430),De=n(4813),Ie=n(9),xe=n(1577),Ce=n(4828),Oe=n(867),we=n(1609),Ee=function(){function e(){}return e.shouldAddGroupsFeatures=function(e){return Object(g.l)(e)},e.loadAndInitGroupsResources=function(e){e.isDefined(Oe.e)||e.exposeFactory(Oe.e,new T.e(we.e));var t=M.n.resolve(e.consumeAsync(Oe.e));return e.isExposed(Oe.t)||e.expose(Oe.t,t),t.then(function(e){return{groupsProvider:e}})},e}(),Ae=n(4835),Le=n(4438),ke=n(4148),Me=n(4779),Pe=n(2269),Te=n(204),Ue=n(4441),Fe=n(2206),He=n(4220),Re=n(2653),Ne=n(4843),Be=function(e){function t(t){var n=e.call(this,t)||this;return n.id=t.id,n._onViewChanged=t.onViewChanged||null,n}return Object(o.__extends)(t,e),t.prototype.initialize=function(e){var t=this;this.pageResources=e;var n=e.resourceScope,a=e.appResources.pageContext,i=e.commandSet;ke.e.exposeResources({resourceScope:n,pageContext:a,viewId:a.viewId}),this.useItemsScope=n.consume(Re.e),this.dataManager=n.consume(f.t),this._error=this.observables.create();var r=n.consume(d.P);n.expose(d.a,this.dataManager.canModifySchema);var c=n.consume(f.n);this._registerPageLoadCompleteEvent(this.dataManager,c),this._setupViewChangeEventHandler(n),n.expose(f.a.isArrangeControlVisible,s.observable(!1));var u={};n.isExposed(l.re)&&Object(N.isFeatureEnabled)(N.Spotlight)&&!this.useItemsScope.peek()&&(u=this._setupSpotlight(n));var p=Object(o.__assign)({topCommandSet:i,showViewCommandSet:!0,isCustomList:!0,breadcrumbBuilder:this.dataManager.getCrumbs.bind(this.dataManager)},u);this._initializeItemsScopeManager(),this.controlSpecification=this._getListSpecification(p),this.observables.backgroundCompute(function(){r(),t._error(void 0)})},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype._registerPageLoadCompleteEvent=function(e,t){var n=this;this.events.on(e,"pageLoadComplete",function(){Te.t.raise(t,Ae.e.mainContentLoadComplete),n.events.off(e,"pageLoadComplete")})},t.prototype._setupViewChangeEventHandler=function(e){if(this._onViewChanged){var t=e.consume(d.l);this.observables.subscribe(t,this._onViewChanged)}},t.prototype._setupSpotlight=function(e){e.expose(p.g,new(e.injected(Me.e))({itemSet:e.consume(d.s),itemsStore:e.consume(Pe.t),spotlightDataSource:e.consume(l.re),currentView:e.consume(d.l)}));var t=e.consume(p.g).getSpotlightItems(),n=s.pureComputed(function(){return t.peek().length>0||t().length>0}),a=s.observable(),i=s.observable(!1),r={spotlightCommandSet:a,isSpotlightActive:i,isSpotlightVisible:n,boundingElementClass:"StandaloneList-content"};return{subcomponentSpecification:Object(Fe.i)(Ue.e,r),subcomponentCommandSet:a,isSubcomponentActive:i,isSubcomponentVisible:n}},t.prototype._getListSpecification=function(e){var t=this,n=Object(Fe.i)(Le.e.bypass,e),a=Object(Fe.i)(He.e.bypass,{props:{},error:this._error});return this.observables.pureCompute(function(){return t._error()?Object(Fe.i)(Ne.e,{error:t._error.peek()}):t.useItemsScope()?a:n})},t.prototype._initializeItemsScopeManager=function(){var e=this;this.observables.backgroundCompute(function(){e.useItemsScope.peek()?e.pageResources.resourceScope.consumeAsync(m.e):e.useItemsScope()})},t}(b.default),je=function(){function e(){}return e.prototype.addGroupsFeatures=function(e){var t=this,n=e.getPageSettings,a=e.initializeScenario;e.initializeScenario=function(e){a(e),t.synchronousInitialize(e)},e.getPageSettings=function(){var e=n();return t._configurePageSettings(e),e}},e.prototype.synchronousInitialize=function(e){Ee.loadAndInitGroupsResources(e.resourceScope)},e.prototype._configurePageSettings=function(e){e.route=new Be({id:"List"})},e}(),Ve=n(4428),ze=n(2654),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.getAction=function(e){if(this.resources.isExposed(c.o)){var t=this.resources.consume(c.o),n=t.listUrl?t.listUrl:t.folderPath;if(n)return{text:ze.m,url:n}}return{text:null,url:null,hideButton:!0}},t}(b.default),Ke=Ge,We=new P.t({name:"PublishDataSource.key",loader:new T.t(function(){return n.e(487).then(n.bind(null,5705)).then(function(e){return e.resourceKey})})}),qe=new P.t({name:"PublishProvider.key",loader:new T.t(function(){return n.e(534).then(n.bind(null,5706)).then(function(e){return e.resourceKey})})}),Qe=n(466),Ye=function(){function e(e,t){this._pageContext=t.pageContext}return e.prototype.getCurrentLanguage=function(){return Qe.t.language},e.prototype.getCurrentLanguageCode=function(){return this._pageContext.currentUICultureName},e}(),Je=Object(T.r)("LanguageDataSource",Ye,{pageContext:c.f}),Xe=n(23),Ze=n(170),$e=n(4221),et=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;return a._footerLinks=s.observable([]),a._searchFooterLinkId="upscopeSearchLink",a}return Object(o.__extends)(t,e),t.prototype.showLanguageLink=function(){return!1},t.prototype.showConfidentialText=function(){return!1},t.prototype.getLanguageText=function(){return""},t.prototype.getFooterLinks=function(){var e=this;return this.async.setTimeout(function(){var t=document.getElementById(e._searchFooterLinkId);t&&e.events.on(t,"click",Ze.e.logData.bind(e,{name:"Expand.Search.Click"}))}.bind(this),100),this._footerLinks()},t.prototype.setSearchFooterLink=function(e){if(e){var t=$e.t,n=this._searchFooterLinkId,a=Xe.format($e.n,'<a id="'.concat(n,'" title="').concat(t,'" href="').concat(e,'" target="_blank">').concat(t,"</a>"));this._searchFooterLink=[{encodedText:a}],this._footerLinks(this._searchFooterLink)}else this._footerLinks([])},t}(b.default),tt=et,nt=(Object(T.r)("SPListFooterDataSource",et),function(){function e(){}return e.prototype.getEncoding=function(){return null},e}()),at=new P.t({name:"VideoItemDataSource.key",loader:new T.t(function(){return n.e(493).then(n.bind(null,5950)).then(function(e){return e.resourceKey})})}),it=n(4442),rt=n(2975),ot=new P.t({name:"NeedsAttentionViewHelper.key",loader:new T.t(function(){return n.e(542).then(n.bind(null,5707)).then(function(e){return e.resourceKey})})}),st=n(2478),ct=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t},dt=n(2885),lt=n(2602),ut=n(2816),ft=n(3117),pt=n(4443),mt=n(2723),_t=n(3024),ht=!B.e.isActivated("2f9bdd69-14dc-4f06-8a20-7caedf41c80a","05/24/2022","Enable using new embed dialog in ODB and SPO."),bt=!B.e.isActivated("78ce42b1-dcef-438a-824c-c7808018f95e","10/03/2022","checks for viewListItems permissions if item doesnt contain openItems perimissions and allows view access,this could fix view access restriction for blockDownload items"),gt=((a={})[lt.i.id]=!0,a[lt.e.id]=!0,a[ut.e.id]=!0,a[ut.a.id]=!0,a[lt.n.id]=!0,a[ft.e.id]=!0,a[ft.t.id]=!0,a[ft.n.id]=!0,a[ft.r.id]=!0,a[_t.t.id]=!0,a[lt.f.id]=!0,a[mt.a.id]=!0,a[ut.t.id]=!0,a[ut.n.id]=!0,a[ut.r.id]=!1,a[dt.t.id]=!0,a[dt.e.id]=!0,a[mt.n.id]=!0,a),vt=((i={})[ut.e.id]=!0,i[lt.n.id]=!0,i[_t.t.id]=!0,i[dt.t.id]=!0,i[dt.e.id]=!0,i[ft.n.id]=!0,i[ut.i.id]=!0,i[ut.n.id]=!0,i[mt.t.id]=!0,i),yt=((r={})[lt.a.id]=!0,r),St=function(){function e(e,t){this._pageContext=t.pageContext}return e.prototype.getCommand=function(e,t){var n,a;switch(t){case lt.p:a=this._isRestoreEnabled(e);break;case lt.r:a=!this._pageContext.isAnonymousGuestUser||C.e.hasItemPermission(e,C.e.openItems)||bt&&C.e.hasItemPermission(e,C.e.viewListItems);break;case pt.e:a=!this._pageContext.blockDownloadsExperienceEnabled&&!this._pageContext.viewOnlyExperienceEnabled&&C.e.hasItemPermission(e,C.e.openItems);break;case mt.n:a=Object(N.isFeatureEnabled)(N.EnableEmbedDialog)&&ht;break;case ut.i:case ut.a:case ut.t:case ut.e:case ut.n:case lt.e:case lt.i:case lt.f:case lt.l:case lt.c:case lt.o:case lt.s:case lt.d:case lt.t:case lt.u:case ft.n:case ft.i:case ft.a:case ft.e:case ft.t:case ft.r:case mt.a:case mt.t:case mt.e:case lt.n:case _t.t:case _t.n:case _t.e:case ut.r:case dt.t:case dt.e:a=!0}return(this._pageContext.isAnonymousGuestUser&&gt[t.id]||this._pageContext.isEmailAuthenticationGuestUser&&vt[t.id])&&(a=!1),e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected&&(a=a&&yt[t.id]),a&&(n=new ct),n},e.prototype._isRestoreEnabled=function(e){return!!e.recycleBinProperties.itemState},e}(),Dt=Object(T.r)("ItemCommandDataSource",St,{pageContext:c.f}),It=function(e){function t(t){var n=e.call(this,t)||this;return n._fileSystemItemIdMapping={},n}return Object(o.__extends)(t,e),t.prototype.getPathFromItemId=function(e){return this._fileSystemItemIdMapping[e]},t.prototype.setFileSystemIdMapping=function(e,t){this._fileSystemItemIdMapping[e]=t},t}(b.default),xt=n(4844),Ct=new P.t({name:"PushChannelDataSource.key",loader:new T.t(function(){return n.e(488).then(n.bind(null,6022)).then(function(e){return e.resourceKey})})}),Ot=n(4222),wt=n(2912),Et=n(4444),At=new P.t({name:"ItemAutoRefreshDataSource.key",loader:new T.t(function(){return n.e(465).then(n.bind(null,5708)).then(function(e){return e.resourceKey})})}),Lt=new P.t({name:"ItemAutoRefreshProvider.key",loader:new T.t(function(){return n.e(596).then(n.bind(null,5709)).then(function(e){return e.resourceKey})})}),kt=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(o.__extends)(t,e),t.prototype.initialize=function(){this._dataPromise=null},t.prototype.getCustomActionData=function(){return this._dataPromise||(this._dataPromise=M.n.resolve(this.resources.consumeAsync(l.o)).then(function(e){return e.getCustomActionData()})),this._dataPromise},t.prototype.isGroup=function(e){return"children"in e},t}(n(299).e),Mt=n(181),Pt=function(){function e(e,t){var n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}return e.prototype.getWopiFrameUrl=function(e,t){var n="ms-word"===e.appMap,a=e.wopiFrameUrl,i=n?this._wordAction:"embedview",r=a&&a.replace(/action=([^&]+)/,"action=".concat(i,"&wdnc=1&nobg=1"));return r?r.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/".concat(t?"WopiEmbedFrame":"doc",".aspx")):void 0},e}(),Tt=Object(T.r)("WopiFrameDataSource",Pt,{platformDetection:Mt.e}),Ut=new P.t({name:"WrsDataSource.key",loader:new T.t(function(){return n.e(495).then(n.bind(null,5710)).then(function(e){return e.resourceKey})})}),Ft=n(1433),Ht=n(4218),Rt=new P.t({name:"SearchDataSource.key",loader:new T.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("deferred"),n.e(763)]).then(n.bind(null,5922)).then(function(e){return e.resourceKey})})}),Nt=n(4211),Bt=n(60),jt=function(){function e(e){this._pageContext=e;var t=(e&&new Bt.e(e.webAbsoluteUrl)).authority;this._itemUrlBase=t+this._pageContext.listUrl}return e.prototype.getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e&&void 0!==e.relativePath?this._itemUrlBase+e.relativePath:void 0},e.prototype.getPageContextForRenderUser=function(){return this._pageContext},e}(),Vt=new P.t({name:"ItemActivityFeedHelper.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(762)]).then(n.bind(null,6023)).then(function(e){return e.resourceKey})})}),zt=new P.t({name:"ItemActivityFeedSharingHelper.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(712)]).then(n.bind(null,6024)).then(function(e){return e.resourceKey})})}),Gt=new P.t({name:"ItemCommentsDataSource.key",loader:new T.t(function(){return n.e(752).then(n.bind(null,5923)).then(function(e){return e.resourceKey})})}),Kt=n(4845),Wt=new P.t({name:"RestoreOperationDataSource.key",loader:new T.t(function(){return n.e(755).then(n.bind(null,6025)).then(function(e){return e.resourceKey})})}),qt=new P.t({name:"RestoreActivitiesDataSource.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(754)]).then(n.bind(null,5951)).then(function(e){return e.resourceKey})})}),Qt=new P.t({name:"MruRecentDataSource.key",loader:new T.t(function(){return n.e(485).then(n.bind(null,4997)).then(function(e){return e.resourceKey})})}),Yt=new P.t({name:"MruRecentProvider.key",loader:new T.t(function(){return n.e(527).then(n.bind(null,4998)).then(function(e){return e.resourceKey})})}),Jt=n(5085),Xt=n(4836),Zt=n(3707),$t=n(5105),en=n(3463),tn=n(214),nn=n(1944),an=n(378),rn=n(3),on=n(2985),sn=n(1959),cn=n("react-lib"),dn=cn.lazy(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(567)]).then(n.bind(null,2800))});function ln(e){return cn.createElement("div",null,cn.createElement(cn.Suspense,{fallback:cn.createElement("div",null)},cn.createElement(dn,Object(o.__assign)({},e))))}var un=new P.t({name:"PeoplePickerProvider.key",loader:new T.t(function(){return n.e(533).then(n.bind(null,2397)).then(function(e){return e.resourceKey})})}),fn=n(2307),pn=function(){function e(e,t,n,a,i,r,o){this._id=t,this.rx=o,this._resources=e,this._pageContext=n,this._getViewParams=i,this._submitSearch=r,this._rootItemId=a}return e.prototype.getId=function(){return this._id},e.prototype.createStream=function(e){var t=this;return this.rx.Observable.fromPromise(this._getPropsPromise(e)).selectMany(function(e){return t.rx.Observable.fromArray(e)})},e.prototype._getPropsPromise=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,a=this;return Object(o.__generator)(this,function(i){switch(i.label){case 0:return this._searchProvider?[3,2]:[4,n.e(741).then(n.bind(null,6035))];case 1:t=i.sent().MetadataSearchProvider,this._searchProvider=new t({getViewParams:this._getViewParams,rootItemId:this._rootItemId},{dataSource:this._resources.consume(en.e),pageContext:this._pageContext}),i.label=2;case 2:return this._searchProvider.searchBoxText=e,[2,this._resources.consumeAsync(un).then(function(e){return[{id:"metadataSearchForm",provider:a._searchProvider,pageContext:a._pageContext,getIconUrl:function(e,t){return Object(fn.e)(a._resources,e,t)},peoplePickerProvider:e,ariaRole:"dialog",ariaLabel:sn.d,ariaModal:!0,submitSearch:a._submitSearch}]})]}})})},e}();function mn(e,t,n,a,i,r){return{id:"metadataFormUpdater",groupUpdaters:[{groupId:"file",createUpdater:function(){var o=pn.bind(null,e,"SuiteNavSearchBox.MetadataSearchFormProvider",t,n,i,r);return o.__parameters=[{index:0,name:"rxjs"}],{providers:function(e){return[o]},component:function(e){return a||ln},heading:function(e){return""},optimalCount:function(e){return 1},ariaLabel:function(e){return sn.d}}}}]}}var _n=n(4224),hn=n(4445),bn=new P.t("searchUpscopeDataSource"),gn=n(5114),vn=n(862),yn=n(5189);function Sn(){var e="alertInPageSearchResults",t=document.getElementById(e);t&&t.parentElement&&t.parentElement.removeChild(t),(t=document.createElement("div")).id=e,t.className="ms-accessible",t.innerText=yn.e,t.setAttribute("role","alert"),document.body.appendChild(t)}var Dn=n(206),In=n(507),xn=n(2655),Cn=new P.t({name:"ShortcutProvider.key",loader:new T.t(function(){return Promise.resolve().then(n.bind(null,2984)).then(function(e){return e.resourceKey})})}),On=n(2640),wn=n(12),En=n(4846),An=wn.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url");function Ln(e,t){return e.sPWebUrl&&Object(rn.co)(rn.hi)&&xn.e.isShortcutFileType(e.fileExtension)?function(e,t,n){return n.consumeAsync(Cn).then(function(n){return n.getShortcutTargetData(e,!0,void 0,t).then(function(e){return e.isInternal?Object(En.e)(e.url):e.url})})}(e.url,e.sPWebUrl,t).then(function(e){return e}):Promise.resolve(Object(En.e)(e.url))}function kn(e){return e.url.toLowerCase().indexOf("docsethome.aspx")>=0}function Mn(e){return{id:"fileSuggestionClickUpdater",groupUpdaters:Pn(e)}}function Pn(e){return[{groupId:"file",createUpdater:Tn(e)},{groupId:"app",createUpdater:Tn(e)}]}function Tn(e){return function(){return{component:function(t){return function(n){return cn.createElement(t,Object(o.__assign)(Object(o.__assign)({},n),{onClick:function(t){!function(e,t,n){Object(o.__awaiter)(this,void 0,void 0,function(){var a;return Object(o.__generator)(this,function(i){switch(i.label){case 0:return n.engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0}),t.onClick&&t.onClick(e),function(e){var t=e.fileExtension,n=e.fileType;return void 0===t&&"File"===n}(t)&&function(e,t){e.preventDefault(),e.stopPropagation(),window.open(t,"_blank")}(e,t.url),function(e){var t,n=!An&&("one"===e.fileExtension||-1!==(null===(t=e.url)||void 0===t?void 0:t.toLowerCase().indexOf("/doc.aspx?")));return!!e.fileType&&"folder"===e.fileType.toLowerCase()&&!kn(e)&&!n}(t)?(function(e,t,n){var a;e.preventDefault(),e.stopPropagation(),!n.pageContext.listUrl||function(e,t){return e.indexOf(t)>-1}(t.url,n.pageContext.listUrl)||(a=t.url.substring(0,t.url.lastIndexOf("/"))),n.navigation.updateViewParams(function(e,t,n){var a={},i=new Dn.e(e),r=i.path.indexOf("?"),o=i.path.substring(0,-1!==r?r:i.path.length);return a[Ie.n.idParamKey]=o,!n||(a[Ie.n.listUrlKey]=n),a}(t.url,0,a),{clearOtherParams:!0})}(e,t,n),[3,3]):[3,1];case 1:return!function(e,t){return!(!e.url||(a=e.url,!wn.e.isActivated("31d4a0b9-e9f7-4b89-a452-b27b0222793d")&&-1!==a.indexOf("/_layouts/15/"))||function(e,t){return!!e&&!!e.listTemplateType&&Object(Z.r)(e.listTemplateType)&&t.url.toLowerCase().indexOf("dispform.aspx")>=0}(t.listContext,e)||function(e){return("aspx"===e.fileExtension||!e.fileExtension)&&e.url.toLowerCase().indexOf(".aspx")>=0}(e)||(n=e.fileExtension,n&&Object(On.s)(n.toLowerCase()))||kn(e));var n,a}(t,n)||(o=(r=t.url).indexOf("?")>-1?Object(In.e)(r.substring(r.indexOf("?")+1)):void 0)&&o[Ie.n.idParamKey]&&o[Ie.n.parentIdParamKey]?[3,3]:(e.preventDefault(),e.stopPropagation(),[4,Ln(t,n.resources)]);case 2:a=i.sent(),window.open(a,"_blank"),i.label=3;case 3:return[2]}var r,o})})}(t,n,e)}}))}}}}}var Un=n(1232),Fn=n(2435),Hn=n(4214),Rn=n(240),Nn=n(402),Bn=n(2673),jn=n(234),Vn=new Rn.e,zn={delayQos:{},delayTimeoutState:{}},Gn=wn.e.isActivated("891196BA-98FA-4623-ABD1-371612730330","10/10/2022","fix oneNote results and suggestions url"),Kn=function(){function e(e,t,n,a,i){var r=this;this._getSearchDataSource=function(){return Object(o.__awaiter)(r,void 0,void 0,function(){var e;return Object(o.__generator)(this,function(t){switch(t.label){case 0:return e=this._resources,Object(rn.co)(rn.Vr)?[4,e.consumeAsync(jn.e.optional)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,e.consumeAsync(l.J)]}})})},this._resources=e,this._id=t,this._getScope=n,this.rx=i,this._isList=a}return e.prototype.getId=function(){return this._id},e.prototype.createStream=function(e){var t=this,n=1===e.length?"":e;return this.rx.Observable.fromPromise(this._updateDelayedQuery(n)).selectMany(function(e){return t.rx.Observable.fromArray(e)}).select(function(n){return t.transform(n,e)})},e.prototype._getSuggestionResultPromise=function(e){var t=this,n=e+"*",a=new D.e({name:this._id});return M.n.wrap(this._getSearchDataSource()).then(function(e){var i,r=null===(i=t._getScope())||void 0===i?void 0:i.id;return e.getItems(n,void 0,r).then(function(e){return a.end({resultType:I.e.Success}),e.containers[0]&&e.containers[0].results||void 0}).catch(function(e){throw a.end({resultType:I.e.Failure,error:e.message}),e})})},e.prototype._updateDelayedQuery=function(e){var t=this;return this._ensureDelayQos(),zn.delayTimeoutState.delayTimeoutId&&zn.delayTimeoutState.rejectQuery&&this._rejectPreviousSuggestion(),new M.n(function(n,a){zn.delayTimeoutState.delayTimeoutId=Vn.setTimeout(function(){t._resolveSuggestion(n,e)},400),zn.delayTimeoutState.rejectQuery=a})},e.prototype.transform=function(e,t){var n,a,i=Xe.format(Bn.b,e.lastModifiedBy,Object(Nn.n)(e.lastModifiedDate,Qe.t.language));if(e.rawTitleText)n=e.rawTitleText;else{var r=document.createElement("textarea");r.innerHTML=e.titleText,n=r.value}a=Gn?e.fileExtension||-1!==n.lastIndexOf(".")?n.substring(n.lastIndexOf(".")+1):"":e.fileExtension||(-1!==n.lastIndexOf(".")?n.substring(n.lastIndexOf(".")+1):"");var o=this._highlight(n,t);return i=this._highlight(i,t),{id:e.url,searchText:t,displayText:o,secondaryDisplayText:i,title:o,icon:e.iconUrl,iconUrl:e.iconUrl,lastModifiedBy:e.lastModifiedBy,lastModifiedTime:e.lastModifiedDate.toISOString(),url:Hn.e?this._fixUrl(e,n,a):e.itemOpenUrl||this._fixUrl(e,n,a),fileExtension:a,fileType:this._getFileType(a,e.isContainer),sPWebUrl:e.siteUrl}},e.prototype._getFileType=function(e,t){return t&&(Gn||"one"!==e)?"folder":"file"},e.prototype._highlight=function(e,t){var n=new RegExp(t,"i");return e.replace(n,"<mark>$&</mark>")},e.prototype._fixUrl=function(e,t,n){var a=e.url,i=e.parentUrl?decodeURI(e.parentUrl):"";return i=i&&Object(Hn.t)(i),a=Object(Hn.n)({filename:t,isContainer:e.isContainer,parentLink:i,path:a,fileExtension:n,shouldAllowDisplayFormUrl:this._isList}),"loop"===n&&i&&(a="".concat(i,"/").concat(t,"?web=1")),a},e.prototype._ensureDelayQos=function(){zn.delayQos.qosEvent||(zn.delayQos.qosEvent=new D.e({name:"SuiteNavSearchBox.SearchDataSourceSuggestionProvider.delayed"}),zn.delayQos.numberOfCanceledQueries=0)},e.prototype._endDelayQos=function(e){var t;null===(t=zn.delayQos.qosEvent)||void 0===t||t.end({resultType:I.e.Success,extraData:{delayTimeInMs:400,numberOfCanceledQueries:zn.delayQos.numberOfCanceledQueries,characterCount:e}}),zn.delayQos={}},e.prototype._updateDelayQosCanceledQueries=function(){void 0!==zn.delayQos.numberOfCanceledQueries&&zn.delayQos.numberOfCanceledQueries++},e.prototype._rejectPreviousSuggestion=function(){Vn.clearTimeout(zn.delayTimeoutState.delayTimeoutId),zn.delayTimeoutState.rejectQuery(),this._updateDelayQosCanceledQueries(),zn.delayTimeoutState={}},e.prototype._resolveSuggestion=function(e,t){zn.delayTimeoutState={},this._endDelayQos(t.length),e(this._getSuggestionResultPromise(t))},e}();function Wn(e,t,n){var a="SuiteNavSearchBox.ListItemSuggestionProvider";return{id:"listItemSuggestions",groupUpdaters:[{groupId:"file",createUpdater:qn(e,a,t,n)},{groupId:"app",createUpdater:qn(e,a,t,n)}]}}function qn(e,t,n,a){return function(i,r){var o,s,d=Object(rn.co)(rn.L)||1===Object(tn.n)(90097,e.consume(c.f))?Kn.bind(null,e,t,n,a):Kn.bind(null,e,t,function(){},a);if(d.__parameters=[{index:0,name:"rxjs"}],B.t.isActivated("6fc4458a-0a18-4bb4-af1d-320fcce353e1","09/14/2020","Remove suggestions for site/hub/org scopes in SPO"))s=[d];else switch(null===(o=n())||void 0===o?void 0:o.id){case"spSiteSite":case"spSiteHub":case"spHubHub":case"spHubSite":case"org":s=[];break;default:s=[d]}return{providers:function(e){return s},heading:function(e){return Fn.f},ariaLabel:function(e){return Fn.f}}}}var Qn,Yn=function(){function e(e,t){this._deps=t,this._resources=t.resources,Object(_n.e)(this._deps.pageContext)&&(this._metadataSearchDataSource=this._resources.consume(en.e))}return e.prototype.getSuiteNavProviderKey=function(){return p.y},e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()},e.prototype.getProviderConfigUpdaters=function(e,t){var n,a,i,r=this;return Object(_n.e)(this._deps.pageContext)&&(null===(n=this._metadataSearchDataSource)||void 0===n?void 0:n.isMetadataSearchMode)?[mn(this._resources,this._deps.pageContext,this._deps.urlDataSourceLite.getDefaultRootItemId(),(null===(a=this._deps.bootOptions)||void 0===a?void 0:a.chromeless)?null===(i=this._deps.bootOptions)||void 0===i?void 0:i.metadataSearchForm:void 0,t,function(){return r._submitMetadataSearchCallback(t)})]:(Object(rn.co)(rn.L)||1===Object(tn.n)(90097,this._deps.pageContext))&&e?[Wn(this._resources,e,this._isGenericList),Mn(this._deps)]:[Wn(this._resources,function(){},this._isGenericList),Mn(this._deps)]},e.prototype.onSubmitSearchCallback=function(e,t,n,a){var i;this._deps.instrumentationProvider.logStartSearchOnSubmit();var r,s,c=this._deps.pageContext.listItemCount,d=B.t.isActivated("89825f27-33e9-4ffd-aa68-b2b360b6c8dc","07/13/2022","use isPrimedLibrary passed from search box provider")?Object(on.e)(this._deps.listContext):this._isPrimedLibrary,l=Object(_n.e)(this._deps.pageContext);if(l&&(r=this._metadataSearchDataSource.getContentTypesCount(t(),!0)),this._isMetadataSearch())this._submitMetadataSearchCallback(t);else if(e){if(this._closeInfoPanel(),this._deps.engagement.logData({name:"InPage.Search.Click",isIntentional:!0,extraData:{listItemCount:c,isSyntexEnabled:d,contentTypesCount:r,isMetadataSearchEnabled:l}}),n&&("spSiteSite"===(s=n.id)||"spSiteHub"===s||"spHubHub"===s||"spHubSite"===s||"org"===s))return void function(e,t,n,a,i){switch(t.id){case"spSiteSite":case"spHubSite":case"spHubHub":var r="spHubHub"===t.id?"hub":"site";return n.getSiteSearchUpscopeUrl(e,r).then(function(e){Object(hn.e)(e,a,i)});case"spSiteHub":return n.getHubSearchUpscopeUrl(e,"hub").then(function(e){Object(hn.e)(e,a,i)});case"org":return n.getTenantUpscopeUrl(e).then(function(e){Object(hn.e)(e,a,i)});default:throw new Error("Unsupported scope ".concat(t.id))}}(e,n,this._deps.searchUpscopeDataSource,this._deps.navigation,a);var u=((i={})[Ie.n.queryTypeParamKey]=ie.e.Search,i[Ie.n.queryParamKey]=e,i);if(n){var f=this._deps.urlDataSourceLite.getKey(Object(o.__assign)({},t())),p=this._getSearchItemId(n.id,f);p&&(u[Ie.n.idParamKey]=p)}this._deps.navigation.updateViewParams(u),Sn()}else Object(gn.e)(this._deps.navigation)},e.prototype.onExitSearchCallback=function(e){var t=this._isMetadataSearch()?this._viewParamsBeforeMetadataSearch:e;Object(gn.e)(this._deps.navigation,t),_n.e&&this._metadataSearchDataSource&&(this._metadataSearchDataSource.isMetadataSearchMode=!1)},e.prototype.isSearchResultsPage=function(){return Object(vn.e)(this._deps.urlDataSourceLite.getQueryType(this._deps.navigation.viewParams))},e.prototype.setIsPrimedLibrary=function(e){this._isPrimedLibrary=e},e.prototype.setIsGenericList=function(e){this._isGenericList=e},e.prototype._closeInfoPanel=function(){if(!B.t.isActivated("47752bad-5b7b-4604-b48f-8285858491cc","08/01/2022","close info panel before search")){var e=this._resources.consume(nn.resourceKey.optional);e&&e()&&e(!1)}},e.prototype._isMetadataSearch=function(){var e,t,n,a,i;return Object(_n.e)(this._deps.pageContext)&&(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode)&&(!!(null===(n=null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.queryKQL)||void 0===n?void 0:n.kql)||!!(null===(i=null===(a=this._metadataSearchDataSource)||void 0===a?void 0:a.queryKQL)||void 0===i?void 0:i.query))},e.prototype._submitMetadataSearchCallback=function(e){var t;this._closeInfoPanel(),this.isSearchResultsPage()||(this._viewParamsBeforeMetadataSearch=null==e?void 0:e());var n=this._deps.urlDataSourceLite.getCurrentItemKey(),a=!this._deps.itemUrlHelper.getItemUrlParts(n).serverRelativeItemUrl,i="".concat(this._deps.urlDataSourceLite.getSearchItemId(n))||"",r=null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.getSearchQueryParams(i,a);this._logMetadataSearchFieldsEngagement(this._deps.navigation.viewParams);var s=this._deps.navigation.viewParams,c=Ie.n.queryParamKey,d=(s[c],Object(o.__rest)(s,["symbol"==typeof c?c:c+""]));this._deps.navigation.updateViewParams(Object(o.__assign)(Object(o.__assign)({},d),r),{clearOtherParams:!0}),Sn()},e.prototype._getSearchItemId=function(e,t){var n=this._deps.itemUrlHelper.getItemUrlParts(t);switch(e){case"spListFolder":case"spDocLibFolder":return;case"spDocLib":case"spList":return n.serverRelativeListUrl;default:throw new Error('Invalid SearchBoxScope: "'.concat(e,'"'))}},e.prototype._logMetadataSearchFieldsEngagement=function(e){var t;this._deps.engagement.logData({name:"MetadataSearch.Search.Click",isIntentional:!0,extraData:null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.getSearchEnagementLogExtraData(e,this._isPrimedLibrary)})},e.dependencies={resources:P.r,navigation:he.e,engagement:F.e,searchBoxConfig:Un.e,listContext:c.o,pageContext:c.f,itemUrlHelper:W.c,urlDataSourceLite:l.fe,searchUpscopeDataSource:bn,bootOptions:an.e.optional,instrumentationProvider:p.r},e}(),Jn=Object(T.r)("SPListSearchBoxDataSource",Yn),Xn=n(5106),Zn=n(1223),$n=n(4847),ea=function(){function e(e,t){this._deps=t}return e.prototype.getInitialScope=function(){var e,t,n=this._deps.navigation.viewParams,a=this._deps.urlDataSourceLite.getKey(Object(o.__assign)({},n)),i=this._deps.itemUrlHelper.getItemUrlParts(a);return B.t.isActivated("f16521d4-c64b-4d9b-b82c-852401fed6ae","1/27/2021","Use INavLink targetLink to identify doclib")?(e=i.serverRelativeItemUrl===i.serverRelativeListUrl,t=Object(Z.a)(this._deps.pageContext.listBaseType)):(e=!i.listRelativeItemUrl,t=this._deps.onePageContext.targetLink?this._deps.onePageContext.targetLink.isDocLib:Object(Z.a)(this._deps.pageContext.listBaseType)),t?e?$n.t:$n.e:e?$n.i:$n.a},e.prototype.getAvailableScopes=function(){return B.t.isActivated("318eed5c-1325-48a3-8743-35c69f2daf95","10/07/2021","Remove whole org scope option from scoping control when user is guest")?Object($n.n)(this.getInitialScope().id,!!this._deps.pageContext.isHubSite,!!this._deps.pageContext.hubSiteId,this._deps.pageContext.searchScope,Number(this._deps.pageContext.webTemplate)===O.t.mySite||Object(Zn.r)(this._deps.pageContext),!1):Object($n.n)(this.getInitialScope().id,!!this._deps.pageContext.isHubSite,!!this._deps.pageContext.hubSiteId,this._deps.pageContext.searchScope,Number(this._deps.pageContext.webTemplate)===O.t.mySite||Object(Zn.r)(this._deps.pageContext),this._deps.pageContext.isAnonymousGuestUser||this._deps.pageContext.isExternalGuestUser)},e.prototype.setActiveScope=function(e){this._activeScope=e},e.prototype.getActiveScope=function(){return this._activeScope},e.prototype.isScopingControlEnabled=function(){return Object(rn.co)(rn.L)||1===Object(tn.n)(90097,this._deps.pageContext)},e.prototype.getScopeControlScenario=function(e,t){if(t)return"SPO.List.Search";switch(e){case $n.a:return"SPO.List.Folder";case $n.i:return"SPO.List.Root";case $n.e:return"SPO.DocLib.Folder";case $n.t:return"SPO.DocLib.Root";default:throw new Error('Unsupported scope: "'.concat(e.id,'"'))}},e.dependencies={navigation:he.e,pageContext:c.f,itemUrlHelper:W.c,urlDataSourceLite:l.fe,onePageContext:c.u},e}(),ta=Object(T.r)("SPListScopingControlDataSource",ea),na=n(4225),aa=n(41),ia=function(){function e(e,t){this._searchUpscopeDataSource=t.searchUpscopeDataSource,this._pageContext=t.pageContext,this._navigation=t.navigation}return e.prototype.getUpscopeUrl=function(){var e,t=Number(this._pageContext.webTemplate)===O.e.mySite,n=this.getSearchText(),a=this._pageContext.searchScope;return t||Object(Zn.r)(this._pageContext)||a===g.i.Tenant?this._searchUpscopeDataSource.getTenantUpscopeUrl(n):(e=this._pageContext.hubSiteId&&a!==g.i.Site&&this._pageContext.isHubSite?"hub":"site",this._searchUpscopeDataSource.getSiteSearchUpscopeUrl(n,e))},e.prototype.getSearchText=function(){return Object(aa.h)(this._navigation.viewParams)||""},e.prototype.getLabel=function(){return this._searchUpscopeDataSource.getLabel()},e.prototype.getAriaLabel=function(){return this._searchUpscopeDataSource.getAriaLabel()},e.prototype.getListTemplate=function(){return this._pageContext.listBaseTemplate},e.dependencies={searchUpscopeDataSource:bn,pageContext:c.f,navigation:he.e},e}(),ra=Object(T.r)("SearchUpscopeProvider",ia),oa=n(1956),sa=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dataRequestor=new(a.child(q.t))({qosName:"SPOSearchUpscopeDataSource"}),a._pageContext=n.pageContext,a._sharepointUrl=n.sharepointUrl,a}return Object(o.__extends)(t,e),t.prototype.getSiteSearchUpscopeUrl=function(e,t){var n=this,a=this._pageContext.webAbsoluteUrl;return this._getUpscopeUrl(a).then(function(i){return i&&n._urlIsValidSearchResultsPage(i)?n._buildSearchUrl(i,e,t):n._getDefaultUrl(a,e,t)}).catch(function(){return n._getDefaultUrl(a,e,t)})},t.prototype.getHubSearchUpscopeUrl=function(e,t){var n=this;return this._getHubUrl().then(function(a){return n._getUpscopeUrl(a).then(function(i){return i&&n._urlIsValidSearchResultsPage(i)?n._buildSearchUrl(i,e,t):n._getDefaultUrl(a,e,t)})})},t.prototype.getTenantUpscopeUrl=function(e){var t=new Bt.e(this._getSharePointUrl()).authority;return Promise.resolve("".concat(t,"/").concat(this._pageContext.layoutsUrl,"/search.aspx?q=").concat(e))},t.prototype.getLabel=function(){return oa.o},t.prototype.getAriaLabel=function(){return"".concat(oa.o," ").concat(oa.s)},t.prototype._getUpscopeUrl=function(e){var t=e+"/_api/search/resultspageaddress";return this._dataRequestor.getData({url:t,qosName:"SearchUpscopeDataSource.ResultsPageAddress",method:"GET",parseResponse:function(e){var t=e?JSON.parse(e):void 0;return t&&t.d&&t.d.resultspageaddress}})},t.prototype._getHubUrl=function(){if(this._pageContext.webAbsoluteUrl&&this._pageContext.hubSiteId){var e="".concat(this._pageContext.webAbsoluteUrl,"/_api/HubSites/GetById?hubSiteId='").concat(this._pageContext.hubSiteId,"'");return this._dataRequestor.getData({url:e,qosName:"SearchUpscopeDataSource.ResultsHubUrl",method:"GET",parseResponse:function(e){var t=e?JSON.parse(e):void 0;return t&&t.d&&t.d.SiteUrl}})}return Promise.reject(new Error("webAbsoluteUrl or hubSiteId is empty"))},t.prototype._buildSearchUrl=function(e,t,n){var a=new x.t(e);return a.setQueryParameter("q",t),a.setQueryParameter("k",t),a.setQueryParameter("scope",n),a.toString()},t.prototype._urlIsValidSearchResultsPage=function(e){if(!new Bt.e(e).authority)return!0;try{return new URL(e).hostname===new URL(this._pageContext.siteAbsoluteUrl).hostname}catch(e){return!1}},t.prototype._getDefaultUrl=function(e,t,n){var a=new x.t("".concat(e,"/_layouts/15/search.aspx/siteall"));return a.setQueryParameter("q",t),a.setQueryParameter("scope",n),a.toString()},t.prototype._getSharePointUrl=function(){return Number(this._pageContext.webTemplate)===O.t.mySite&&this._sharepointUrl?this._sharepointUrl.get():Object(g.c)(this._pageContext)},t.dependencies=Object(o.__assign)(Object(o.__assign)({},b.default.dependencies),{pageContext:c.f,sharepointUrl:Zt.t.optional}),t}(b.default),ca=Object(T.r)("SPOSearchUpscopeDataSource",sa),da=n(1),la=n(88),ua=n(120),fa=n(39),pa=n(116),ma=n(2986),_a=n(51),ha=n(399),ba=n(857),ga=n(1105),va=n(4848),ya=function(){function e(e,t){this._isMetadataSearchMode=!1,this._deps=t,this._itemCacheStore=t.itemCacheStore,this._itemsScopeItemKey=t.itemsScopeItemKey,this._contentTypes=[],this._queryableFields=[],this._defaultFields=[],this._defaultFields=Object(ma.n)(),this._cacheType="LocalStorage",this._areExclusionQueriesSupported=Object(rn.co)(rn.k),this._isStronglyTypedFieldsSupported=Object(rn.co)(rn.k)&&this._deps.pageContext.isSearchQueryServedBySubstrate}return Object.defineProperty(e.prototype,"queryKQL",{get:function(){return this._queryKQL},set:function(e){this._queryKQL=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMetadataSearchMode",{get:function(){return this._isMetadataSearchMode},set:function(e){this._isMetadataSearchMode=e,e?this._startQoS():this._endQoS("Close")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isList",{get:function(){return this._isList},set:function(e){this._isList=e,this._defaultFields=Object(ma.n)(this._isList)},enumerable:!1,configurable:!0}),e.prototype.getDefaultFields=function(){return Object(ma.n)(this._isList)},e.prototype.getContentTypes=function(e){return this._setContentTypes(e),this._contentTypes},e.prototype.getContentTypesCount=function(e,t){t&&this._setContentTypes(e);var n=this._contentTypes.filter(function(e,t){var n=0===t;return!Object(ma.i)(e.contentTypeId,n)});return n.length?n.length+1:1},e.prototype.getSearchQueryParams=function(e,t){var n,a=((n={})[Ie.n.queryTypeParamKey]=ie.e.Search,n);if(t||(a[Ie.n.idParamKey]=e),this._queryKQL.query&&(a[Ie.n.queryParamKey]=this._queryKQL.query),this._queryKQL.kql||this._queryKQL.query){var i=this._generateID();sessionStorage.setItem(i,JSON.stringify(this._queryKQL)),a[Ie.n.metadataSearchIdKey]=i}return this._endQoS("Search"),a},e.prototype.getSearchEnagementLogExtraData=function(e,t){var n=!!e[Ie.n.useFiltersInViewXmlKey]&&!!e.FilterFields1,a=B.t.isActivated("89825f27-33e9-4ffd-aa68-b2b360b6c8dc","07/13/2022","use isPrimedLibrary passed from search box provider")?Object(on.e)(this._deps.listContext):t,i=this.getContentTypesCount(e);return Object(o.__assign)({isFilterView:n,listItemCount:this._deps.pageContext.listItemCount,isSyntexEnabled:a,contentTypesCount:i,queryLength:this._getQueryLength(),queryableFieldsCount:this._queryableFields.length},this._getSearchFieldsUsageData())},e.prototype.getMetadataStoredSession=function(e){return Object(va.e)(e)},e.prototype.isMetadataSearchResultPage=function(e){return this._isSearchResultsPage(e)&&!!Object(aa.m)(e)},e.prototype.getAdditionalSearchFields=function(e){return this._getCustomColumnsInView(this._defaultFields.length,e)},e.prototype.getLastCachedQueryableFields=function(e){var t=sessionStorage.getItem(e);if(this._queryableFields=[],t){var n=JSON.parse(t);this._queryableFields=n}return this._queryableFields},e.prototype.getSiteColumns=function(){return Object(o.__awaiter)(this,void 0,M.e,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(484).then(n.bind(null,6026))];case 1:return[4,new(0,e.sent().QueryableFieldsFetchHelper)({pageContext:this._deps.pageContext,storageType:this._cacheType}).getSiteColumns(this._deps.pageContext.siteId,this._deps.pageContext.webId)];case 2:return[2,e.sent()]}})})},e.prototype.isStronglyTypedFieldsSupported=function(){return this._isStronglyTypedFieldsSupported},e.prototype.areExclusionQueriesSupported=function(){return this._areExclusionQueriesSupported},e.prototype._isSearchResultsPage=function(e){return Object(vn.e)(Object(ga.e)(e))},e.prototype._getQueryLength=function(){var e=0;return this._queryKQL.query&&(e+=this._queryKQL.query.length),this._queryKQL.kql&&(e>0&&(e+=1),e+=this._queryKQL.kql.length),e},e.prototype._getSearchFieldsUsageData=function(){var e=this,t=0,n=[],a=0,i=new Map;this._queryKQL.query&&(t++,n.push("Keywords")),this._queryKQL.kqlFields&&this._queryKQL.kqlFields.forEach(function(r){if(r.isSystemField)t++,n.push(e._defaultFields[r.fieldId].kqlProperty);else{a++;var o=e._getCustomFieldType(r);i.has(o)?i.set(o,i.get(o)+1):i.set(o,1)}});var r={systemFieldCount:t,systemFields:n,customFieldCount:a};return i.forEach(function(e,t){r["".concat(ma.e[t],"CustomFieldCount")]=e}),r},e.prototype._getCustomFieldType=function(e){for(var t,n=0,a=this._queryableFields;n<a.length;n++){var i=a[n];if(i.fieldId===e.fieldId){t=i.fieldType;break}}return t},e.prototype._getCustomColumnsInView=function(e,t){return Object(o.__awaiter)(this,void 0,M.e,function(){var a,i,r,s,c,d,l,u,f,p=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return[4,this.getSiteColumns()];case 1:return a=o.sent(),this._queryableFields=[],a&&Object.keys(a).length>0?[4,n.e(483).then(n.bind(null,5711))]:[3,3];case 2:i=o.sent(),r=i.cacheLastQueryableFieldsToSessionStorage,s=i.getCustomChoiceFieldOption,c=i.getCustomFieldType,d=i.getCustomFieldManagedPropertyName,l=i.isSiteSystemField,u=[],f=e,this._deps.listContext.rawListSchema.Field.forEach(function(e){if(e.ID in a&&!l(e.Name)){var t=a[e.ID],n=e.FieldType,i=c(n,t,e.Unit);if(void 0!==i){var r=p._areExclusionQueriesSupported?d(t.name,n,p._isStronglyTypedFieldsSupported):'"'.concat(d(t.name,n,p._isStronglyTypedFieldsSupported),'"'),o={displayName:e.DisplayName,fieldType:i,isSystemField:!1,kqlProperty:r,fieldId:f++};i===ma.e.Dropdown&&(o.choices=s(e.Choices)),i===ma.e.ManagedMetadata&&(o.termSuggestionParams={lcid:p._deps.pageContext.currentLanguage||1033,sspList:e.SspId,termSetList:e.TermSetId,anchorId:e.AnchorId}),u.push(o)}}}),r(u,t),this._queryableFields=u,o.label=3;case 3:return[2,this._queryableFields]}})})},e.prototype._generateID=function(){return"metadataSearch-".concat(_a.e.generate())},e.prototype._startQoS=function(){this._metadataSearchCurrentQosEvent&&this._metadataSearchCurrentQosEvent.end({resultType:I.e.Failure}),this._metadataSearchCurrentQosEvent=new D.e({name:"MetadataSearch.Usage"})},e.prototype._endQoS=function(e){this._metadataSearchCurrentQosEvent&&(this._metadataSearchCurrentQosEvent.end({resultType:I.e.Success,resultCode:e}),this._metadataSearchCurrentQosEvent=void 0)},e.prototype._setContentTypes=function(e){var t=this,n=new D.e({name:"MetadataSearch.GetContentTypes"}),a=[];!this._isSearchResultsPage(e)&&this._itemCacheStore&&this._itemsScopeItemKey?a=this._itemCacheStore.dispatch(Object(pa.e)(function(e){var n=Object(fa.e)(e,t._itemsScopeItemKey),a=e.demandItemFacet(la.e,n)||{},i=a.webAbsoluteUrl,r=void 0===i?void 0:i,o=a.listFullUrl,s=void 0===o?void 0:o,c=r&&s&&ua.e.serialize({webAbsoluteUrl:r,listFullUrl:s});return(e.demandItemFacet(da.b,c)||[]).map(function(t){return e.demandItemFacet(da.yn,t)})})):this._deps.contentTypes&&(a=this._deps.contentTypes.peek()),a.length>0?n.end({resultType:I.e.Success}):n.end({resultType:I.e.Failure,resultCode:"NoContentTypes"}),this._contentTypes=a},e.dependencies={pageContext:c.f,listContext:c.o,itemCacheStore:ba.e.optional,itemsScopeItemKey:ha.e.optional,contentTypes:c.n.optional},e}(),Sa=Object(T.r)("MetadataSearchDataSource",ya),Da=new P.t({name:"UserExpirationDataSource.key",loader:new T.t(function(){return n.e(760).then(n.bind(null,5712)).then(function(e){return e.resourceKey})})}),Ia=new P.t({name:"SmartFiltersDataSource.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(894)]).then(n.bind(null,5713)).then(function(e){return e.resourceKey})})}),xa=n(2987),Ca=n(3293),Oa=n(105),wa=n(4439),Ea={files:Object(wa.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(515)]).then(n.bind(null,5845))}),embed:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(503)]).then(n.bind(null,5848))}),oneUp:Object(wa.e)(function(){return n.e(518).then(n.bind(null,5920))}),share:Object(wa.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(523)]).then(n.bind(null,5952))}),restore:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(502)]).then(n.bind(null,6027))}),base:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(501)]).then(n.bind(null,5703))}),picker:Object(wa.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(506)]).then(n.bind(null,5714))}),textEditor:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(524)]).then(n.bind(null,5844))}),settings:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(521)]).then(n.bind(null,5885))}),mobileUpsell:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(517)]).then(n.bind(null,5948))}),error:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(504)]).then(n.bind(null,5949))}),mobileUpsellInner:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(516)]).then(n.bind(null,5087))}),settingsInner:Object(wa.e)(function(){return n.e(520).then(n.bind(null,5894))}),restoreInner:Object(wa.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(519)]).then(n.bind(null,5921))}),commands:Object(wa.e)(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(889)]).then(n.bind(null,5953))})},Aa=function(){function e(){}return e.prototype.getPageModuleLoader=function(e){if(e===Oa.e.MobileAppUpsell&&Object(N.isFeatureEnabled)(N.EnableMobileWebOfficeAppUpsell))return Ea.mobileUpsell;switch(e){case Oa.e.FilePicker:return Ea.picker;case Oa.e.Share:return Ea.share;case Oa.e.Restore:return Ea.restore;case Oa.e.Error:return Ea.base;case Oa.e.Settings:return Ea.settings;case Oa.e.TextFileEditor:return Ea.textEditor;case Oa.e.Embed:return Ea.embed;case Oa.e.OneUp:return Ea.oneUp;default:return Ea.files}},e.prototype.getInnerPageModuleLoader=function(e){switch(e){case Oa.e.MobileAppUpsell:return Ea.mobileUpsellInner;case Oa.e.Settings:return Ea.settingsInner;case Oa.e.Restore:return Ea.restoreInner;case Oa.e.Error:default:return Ea.error}},e.prototype.getCommandSetModuleLoader=function(){return Ea.commands},e}(),La=new P.t({name:"ModuleLoaderDataSource",factory:new T.i(Aa)}),ka=n(3850),Ma=n(4840),Pa=n(4212),Ta=n(4447),Ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.canSaveAsCopy=function(e){var t=e.item;return!!t&&C.e.hasItemPermission(t,C.e.insertListItems)},t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&this.isWebFormat(t)&&C.e.hasItemPermission(t,C.e.insertListItems)&&C.e.hasItemPermission(t,C.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsCopy(e)||this.canSaveAsOriginal(e)},e.prototype.isWebFormat=function(e){var t,n=null===(t=null==e?void 0:e.extension)||void 0===t?void 0:t.toLowerCase();return n&&(".png"===n||".jpeg"===n||".jpg"===n)},e}()),Fa=Object(T.r)("ImageEditorDataSource",Ua),Ha=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&C.e.hasItemPermission(t,C.e.insertListItems)&&C.e.hasItemPermission(t,C.e.editListItems)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),Ra=Object(T.r)("PdfDataSource",Ha),Na=n(4849),Ba=(n(1844),n(428)),ja=n(4837),Va=n(4838),za=n(4841),Ga=n(3452),Ka=n(4842),Wa=n(4167),qa=n(4440),Qa=n(3119),Ya=n(2562),Ja=n(3181),Xa=n(1367),Za=n(1457),$a=n(3359),ei=n(225),ti=n(4817),ni=n(593),ai=n(3290),ii=void 0,ri=void 0,oi=new P.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=function(e,t){if(!e)return[!1,void 0];var n=Object(ni.e)(e);if(Object(ni.i)(n)||Object(ni.n)(n))return[!1,void 0];var a=Object(N.isFeatureEnabled)(N.EnableOnePlayerForGovCloud)||Object(N.isFeatureEnabled)(N.EnableOnePlayerForGovCloudForEmbedMicroservice);if(Object(ni.r)(n)&&!a)return[!1,void 0];var i=Object(N.isFeatureEnabled)(N.UseOnePlayer),r={experimentId:"number"==typeof N.UseOnePlayer.ODB?N.UseOnePlayer.ODB:1995,variant:i?1:0,isAATest:!1,isOverride:ei.n.isFeatureEnabled(N.UseOnePlayer),correlationId:e?e.CorrelationId:"",cloudType:e?String(e.cloudType):""},o=i?r:void 0,s=i;return void 0!==o&&void 0!==o.variant?[s,o=function(e,t){var n=ti.e();return void 0===e.variant||t&&JSON.stringify(t)===JSON.stringify(e)||(ti.t(n,e),t=e),t}(o,t)]:[s,void 0]}(e.pageContext,ii),n=t[0],a=t[1];return ii=a,{instance:n}}}}),si=new P.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;return{instance:function(){var e=Object(ai.e)(N.OnePlayerGetTranscriptsFromVroom,90028,N.OnePlayerGetTranscriptsFromVroomGovClouds,t,ri),n=e[0],a=e[1];return ri=a,n}}}}}),ci=n(4427),di=new P.t({name:"".concat("EnableNewOneUpCommandBarResourceKey",".enableNewOneUpCommandBarResourceKey"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;if(!wn.e.isActivated("5902b772-cd42-40fa-80cf-a77f494d5df6","06/18/2021","Disable OneUp new command bar")){if(Object(N.isFeatureEnabled)(N.EnableNewOneUpCommandBar))return{instance:!0};if(t)return{instance:1===Object(tn.n)(90086,t)}}return{instance:!1}}}}),li=n(4426),ui=new P.t({name:"".concat("EnableDarkThemeForOneUpMediaResourceKey",".enableDarkThemeForOneUpMedia"),factory:{dependencies:{pageContext:c.f.optional},create:function(e){var t=e.pageContext;if(!wn.e.isActivated("d30193ae-159f-40d8-af45-38df4cecd4ec","06/14/2021","Disable dark theme in light mode for OneUp media.")){if(Object(N.isFeatureEnabled)(N.EnableDarkThemeForOneUpMediaViewer))return{instance:!0};if(t)return{instance:1===Object(tn.n)(90091,t)}}return{instance:!1}}}}),fi=n(61),pi=n(457),mi=n(16),_i=n(189),hi=n(880),bi=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.itemCacheStore.dispatch,r=n.itemCacheObservablesFactory.pureCompute(function(e){return!!e.demandItemFacet(hi.e,mi.c)});return a.isExpanded=a.observables.compute({read:function(){return r()},write:function(e){var t;i(Object(_i.e)({items:(t={},t[mi.c]=Object(o.__assign)({},hi.e.pack(e)),t)})),i(Object(pi.e)())},pure:!0}),a}return Object(o.__extends)(t,e),t}(b.default),gi=(Qn=Object(T.o)("isReactLeftNavExpandedHelper",bi,{itemCacheObservablesFactory:le.e,itemCacheStore:ba.e}),new P.t({name:"isReactLeftNavExpanded.key",factory:{dependencies:{isReactLeftNavExpandedType:Qn},create:function(e){var t=new e.isReactLeftNavExpandedType({});return{instance:t.isExpanded,disposable:t}}}}));function vi(e){return e.resourceKey}var yi=function(){function e(){}return e.prototype.exposeResources=function(e){var t=this,a=e.resourceScope,i=e.pageContext,r=e.navigation,o=e.viewParams,s=new Ba.e,m=s.attach(new(a.consume(b.observablesFactoryTypeResourceKey)));this._pageContext=i,this._navigation=r,this._shouldAddGroupsFeatures()&&(new je).synchronousInitialize(e);var _=function(e,t){a.exposeAsync(e,new T.t(function(){return t().then(vi)}))};a.expose(Kt.e,i.CorrelationId),_(l.e,function(){return n.e(595).then(n.bind(null,5677))}),_(l.Z,function(){return n.e(489).then(n.bind(null,5678))}),_(l.k,function(){return n.e(469).then(n.bind(null,5679))}),_(l.Ce,function(){return n.e(496).then(n.bind(null,6010))}),this._urlDataSource=a.expose(l.ue,new(a.injected(De.e))),a.exposeFactory(Re.e,new T.e(Si)),a.exposeFactory(Ja.e,new T.e(Si)),a.expose(Se.e,new(a.injected(It))),a.expose(d.h,m.create(!1)),a.exposeFactory(l.ne,new T.e(Ve.e)),a.expose(u.e,new xt.e),a.expose(Nt.e,i.allowInfectedDownload),a.expose(d.C,m.create(!1)),a.expose(Pa.e,i.m365GroupsBlockDownloadsExperienceEnabled),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||(a.expose(Zt.e,new Za.e(!1)),a.expose(Zt.t,new Za.e("")),a.expose(c.o,new(a.injected(xe.e))({listId:i.listId||this._navigation.viewParams[Ie.n.listIdKey],listRootFolderServerRelativeUrl:i.listUrl||this._navigation.viewParams[Ie.n.listUrlKey]}))),a.exposeFactory(l.v,new T.e(Xt.e)),a.exposeFactory(l.P,new T.e(Xt.e)),a.exposeFactory(l.s,new T.e(Xt.e)),a.exposeFactory(xa.e,new T.e(Ia)),a.exposeFactory(l.F,new T.e(rt.t)),a.exposeFactory(ye.n,new T.e(ot)),a.exposeFactory(Ta.e,new T.e(Fa)),a.exposeFactory(l.B,new T.e(Ra)),a.expose(d.e,new Ce.e),a.expose(l.f,new(a.injected(Ke))),a.exposeFactory(p.p,new T.e(qe)),a.exposeFactory(l.G,new T.e(We)),a.exposeFactory(l.T,new T.e(Je)),a.expose(l.l,new nt),a.expose(l.g,new(a.injected(tt))),a.exposeFactory(l.be,new T.e(at)),a.exposeFactory(l.w,new T.e(it.e)),_(l.ie,function(){return n.e(758).then(n.bind(null,4373))}),_(l.h,function(){return n.e(590).then(n.bind(null,5680))}),_(l.oe,function(){return n.e(490).then(n.bind(null,5681))}),a.exposeFactory(l.E,new T.e(Dt)),a.expose(d.v,m.create(!1)),a.expose(c.n,m.createArray()),a.expose(l.I,new jt(i)),a.exposeFactory(l.x,new T.e(Vt)),a.exposeFactory(l.C,new T.e(zt)),a.exposeFactory(l.A,new T.e(Gt)),a.expose(d.x,m.create(!1)),a.expose(c.l,m.create(null)),a.expose(c.p,{useEnableDynamicGroups:null!==i.groupId,setPathOnViewChange:!0}),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||(a.exposeFactory(Xn.e,new T.e(ta)),a.exposeFactory(l.J,new T.e(Rt)),a.exposeFactory($t.e,new T.e(Jn)),a.exposeFactory(bn,new T.e(ca)),a.exposeFactory(na.e,new T.e(ra)),Object(_n.e)(this._pageContext)&&a.exposeFactory(en.e,new T.e(Sa))),m.compute(function(){t._urlDataSource.getQueryType(o())!==ie.e.Search?a.consume(c.c).delete(st.e.Search):a.consume(c.c).set(st.e.Search,"isOn",!0)}),_(l.o,function(){return n.e(462).then(n.bind(null,6011))}),a.expose(p.t,new(a.resolved(kt))({})),_(l.ge,function(){return n.e(460).then(n.bind(null,5682))}),a.exposeAsync(l.a,new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(491)]).then(n.bind(null,5054)).then(function(e){return e.typeResourceKey})})),a.exposeAsync(Na.e,new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(759)]).then(n.bind(null,5683)).then(vi)})),a.exposeFactory(wt.e,new T.e(Et.e)),_(l.p,function(){return Promise.resolve().then(n.bind(null,5684))}),_(l.z,function(){return n.e(486).then(n.bind(null,5685))}),_(l.t,function(){return n.e(459).then(n.bind(null,5686))}),_(ye.t,function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e(142)]).then(n.bind(null,5687))}),_(l.y,function(){return n.e(751).then(n.bind(null,5688))}),Object(N.isFeatureEnabled)(N.EnablePushChannel)&&!Object(N.isFeatureEnabled)(N.UseItemsScopeInTeamSites)&&(a.exposeFactory(l.K,new T.e(Ct)),a.exposeFactory(l.O,new T.e(At)),a.consumeAsync(Object(N.isFeatureEnabled)(N.EnablePushChannelAutoRefresh)?Lt:Ot.e)),a.expose(p._,null),a.exposeFactory(l.q,new T.e(Wt)),a.exposeFactory(l.Q,new T.e(qt)),a.exposeFactory(l.De,new T.e(Tt)),a.exposeFactory(l.xe,new T.e(Ut)),a.exposeFactory(l.ve,new T.e(Ft.e)),a.exposeFactory(l.V,new T.e(Ht.e)),_(l.Ie,function(){return n.e(494).then(n.bind(null,5689))}),a.exposeFactory(l.R,new T.e(Qt)),a.exposeFactory(p.s,new T.e(Yt)),this._pageContext.isSiteAdmin&&a.exposeFactory(l.pe,new T.e(Da)),a.exposeFactory(Ca.e,new T.e(La)),a.expose(p.e,new(a.injected(Jt.e))),a.exposeFactory(c.s,new T.e(Xt.e)),a.exposeFactory(l.r,new T.e(Va.e)),a.exposeFactory(ka.e,new T.e(Ma.e)),a.exposeFactory($a.e,new T.e(oi)),a.exposeFactory($a.t,new T.e(si)),a.exposeFactory(ci.e,new T.e(di)),a.exposeFactory(li.e,new T.e(ui)),a.exposeFactory(l.c,new T.e(ja.e)),a.exposeFactory(f.o,new T.e(Ka.e)),a.exposeFactory(f.e.leftNav.isLeftNavUserExpanded,new T.e(gi));var h=a.expose(f.t,new(a.injected(Wa.e))({defaultViewId:i.viewId}));a.expose(f.a.layoutType,h.layoutType),a.expose(d.m,h.focusItem),a.expose(d._,h.focusItemSet);var g=new(a.injected(qa.e));a.expose(d.d,g),a.expose(d.I,new(a.injected(Ga.e))({selectionModelGroup:g,enableSelectionResolution:!1}));var v=a.consume(Qa.e);s.attach(v.register(m.pureCompute(function(){var e=g.currentSelection();return!!e&&e.selectedCount()>0}))),s.attach(v.register(a.consume(Ya.t))),Object(N.isFeatureEnabled)(N.MoveTransitionResourcesToKOResourceScope)||a.expose(nn.resourceKey,m.create(!1)),a.expose(d.i,m.create(!0)),a.expose(ye.a,new(a.injected(za.e))),Object(N.isFeatureEnabled)(N.SPSearchItemsScope)&&(_(fi.k,function(){return n.e(834).then(n.bind(null,5690))}),_(fi.L,function(){return n.e(748).then(n.bind(null,5691))}))},e.prototype._shouldAddGroupsFeatures=function(){var e=window._spPageContextInfo;return Object(g.l)(e)},e}(),Si=new P.t({name:"DeferredResourceLoader",factory:{dependencies:{viewParams:d.P,observablesFactoryType:b.observablesFactoryTypeResourceKey,urlDataSource:l.ue,getIsItemsScopeEnabledInFilesPivot:Xa.o.lazy},create:function(e){var t=e.viewParams,n=e.observablesFactoryType,a=e.urlDataSource,i=e.getIsItemsScopeEnabledInFilesPivot,r=new Ba.e;return{instance:r.attach(new n).pureCompute(function(){if(!i())return!1;var e=t();if(!e[Ie.n.isPowerAppView]&&a){var n=a.getQueryType(e);return n===ie.e.Files||Object(N.isFeatureEnabled)(N.SPSearchItemsScope)&&n===ie.e.Search}return!1}),disposable:r}}}}),Di=n(4448),Ii=new P.t({name:"InfoPaneManager.key",loader:new T.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(809)]).then(n.bind(null,5847)).then(function(e){return e.typeResourceKey})})}),xi=n(4226),Ci=n(2221),Oi=n(2470),wi=n(1620),Ei=n(482),Ai=function(){function e(e){this._spoAppContextHandler=e}return e.prototype.get=function(){return!1},e.prototype.set=function(e){var t;this._spoAppContextHandler.update(((t={})[Ei.paneControls]={needsOverlayContent:e},t))},e.prototype.subscribe=function(e){return function(){}},e}(),Li=new P.t({name:"NeedsOverlayContent",factory:{dependencies:{spoAppContextHandler:wi.e},create:function(e){var t=e.spoAppContextHandler;return{instance:{needsOverlayContent:new Ai(t)}}}}}),ki=(n(4850),n(3590)),Mi=function(e){function t(t){var n=e.call(this,t)||this;return n._embedDataSource=n.resources.consume(l.d),n}return Object(o.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)},t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)},t}(b.default),Pi=!B.e.isActivated("94F00C2A-A77D-4B5E-AF56-A103CD3C2C3B","12/19/2022","The embed link can be generated without call sharingInformation API, fix the cross site error as well"),Ti=function(e){function t(){var t=e.call(this)||this;return t._sharingDataSource=t.resources.consume(l.ee),t._itemUrlHelper=t.resources.consume(W.c),t}return Object(o.__extends)(t,e),t.prototype.getEmbedInfo=function(e){if(Pi){var t=this._itemUrlHelper.getItemUrlParts(e.key).fullWebUrl;return M.n.resolve({embedUrl:t+"/_layouts/15/embed.aspx"})}return this._sharingDataSource.getSharingInformation(e).then(function(e){return{embedUrl:(null==e?void 0:e.webUrl)+"/_layouts/15/embed.aspx"}})},t}(b.default),Ui=(Object(T.r)("EmbedDataSource",Ti),n(1714)),Fi=n(1683);function Hi(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,v,y;return Object(o.__generator)(this,function(o){return window.__ko=s,n=t.attach(new(e.consume(b.observablesFactoryTypeResourceKey))({owner:this})),a=e.consume(f.n),i=e.consume(c.f),r=e.consume(he.e),e.exposeFactory(Oi.e,new T.e(Li)),Object(rn.co)(rn.jn)||e.expose(u.n,new ve.default),e.exposeFactory(d.P,new T.e(Ni)),e.expose(d.p,!0),e.expose(c.c,new _e.e),e.expose(l.$,new(e.injected(G))(i)),e.expose(p.b,new(e.injected(ue))),e.expose(l.b,new(e.injected(Q))),e.exposeFactory(Ci.e,new T.e(xi.typeResourceKey)),Object(rn.co)(rn.jn)||(e.expose(l.D,new(e.injected(de.e))),e.expose(p.r,new(e.injected(fe.e)))),e.exposeFactory(Di.e,new T.e(Ii)),e.expose(d.b,n.create(!0)),e.expose(c.i,n.create("")),e.exposeFactory(Y.e,new T.e(oe)),(new yi).exposeResources({resourceScope:e,navigation:r,pageContext:i,eventScope:a,viewParams:e.consume(d.P)}),e.expose(l.ee,new(e.injected(_.default))(i)),e.expose(l.te,new(e.injected(h.default))(i)),e.exposeFactory(l.j,new T.e(se.resourceKey)),v=function(e,t,n){var a=t.create(void 0);e.expose(d.n,a);var i=e.consume(d.l);return t.subscribe(i,function(e){if(e&&e.serverRelativeUrl){var t=e.serverRelativeUrl;e.isPersonal&&(t+="?PageView=Personal&ShowWebPart={".concat(e.id.toUpperCase(),"}")),a(x.t.concatenate(Object(g.c)(n),t))}else a(void 0)}),a}(e,n,i),e.expose(l.U,new(e.injected(z))({backToClassicUrl:v})),y=e.consume(f.e.leftNav.isLeftNavUserExpanded),e.expose(f.e.leftNav.toggleIsLeftNavUserExpanded,function(){var e=!y.peek();return y(e),e}),e.expose(f.e.columnCustomizationPane.isColumnCustomizationPaneExpanded,n.create(!1)),e.expose(f.e.columnCustomizationPane.columnToFormat,n.create(void 0)),e.expose(f.e.columnCustomizationPane.viewToFormat,n.create(void 0)),e.expose(ki.isCustomizingCardResourceKey,n.create(void 0)),e.expose(d.S,n.create(!1)),e.expose(f.a.isArrangeControlVisible,s.observable(!1)),e.expose(l.d,new(e.injected(Ti))),e.expose(p.a,new(e.injected(Mi))),e.expose(u.t,new be.default),Object(rn.co)(rn.jn)||(e.expose(l.me,new(e.injected(ce.default))),e.expose(p.x,new(e.injected(me.default))),e.exposeFactory(p.D,new T.e(pe.resourceKey))),t.trackPromise(M.n.resolve(e.consumeAsync(m.e.bypass))),[2]})})}var Ri=new P.t({name:"TransitionResourceLoader",factory:new P.e(Hi)}),Ni=new P.t({name:"TransitionResourceLoader",factory:{dependencies:{itemCacheObservable:le.e,itemsScopeItemKey:ha.e,itemCacheStore:ba.e,observablesFactoryType:b.observablesFactoryTypeResourceKey},create:function(e){var t=e.itemCacheObservable,n=e.itemsScopeItemKey,a=e.itemCacheStore,i=e.observablesFactoryType,r=new ge.e,o=r.attach(new i),s=r.attach(a.dispatch(Object(Ui.e)({itemsScopeItemKey:n}))).evaluationContext,c=r.attach(t.pureCompute(function(e){return Object(Fi.e)(e)},{evaluationContext:s}));return{instance:o.pureCompute(function(){return c()}),disposable:r}}}})}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return R});var a=n(0),i=n(5500),r=n(4203),o=n(4818),s=n(1366),c=n(65),d=n(23),l=n(96),u=n(51),f=n(2395),p=n(1370),m=n(467),_="Group('{0}')",h="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",b="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",g="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",v="Group('{0}')/Members/Remove('{1}')",y="Group('{0}')/Owners/Remove('{1}')",S="/_layouts/15/groupstatus.aspx?id={0}&target={1}",D="isTeamifyPromptHidden",I=function(e){function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;return n._isTeamifyPromptHiddenCacheKey=t?D+"_".concat(t.siteId+t.groupId):D,n}return Object(a.__extends)(t,e),t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)},t._copyMembers=function(e){var n=new o.e;return n.members=e.map(function(e){return t._copyMember(e)}),n},t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)},t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)},t._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,assignedLabels:e.assignedLabels,membership:t._copyMembership(e)}},t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}},t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)},t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}},t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels",e),"SP.Directory.DirectorySession")},function(a){var i=t._parseGroup(a);return i.id||(i.id=e),n._calculateMissingGroupProperties(i,e),i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},t.prototype.setGroupBasicProperties=function(e){var t=this;return e?this.getData(function(){return t._getUrl(d.format(_,e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t={__metadata:{type:"SP.Directory.Group"}};return e.name&&(t.displayName=e.name),e.description&&(t.description=e.description),e.assignedLabels?(null!=e.isPublic&&(t.isPublic=e.isPublic),e.assignedLabels===u.e.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(t.isPublic=e.isPublic),e.classification&&(t.classification=e.classification)),JSON.stringify(t)},"PATCH",void 0,void 0,3):c.n.reject("Group parameter is null or undefined")},t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},t.prototype.getGroupMembership=function(e,n,a,i){var r=this;void 0===a&&(a=!1),void 0===i&&(i=!1);var o=a?"100":"3";return this.getData(function(){return r._getUrl(d.format(h,e,"members","0",o),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?r._addOwnerInformation(e,n,t):c.n.resolve(t)})},t.prototype.getGroupMembershipPage=function(e,n,a,i){var r=this;return this.getData(function(){return r._getUrl(d.format(h,e,"members",a,i),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},t.prototype.getGroupOwnership=function(e,n){var a=this,i=n||"100";return this.getData(function(){return a._getUrl(d.format(h,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);return a._calculateMissingOwnershipProperties(n),n},"GetOwnership",void 0,"GET",void 0,void 0,3)},t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return d.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(d.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)},t.prototype.addGroupMember=function(e,t,n,a){var i=this;return t=t||u.e.Empty,n=n||"",this.getData(function(){return i._getUrl(d.format(b,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddMember",void 0,"POST",void 0,void 0,3)},t.prototype.addGroupOwner=function(e,t,n,a){var i=this;return t=t||u.e.Empty,n=n||"",this.getData(function(){return i._getUrl(d.format(g,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddOwner",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupMember=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(d.format(v,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupOwner=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(d.format(y,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)},t.prototype.addUsersToGroup=function(e,t,n,i,r){var o=this,s=u.e.generate(),l="multipart/mixed; boundary=batch_"+s,p=[],m=[],_=0,h=0,v=function(t,n,a){for(var i=n?g:b,r=0;r<t.length;r++){var s=void 0,c=void 0;if(a?c=t[r]:s=t[r],s||c){s=s||u.e.Empty,c=c||"";var l=o._getUrl(d.format(i,e,s,c),"SP.Directory.DirectorySession");n?m.push(l):p.push(l)}}};if(t?(v(t,!0,!1),_=t.length):i&&(v(i,!0,!0),_=i.length),n?(v(n,!1,!1),h=n.length):r&&(v(r,!1,!0),h=r.length),!(m.length<1&&p.length<1)){var y=this.getData(function(){return f.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return f.e.getBatchContent(s,[m,p],"POST",f.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersNumber:_,MembersNumber:h},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new c.n(function(e,t){y.then(function(n){var a=f.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.addRemoveGroupUsers=function(e,t,n,i,r){var o=this,s=u.e.generate(),l="multipart/mixed; boundary=batch_"+s,p=[],m=[],_=[],h=[],S=function(t,n,a){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var r=0;r<t.length;r++)if(n)if(a){var s=o._getUrl(d.format(g,e,t[r],""),i);p.push(s)}else s=o._getUrl(d.format(y,e,t[r]),i),_.push(s);else a?(s=o._getUrl(d.format(b,e,t[r],""),i),m.push(s)):(s=o._getUrl(d.format(v,e,t[r]),i),h.push(s))};if(S(t,!0,!0),S(i,!0,!1),S(n,!1,!0),S(r,!1,!1),0!==p.length||0!==m.length||0!==_.length||0!==h.length){var D=this.getData(function(){return f.e.getBatchOperationUrl(o._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return f.e.getBatchContent(s,[p,m,_,h],"POST",f.e.defaultBatchRequestPostData)},"POST",void 0,l,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersToAdd:p.length,MembersToAdd:m.length,OwnersToRemove:_.length,MembersToRemove:h.length},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new c.n(function(e,t){D.then(function(n){var a=f.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(d.format("User(principalName='{0}')",l.e.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var a=t._parseUser(n);return a.email=e,a},"GetGraphUser",void 0,"GET",void 0,void 0,3)},t.prototype.deleteGroup=function(e){var t=this;return e?this.getData(function(){return t._getUrl(d.format(_,e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):c.n.reject("Group parameter is null or undefined")},t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(a){return t(a),a&&a.teamsId?n._pinToTeam(a,e):void 0})},t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0)})},t.prototype.getTeamifyBannerHidden=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return t._pageContext.siteAbsoluteUrl+d.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},qosName:"TeamifyBannerHidden",parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden},additionalPostData:"",method:"Get",cachingStrategy:e?m.e.bypassCache:m.e.useCacheAndUpdateInTheBackground,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},t.prototype._getUrl=function(e,t){return"".concat(this._pageContext.webAbsoluteUrl,"/_api/").concat(t,"/").concat(e)},t.prototype._getCsomUrl=function(e){return"".concat(this._pageContext.webAbsoluteUrl,"/_vti_bin/client.svc/").concat(e)},t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+d.format(S,e,"notebook")},t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+d.format(S,e,"documents")},t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var a=e.ownersList.members,i=n.membersList.members,r=[],o={};a.forEach(function(e){o[e.userId]=!0,e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var s=0,d={};return i.forEach(function(e){o[e.userId]?(e.isOwnerOfCurrentGroup=!0,r.push(e),s++,d[e.userId]=!0):r.push(e),e.principalName===t&&(n.isMember=!0)}),s<a.length&&a.forEach(function(e){d[e.userId]||(e.isOwnerOfCurrentGroup=!0,r.push(e))}),n.membersList.members=r,n.totalNumberOfMembers<r.length&&(n.totalNumberOfMembers=r.length),n.totalNumberOfOwners=e.totalNumberOfOwners,c.n.resolve(n)})},t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(p.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=d.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})},t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})},t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t)),!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))},t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var a=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return t._calculateMissingGroupProperties(n,n.id),n}),i=a.filter(function(e){return e.isFavorite});return i.push.apply(i,a.filter(function(e){return!e.isFavorite})),i},t.prototype._pinToTeam=function(e,t){var n=this;return t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var a={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(a)}},"POST",void 0,void 0,0)},t}(s.t),x=n(5176),C=function(){function e(e,t,n,a,i){this._groupsProvider=e,this._parentGroup=t,this._loadPageFromServerDelegate=n,this._pageSize=a&&"number"==typeof a.pageSize?a.pageSize:20,this._shouldAddOwnershipInformation=!a||(a.ownershipInformation,!1)||a.ownershipInformation,this._userLoginName=i,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var t=this,n=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){return t.error=e,c.n.reject(e)}):c.n.reject(void 0)},e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var a=t+this._pageSize>=this.totalNumberOfMembers,i=a?void 0:this._computeGetNextPagePromise(t+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,a),c.n.resolve({page:e.membersList.members,getNextPagePromise:i})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){return n._addOwnershipInformationToPage(e,a,t),c.n.resolve({page:e.membersList.members,getNextPagePromise:i})}):c.n.resolve({page:e.membersList.members,getNextPagePromise:i})},e.prototype._addOwnershipInformationToPage=function(e,t,n){var a=this;if(n&&(this.totalNumberOfOwners=n.totalNumberOfOwners,this._ownersDictionary={},n.ownersList.members.forEach(function(e){e.userId&&(a._ownersDictionary[e.userId]=e)}),this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=a._ownersDictionary&&!!a._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(a._numberOfOwnersFound++,a._foundOwnersDictionary[e.userId]=!0)}),t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var r=this._ownersDictionary[i];this._foundOwnersDictionary[r.userId]||(r.isOwnerOfCurrentGroup=!0,e.membersList.members.push(r),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}},e}(),O=n(172),w=n(204),E=n(262),A=n(1850),L=n(355),k=n(170),M=n(138),P=n(225),T="Yammer.FeedURL",U="MicrosoftTeams.TeamHomeURL",F="Missing group id.",H="CurrentUser",R=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._partnerUser="PartnerUser",this._pageContext=e.pageContext,this._dataRequestor=new E.t({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new I(e.pageContext);var t=function(e){return e.name?Object(a.__assign)(Object(a.__assign)({},e),{name:"GroupsProvider.PersistentCache.".concat(e.name)}):e};this._persistentCache=new A.e({secret:void 0,cacheType:L.e.indexedDB,telemetry:{engagement:k.e.withData(t),qos:M.e.withData(t)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new w.t(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var t=this;return new C(this,this.group,function(e,n,a){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,a):c.n.reject(t._missingLoginNameError):c.n.reject(F)},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?c.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):c.n.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return c.n.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,t){var n=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer},n.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return t._performBasicPropertiesPostProcessing(e),Object(O.l)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties(),e}):c.n.reject(F)},e.prototype.loadMembershipContainerFromServer=function(e,t,n,a){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=this._userLoginName),e?a?this._dataSource.getGroupMembership(e,a,t,n):c.n.reject(this._missingLoginNameError):c.n.reject(F)},e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):c.n.reject(F)},e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?c.n.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){return t._persistentCache.update({key:"UserGroupsFromAAD"+n.userId},e),e}):t._dataSource.getUserGroups(n).then(function(e){return t._persistentCache.update({key:"UserGroups"+n.userId},e),t._setUsersGroups(e,r.e.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(n){return(e?c.n.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+n.userId}).then(function(e){return e.data})):c.n.resolve(t._persistentCache.read({key:"UserGroups"+n.userId}).then(function(e){return e.data}))).then(function(n){return n&&!e&&t._setUsersGroups(n,r.e.Cache),n})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,a=t.length;n<a;n++)if(t[n].id===e)return!0;return!1})},e.prototype.getGroup=function(e,t){var n=this;if(void 0===t&&(t=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return t||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new c.n(function(e,t){var a=n.group;n.group?a.source===r.e.None?n._eventGroup.on(a,i.t.onSourceChange,function(i){i!==r.e.Error?i===r.e.None||e(a):t(n.group.error)}):e(a):t("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?c.n.resolve(this.currentUser):this._getUserFromCache(H).then(function(t){return e.currentUser=t,t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){return e._saveUserToCache(t,H),e.currentUser=t,t})}):c.n.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupMember(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.n.reject(F)},e.prototype.addUserToGroupOwnership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupOwner(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.n.reject(F)},e.prototype.removeUserFromGroupMembership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.n.reject(F)},e.prototype.removeUserFromGroupOwnership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.n.reject(F)},e.prototype.addUsersToGroup=function(e,t,n,a,i){var r,o=this;return e?P.n.isFeatureEnabled({ODB:60358})&&this._isPartnerUser()?this._dataSource.addUsersToGroup(e,t,n,a,i):this.currentUser?(r=this.currentUser.userId,this._dataSource.addUsersToGroup(e,t,n,a,i).then(function(e){return o._clearUserGroupsCache(r),e})):this.getCurrentUser().then(function(e){r=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,a,i)}).then(function(e){return o._clearUserGroupsCache(r),e}):c.n.reject(F)},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load(),this.group=n}},e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];return n||(n=new i.t(t,this,e,this._pageContext),this._groups[e]=n),n},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t,n,a=this._pageContext;return a.groupId===e.id&&(a.webTitle!==e.name||(a.siteClassification||e.classification)&&a.siteClassification!==e.classification||(a.sensitivityLabel||e.assignedLabels)&&(null===(t=a.sensitivityLabel)||void 0===t?void 0:t.toLocaleLowerCase())!==(null===(n=e.assignedLabels)||void 0===n?void 0:n.toLocaleLowerCase())||null===a.groupType||void 0===a.groupType||a.groupType===x.t.public!==e.isPublic||!a.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return c.n.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var t=this;return c.n.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(n){return!!n.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){var t=e||this._pageContext.siteId;return"".concat("HideTeamify",":").concat(t)},e.prototype._setUsersGroups=function(t,n){var a=this;this.userGroups=t.map(function(e){var t=a.getCachedGroup(e.id,e);return n!==r.e.Server&&t.source===r.e.Server||t.extend(e),t.pictureUrl||t.load(),t}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl="".concat(this._pageContext.webAbsoluteUrl).concat("/_api/GroupService/GetGroupImage"),e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations",T),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,U))},e.prototype._getWorkloadUrl=function(e,t,n,a){var i=null,r=e.yammerResources,o=e.teamsResources,s=function(e){var t=e.filter(function(e){return e.Key===a});return t&&t[0]?t[0].Value:null};return a===U?o&&o.results&&o.results.length>0&&(i=s(o.results)):r&&r.results&&r.results.length>0?a===T&&(i=s(r.results)):i=e[t]?e[t]:"".concat(this._pageContext.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(e.id,"&target=").concat(n),i},e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)},e.prototype._getUserFromCache=function(e){return c.n.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return c.n.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,t){var n;return this.currentUser&&e?(n=e===this.currentUser.userId?e:null,c.n.resolve(n)):this.getCurrentUser().then(function(a){return n=e?e===a.userId?a.userId:null:t===a.principalName?a.userId:null})},e.prototype._isPartnerUser=function(){var e,t;try{var n=window.parent;return!!n&&(null===(t=null===(e=n.window)||void 0===e?void 0:e.adminPageContext)||void 0===t?void 0:t.userType)===this._partnerUser}catch(e){return!1}},e.onUserGroupsChange="userGroups",e}();t.t=R},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(2201),r=n(320),o=n(1214),s=n(1219),c=n(2626),d=n(73),l=n(547),u=n(15),f=n(41),p=u.e.isActivated("E75FD3EC-1ECF-444B-87FB-B81B02F4E416","02/03/2022","Start the PowerApps host loader via React"),m=!u.e.isActivated("28525989-fd19-41bd-88fd-121e530a8ea4","12/14/2022","load power app on serp when currentItem.id not available"),_=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=n.currentItem,r=n.viewParams;return a._pageLoadMonitor=n.pageLoadMonitor,a._engagement=n.engagement,a.isPowerappHostModuleLoaded=a.observables.create(!1),a._powerAppsStore=n.powerAppsStore,a.loadBackgroundPowerApp=a._powerAppsStore.loadPowerApp,a.loadBackgroundPowerApp(!1),c.default.arePowerAppsFormsEnabled()?(a._pageLoadMonitor.waitForPLT().then(function(){if(p){a._loadOrUpdatePowerAppModule();var e=i.peek().id;a.observables.subscribe(i,function(t){t.id&&e!==t.id&&(e=t.id,a._loadOrUpdatePowerAppModule(!0))})}else(m?i.peek().id||Object(f.E)(r.peek()):i.peek().id)&&a._loadOrUpdatePowerAppModule()}),a):a}return Object(a.__extends)(t,e),t.prototype._loadOrUpdatePowerAppModule=function(e){return void 0===e&&(e=!1),Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this._powerAppsStore.isPowerAppsSupportedScenario()?(this._engagement.logData({name:"CheckShouldLoadPowerAppModule",isIntentional:!1}),[4,this._powerAppsStore.hasPowerAppsForm(e)]):[2];case 1:return t.sent()&&(this._engagement.logData({name:"ShouldLoadPowerAppModule",isIntentional:!1}),this.isPowerappHostModuleLoaded.peek()?this._bootPowerApp():this._loadPowerAppHostModule()),[2]}})})},t.prototype._loadPowerAppHostModule=function(){var e=this;return this._powerAppsStore.ensurePowerAppSdkPreloaded(),Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e(614)]).then(n.bind(null,5924)).then(s.e).then(function(t){e.powerAppHostTagName=t.tagName,e.isPowerappHostModuleLoaded(!0),e._bootPowerApp()})},t.prototype._bootPowerApp=function(){this.loadBackgroundPowerApp(!1),this.loadBackgroundPowerApp(!0)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.default.dependencies),{currentItem:r.o,pageLoadMonitor:d.e,powerAppsStore:c.resourceKey,engagement:l.e,viewParams:r.P}),t}(i.e),h=n(2206),b=Object(h.n)({name:"PowerAppHostLoader",template:"\x3c!--ko if:loadBackgroundPowerApp()&&isPowerappHostModuleLoaded()--\x3e\x3c!--ko component:{name:powerAppHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",automationName:"ms-powerapp-host-loader",viewModelType:_});t.default=b},,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(5570),r=n(1001),o=n(4824),s=n(186),c=n(697),d=n(172),l=n(65),u=n(4825),f=n(5567),p=n(4210),m=n(3339),_=n(69),h=n(14),b=n(96),g=n(1473),v=n(190),y=function(e){function t(t){var n=e.call(this,t)||this;n.resources&&(n._apiUrlHelper=n.resources.consume(r.e),n._sharingContextInformation=n.resources.consume(g.e.optional));var a=n._askParentForAuthToken,i=n._getSharingContextInformation();n._sharingDataSourceCommon=new m.e({pageContext:t,getParentListId:n._getParentListId.bind(n),apiUrlHelper:n._getApiUrlHelper(),sharingContextInformation:i,isItemUrlEncoded:!0},{tokenProvider:i&&i.hasTokenProvider?{getAuthToken:function(e){return a(e).then(function(e){return i.authToken=e,e})}}:void 0,pageContext:t});var o=Object(d.s)(n._pageContext);return n._createAnonymousLinkMethodName="CreateAnonymousLink",n._createAnonymousLinkUrl=o+"/_api/SP.Web."+n._createAnonymousLinkMethodName,n._createAnonymousLinkWithExpirationMethodName="CreateAnonymousLinkWithExpiration",n._createAnonymousLinkWithExpirationUrl=o+"/_api/SP.Web."+n._createAnonymousLinkWithExpirationMethodName,n._createOrganizationLinkMethodName="CreateOrganizationSharingLink",n._createOrganizationLinkUrl=o+"/_api/SP.Web."+n._createOrganizationLinkMethodName,n._disableAnonymousLinkMethodName="DeleteAnonymousLinkForObject",n._disableAnonymousLinkUrl=o+"/_api/SP.Web."+n._disableAnonymousLinkMethodName,n._disableOrganizationLinkMethodName="DestroyOrganizationSharingLink",n._disableOrganizationLinkUrl=o+"/_api/SP.Web."+n._disableOrganizationLinkMethodName,n._managePermissionsUrl=o+"/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo",n._unshareUrl=o+"/_api/SP.Web.UnshareObject",n}return Object(a.__extends)(t,e),t.prototype.getSharingInformation=function(e,t,n,a,i,r){if(a){var o=a.method("Lists",this._getParentListId(this.convertToISPListItem(e))).method("GetItemById",i);return this._sharingDataSourceCommon.getSharingInformation(this.convertToISPListItem(e),t,n,o,r)}return this._sharingDataSourceCommon.getSharingInformation(this.convertToISPListItem(e),t,n,null,r)},t.prototype.getShareLinkApi=function(e,t,n){return t.method("Lists",this._getParentListId(this.convertToISPListItem(e))).method("GetItemById",n).segment("ShareLink")},t.prototype.emailWithoutPermissioning=function(e,t,n){return this._sharingDataSourceCommon.emailWithoutPermissioning(e,this.convertToISPListItem(t),n)},t.prototype.checkPermissions=function(e,t){return this._sharingDataSourceCommon.checkPermissions(e,this.convertToISPListItem(t))},t.prototype.share=function(e,t){var n=this,a={items:t.items.map(function(e){return n.convertToISPListItem(e)}),roleValue:t.roleValue,message:t.message,subject:t.subject,sendEmail:t.sendEmail,requireSignIn:t.requireSignIn,propagateSharing:t.propagateSharing,linkType:t.linkType,expiration:t.expiration};return this._sharingDataSourceCommon.share(e,a)},t.prototype.stopSharing=function(e,t){var n=this._pageContext.webAbsoluteUrl+"/_api/web/Lists(@a1)/GetItemById(@a2)/UnshareObject?@a1='"+b.e.encodeURIComponent(e)+"'&@a2='"+b.e.encodeURIComponent(t)+"'";return this.dataRequestor.getData({url:n,parseResponse:function(e){var n=JSON.parse(e).d,a={};return a.statusCode=n.StatusCode,a.errorMessage=n.ErrorMessage,a.itemId=t,a},qosName:"StopSharing",additionalPostData:JSON.stringify({})})},t.prototype.unshare=function(e){var t,n,a=this._getSharingDataSourceHelper().canUseSecurable(e);return t=a?this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e).segment("UnshareObject").toString():this._unshareUrl,this.dataRequestor.getData({url:t,parseResponse:function(t){var n=JSON.parse(t).d,a={};return a.statusCode=n.StatusCode,a.errorMessage=n.ErrorMessage,a.itemId=e.id,a},qosName:"StopSharing",additionalPostData:(n={},a||(n.url=this._getSharingDataSourceHelper().getFileUrl(e)),JSON.stringify(n))})},t.prototype.updatePermissions=function(e,t,n){var a,i=this,r=this._getSharingDataSourceHelper().canUseSecurable(t);return a=r?this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),t).segment("UpdateDocumentSharingInfo").toString():this._managePermissionsUrl,this.dataRequestor.getData({url:a,parseResponse:function(e){var n=JSON.parse(e).d,a=[];n.UpdateDocumentSharingInfo&&n.UpdateDocumentSharingInfo.results&&(a=n.UpdateDocumentSharingInfo.results);var i={statusCode:0,errorMessage:null};return i.people=m.e.parsePeople(a),i.itemId=t.id,i},qosName:"ManagePermissions",additionalPostData:function(){var a,o=[];switch(n){case p.e.None:a=0;break;case p.e.View:a=1;break;case p.e.Review:a=6;break;case p.e.Edit:a=2;break;default:a=1}for(var d=0;d<e.length;d++){var l={UserId:e[d].userId,Role:a};o.push(l)}var u={userRoleAssignments:o,validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:t.type===v.t.Folder&&Object(s.t)(c.n)};return r||(u.resourceAddress=i._getSharingDataSourceHelper().getFileUrl(t)),JSON.stringify(u)}()})},t.prototype.updatePermissions2=function(e,t,n){return this._sharingDataSourceCommon.updatePermissions2(e,this.convertToISPListItem(t),n)},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){return this._sharingDataSourceCommon.updatePermissionsMultiple(e,this.convertToISPListItem(t),n,a,i)},t.prototype.parseRawSharingInformation=function(e,t){return this._sharingDataSourceCommon.parseRawSharingInformation(e,this.convertToISPListItem(t))},t.prototype.setAddressBarLinkCapability=function(e,t){return this._sharingDataSourceCommon.setAddressBarLinkCapability(this.convertToISPListItem(e),t)},t.prototype.manageSharingLinks=function(e,t){var n,a=this,r=this._createAnonymousLinkUrl,o="CreateAnonymousSharingLink",s=this._createAnonymousLinkMethodName;if(this._getSharingDataSourceHelper().canUseSecurable(e[0].item)){var c={items:[e[0].item],expiration:t.expiration,linkType:t.type,roleValue:t.role.toString()};return(t.create?this._getSharingLink.bind(this):this._deleteSharingLink.bind(this))(c,e[0],t.role)}return t.expiration&&(r=this._createAnonymousLinkWithExpirationUrl,o="CreateAnonymousSharingLinkWithExpiration",s=this._createAnonymousLinkWithExpirationMethodName),t.create||(r=this._disableAnonymousLinkUrl,o="DisableAnonymousSharingLink",s=this._disableAnonymousLinkMethodName),t.type===f.e.Organization&&(r=t.create?this._createOrganizationLinkUrl:this._disableOrganizationLinkUrl,o=t.create?"CreateOrganizationSharingLink":"DisableOrganizationSharingLink",s=t.create?this._createOrganizationLinkMethodName:this._disableOrganizationLinkMethodName),this.dataRequestor.getData({url:r,parseResponse:function(n){var i=JSON.parse(n).d,r=[],o={};return o.url=i[s]?a._getSharingDataSourceHelper().encodeSharingLink(i[s]):"",o.type=t.type,o.role=t.role,o.expiration=a._getSharingDataSourceHelper().getExpirationFromLink(o.url),o.isActive=!!o.url,e[0].setLink(o),i[s]&&r.push(o),r},qosName:o,additionalPostData:(n={url:a._getSharingDataSourceHelper().getFileUrl(e[0].item),isEditLink:t.role===p.e.Edit},t.expiration&&(n.expirationString=Object(i.e)(t.expiration)),JSON.stringify(n))})},t.prototype.unshareLink=function(e){var t={item:this.convertToISPListItem(e.item),kind:e.kind,shareId:e.shareId};return this._sharingDataSourceCommon.unshareLink(t)},t.prototype.shareLink=function(e){var t=this,n={emailData:e.emailData,emailSubject:e.emailSubject,items:e.items.map(function(e){return t.convertToISPListItem(e)}),recipients:e.recipients,settings:e.settings};return this._sharingDataSourceCommon.shareLink(n)},t.prototype.supportsExistingAccessOption=function(e){var t=!0;if(e){var n=this._getRootItem(e,"list");n&&(t=n.list.templateType===h.n.mySiteDocumentLibrary)}var a=Number(this._pageContext.webTemplate);return a===_.t.teamSite||a===_.t.group||!t},t.prototype.getClientId=function(){return this._sharingDataSourceCommon.getClientId()},t.prototype.getDataSourceName=function(){return"SharingDataSource"},t.prototype._getApiUrlHelper=function(){return this._apiUrlHelper},t.prototype._getSharingContextInformation=function(){return this._sharingContextInformation},t.prototype._deleteSharingLink=function(e,t,n){var a,i=this,r=this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e.items[0]).segment("DeleteLinkByKind").toString();return this.dataRequestor.getData({url:r,parseResponse:function(a){var r=JSON.parse(a).d,o=[],s={};return s.url=r.DeleteLinkByKind?i._getSharingDataSourceHelper().encodeSharingLink(r.DeleteLinkByKind.sharingLinkInfo.Url):"",s.type=e.linkType,s.role=n,s.expiration=i._getSharingDataSourceHelper().getExpirationFromLink(s.url),s.isActive=!!s.url,t.setLink(s),r.DeleteLinkByKind&&o.push(s),o},qosName:"DeleteLinkByKind",additionalPostData:(a={linkKind:i._getSharingLinkKind(e.linkType,e.roleValue)},JSON.stringify(a))})},t.prototype._getSharingLink=function(e,t,n){var a=this,r=this._getSharingDataSourceHelper().getApiRoot(this._getApiUrlHelper(),e.items[0]).segment("ShareLink").toString();return this.dataRequestor.getData({url:r,parseResponse:function(i){var r=JSON.parse(i).d,o=[],s={};return s.url=r.ShareLink?a._getSharingDataSourceHelper().encodeSharingLink(r.ShareLink.sharingLinkInfo.Url):"",s.type=e.linkType,s.role=n,s.expiration=a._getSharingDataSourceHelper().getExpirationFromLink(s.url),s.isActive=!!s.url,t.setLink(s),r.ShareLink&&o.push(s),o},qosName:"GetLinkViaShareLink",additionalPostData:function(){var t=null;e.expiration&&(t=Object(i.e)(e.expiration));var n={request:{emailData:null,linkKind:a._getSharingLinkKind(e.linkType,e.roleValue),createLink:!0,expiration:t}};return JSON.stringify(n)}()})},t.prototype._getSharingLinkKind=function(e,t){var n=u.e.Direct;return e===f.e.Edit?n=u.e.AnonymousEdit:e===f.e.View?n=u.e.AnonymousView:e===f.e.Organization&&(n=t===p.e.Edit.toString()?u.e.OrganizationEdit:u.e.OrganizationView),n},t.prototype._getParentListId=function(e){var t=this.convertToIOneDriveItem(e);return this._getSharingDataSourceHelper().getParentListId(t)},t.prototype._askParentForAuthToken=function(e){return new l.n(function(t,n){var i=function(e){if(e.data&&"string"==typeof e.data){var a;try{a=JSON.parse(e.data)}catch(e){return}var r=!1;switch(a.name){case"share_newToken":r=!0;var o=a;if(o.error){n(o.error);break}if(!o.token){n("invalid_token");break}t(o.token)}r&&window.removeEventListener("message",i)}};window.addEventListener("message",i,!1);var r=Object(a.__assign)(Object(a.__assign)({},e),{name:"share_getToken"});window.parent.postMessage(JSON.stringify(r),"*")})},t}(o.e),S=n(2220),D=n(2738),I=n(3337),x=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(S.e),n._sharingDataSourceHelper=new(n.managed(I.e)),n}return Object(a.__extends)(t,e),t.prototype.convertToISPListItem=function(e){return Object(D.n)(e)},t.prototype._getRootItem=function(e,t){return this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t))||null},t.prototype.convertToIOneDriveItem=function(e){return Object(D.t)(e)},t.prototype._getSharingDataSourceHelper=function(){return this._sharingDataSourceHelper},t}(y);t.default=x},,function(e,t,n){"use strict";n.d(t,"n",function(){return u}),n.d(t,"e",function(){return f});var a,i=n(4818),r=n(4203),o=n(65),s=n(204);!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(a||(a={}));var c=function(){function e(e,t,n){this._eventGroup=new s.t(this),this.source=r.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this._parent=n,e&&this.extend(e,r.e.None),this.membersList||(this.membersList=new i.e)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,t){var n=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._groupsProvider&&this._parent.id){var i=0;e&&(i|=a.allMembers),t&&(i|=a.ownershipInformation);var s=o.n.resolve();return u()||this.source!==r.e.None||i||(s=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&n.extend(e.membership,r.e.Cache)})),s.then(function(){if(n._shouldLoadNewData(i))return n._startLoadingFromServer(i),n._groupsProvider.loadMembershipContainerFromServer(n._parent.id,e,t).then(function(e){n.extend(e,r.e.Server),n._finishLoadingFromServer(),i||(e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer,n._groupsProvider.saveMembershipToCache(n._parent.id,e))},function(e){n._errorLoading(e)})})}return o.n.resolve()},e.prototype.loadWithOptions=function(e){var t=this;return this._groupsProvider&&this._parent.id&&(this.source!==r.e.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,r.e.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&a.allMembers)===a.allMembers,e&&(e&a.ownershipInformation)===a.ownershipInformation).then(function(n){t.extend(n,r.e.Server),t._finishLoadingFromServer(),e&&e!==a.forceSkipCache||(n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,n))},function(e){t._errorLoading(e)})):o.n.resolve(void 0)},e.prototype.extend=function(t,n){this.isMember=t.isMember,this.isOwner=t.isOwner,this.isJoinPending=t.isJoinPending,this.membersList=t.membersList,this.totalNumberOfMembers=t.totalNumberOfMembers,this.totalNumberOfOwners=t.totalNumberOfOwners,this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=n,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==r.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&a.forceSkipCache)===a.forceSkipCache||e&&(e&a.allMembers)===a.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.allMembers)===a.allMembers)||e&&(e&a.ownershipInformation)===a.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.ownershipInformation)===a.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}(),d=n(23),l=n(109);function u(){var e,t=new l.e,n=!1;if(window.indexedDB&&t.isFirefox)try{var a=window.indexedDB.open("FF_INPRIVATE");a.onerror=function(){return n=!0},"InvalidStateError"===(null===(e=null==a?void 0:a.error)||void 0===e?void 0:e.name)&&(n=!0)}catch(e){n=!0}return n}var f=function(){function e(t,n,a,i){this._eventGroup=new s.t(this),this.source=r.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=n,this.id=a,t?this.extend(t):this.load(),this.membership=new c(void 0,this._groupsProvider,this),!i&&n&&(i=n.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(i,a)}return e._getPlannerUrl=function(e,t){if(e)return t||(t=e.groupId),e.webAbsoluteUrl+d.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){var a=o.n.resolve();return this.source!==r.e.None||u()||(a=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){t&&t.lastLoadTimeStampFromServer>0&&(n.extend(t),n.source=r.e.Cache,n._eventGroup.raise(e.onSourceChange,n.source))})),a.then(function(){if(n._shouldLoadNewData(t))return n._startLoadingFromServer(),n._groupsProvider.loadGroupInfoContainerFromServer(n.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),n.extend(e),n._finishLoadingFromServer(),n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})})}return o.n.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==r.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=r.e.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1,this.error=t,this._eventGroup.raise(e.onSourceChange,r.e.Error)},e.onSourceChange="source",e}();t.t=f}],Array(49),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return m});var a=n(0),i=n(1214),r=n(136),o=n(601),s=n(38),c=n(156),d=n(60),l=n(116),u=n(201),f=n(857),p=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._rawDataSignal=new o.e,a._itemCacheStore=n.itemCacheStore,a._pageContext=n.pageContext;var i=a._itemCacheStore.dispatch(a._getFileHandlerDataFromItemsCacheStore());return i?a.setFileHandlerData(i):a.setFileHandlerData(void 0),a}return Object(a.__extends)(t,e),t.prototype.getFileHandlerData=function(e){return this._rawDataSignal.getPromise().then(function(t){if(t)return e&&e.includePromotedApp!==t.signature.includePromotedApp?void 0:t.data})},t.prototype.setFileHandlerData=function(e){this._rawDataSignal.complete(e)},t.prototype._getFileHandlerDataFromItemsCacheStore=function(){var e=this;return function(t){var n=e._pageContext.webAbsoluteUrl,a=new d.e(n).authority+"/_api/v2.0",i=u.t.serialize({endpoint:a});return t(Object(l.e)(function(e){return e.demandItemFacet(c.s,i)}))}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.default.dependencies),{itemCacheStore:f.e,pageContext:s.f}),t}(i.default);t.default=p;var m=Object(r.r)("FileHandlerCacheDataSource",p)},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return d});var a=n(0),i=n("react-lib"),r=n(10),o=n(91),s=n(73),c=n(12).e.isActivated("B0D5C53D-588B-40AB-A922-1426AA4E0E0C","7/16/2021","Disable routing to the legacy Groove client"),d=new r.t({name:"SyncActionControlHandler",factory:{dependencies:{pageLoadMonitor:s.e},create:function(e){var t=e.pageLoadMonitor,r=Object(o.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,t.waitForPLT()];case 1:return e.sent(),[4,n.e(166).then(n.bind(null,5292))];case 2:return[2,e.sent().SyncAction]}})})});return{instance:function(e,t){var n=t.syncState;return c&&"syncGroove"===n?{isAvailable:!0,fallbackAction:i.createElement(r,null)}:{}}}}}})},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(10),i=n(230),r=n(1944),o=new a.t({name:"SwitchLayoutActionControlHandler",factory:{dependencies:{resources:a.r,isInfoPaneExpanded:r.resourceKey},create:function(e){return{instance:function(t,n){return{onSwitchLayout:function(t){return function(n){var a=e.isInfoPaneExpanded;t.layoutType===i.e&&a&&a.peek()&&a(!1)}}}}}}}})},function(e,t,n){"use strict";var a;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(a||(a={})),t.e=a},,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return P});var a=n(0),i=n(136),r=n(5064),o=n(4213),s=n(2370),c=n(549),d=n(37),l=n(116),u=n(221),f=n(553),p=n(9),m=n(41),_=n(51),h=n(3186),b=n(100),g=n(566),v=n(770),y=n(38),S=n(2135),D=n(2862),I=n(147),x=n(5),C=n(16),O=n(838),w=n(4821),E=n(88),A=n(318),L=n(1),k=n(1887),M=function(){function e(e,t){this._listItemBuilder=t.listItemBuilder,this._listItemResultProcessor=t.listItemResultProcessor,this._itemTaskObserverType=t.itemTaskObserverType,this._urlDataSource=t.urlDataSource,this._microServiceDataSource=t.microServiceDataSource,this._microServiceDataSourceStore=t.microServiceDataSourceStore,this._listContext=t.listContext,this._onePageContext=t.onePageContext,this._pageContext=t.pageContext}return e.prototype.updateFromResponse=function(e){var t=this;return function(n){var i=new t._itemTaskObserverType,r=e.itemSetKey,o=e.serverData,s=e.isItemSetRequest,p=n(Object(l.e)(function(e){var t=e.demandItemFacet(E.e,r),n=t.webAbsoluteUrl,a=t.listFullUrl,i=A.e.serialize({webAbsoluteUrl:n,listFullUrl:a}),o=e.demandItemFacet(L.Dn,i);return{storeKey:e.demandItemFacet(f.t,r),pageContextKey:i,pageContext:o}})),_=p.storeKey,h=p.pageContext,b=p.pageContextKey;if(void 0!==_){var g=[_],v=_.key;s&&(o&&S.e.updateListContext(o,t._listContext),O.e&&t._onePageContext&&n(Object(w.e)(t._pageContext,h,b,t._listContext)));var y=t._listItemResultProcessor.processResponse({response:o,pageContext:h,requestKey:v,observer:i}).listRootItemKey;if(s){var M=t._processRootFolder({response:o,requestKey:v,observer:i,isItemSetRequest:s,pageContext:h});M&&g.push(M.item)}var P=o.ListData&&o.ListData.Row||[],T=t._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(y);if(T&&o.ListSchema){var U={data:o.ListSchema,allowCookies:!1};T.setBaseInfo(U),t._microServiceDataSource.setBaseInfo(U)}for(var F=o.ListSchema&&"TRUE"===o.ListSchema.Collapse,H=0,R=o.SpotlightInfo&&o.SpotlightInfo.Items&&o.SpotlightInfo.Items.Row||[];H<R.length;H++){var N=R[H],B=t._listItemBuilder.getItemResult({microServiceDataSource:T,itemFromServer:Object(a.__assign)({},N),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i}).item;g.push(B)}if(!F)for(var j=0,V=P;j<V.length;j++){var z=V[j];B=t._listItemBuilder.getItemResult({microServiceDataSource:T,itemFromServer:Object(a.__assign)({},z),requestKey:v,queryType:d.e.Files,supportsNestedGroups:!1,isItemDataOnly:!s,groupBy:[],observer:i,pageContext:h}).item,g.push(B)}i.flush();for(var G=new u.e,K=function(e){var t,r,o=i.getItem(e);if(o&&!o.isPlaceholder){var s=Object(m.f)(e.key),d=n(Object(l.e)(function(e){var t=e.demandItemFacet(c.e,C.c);return c.e.evaluate(t)(e,{viewParams:s,isNavigation:!1}).itemKey}));if(d){var u=D.n.serialize({itemKey:d});G.resolveItems({items:(t={},t[d]=Object(a.__assign)({},Object(I.e)().forFacet(x.f).thenInvalidate(u,D.e).pack()),t[u]=Object(a.__assign)({},D.e.pack(void 0)),t)});var f=n(Object(k.t)({itemKey:d}));if(f)for(var p=0,_=Object.keys(f);p<_.length;p++){var h=_[p];h!==d&&G.mapKeys({mappings:(r={},r[u]=D.n.serialize({itemKey:h}),r)})}}}},W=0,q=g;W<q.length;W++)K(q[W]);n(G.execute())}}},e.prototype._processRootFolder=function(e){var t=e.response,n=e.requestKey,a=e.observer,i=e.pageContext,r=e.isItemSetRequest,o=t.ListData,s=t.ListSchema,c=(void 0===s?{}:s).Collapse,d=void 0===c?"FALSE":c;if(o){var l=o&&o.Row,u="";o.NextHref&&(u=(u=o.NextHref).replace("&View=".concat(_.e.Empty),""));var f="TRUE"===d,m=!f&&l?l.slice(0):[],b=this._urlDataSource.getKeyParams(n),g={id:b[p.t.idParamKey],folder:{childCount:m.length,children:m},nextRequestToken:u,PermMask:o.FolderPermissions,groups:f?l:null,isRootFolder:!1};if(Object(h.n)()){var v=o&&o.CurrentFolderProgId;g.ProgId=v}return this._listItemBuilder.getItemResult({requestKey:n,queryType:this._urlDataSource.getQueryType(b),itemFromServer:g,supportsNestedGroups:!1,isItemDataOnly:!r,observer:a,groupBy:[],pageContext:i})}},e}();t.default=M;var P=Object(i.r)("LegacyItemCacheSPResponseHandler",M,{listItemBuilder:r.e,listItemResultProcessor:o.e,itemTaskObserverType:s.resourceKey,urlDataSource:b.ue,microServiceDataSource:g.resourceKey,microServiceDataSourceStore:v.e,listContext:y.o,pageContext:y.f,onePageContext:y.u.optional})},,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return _});var a=n(10),i=n(1660),r=n(1214),o=n(2718),s=n(3019),c=n(996),d=n(320),l=n(146),u=n(1439),f=n(1012),p=n(5465),m=n(3),_=new a.t({name:"KnockoutResourceScope",factory:{dependencies:{resources:i.e.bypass,navigation:l.e},create:function(e){var t,n=e.resources,a=e.navigation;Object(m.co)(m.jn)&&(t=new f.e,Object(p.loadTransitionResources)(n,t));var i=new(n.consume(r.observablesFactoryTypeResourceKey)),l=function(e){var t=new o.e,n=new s.e;return n.item=e.create(t),n}(i),_=l.item;_.equalityComparer=c.n,h(n,d.o,function(){return _});var b=i.create(l);b.equalityComparer=c.n,h(n,d.s,function(){return b});var g=i.create(void 0);h(n,d.l,function(){return g});var v=i.create(a.viewParams);return h(n,d.P,function(){return v}),n.consumeAsync(u.e),{instance:n,dispose:t}}}});function h(e,t,n){return e.isExposed(t)?e.consume(t):e.expose(t,n())}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Network:1,Embed:3,App:4,View:5,Edit:6,Form:7,Direct:8,Organization:9,AppAccess:10,RequestAccess:11,None:100}},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={generic:0,getSharingInformation:1,shareLink:2,shareObject:3,permissions:4,item:5,me:6,drive:7,invite:8,createLink:9};t.t={authFailure:1,serverFailure:2,invalidItem:3,invalidWebAbsoluteUrl:4,generic:5,objectNotSupported:6,invalidEmail:7,linkNoLongerAvailable:8}},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(23);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={uninitialized:-1,anyone:0,organization:1,specificPeople:2,existing:3}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={anyone:0,organization:1,specificPeople:2}},function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={none:0,allow:1,allowWithJustification:2},i={none:0,falsePositiveReported:1,overridden:2,falsePositiveReportedAndOverridden:3},r={override:0,reportFalsePositive:1}},,function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultClickAction",function(){return r});var a=n(3105),i=n(320),r=Object(a.e)(function(e,t){var n=e.consume(i.e).DefaultClickAction;return new(e.injected(n,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"flowAddon",function(){return l});var a=n(0),i=n(11),r=n(264),o=n(189),s=n(343),c=n(200),d=n(7),l=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(o.t)({keyFacet:c.r,facets:[d.e]})),e(Object(o.t)({keyFacet:c.s,facets:[d.e]})),e(Object(r.a)(c.r,s.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(478)]).then(n.bind(null,5111))];case 1:return[2,e.sent().getFlowSetOperationHandler]}})})}))),e(Object(r.a)(c.s,s.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(478)]).then(n.bind(null,5111))];case 1:return[2,e.sent().getFlowTemplateSetOperationHandler]}})})}))),[2]})})}})}],Array(57),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return r});var a=n(10),i={pageContext:n(4906).e.optional},r=new a.t({name:"SimpleEngagementHandlers",factory:{dependencies:i,create:function(e){var t=[],n=e.pageContext;return n&&t.push(n),{instance:t}}}})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"ItemAutoRefresh",function(){return o}),n.d(t,"CurrentItemAutoRefresh",function(){return s});var a=n(13),i=n(57),r=n(1589),o=Object(i.t)(function(e,t){var n=t.itemKey,a=e.demandItemFacet(r.e,n),i=r.e.evaluate(a)(e,{itemKey:n,itemSubscriber:null,isAvailable:!0}),o=i.isAvailable,s=i.itemSubscriber;return o&&(void 0===s?null:s)||null}),s=Object(a.n)()(o)},function(e,t,n){"use strict";n.r(t),n.d(t,"LocalModelCreationWarningBanner",function(){return m});var a=n(0),i=n("react-lib"),r=n(5078),o=n(3461),s=n(5942),c=n(57),d=n(16),l=n(4863),u=n(4862),f=n(5245),p=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissBanner=function(){n.props.showOrHideBanner(!1)},n.state={isBannerVisible:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.props.bannerState;t!==e.bannerState&&this.setState({isBannerVisible:t})},t.prototype.render=function(){return this.state.isBannerVisible?i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.warning,isMultiline:!1},i.createElement(s.e,null,f.e)):null},t}(i.Component);t.default=p;var m=Object(c.e)(function(e){var t=e.demandItemFacet(l.e,d.c);return{bannerState:null==t?void 0:t.bannerState}},function(e){return{showOrHideBanner:function(t){e(Object(u.e)({bannerState:t}))}}})(p)},function(e,t,n){"use strict";n.r(t),n.d(t,"TeamChannelHeaderHost",function(){return p});var a=n(0),i=n("react-lib"),r=n(57),o=n(13),s=n(1),c=n(91),d=n(755),l=n(3186),u=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,5363))];case 1:return[2,e.sent().TeamChannelHeader]}})})}),f=Object(r.t)(function(e,t){var n=e.demandItemFacet(s.Pt,t.itemKey);return Object(l.e)(n)?i.createElement(d.e,null,i.createElement(u,null)):null}),p=Object(o.e)()(f)},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"ItemPromoteChannelFolderAction",function(){return p}),n.d(t,"PromoteChannelFolderAction",function(){return m});var a=n(0),i=n("react-lib"),r=n(57),o=n(13),s=n(1),c=n(28),d=n(167),l=n(1703),u=n(22),f=n(29),p=Object(r.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n),o=e.demandItemFacet(d.e,n);if(!n||!r||!o)return null;if(!e.isItemFacetResolved(s.Pt,n))return null;if(e.demandItemFacet(s.Pt,n))return null;var p=e.dispatch;return i.createElement(u.e,Object(a.__assign)({},Object(f.t)(e,{itemKey:n,engagement:{name:"PromoteChannelFolder"}}),{onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,p(Object(l.e)({items:(e={},e[n]={},e)}))];case 1:return t.sent(),[2]}})})}}))}),m=Object(o.e)()(p)},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"AddToOneDriveCommandCFT",function(){return r});var a=n(5075),i=n(1002),r=Object(a.e)(i.ADD_TO_ONEDRIVE_COMMAND_CFT,function(){return!0})}],Array(19),[function(e,t,n){"use strict";n.r(t),n.d(t,"teamifyStrings",function(){return a});var a=n(5299)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return d});var a=n(867),i=n(38),r=n(5300),o=n(1318),s=n(136),c=n(4965),d=Object(s.r)("TeamsProvider",c.e,{pageContext:i.f,groupsProvider:a.e,graphUserInfoDataSource:r.resourceKey,userInfoDataSource:o.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(65),r=n(373),o=n(1377),s=n(1363),c=n(467),d={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},l=function(e){function t(t,n){var a=e.call(this,{dataSourceName:"GraphUserInfo"},n)||this;return a._oAuthTokenProvider=n.oAuthTokenProvider,a._canUseGraph=a._pageContext.isSPO,a._persistentRequestCache=new o.e({id:"GraphUserInfo"},{pageContext:a._pageContext}),a}return Object(a.__extends)(t,e),t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:c.e.useCacheIfNotExpired,cacheTimeoutTime:r.i,cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):i.n.resolve(null)},t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(a.__assign)(Object(a.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},d),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){for(var t=e.servicePlans||[],n=0;n<t.length;n++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[n].servicePlanId)return"Success"===t[n].provisioningStatus;return!1})}}))},t}(s.e)},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return s});var a=n(136),i=n(1222),r=n(1717),o=n(1719),s=Object(a.r)("FileHandlerDataSource",r.e,{dataRequestor:i.e,localFileHandlerProvider:o.e})},,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(3116),r=n(2213),o=n(9),s=n(320),c=n(65),d=n(83),l=n(96),u=n(146),f=n(151),p=n(859),m=n(38),_=function(e){function t(t){var n=e.call(this,t)||this;return n.name="BackToclassic",n._params=t,n._viewParams=n.resources.consume(s.P),n._itemUrlHelper=n.resources.consume(f.c),n._pageContext=n.resources.consume(m.f),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this,a=this._params.url,r=this.peekUnwrapObservable(a),s=this._viewParams.peek(),f=s&&s[o.n.idParamKey],m=!1;if(!r){var _=s[o.n.listUrlKey],h=this._itemUrlHelper.getUrlParts({path:f||_,listUrl:_});r=h.fullItemUrl,m=!0}if(r){if(r=p.e(r),f&&!m){r+=-1===r.indexOf("?")?"?":"&";var b=l.e.encodeURIComponent(f);r+="".concat(o.n.rootFolderParamKey,"=").concat(b)}return this.async.setTimeout(function(){n._params.cookieName&&("splnu"===n._params.cookieName&&n._params.cookieValue?i.set(n._params.cookieName,n._pageContext.listId):i.set(n._params.cookieName,"0")),n.resources.consume(u.e).navigateTo(r)},0),c.n.wrap({resultType:d.e.Success})}return c.n.wrap({resultType:d.e.Failure})},t}(r.e);t.default=_}],Array(128),[function(e,t,n){"use strict";n.r(t),n.d(t,"odspNextAppExtendedItemsCommandBarControlHandler",function(){return wn}),n.d(t,"getSwitchLayoutCommandWithModernTemplateFRE",function(){return Mn}),n.d(t,"getSwitchLayoutWithViewSwitched",function(){return Pn});var a=n(0),i=n("react-lib"),r=n(16),o=n(359),s=n(1310),c=n(1309),d=n(705),l=n(4741),u=n(5079),f=n(5080),p=n(320),m=n(4238),_=n(1),h=n(4861),b=n(77),g=Object(m.e)({isAvailable:function(e,t){var n=Object(b.e)(e);if(n){var a=e.demandItem({permissions:_.St},n).permissions;return Object(h.e)({permissions:a})}return!1},getKnockoutAction:function(e,t){var n=e.consume(p.e);return new(e.injected(n.NewClipchampAction))}}),v=n(664),y=n(58),S=Object(y.e)("newClipchamp"),D=n(50),I=n(892),x={key:S,name:v.NewClipchamp,action:i.createElement(D.e,null,i.createElement(g,null)),iconProps:{iconType:I.e.Image,imageProps:{src:window.require.toUrl("odsp-media/images/clipchamp/clipchamp_256x.svg"),width:"16px",height:"16px"}}},C=n(2),O=n(80),w=n(38),E=n(53),A=Object(O.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(176).then(n.bind(null,5737))];case 1:return[2,e.sent().CancelEditAtion]}})})},function(e,t){var n=t.resources;if(n){var a=n.consume(w.i.optional);return!(!a||!a())}return!1}),L={key:new C.e("CancelEdit").id,name:v.cancelEdit,action:i.createElement(function(){var e=Object(E.n)();return i.createElement(A,{resources:e})},null),iconProps:{iconName:"CheckMark"}},k=n(5081),M=n(91),P=n(3118),T=n(100),U=n(4862),F=n(13),H=n(57),R=n(22),N=n(21),B=n(5),j=n(97),V=n(36),z=n(473),G=n(69),K=n(12),W=Object(H.t)(function(e,t){var o,s=e.demandItemFacet(r.u,r.c),c=t.itemKeys,d=t.resources.consume(w.f),l=!1,u=c.map(function(t){var n={itemId:e.demandItemFacet(_.Un,t)||""},a=e.demandItem({fileName:B.m},t).fileName;n.extension=(null==a?void 0:a.extension)||"",n.name=(null==a?void 0:a.name)||"",n.displayName="".concat(n.name).concat(n.extension);var i=e.demandItemFacet(B.h,t);return n.isFolder=!!i,n.isFolder&&(l=!0),n}),f=u.filter(function(e){return!e.isFolder}).slice(0,50),p=e.dispatch,m=u.length>50||l,h=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,i,r,o,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,Promise.resolve().then(n.bind(null,881))];case 1:return e=a.sent().getSessionToken,[4,p(e({scopes:["InformationProtection.Read.All"],endpoint:t}))];case 2:return[2,null==(i=a.sent())?void 0:i.accessToken];case 3:return r=a.sent(),j.e.logError(r,{eventName:"fetchGraphToken",feature:"CreateModelEverywhere",errorCode:null===(o=null==r?void 0:r.errorData)||void 0===o?void 0:o.code,correlationId:null===(s=null==r?void 0:r.errorData)||void 0===s?void 0:s.correlationId,status:null===(c=null==r?void 0:r.errorData)||void 0===c?void 0:c.status}),[2,""];case 4:return[2]}})})},b=Object(N.o)(function(e){var t,r=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("deferred"),n.e(579)]).then(n.bind(null,5501))];case 1:return[2,e.sent().default]}})})});function o(){e&&e.resolve&&e.resolve(),s&&s.consumeAsync(T.L).then(function(e){e.invalidateCurrentItemSet()})}return t=m,p(Object(U.e)({bannerState:t})),m?null:i.createElement(r,{screenReaderAlert:P.e.alert,selectedItems:f,pageContext:d,onDismiss:o,onComplete:o,getAuthToken:h})}),g=f&&f.length>0,v=c&&c.length>0&&g&&((null==d?void 0:d.canUserUseSyntex)||(null==d?void 0:d.isSyntexPAYGEnabled));if(!K.e.isActivated("8A7EDAEE-58E3-4728-A8BC-80E244BC0A2B","03/02/2022","Check manageWeb permission")&&v&&!function(e){var t=null==e?void 0:e.featureInfo;if(!t)return!1;if(Number(e.webTemplate)===G.e.contentCenter)return!0;var n=new z.e(t);if(n){var a=n.get("ContentCenterEverywhereFeature");return!!a&&a.enabled}return!1}(d)&&s){var y=null===(o=s.consume(T.S))||void 0===o?void 0:o.getIdentity();y&&y.webPermMasks&&(v=V.e.hasPermission(y.webPermMasks,V.e.manageWeb))}return i.createElement(R.e,{engagement:{isIntentional:!0,name:"LaunchCreateModelEverywhereCommand.Clicked",webTemplateId:null==d?void 0:d.webTemplate,extraData:{showWarning:m,selectedItemsCount:u.length,hasFolderSelected:l}},isAvailable:v,onExecute:b})}),q=Object(F.r)()(W),Q=n(1698),Y=n(176),J={key:Q.e,name:v.CreateModelEverywhereText,action:i.createElement(D.t,null,i.createElement(function(){var e=Object(E.n)();return i.createElement(q,{resources:e})},null)),iconProps:{iconName:"GenericScan"},facets:Object(a.__assign)({},_.Tt.pack(Y.y))},X=n(56),Z=n(88),$=n(120),ee=n(318),te=n(351),ne=n(28),ae=n(1117),ie=n(109),re=n(7),oe=n(14),se=n(40),ce=n(3726),de=n(1496),le=n(37),ue=n(302),fe=n(9),pe=n(131),me=new ie.e,_e=Object(O.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(190).then(n.bind(null,5738))];case 1:return[2,e.sent().LaunchQuickEditAction]}})})},function(e,t){if(se.isFeatureEnabled(se.UseItemsScopeInTeamSites))return!1;if(me.isMobile)return!1;var n=t.itemKey;if(n){var a=e.demandItemFacet(Z.e,n);if(a){var i=$.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),r=e.demandItemFacet(_.We,i);if(function(e,t,n){if(n&&n.isDocumentLibrary){var a=e.demandItemFacet(re.o,t),i=[];if(a&&a.columnKeys)for(var r=0,o=a.columnKeys;r<o.length;r++){var s=o[r],c=e.demandItemFacet(_.Ee,s);c&&i.push({internalName:c})}return Object(ce.e)(i,!0)}return!1}(e,n,r))return!1;var o=ee.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl}),s=e.demandItemFacet(_.Dn,o);if(s&&s.isAnonymousGuestUser)return!1;if(r&&r.templateType===oe.n.mySiteDocumentLibrary)return!1;var c=void 0;if(!t.resources)return!1;if(!(c=t.resources.isExposed(w.i)?t.resources.consume(w.i):null))return!1;var d=e.demandItemFacet(Z.e,n),l=void 0,u=void 0;if(d&&d.viewKey){var f=te.e.serialize(d.viewKey);(u=e.demandItemFacet(_.g,f))&&u.baseViewXml&&(l=(new DOMParser).parseFromString(u.baseViewXml,"text/xml").getElementsByTagName("ViewStyle"))}var p=Object(X.e)(e).itemsScopeItemKey,m=e.demandItemFacet(ue.e,p),h=e.demandItemFacet(_.St,ne.e.serialize({listFullUrl:a.listFullUrl,webAbsoluteUrl:a.webAbsoluteUrl})),b=V.t.hasItemPermission({permissions:h},V.t.editListItems),g=Object(de.e)(e,n),v=e.demandItemFacet(re.e,n),y=!1;if(v&&v.itemKeys)for(var S=0,D=v.itemKeys;S<D.length;S++){var I=D[S];ae.e.matches(I)&&(y=!0)}return g===le.e.Files&&!y&&!!r&&!!r.allowGridMode&&!!u&&!!u.id&&!!l&&0===l.length&&!(m&&m[fe.n.needsAttentionViewKey])&&b&&(!c||!c())&&!function(e,t){if(e&&e.listBaseTemplate&&Object(oe.o)(e.listBaseTemplate))try{if(t&&t.baseViewXml){var n=Object(pe.u)(t.baseViewXml);if("1"===Object(pe.t)(n.childNodes[0],"BaseViewID"))return!0}}catch(e){}return!1}(s,u)}}return!1}),he=Object(F.n)()(_e),be={key:new C.e("QuickEdit").id,name:v.EditAll,action:i.createElement(D.e,null,i.createElement(function(){var e=Object(E.n)();return i.createElement(he,{resources:e})},null)),iconProps:{iconName:"Edit"}},ge=n(5082),ve=n(4456),ye=n(4866),Se=n(2255),De=n(2264),Ie=n(2527),xe=n(2718),Ce=n(997),Oe=n(265),we=n(39),Ee=n(170),Ae=n(29),Le=K.e.isActivated("30c7fb6b-a15b-4b1b-a7dc-4c8a7d591609","08/05/2021","KillSwitch for folder string change"),ke=Object(H.t)(function(e,t){var n,r,o,s=t.resources;if(!s)return null;var c=t.itemKeys,d=s&&s.consume(w.o)||{},l=d.listUrl,u=d.listTemplateType,f=Object(se.isFeatureEnabled)(se.RunModelFlatFileStructureSupport),p=Object(se.isFeatureEnabled)(se.RunModelFolderClassificationSupportEnabled)&&Object(se.isFeatureEnabled)(se.RunModelCustomizationSupportEnabled);p&&f||(c=c.filter(function(t){return!e.demandItemFacet(B.h,t)}));var m=Object(we.e)(e),h=e.demandItemFacet(Z.e,m),b=h&&$.e.serialize(h),g=e.demandItemFacet(_.We,b),v="AE9D4F24-EE84-4C0C-A972-A74CFFE939A1",y="Microsoft.Office.Server.ContentCenter.SPMachineLearningWorkItemEntityData",S=s&&s.consume(ve.e),D=s&&s.consume(w.f),I=D&&(null===(n=D.siteId)||void 0===n?void 0:n.replace(/[\{\}']+/g,""))||"",x=D&&(null===(r=D.webId)||void 0===r?void 0:r.replace(/[\{\}']+/g,""))||"",C=D||{},O=C.webAbsoluteUrl,E=C.webServerRelativeUrl,A=c.map(function(t){var n=new xe.e(t),a=e.demandItemFacet(_.Un,t)||"",i=e.demandItem({fileName:B.m,openUrl:B.L},t),r=i.fileName,o=i.openUrl;return n.name=(null==r?void 0:r.name)||"",n.extension=(null==r?void 0:r.extension)||"",n.displayName="".concat(n.name).concat(n.extension),n.openUrl=o||"",n.itemId=a,n.type=p&&e.demandItemFacet(B.h,t)?Oe.e.Folder:Oe.e.File,n}),L=function(e,t){var n,a=(null===(n=t.payloads().runModelOnItems)||void 0===n?void 0:n.itemId)||"";return p?f?!!a&&201===e[a]:201===e[t.name]:f?e.has(a):e.has(t.name)},k=((null==g?void 0:g.machineLearningCaptureEnabled)&&D.canUserUseSyntex||D.isSyntexPAYGEnabled)&&c&&c.length>0&&u!==oe.n.contentCenterSampleLibrary&&!!g&&!!g.flags2&&4096==(4096&g.flags2)&&!!(null===(o=null==g?void 0:g.permissions)||void 0===o?void 0:o.manageLists);return i.createElement(R.e,Object(a.__assign)({isAvailable:k,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=new Ie.e,[4,s.consumeAsync(ye.e)];case 1:return t=a.sent(),n=0,i=0,r=A.map(function(n){var a=t.register({name:n.displayName||"",iconName:Ce.a({type:n.type,extension:n.extension}),type:Se.e.runModelOnItems,payloads:{runModelOnItems:{item:n,itemId:n.itemId,isKillSwitchActive:Le}},batch:e,progress:{minimum:0,maximum:1,current:0}});return a.progress.maximum(1),a.progress.current(0),a}),Le||r.forEach(function(e){e.payloads().runModelOnItems.item.type===Oe.e.File?n++:i++}),r.forEach(function(e){e.payloads().runModelOnItems.fileCount=n,e.payloads().runModelOnItems.folderCount=i,e.state(De.e.started)}),[2,r]}})})];case 1:return e=r.sent(),t=function(){var e=[];return A.forEach(function(t){var n={__metadata:{type:y},Type:v,TargetSiteUrl:O,TargetWebServerRelativeUrl:E,TargetServerRelativeUrl:"".concat((null==h?void 0:h.rootFolder)||l,"/").concat(t.displayName)},a={__metadata:{type:y},Type:v,TargetSiteId:I,TargetWebId:x,TargetUniqueId:t.itemId||"",IsFolder:t.type===Oe.e.Folder};e.push(f?a:n)}),e}(),n=0,i=0,[4,null==S?void 0:S.runModel(t).then(function(t){Le?function(e,t){e.forEach(function(e){var n;(null===(n=e.payloads().runModelOnItems)||void 0===n?void 0:n.itemId)&&L(t,e)?(e.progress.current(1),e.state(De.e.completed)):e.state(De.e.failed)})}(e,t):(e.forEach(function(e){var a;(null===(a=e.payloads().runModelOnItems)||void 0===a?void 0:a.itemId)&&L(t,e)&&(e.payloads().runModelOnItems.item.type===Oe.e.File?n++:i++)}),Ee.e.logData({name:"ContentCenterUI.RunModel.FilesAndFoldersProcessed",component:"ContentCenterUI.RunModel",extraData:{fileCount:n,folderCount:i}}),e.forEach(function(e){var a;(null===(a=e.payloads().runModelOnItems)||void 0===a?void 0:a.itemId)&&L(t,e)?(e.payloads().runModelOnItems.fileCount=n,e.payloads().runModelOnItems.folderCount=i,e.progress.current(1),e.state(De.e.completed)):e.state(De.e.failed)}))}).catch(function(t){var n;j.e.log("[ccui] fetching content type failed "+(null===(n=null==t?void 0:t.message)||void 0===n?void 0:n.value)),e.forEach(function(e){e.state(De.e.failed)})})];case 2:return r.sent(),[2]}})})}},Object(Ae.t)(e,{itemKey:c[0],engagement:{name:"ContentCenter.RunModelOpen",isIntentional:!0}})))}),Me=Object(F.r)()(ke),Pe={key:Object(y.e)("runModel"),name:v.RunModelText,title:v.RunModelToolTip,action:i.createElement(D.t,null,i.createElement(function(){var e=Object(E.n)();return i.createElement(Me,{resources:e})},null)),iconProps:{iconName:"GenericScan"},facets:Object(a.__assign)({},_.Tt.pack(Y.y))},Te=n(1064),Ue=n(1711),Fe=n(132),He=n(43),Re=n(340);function Ne(e){var t,n,a=null==e?void 0:e.siteId,i=null===(t=null==e?void 0:e.knowledgeHubSiteDetails)||void 0===t?void 0:t.SiteId;return!(!((null===(n=null==e?void 0:e.knowledgeHubSiteDetails)||void 0===n?void 0:n.Url)&&a&&i&&Object(Re.normalizeLower)(a)===Object(Re.normalizeLower)(i)&&(null==e?void 0:e.webPermMasks)&&V.e.hasAny(null==e?void 0:e.webPermMasks,[V.e.manageLists,V.e.manageWeb])&&function(e){return!!(null==e?void 0:e.HasCortexTopicExperiencesCapability)}(e))||!K.e.isActivated("e517fa26-3ff9-4d03-8787-96b5d816bd7c")&&function(e){var t=e.env,n=e.farmLabel;return"prodbubble"===t&&"MSIT_SPDF_1_Content"!==n}(e)&&!V.e.hasPermission(null==e?void 0:e.webPermMasks,V.e.manageWeb))}var Be=Object(H.t)(function(e){var t=Object(Fe.e)(e),r=Object(b.e)(e),o=Object(He.e)(e,r);if(!o)return null;var s=e.dispatch,c=Object(R.n)(e,Object(a.__assign)({onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.e(179).then(n.bind(null,5739))];case 1:return e=a.sent().createNewTopic,[4,s(e({itemKeys:t,pageContext:o}))];case 2:return a.sent(),[2]}})})}},Object(Ae.t)(e,{itemKey:t[0],engagement:{name:"CreateNewTopic"}})));return i.createElement(N.e,{onExecute:c,isAvailable:Ne(o)})}),je={key:v.CreateNewTopicLabel,name:v.CreateNewTopicLabel,action:i.createElement(Be,null),iconProps:{iconName:"Page"}},Ve=n(313),ze=n(778),Ge=n(488),Ke=n(182),We=n(437),qe=n(246),Qe=n(570),Ye=n(314),Je=n(560),Xe=n(1008),Ze=n(1080),$e=n(3),et=n(118),tt=n(372),nt=n(712),at=n(336),it=n(2626),rt=n(1885),ot=n(908),st=n(1705),ct=n(51),dt=n(514),lt=n(1706),ut=n(1311),ft=n(217),pt=n(230),mt=n(3467),_t=n(193),ht=n(3468),bt=function(e){var t=e.undoRedoActionType,n=e.dispatch,r=e.isAvailable,o=i.useState(0),s=o[0],c=o[1],d=i.useState(0),l=d[0],u=d[1],f=i.useRef(new _t.e({})),p=r&&("undo"===t&&s>0||"redo"===t&&l>0);return i.useEffect(function(){var e=n(mt.e);return f.current.on(e,ht.e.undoRealCmdCountChangeEventName,function(e){c(e.undoRealCmdCount)}),f.current.on(e,ht.e.redoRealCmdCountChangeEventName,function(e){u(e.redoRealCmdCount)}),function(){f.current.dispose()}},[]),i.createElement(R.e,Object(a.__assign)({},e,{isAvailable:p}))},gt=Object(H.t)(function(e,t){var n=t.itemKey,r=t.undoRedoActionType,o="undo"===r,s=Object(ft.e)(e)===pt.e,c=e.dispatch;return i.createElement(bt,Object(a.__assign)({undoRedoActionType:r,dispatch:c,isAvailable:s,onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){return e=c(mt.e),_t.e.raise(e,o?ht.e.undoChangeEventName:ht.e.redoChangeEventName),[2]})})}},Object(Ae.t)(e,{itemKey:n,engagement:{name:o?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),vt=Object(F.n)()(gt),yt=n(47),St={key:Object(y.e)("quickEditUndo"),automationId:"quickEditUndoCommand",name:yt.be,iconProps:{iconName:"Undo"},isPermanent:!0,action:i.createElement(vt,{undoRedoActionType:"undo"})},Dt={key:Object(y.e)("quickEditRedo"),automationId:"quickEditRedoCommand",name:yt.he,iconProps:{iconName:"Redo"},action:i.createElement(vt,{undoRedoActionType:"redo"})},It=n(717),xt=n(141),Ct=n(15),Ot=n(820);function wt(e,t,n){var i;return i=Object(xt.e)(Object(Ve.t)({showExportToPowerBI:Object(se.isFeatureEnabled)(se.ShowExportToPowerBI),forDoclib:!1})),Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([Object(ut.e)(),Object(ot.t)(e),l.a,St,Dt,Object(xt.e)(qe.n),Object(xt.e)(qe.t)],n?[l.t]:[],!0),i?[i]:[],!0),Object(It.e)(null==e?void 0:e.listBaseTemplate)?[]:[Object(xt.e)(o.a)],!0),[dt.e],!1)}function Et(e){var t;return Ct.t.isActivated("13328880-4673-4E08-A2CE-A7CCDFBD6665","3/14/2022","Clean Up and Update Export Menu Logic")?[Object(ot.t)(e),St,Dt,qe.n,qe.t,d.e,Je.e,Ve.e,dt.e,l.v]:(t=Object(Ve.t)({showExportToPowerBI:Object(se.isFeatureEnabled)(se.ShowExportToPowerBI),forDoclib:!0}),Object(a.__spreadArray)(Object(a.__spreadArray)([Object(ot.t)(e),St,Dt,qe.n,qe.t,d.e,Je.e],t?[t]:[],!0),[dt.e,l.v],!1))}var At=[Object(xt.e)(o.e),Object(xt.e)(o.n)],Lt=[l.b,o.r,o.e,o.n],kt=[lt.e,l.x],Mt=[lt.e,l.x],Pt=n(1157),Tt=n(1323),Ut=n(1013),Ft=n(248),Ht=n(1104),Rt=n(510),Nt=n(342),Bt=Object(H.t)(function(e,t){return i.createElement(R.e,{onExecute:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(n){return e=null,t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId)),e&&(e.focus(),t.shouldClick&&e.click&&e.click()),[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})}),jt=new C.e("GetNPSSurveyFocusShortcut").id,Vt=(Nt.o,i.createElement(Bt,{elementId:"obf-TPromptContainer"}),{key:new C.e("focusFloodgateShortcutCommand").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:v.FloodgateShortcutDescription},action:i.createElement(Bt,{elementId:"obf-TPromptContainer"})}),zt=n(784),Gt=n(785),Kt=n(481),Wt=n(1599),qt=n(4867),Qt=n(1689),Yt=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(344).then(n.bind(null,5740))];case 1:return[2,e.sent().AddSmartTemplateTeachingBubbleContent]}})})}),Jt={key:Qt.e,automationId:"AddSmartTemplate",name:v.AddSmartTemplate,iconProps:{iconName:"FileTemplate"},action:i.createElement(D.e,null,i.createElement(qt.e,null))};function Xt(e){var t=Jt;return e||(t=Object(a.__assign)(Object(a.__assign)({},t),{onRender:function(e){return i.createElement(Yt,{item:e,commandButtonId:t.automationId})}})),t}var Zt=n(1002),$t=n(857),en=n(117),tn=n(172),nn=n(3595),an=n(409),rn=n(813),on=n(189),sn=n(777),cn=n(3027),dn=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(562)]).then(n.bind(null,5843))];case 1:return[2,e.sent().DocumentGenerator]}})})}),ln=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(162)]).then(n.bind(null,5741))];case 1:return[2,e.sent().ListRecordSelectionPicker]}})})}),un=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(161).then(n.bind(null,5742))];case 1:return[2,e.sent().ImageFilePicker]}})})});function fn(e){var t=Object(E.n)(),n=t.consume($t.e.optional),a=window.require.toUrl("odsp-media/images/error/error-fileloading-light.svg");return i.createElement(dn,{pageContext:e.pageContext,templateName:e.templateName,showFRE:e.showFRE,errorImagePath:a,loadWebDataSource:function(){return t.consumeAsync(T.ve)},ListRecordSelectionPicker:ln,closeDocumentGeneratorLayer:e.closeDocumentGeneratorLayer,startTime:e.startTime,getOAuthToken:function(){var t=Object(tn.c)(e.pageContext);return n.dispatch(Object(en.e)({url:t,disallowCookies:!0}))},ctId:e.ctId,rootFolderUrl:e.rootFolderUrl,parentFolders:e.parentFolders,itemSetKey:e.itemSetKey,ImageFilePicker:un,getUploadedFileData:e.getUploadedFileData,showNPSSurvey:function(){Object(nn.t)(t)},formatDateString:cn.e})}var pn=Object(H.t)(function(e,t){var r,o,s,c=Object(we.e)(e),d=e.demandItemFacet(Z.e,c),l="",u=e.dispatch,f=[];o=Object(b.e)(e);var p=e.demandItemFacet(B.f,o);f.push(p);for(var m=e.demandItemFacet(B.M,o);m;){var h=e.demandItemFacet(B.f,m.itemKey);f.push(h),m=e.demandItemFacet(B.M,m.itemKey)}s=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e!==nn.e.SPOFilePicker?[3,3]:(n=t[0],[4,u(Object(rn.e)(function(e){var t=e.demandItemFacet(B.m,n);l=t.name+t.extension;var a=e.demandItemFacet(an.e,n);return an.e.evaluate(a)(e,{itemKeys:[n]})}))]);case 1:return i=a.sent().getDownloadData,[4,u(i())];case 2:return[2,{downloadData:a.sent(),fileName:l}];case 3:return[2]}})})};var g=Object(He.e)(e,c);if(!g)return null;var v,y=Object(N.o)(function(e){var r=e.onExecuteProps.qos.startTime;return i.createElement(fn,{pageContext:g,showFRE:t.showFRE||!1,templateName:t.ctName,closeDocumentGeneratorLayer:function(i,r){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var o,s,l,f,p,m,h,b;return Object(a.__generator)(this,function(g){switch(g.label){case 0:return Object(se.isFeatureEnabled)(se.PlaceholdersToColumns)?r?(o=!1,[4,n.e(113).then(n.bind(null,2384))]):[3,2]:[3,3];case 1:for(s=g.sent(),l=0,f=i;l<f.length;l++)if((p=f[l])&&p.ListViewXml&&s.parseView(p.ListViewXml).associatedContentTypeId===t.ctId){o=!p.DefaultView;break}o&&(m=d.viewKey&&te.e.serialize(d.viewKey),u(Object(on.e)({items:(h={},h[m]=Object(a.__assign)({},_.zt.pack(!0)),h)}))),u(Object(sn.e)({items:(b={},b[c]=[re.e],b)})),g.label=2;case 2:return e.resolve(),[3,4];case 3:window.location.reload(),g.label=4;case 4:return[2]}})})},startTime:r,ctId:t.ctId,rootFolderUrl:d.rootFolder,parentFolders:f,itemSetKey:o,getUploadedFileData:s})},{scope:"global"}),S=d&&$.e.serialize(d),D=e.demandItemFacet(_.We,S),I=d?d.webAbsoluteUrl:"",x=(null==d?void 0:d.listFullUrl)?d.listFullUrl:"",C=(null==D?void 0:D.id)?D.id.replace("{","").replace("}",""):"",O=g.canUserUseSyntex;return v=!!(x&&I&&C&&D&&D.isDocumentLibrary&&D.templateType===oe.t.documentLibrary&&(null===(r=null==D?void 0:D.permissions)||void 0===r?void 0:r.manageLists)&&D.newWOPIDocumentEnabled&&O),i.createElement(R.e,Object(a.__assign)({isAvailable:v,onExecute:y},Object(Ae.t)(e,{itemKey:c,engagement:{name:"GenerateCAAEDocument"}})))}),mn=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(345).then(n.bind(null,5487))];case 1:return[2,e.sent().TeachingBubbleWrapper]}})})}),_n={onRender:function(e,t){return i.createElement(N.n,{action:i.createElement(pn,{ctName:e.name,showFRE:!0,ctId:e.key.substr(16,e.key.length-16)})},function(n){n.isAvailable;var r=n.execute;return i.createElement(mn,{key:e.key,subMenuItem:e,submenuItemId:"generate-caae-document-button",teachingBubbleCampaign:Zt.GENERATE_CAAE_DOCUMENT,onBubblePrimaryButtonClick:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return t(),[4,r()];case 1:return e.sent(),[2]}})})},onSubmenuButtonClicked:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:return t(),[4,e.onClick()];case 1:return n.sent(),[2]}})})}})})}},hn=n(1688),bn=n(214),gn=n(305),vn=n(70),yn=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(345).then(n.bind(null,5487))];case 1:return[2,e.sent().TeachingBubbleWrapper]}})})});function Sn(e){return i.createElement(yn,Object(a.__assign)({},e,{commandId:"switchLayoutCommand",teachingBubbleCampaign:Zt.MODERN_TEMPLATE_VIEW_INFO,onBubbleSecondaryButtonClick:function(){window.open("https://go.microsoft.com/fwlink/?linkid=2185538")},imageProps:{src:window.require.toUrl("odsp-media/images/contentassembly/viewswitcher-image.png"),alt:v.ModernTemplateTeachingBubbleImageAlt,styles:{image:{width:"100%",height:"100%"}}}}))}var Dn=n(229),In=Object(M.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(46).then(n.bind(null,1992))];case 1:return[2,e.sent().SwitchViewExecutor]}})})}),xn=Object(Dn.t)()(In),Cn=Object(H.t)(function(e,t){var n=Object(we.e)(e),r=e.demandItemFacet(_.kn,n),o=e.dispatch,s=t.defaultRender;return i.createElement(i.Fragment,null,r&&i.createElement(xn,{viewId:r.id,currentDerivedView:r,onComplete:function(){var e;o(Object(on.e)({items:(e={},e[n]=Object(a.__assign)({},_.kn.pack(void 0)),e)}))},itemSetKey:t.currentItemSetKey}),i.createElement(s,Object(a.__assign)({},t,{id:t.commandId})))}),On=Ct.t.isActivated("72ad9c03-ac5e-4d5c-83b7-f5d0852daa15","04/13/2022","Add go to channel action into the command bar for items in the In channels section");function wn(e,t){var n=t.itemKey,i=t.commands,u=t.farCommands,f=t.overflowCommands,p=Object(et.n)(),m=Object(tt.t)(),h=p||m&&!Object($e.co)($e.Wt),b=e.demandItemFacet(ne.e,n);if(b){var g=e.demandItemFacet(_.Dn,ee.e.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl})),v=g&&g.listBaseTemplate,y=Number(v)===oe.t.contentCenterModelLibrary,S=y&&Object($e.co)($e.B),D=Number(v)===oe.t.contentCenterModelUsageList,I=Object(Kt.e)(e),x=I.isMachineLearningCaptureEnabled,C=I.isMachineLearningExperienceEnabled,O=I.isMachineTeachingModelApplied,w={webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl},E=$.e.serialize(w),A=e.demandItemFacet(_.We,E),M=!!A&&!!A.isDocumentLibrary,P=!!A&&A.allowCreateFolder,T=!!A&&A.permissions,U=Object(Ze.e)(e,n);U&&(U=Object(xt.e)(U));var F=Object(Ht.e)(e,n,M);F&&(F=Object(xt.e)(F));var H=Object(ft.e)(e),R=H===pt.e,N=H===Ft.e,B=!(null==A?void 0:A.disableCommenting)&&!(null==g?void 0:g.CommentsOnListItemsDisabled);if(R){var j=An(Pt.e);return Object(a.__assign)(Object(a.__assign)({},function(e,t){var n,i,r=t.itemKey,o=t.listKey,s=t.pageContext,c=t.isDocumentLibrary,d=t.extraCommands,u=t.isCommentCommandEnabled,f=Object(we.e)(e),p=e.demandItemFacet(ne.e,r),m=e.demandItemFacet(Z.e,f),_={webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl},h=rt.e.serialize(_),b=e.demandItemFacet(re.e,h),g="";if(m&&m.viewKey&&(g=m.viewKey.viewId),!g&&s&&s.viewId&&(g=ct.e.normalizeLower(s.viewId,!1)),b&&p){var v=[];if((n=Object(st.e)(e,{viewKeys:b.itemKeys,webAbsoluteUrl:p.webAbsoluteUrl,listViewSetKey:_,itemSetKey:f,currentViewKey:te.e.serialize({viewId:g})}))&&n.subMenuProps&&n.subMenuProps.items){for(var y=n.subMenuProps.items,S=-1,D=0;D<y.length;D++){var I=y[D].automationId;if(I&&(0===I.indexOf("switchToFixedGridLayoutCommand")||0===I.indexOf("switchViewCommand_")||0===I.indexOf("saveCommand"))){S=D;break}}-1!==S&&(v=y.slice(S)),v.push(l.E),v.push(l.w),v.push.apply(v,Object(Ot.e)())}n=Object(a.__assign)(Object(a.__assign)({},n),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},n.subMenuProps),{items:v})})}return i=c?{commands:Et(s),overflowCommands:Lt,farCommands:Mt}:{commands:wt(s,0,u),overflowCommands:At,farCommands:kt},d&&d.flowCommand&&(i.commands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.commands,!0),[d.flowCommand],!1)),d&&d.integrateCommand&&(i.commands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.commands,!0),[d.integrateCommand],!1)),d&&d.openCommand&&c&&(i.commands=Object(a.__spreadArray)([d.openCommand],i.commands,!0)),n&&(i.farCommands=Object(a.__spreadArray)([l.O,n],i.farCommands,!0)),d&&d.fullscreenCommand&&(i.farCommands=Object(a.__spreadArray)(Object(a.__spreadArray)([],i.farCommands,!0),[d.fullscreenCommand],!1)),i}(e,{itemKey:n,listKey:w,pageContext:g,isDocumentLibrary:M,extraCommands:{flowCommand:U,openCommand:j,fullscreenCommand:Object(et.i)(g)||Object(et.a)()?void 0:l.C,integrateCommand:Object(It.e)(v)&&F?F:void 0},isCommentCommandEnabled:B})),kn(0,t))}var V=!(!N||Ct.t.isActivated("9EE56BA6-F49A-4D6B-A983-E9FB4677D8E4","09/09/2020","Allowing command bar in case of error screen")||!Object(Rt.e)(e).error),z=!Ct.t.isActivated("793446d6-336a-4617-b387-1011564015e8","10/04/2022","Use Syntex supported document libraries allow list"),K=g&&g.webTemplate,W=z?Object(oe.s)(Number(v))&&Number(K)!==G.e.contentCenter&&!O:M&&Number(K)!==G.e.contentCenter&&Number(v)!==oe.t.webPageLibrary&&Number(v)!==oe.t.mySiteDocumentLibrary&&!y&&!O,q=z?Object($e.co)($e.Li)&&Object(oe.s)(Number(v)):Object($e.co)($e.Li)&&M&&Number(v)!==oe.t.webPageLibrary&&Number(v)!==oe.t.mySiteDocumentLibrary&&!y&&Number(v)!==oe.t.contentCenterSampleLibrary,Q=!1,Y=void 0;if(Object($e.co)($e.ga)){var X=Object(we.e)(e),ae=e.demandItemFacet(Z.e,X),ie=ae&&ae.viewKey&&te.e.serialize(ae.viewKey);Q=e.demandItemFacet(_.zt,ie),Y=e.demandItemFacet(_.kn,X)}var se=i?function(e,t,n){var i=[],r=t.isDocumentLibrary,s=t.isContentCenterModelLibrary,c=t.isContentCenterModelUsageList,u=t.isMachineLearningCaptureEnabled,f=t.isMachineLearningExperienceEnabled,p=t.hostedCrossOrigin,m=t.defaultCommands,_=t.hosted,h=t.hostedInTeamsDesktop,b=t.allowCreateFolder,g=t.listTemplate,v=t.isCommentCommandEnabled,y=t.flowCommand,S=t.integrateCommand,D=t.isCopyRenameModelActionEnabled,I=t.isContentCenterEverywhereEnabled,x=t.isSyntexViewModelsEnabled;if(t.isCalendarLayoutWithError)return[];r?p&&!Object($e.co)($e.Wt)||i.push(L):p&&!Object($e.co)($e.Wt)?i.push(l.a):i.push(L,l.a);for(var C=Object(gn.e)(e),O=g!==oe.t.webPageLibrary&&(Object($e.co)($e.ir)||C&&1===Object(bn.t)($e.rr,C).variantToDisplay),w=0,E=m;w<E.length;w++){var A=E[w];if(A.key===Ke.e.key){if(!s||u||f){var M=En(e,A,!!r,!!s,!!b);i.unshift(M)}}else if(A.key===qe.t.key)i.push(Object(xt.e)(qe.t)),v&&i.push(Object(xt.e)(l.t));else if(A.key===We.e.key)i.push(An(A));else if(A.key===Je.e.key&&Object($e.co)($e.Ti))i.push(A),i.push(l.p),On||i.push(l.m),i.push(Pe),I&&!x&&i.push(J),x&&i.push(Te.t);else if(A.key!==Je.e.key||Object($e.co)($e.Ti))if(A.key===Xe.e.key&&Object(Ut.e)())i.push(A);else if(A.key===Ve.e.key)h||i.push(A);else if(A.key===Qe.e.key){var P=A;Object($e.co)($e.Pr)||(P=Object(a.__assign)(Object(a.__assign)({},P),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},P.subMenuProps),{items:[l._,l.h]})})),P.subMenuProps&&P.subMenuProps.items&&P.subMenuProps.items.length>0&&P.subMenuProps.items[P.subMenuProps.items.length-1].key!==nt.n.key&&r&&(P=Object(a.__assign)(Object(a.__assign)({},P),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},P.subMenuProps),{items:Object(a.__spreadArray)(Object(a.__spreadArray)([],P.subMenuProps.items,!0),[nt.n],!1)})})),i.push(P)}else A.key===Ge.t.key?i.push(Object(xt.e)(A)):i.push(A);else i.push(Pe),I&&!x&&i.push(J),x&&i.push(Te.t)}return r?(p&&!Object($e.co)($e.Wt)||(i.push(be),it.default.arePowerAppsFormsEnabled()&&(Object(It.e)(g)||i.push(o.a))),O&&!D?i.push(zt.e,Gt.e):D?i.push(k.e,k.e,ge.e):i.push(l.L,l.D),i.push(l.e),i.push(Tt.e),i.push(l.v),Object($e.co)($e.Rt)&&i.push(l.r)):(i.push(be),Object(It.e)(g)||i.push(Object(xt.e)(o.a)),O&&!D?i.push(zt.e):D?i.push(k.e,ge.e):i.push(l.L),_&&i.push(l.d)),s?i=i.filter(function(e){return e.key!==d.e.key&&e.key!==be.key&&e.name!==be.name&&e.key!==o.a.key&&e.key!==Ve.e.key&&e.key!==o.t.key&&e.key!==o.o.key}):c&&(i=[Ve.e],y&&i.push(y),S&&i.push(S)),i}(e,{defaultCommands:i||[],isDocumentLibrary:M,isContentCenterModelLibrary:y,isContentCenterModelUsageList:D,isMachineLearningCaptureEnabled:x,isMachineLearningExperienceEnabled:C,allowCreateFolder:P,hosted:h,hostedCrossOrigin:m,hostedInTeamsDesktop:p,listTemplate:v,isCalendarLayoutWithError:V,isCommentCommandEnabled:B,integrateCommand:F,flowCommand:U,isCopyRenameModelActionEnabled:S,isContentCenterEverywhereEnabled:W,isSyntexViewModelsEnabled:q}):[];V||(!U||y||D||se.push(U),F&&Object(It.e)(v)&&se.push(Object(xt.e)(F)));var ce=function(e,t){var n=t.farCommands,i=void 0===n?[]:n,o=t.isCalendarLayout,d=t.isDocumentLibrary,u=t.canModifySchema,f=t.hosted,p=function(){return!o||Object($e.co)($e.$t)?[Object(xt.e)(l.w),Object(xt.e)(l.E)]:[]},m=[];m.push(l.O);for(var _=0,h=i;_<h.length;_++){var b=h[_];if(b.key===Ye.e.key){var g=b.subMenuProps?Object(a.__spreadArray)([],b.subMenuProps.items,!0):[];if(d&&b.subMenuProps&&b.subMenuProps.items)for(var v=0,y=0,S=g;y<S.length;y++){if("tilesListCommand"===S[y].automationId&&(!g[v+1]||g[v+1].key!==l.s.key)){g.splice(v+1,0,l.s);break}v++}var D=Object(a.__assign)(Object(a.__assign)({},b),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},b.subMenuProps),{items:b.subMenuProps&&(u?Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],g,!0),p(),!0),Object(Ot.e)(),!0):Object(a.__spreadArray)([],g,!0))||Object(a.__spreadArray)(Object(a.__spreadArray)([],p(),!0),Object(Ot.e)(),!0)})});t.isModernTemplateFREEnabled&&D.key===Ye.e.key?m.push(Mn(D)):t.switchToView&&D.key===Ye.e.key?m.push(Pn(D)):m.push(D)}else m.push(b)}return m.push(s.e,c.e),!e.demandItemFacet(r.r,r.c)||f||Object(et.a)()||m.push(l.C),m}(e,{farCommands:u,isDocumentLibrary:M,isCalendarLayout:N,canModifySchema:!(!T||!T.manageLists&&!T.managePersonalViews),hosted:h||Object(et.i)(g),isModernTemplateFREEnabled:Q,switchToView:Y}),de=function(e){var t=e.overflowCommands,n=e.isDocumentLibrary,i=e.hostedCrossOrigin,r=e.hostedInTeamsDesktop;if(!t||e.isCalendarLayoutWithError)return[];var s=[];return i&&r&&!Object($e.co)($e.Wt)?s=Object(a.__spreadArray)([Object(xt.e)(o.r)],t,!0):(s=!i||r||Object($e.co)($e.Wt)?!r||i&&!Object($e.co)($e.Wt)?[Object(xt.e)(o.r),Object(xt.e)(o.e),Object(xt.e)(o.n)]:[Object(xt.e)(o.r),Object(xt.e)(o.e)]:[Object(xt.e)(o.r),Object(xt.e)(o.n)],n&&s.push(l.A),s=s.concat(t)),n&&s.splice(0,0,l.b),s}({overflowCommands:f,isDocumentLibrary:M,hostedCrossOrigin:m,isCalendarLayoutWithError:V,hostedInTeamsDesktop:p});return Object(a.__assign)({commands:Ln(se),farCommands:Ln(ce),overflowCommands:Ln(de)},kn(0,t))}return Object(a.__assign)({},kn(0,t))}function En(e,t,n,r,o){if(t.key!==Ke.e.key)return t;var s;if(n){if(r)return Ue.e;var c=Ct.t.isActivated("863972C3-5A05-49F8-9F14-15CAEF8AC092","4/23/2021","Skip check for New menu length");if(s=t,t.subMenuProps&&t.subMenuProps.items&&(!c||t.subMenuProps.items.length>0&&t.subMenuProps.items[t.subMenuProps.items.length-1].key!==nt.e.key)){var d=s.subMenuProps.items.filter(function(e){return Object(hn.e)(e)}).length>0,u=Object(a.__spreadArray)(Object(a.__spreadArray)([],t.subMenuProps.items,!0),[x,l.u,{name:"-",key:"divider_2",itemType:at.e.Divider},l.f,nt.t,Xt(d)],!1);u.unshift(je),s=Object(a.__assign)(Object(a.__assign)({},t),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},t.subMenuProps),{items:u})})}if(s.subMenuProps&&s.subMenuProps.items&&s.subMenuProps.items.length>0)for(var f=0,p=!1,m=0,_=(g=Object(a.__assign)({},s.subMenuProps)).items;m<_.length;m++){var h=_[m];if(Object(hn.e)(h)){var b=Object(a.__assign)(Object(a.__assign)({},h),{action:i.createElement(D.e,null,i.createElement(pn,{ctName:h.name,ctId:h.key.substr(16,h.key.length-16)}))});p||(b=Object(a.__assign)(Object(a.__assign)({},b),_n),p=!0),g.items[f]=b}f++}if(s.subMenuProps&&s.subMenuProps.items&&s.subMenuProps.items.length>0){var g=Object(a.__assign)({},s.subMenuProps),v=Object(we.e)(e),y=Object(He.e)(e,v);g.items=g.items.filter(function(e){return!Object(hn.e)(e)||Object(hn.e)(e)&&y.canUserUseSyntex}),s=Object(a.__assign)(Object(a.__assign)({},s),{subMenuProps:g})}return s}return t.subMenuProps&&t.subMenuProps.items&&t.subMenuProps.items.length>0&&t.subMenuProps.items[t.subMenuProps.items.length-1].key===ze.e.key&&t.subMenuProps.items.length<=2&&!o?s={key:t.key,action:ze.e.action,iconProps:t.iconProps,name:t.name}:t}function An(e){return e.key!==We.e.key?e:e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&e.subMenuProps.items[e.subMenuProps.items.length-1].key!==l.c.key&&Object(a.__assign)(Object(a.__assign)({},e),{subMenuProps:Object(a.__assign)(Object(a.__assign)({},e.subMenuProps),{items:Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],e.subMenuProps.items,!0),[l.l],!1),Object($e.co)($e.Je)&&[Object(a.__assign)(Object(a.__assign)({},Wt.e),{facets:Object(a.__assign)(Object(a.__assign)({},Wt.e.facets),_.Tt.pack(Y.p))})]||[],!0),[l.c,u.e,f.e],!1)})})||e}function Ln(e){if(!e||!e.length)return e;for(var t=[],n={},a=0,i=e;a<i.length;a++){var r=i[a];n[r.key]||(t.push(r),n[r.key]=!0)}return t}function kn(e,t){var n=t.shortcutCommands,a=[];if(n)for(var i=0,r=n;i<r.length;i++){var o=r[i];o.key===jt||a.push(o)}return a.push(Vt),{shortcutCommands:a}}var Mn=function(e){return Object(a.__assign)(Object(a.__assign)({},e),{commandBarButtonAs:Object(vn.e)().merge(Sn,e.commandBarButtonAs)})},Pn=function(e){return Object(a.__assign)(Object(a.__assign)({},e),{commandBarButtonAs:Object(vn.e)().merge(Cn,e.commandBarButtonAs)})}}],Array(26),[function(e,t,n){"use strict";n.r(t),n.d(t,"sharePointAddonAutoRefresh",function(){return Ue});var a,i,r=n(11),o=n(731),s=n(88),c=n(1589),d=n(0),l=n("react-lib"),u=n(348),f=n(26),p=n(7),m=n(5),_=n(221),h=n(240),b=n(933),g=n(15),v=n(1546);!function(e){e[e.WebhookSubscription=0]="WebhookSubscription",e[e.Meta=1]="Meta",e[e.EventHub=2]="EventHub"}(a||(a={})),function(e){e[e.Zip=0]="Zip"}(i||(i={}));var y,S=n(678),D=n(138),I=n(83);!function(e){e[e.New=0]="New",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(y||(y={}));var x=12e4,C={ODB:459},O=function(){function e(e){var t=this;this.subscribe=function(){if(t._log("Subscribe"),0===t._subscribers){t._async=new h.e,g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:a.WebhookSubscription},function(){t._log("PushChannelMessageSource",a.WebhookSubscription),e()}),t._pushChannelService.setupNotificationHandler({source:a.EventHub},function(){t._log("PushChannelMessageSource",a.EventHub),e()}),t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}return t._subscribers++,t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"}),t._unsubscribe.bind(t)},this._id=e.id,this._driveUrlParts=e.driveUrl?Object(v.e)(e.driveUrl):void 0,this._dispatch=e.dispatch,this._template=e.template,this._itemScopeItemKey=e.itemsScopeItemKey||"",this._pushChannelService=e.pushChannelService,this._onUnsubscribe=e.onUnsubscribe,this._isTestMode=e.isTestMode,this._onPushChannelConnected=e.onPushChannelConnected,this._onNotificationReceived=e.onNotificationReceived,this._subscribers=0,this._syncToken="latest",this._getChangesAttempts=0}return e.prototype._unsubscribe=function(){return this._log("Unsubscribe"),this._subscribers--,this._template.onUnsubscribe(this._subscribers),0===this._subscribers&&(this._async&&(this._async.dispose(),this._async=void 0,this._refreshSubscriptionTimeoutId=void 0),this._pushChannelService.setupNotificationHandler({source:a.WebhookSubscription},function(){}),this._pushChannelService.removeConnectionHandler(this._id),this._pushChannelService.disconnect()),this._onUnsubscribe(this._subscribers),this._subscribers},e.prototype._onPushChannelConnection=function(e){return Object(d.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(d.__generator)(this,function(a){switch(a.label){case 0:if(!e)return this._log("Disconnected"),this._clearRefreshSubscriptionTimeout(),[2];if(this._log("Connected"),this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected(),g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._resolveChangeMessages()];case 2:return a.sent(),[3,4];case 3:return t=a.sent(),this._handleError(t),[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];a.label=6;case 6:return a.trys.push([6,8,,9]),[4,this._getChangeMessages()];case 7:return a.sent(),[3,9];case 8:return n=a.sent(),this._handleError(n),[2];case 9:return this._refreshSubscriptionHandler(),[2]}})})},e.prototype._handleError=function(e){var t=this;if(this._getChangesAttempts++,!(this._getChangesAttempts>10)){var n=!1;if(Object(S.r)(e))switch(e.status){case 404:case 410:n=!0,this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}},e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)},e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,a=Date.parse(t.expirationDateTime),i=Date.now(),r=a-i-n,o=isNaN(r);if(o||r<x){if(o||b.e.isFeatureEnabled(C)){var s={refreshDelay:r,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:a,dateTimeNow:i,recreateBufferRandom:n};new D.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:s}).end({resultType:I.e.Failure,extraData:s})}r=x}this._clearRefreshSubscriptionTimeout(),this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(d.__awaiter)(e,void 0,void 0,function(){return Object(d.__generator)(this,function(e){switch(e.label){case 0:return this._log("Refreshing subscription"),this._refreshSubscriptionTimeoutId=void 0,[4,this._pushChannelService.refreshSubscription()];case 1:return!0===e.sent()&&this._refreshSubscriptionHandler(),[2]}})})},r)}}},e.prototype._clearRefreshSubscriptionTimeout=function(){this._async&&void 0!==this._refreshSubscriptionTimeoutId&&(this._async.clearTimeout(this._refreshSubscriptionTimeoutId),this._refreshSubscriptionTimeoutId=void 0)},e.prototype._getChangeMessages=function(){return Object(d.__awaiter)(this,void 0,void 0,function(){var e;return Object(d.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:return e=t.sent(),this._syncToken=e.syncToken?e.syncToken:"latest",this._getChangesAttempts=0,[2,e]}})})},e.prototype._onNotification=function(){return Object(d.__awaiter)(this,void 0,void 0,function(){var e;return Object(d.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this._template.hasPendingRequest()?[2]:(this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived(),[4,this._resolveChangeMessages()]);case 1:return t.sent(),[3,3];case 2:return e=t.sent(),this._log("onNotification error",e),[3,3];case 3:return[2]}})})},e.prototype._resolveChangeMessages=function(){return Object(d.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,l;return Object(d.__generator)(this,function(d){switch(d.label){case 0:return t=new _.e({publisher:e}),[4,this._getChangeMessages()];case 1:for(n=d.sent(),this._log("Change messages",n),a=this._processMessages(n.messages),this._log("Changes",a),t.merge(n.itemResolver),i=0,r=a;i<r.length;i++)switch((o=r[i]).type){case y.New:t.invalidateItems({items:(s={},s[o.invalidateKey]=[p.t],s)});break;case y.Update:o.hasSelection&&this._itemScopeItemKey?this._updateItems(o.invalidateKey):t.invalidateItems({items:(c={},c[o.invalidateKey]=[o.invalidateFacet],c)});break;case y.Delete:t.invalidateItems({items:(l={},l[o.invalidateKey]=[m.l],l)})}return this._dispatch(t.execute()),[2]}})})},e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var a=e[n],i=this._template.processMessage(this._dispatch,a,this._itemScopeItemKey);if(void 0!==i)this._log("Change",i.invalidateKey,i.reason),t.push(i);else if(a.parentItemKey)for(var r=n+1;r<e.length;r++)if(e[r].itemKey===a.parentItemKey){e.splice(r,1);break}}return t},e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)},e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),w=O,E=n(752),A=n(881),L=n(78),k=function(){function e(e,t){this._dataRequestor=t.dataRequestor,this._listId=e.listId,this._webAbsoluteUrl=e.webAbsoluteUrl}return e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl)t="".concat(this._webAbsoluteUrl,"/_api/v2.0/sites/root/lists/").concat(this._listId),n=!1;else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root",n=!0}return this._dataRequestor.send({path:"".concat(t,"/subscriptions/socketIo"),apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})},e}(),M=n(4457),P={ODB:459},T={ODB:!0},U=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],F=function(){function e(e,t){this._firedConnectQoSEvent=!1,this._getSubscriptionAttempts=0,this._socketIoReconnectAttempts=0,this._notificationHandlers={},this._connectionHandlers={},this._disableWebSockets=e.disableWebSockets,this._subscriptionService=t.subscriptionService,this._sessionTokenFetcher=t.sessionTokenFetcher,this._async=new h.e,this._socketIoReconnectAttempts=0}return e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected},e.prototype.getSocketIoSubscription=function(){return this._subscription},e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t},e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]},e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,o=e.id,s=void 0===o?"":o,c=a[n];if(c){if(r&&r.length)for(var d=0,l=r;d<l.length;d++){var u=l[d];this._notificationHandlers[c.toLowerCase()+i[u].toLowerCase()+s]=t}else this._notificationHandlers[c.toLowerCase()+s]=t;return!0}return!1},e.prototype.connect=function(e,t){return Object(d.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s=this;return Object(d.__generator)(this,function(c){switch(c.label){case 0:return this.disconnect(),void 0!==e?[3,2]:(n=this,[4,this._getSubscription("PushChannelService.Connect")]);case 1:return n._subscription=c.sent(),[3,3];case 2:this._subscription=e,c.label=3;case 3:return this._log("Connecting to subscription",this._subscription),void 0===this._subscription?(this._log("Invalid subscription"),[2,!1]):(this._firedConnectQoSEvent&&!b.e.isFeatureEnabled(T)||(this._firedConnectQoSEvent=!0,i=new D.e({name:"PushChannelService.Connect",extraData:Object(d.__assign)({notificationUrl:this._subscription.notificationUrl},t||{})})),r={reconnectionAttempts:20},-1!==this._subscription.notificationUrl.indexOf("pushn")?r.transports=["websocket"]:this._disableWebSockets&&(r.transports=["polling"]),o=this._socketIo=M.connect(this._subscription.notificationUrl,r),this._socketIo.on("connect",function(){o===s._socketIo?(s._log("Connected"),i&&i.end({resultType:I.e.Success,extraData:Object(d.__assign)({notificationUrl:s._subscription.notificationUrl},t||{})}),s._executeConnectionHandlers(!0)):o.disconnect()}),this._socketIo.on("disconnect",function(){o===s._socketIo&&(s._log("Disconnected"),s._executeConnectionHandlers(!1))}),this._socketIo.on("reconnect_failed",function(){s._log("Reconnect failed"),i&&i.end({resultType:I.e.Failure,extraData:Object(d.__assign)({notificationUrl:s._subscription.notificationUrl},t||{})}),s._subscription=void 0,s._socketIoReconnectAttempts++,s._socketIoReconnectAttempts>3?s._log("Exceeded max reconnect attempts"):s._async.setTimeout(function(){s.connect(void 0,{methodInvoker:"reconnect_failed"})},0)}),this._socketIo.on("notification",function(e){var t;s._log("Notification",e);try{t=JSON.parse(e)}catch(e){return}var n=t.source,i=t.scenario?t.scenario.toLowerCase():"";n||(n=a[a.WebhookSubscription]),n=n.toLowerCase();var r=!1;r=s._handleMessage(t,n);var o=n+i;for(var c in s._notificationHandlers)-1!==c.indexOf(o)&&c!==n&&(r=s._handleMessage(t,c,o)||r);r||s._log("Notification - missing handler for message")}),[2,!0])}})})},e.prototype.disconnect=function(){this._socketIo&&(this._socketIo.disconnect(),this._socketIo=void 0),this._async&&(this._async.dispose(),this._async=new h.e),this._subscription=void 0},e.prototype.refreshSubscription=function(){return Object(d.__awaiter)(this,void 0,void 0,function(){var e;return Object(d.__generator)(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:return void 0===(e=t.sent())?[2,void 0]:this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl?(this._log("Notification url changed. Reconnecting..."),this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"}),[2,!1]):(this._subscription=e,[2,!0])}})})},e.prototype._getSubscription=function(e){return void 0===e&&(e="unknown"),Object(d.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,l,u,f=this;return Object(d.__generator)(this,function(d){switch(d.label){case 0:n=void 0,b.e.isFeatureEnabled(P)&&(n=new D.e({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}})),d.label=1;case 1:return d.trys.push([1,6,,7]),i=(a=this._subscriptionService).getSocketIoSubscription,u={},this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:return r=d.sent(),[3,4];case 3:r=void 0,d.label=4;case 4:return[4,i.apply(a,[(u.sessionToken=r,u.existingSubscription=this._subscription,u)])];case 5:return t=d.sent(),n&&n.end({resultType:I.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}),[3,7];case 6:return o=d.sent(),this._log("Failed to get socketIo subscription",o),s=!1,c=0,Object(S.r)(o)&&(403===o.status?s=!0:o.error&&o.error.message&&(s=U.some(function(e){return 0===o.error.message.indexOf(e)})),(l=o.request.getResponseHeader("Retry-After"))&&(c=Number(l),isNaN(c)&&(c=0))),n&&n.end({resultType:I.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts,retryAfterSeconds:c}}),s?[2,void 0]:(this._getSubscriptionAttempts++,this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=Math.max(1e3*c,3e4*Math.pow(2,f._getSubscriptionAttempts));f._log("Retrying in ".concat(t," milliseconds")),f._async.setTimeout(function(){return e(f._getSubscription("Retry_getSubscription"))},t)})]);case 7:return[2,t]}})})},e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var a=this._notificationHandlers[t];return!!a&&(a(e.payload?e.payload:e.value),!0)},e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var a=n[t];this._connectionHandlers[a](e)}},e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}(),H=F,R=n(14),N=n(256),B=n(64),j=n(1),V=n(28),z=n(318),G=n(120),K=n(139),W=n(116),q=n(188),Q=n(99),Y=n(1083),J=n(699),X=n(859),Z=n(574),$=n(35),ee=function(){function e(e){this._dataRequestor=e.dataRequestor,this._rootItemKey=e.rootItemKey,this._pendingRequest=!1}return e.prototype.onUnsubscribe=function(e){},e.prototype.getSubscription=function(e){var t=this,n=e(Object(W.e)(function(e){return{spItem:e.demandItemFacet(V.e,t._rootItemKey)}})).spItem;if((null==n?void 0:n.webAbsoluteUrl)&&n.listFullUrl){var a=G.e.serialize({webAbsoluteUrl:null==n?void 0:n.webAbsoluteUrl,listFullUrl:null==n?void 0:n.listFullUrl}),i=e(Object(W.e)(function(e){return e.demandItemFacet(j.Ze,a)}));if((null==i?void 0:i.notificationUrl)&&(null==i?void 0:i.expirationDateTime)&&(null==i?void 0:i.subscribeID))return{notificationUrl:null==i?void 0:i.notificationUrl,expirationDateTime:null==i?void 0:i.expirationDateTime,id:null==i?void 0:i.subscribeID}}},e.prototype.hasPendingRequest=function(){return this._pendingRequest},e.prototype.getChangeMessages=function(e,t,n){return Object(d.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s,c,l,u,f,p,m,h,b,v,y,S,D,I,x,C,O,w,E,k,M,P,T,U,F,H,R,N,B,z=this;return Object(d.__generator)(this,function(ee){switch(ee.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";return a="".concat(n.endpoint,"/drives/").concat(n.driveId),i=e(Object(q.e)({isTAB:L.A})).isTAB,r=e(Object(W.e)(function(e){return{spItem:e.demandItemFacet(V.e,z._rootItemKey)}})).spItem,o=new _.e,"latest"===t&&r&&(s=G.e.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),c=e(Object(W.e)(function(e){return e.demandItemFacet(j.We,s)})),l=null==c?void 0:c.tick)?(u=l-621355968e9,u/=1e4,f=new Date(u),!g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")&&(t="".concat(f.toISOString()),((new Date).getTime()-f.getTime())/1e3<30)?[2,{syncToken:t,messages:[],itemResolver:o}]:[2,{syncToken:"".concat(f.toISOString()),messages:[],itemResolver:o}]):(m=e(Object(q.e)({dataSyncClientConfiguration:Y.e})).dataSyncClientConfiguration,h=!1,m?[4,m.dataSyncClient]:[3,3]);case 1:return(b=ee.sent())?[4,b.isListDataSyncEnabledAsync({driveId:n.driveId})]:[3,3];case 2:h=ee.sent(),ee.label=3;case 3:return h?(p="",[3,7]):[3,4];case 4:return(y=n.endpoint)?[4,e(Object(A.getSessionToken)({endpoint:n.endpoint,driveUrl:a}))]:[3,6];case 5:y=ee.sent(),ee.label=6;case 6:if(void 0===(p=(v=y)&&v.accessToken))throw new $.e({code:"authFailure"});ee.label=7;case 7:return this._pendingRequest=!0,S="".concat(a,"/root/view.delta?token=").concat(encodeURIComponent(t)),[4,this._dataRequestor.send({apiName:"viewDelta",path:S,accessToken:{accessToken:p,tokenUrl:a},useAuthorizationHeaders:!0,headers:Object(d.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},i?{}:{ScenarioType:"BGO"})})];case 8:if(D=ee.sent(),I=[],D&&D.value)for(x=0,C=D.value;x<C.length;x++){if(O=C[x],w=void 0,E={endpoint:n.endpoint,driveId:n.driveId,itemId:O.id},O.root)for(U=Object(J.t)(E),k=0,M=U;k<M.length;k++)R=M[k],o.mapKeys({mappings:(N={},N[R]=this._rootItemKey,N)});else if(O.webUrl&&(P=Object(X.n)(O.webUrl))&&(T=Z.e.serialize({itemFullUrl:P}),e(Object(K.e)({spItemKey:V.e},T)).spItemKey))for(U=Object(J.t)(E),F=0,H=U;F<H.length;F++)R=H[F],o.mapKeys({mappings:(B={},B[R]=T,B)});O.root||(O.parentReference&&(w=O.parentReference.id),I.push({itemKey:Q.e.serialize(E),parentItemKey:w&&Q.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:w}),isDeleted:!!O.deleted,isShared:!!O.shared,name:O.name,dateModified:O.lastModifiedDateTime,eTag:O.eTag}))}return this._pendingRequest=!1,[2,{syncToken:D["@delta.token"],messages:I,itemResolver:o}]}})})},e.prototype.updateItems=function(e,t,n){},e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(K.e)({deleted:m.l},t.itemKey)).deleted)return;return{type:y.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var a=e(Object(K.e)({spItemKey:V.e,mediaTransformSchema:N.e,displayName:m.f},t.itemKey)),i=a.spItemKey,r=a.mediaTransformSchema,o=a.displayName;if(void 0===i){if(!t.parentItemKey)return;return{type:y.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(r&&t.eTag){var s=r[".etag"];if(s&&t.eTag&&t.eTag!==s)return{type:y.Update,invalidateKey:t.itemKey,invalidateFacet:N.e,reason:"eTag changed from ".concat(s," to ").concat(t.eTag)}}if(void 0!==t.name&&o!==t.name)return{type:y.Update,invalidateKey:t.itemKey,invalidateFacet:m.f,reason:"Name changed from ".concat(o," to ").concat(t.name)}},e}(),te=n(322),ne=n(44),ae=n(67),ie=n(1e3),re=n(51),oe=n(117),se=n(589),ce=function(){function e(e){this._dispatch=e.dispatch,this._webAbsoluteUrl=e.webAbsoluteUrl,this._listFullUrl=e.listFullUrl,this._listId=e.listId}return e.prototype.getSocketIoSubscription=function(e){return Object(d.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,l,f,p,m,_,h,b;return Object(d.__generator)(this,function(d){switch(d.label){case 0:return e.existingSubscription?[3,5]:(n=Object(se.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push"),[4,this._dispatch(Object(oe.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){})]);case 1:if(a=d.sent(),i=this._dispatch(Object(q.e)({isTest:L.A})).isTest,!(r=a&&a.d&&a.d.GetServiceUrls&&a.d.GetServiceUrls.results&&a.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(r="https://northcentralus0-pushs.svc.ms"),o="".concat(r,"/notifications/register"),s=re.e.generate(),c=this._dispatch(Object(u.e)({name:"SubscriptionServiceGenericList.Register"})),l={correlationId:s},d.label=2;case 2:return d.trys.push([2,4,,5]),[4,ie.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":s},requestTimeoutInMS:1e4})];case 3:if((f=d.sent())&&f.responseText&&f.responseText.length>0&&(p=JSON.parse(f.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl),void 0===t)throw new Error("Unable to retireve PushChannel notification url");return this._dispatch(c({resultType:ae.e.success,extraData:l})),[3,5];case 4:throw m=d.sent(),this._dispatch(c({resultType:ae.e.failure,extraData:l})),m;case 5:return _=Object(se.a)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId),e.existingSubscription?(_=_.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update"),t=e.existingSubscription.notificationUrl):_=_.segments("Subscriptions","Add"),h={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}},[4,this._dispatch(Object(oe.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:_.toString(),body:JSON.stringify(h),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((b=d.sent())&&b.d)return delete b.d.__metadata,e.existingSubscription&&(b.d.id=e.existingSubscription.id,b.d.notificationUrl=e.existingSubscription.notificationUrl,b.d.expirationDateTime=h.parameters.expirationDateTime),[2,b.d];throw new Error("Invalid subscription object")}})})},e.prototype.deleteSocketIoSubscription=function(e){var t=Object(se.a)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(oe.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))},e}(),de=n(375),le=n(43),ue=n(132),fe=n(376),pe=n(250),me="SPO_LIST,",_e=function(){function e(e){this._pushChannelService=e.pushChannelService,this._subscriptionService=e.subscriptionService,this._webAbsoluteUrl=e.webAbsoluteUrl,this._listFullUrl=e.listFullUrl,this._itemSetKey=e.itemSetKey,this._serverResponse=void 0,this._pendingRequest=!1}return e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof ce){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}},e.prototype.getSubscription=function(e){if(this._webAbsoluteUrl&&this._listFullUrl){var t=G.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),n=e(Object(W.e)(function(e){return e.demandItemFacet(j.Ze,t)}));if((null==n?void 0:n.notificationUrl)&&(null==n?void 0:n.expirationDateTime)&&(null==n?void 0:n.subscribeID))return{notificationUrl:null==n?void 0:n.notificationUrl,expirationDateTime:null==n?void 0:n.expirationDateTime,id:null==n?void 0:n.subscribeID}}},e.prototype.getChangeMessages=function(e,t,n){return Object(d.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c,l,u,f,p,m,h,b,v,y,S,D,I,x,C,O,w,E,A,k,M,P,T,U,F,H,R,N=this;return Object(d.__generator)(this,function(B){switch(B.label){case 0:if("latest"===t&&(n=G.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(W.e)(function(e){return e.demandItemFacet(j.We,n)})),i=null==a?void 0:a.lastItemModifiedTime))return r=new _.e,[2,{syncToken:"".concat(me).concat(i),messages:[],itemResolver:r}];if(this._pendingRequest=!0,c=!!t&&t.substr(0,9)===me)for(l=t.split(","),u=l[1],f='<Gt><FieldRef Name="Modified" />',f+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'.concat(u,"</Value>"),o=f+="</Gt>",s=["ID","FileRef","Modified","Title"],p=this._getListColumns(e),m=0,h=p;m<h.length;m++)"ID"!==(b=h[m]).internalName&&"FileRef"!==b.internalName&&"Modified"!==b.internalName&&"Title"!==b.internalName&&s.push(b.internalName);else{if(!g.t.isActivated("9e144a63-594c-45c9-8189-a4b0eb40e708","10/26/2021","Return empty messages and current time as sync token for initial sync"))return this._pendingRequest=!1,[2,{syncToken:"SPO_LIST,".concat((new Date).toISOString()),messages:[],itemResolver:new _.e}];s=["ID","FileRef","Modified"]}return v=c,y=c?200:1,S=new te.e("<View></View>"),o&&S.addFilters([o]),s&&S.replaceFields(s),S.updateSort({fieldName:"ID",isAscending:v}),S.updateRowLimit({rowLimit:y,isPerPage:!1}),D=e(Object(W.e)(function(e){return Object(le.e)(e,V.e.serialize({webAbsoluteUrl:N._webAbsoluteUrl,listFullUrl:N._listFullUrl}))})),[4,e(Object(q.e)({isTAB:L.A}))];case 1:return I=B.sent().isTAB,this._requestDatesInUtc=!D,[4,e(Object(de.e)({getItemContext:Object(d.__assign)(Object(d.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:S.getEffectiveViewXml()},I?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:D})}))];case 2:for(x=B.sent(),this._serverResponse=x,C=x.ListData,O=C&&C.Row||[],w=[],E=c?this._getLastModifiedTimeInList(O,D):(new Date).toISOString(),A=0,k=O;A<k.length;A++)if(void 0!==(M=k[A]).FileRef){for(P={},T=Object.keys(M),U=0,F=T;U<F.length;U++)H=F[U],R=0===H.indexOf("OData_")?H.substr(6):H,P[R]=M[H];w.push(Object(d.__assign)(Object(d.__assign)({itemKey:V.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:M.ID}),parentItemKey:V.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:M.Title||""},M.Modified?{dateModified:"".concat(M.Modified)}:{}),{fields:P}))}return 0===w.length&&w.push({itemKey:V.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1}),this._pendingRequest=!1,[2,{syncToken:"SPO_LIST,".concat(E),messages:w,itemResolver:new _.e}]}})})},e.prototype.hasPendingRequest=function(){return this._pendingRequest},e.prototype.updateItems=function(e,t){if(t&&s.e.matches(this._itemSetKey)&&this._serverResponse){var n=s.e.deserialize(this._itemSetKey),a={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(pe.n)({itemSetKey:a})),r=e(Object(pe.e)(n,i,"getSPItem")),o=e(Object(fe.t)({serverData:this._serverResponse,itemSetKey:a,contentTypes:i,currentPageContext:r.currentPageContext,isItemSetRequest:!1})).itemResolver;e(o.execute())}this._serverResponse=void 0},e.prototype.processMessage=function(e,t,n){var a=e(Object(W.e)(function(e){var a=Object(ue.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(V.e,t.itemKey)?{rowData:e.demandItemFacet(j.Bt,t.itemKey),spItemKey:e.demandItemFacet(V.e,t.itemKey),title:e.demandItemFacet(j.Mn,t.itemKey),selectedItemKeys:a}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:a}})),i=a.rowData,r=a.spItemKey,o=a.title,s=a.selectedItemKeys,c=s&&s.length>0;if(void 0===t.parentItemKey){if(c)return;return{type:y.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(K.e)({deleted:m.l},t.itemKey)).deleted||c)return;return{type:y.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===r||void 0===i){if(!t.parentItemKey)return;if(void 0===e(Object(K.e)({spParentItemKey:V.e},t.parentItemKey)).spParentItemKey)return;return c?void 0:{type:y.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==o&&void 0!==t.name&&o!==t.name)return{type:y.Update,invalidateKey:t.itemKey,invalidateFacet:j.Mn,hasSelection:c,reason:'Item title changed from "'.concat(o,'" to ').concat(t.name,")")};if(t.fields){c||(this._serverResponse=void 0);for(var d=this._getListColumns(e),l=function(e){for(var n=e.internalName,a=0,r=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});a<r.length;a++){var o=r[a],s=i&&i[o],d=t.fields[o];try{if("object"==typeof s&&(s=JSON.stringify(s)),"object"==typeof d&&(d=JSON.stringify(d)),u._requestDatesInUtc&&"DateTime"===e.fieldType){var l=Date.parse(s),f=Date.parse(d);isNaN(l)||isNaN(f)||(s=l,d=f)}}catch(e){continue}if(s!==d)return{value:{type:y.Update,invalidateKey:t.itemKey,invalidateFacet:j.Bt,hasSelection:c,reason:'Item field "'.concat(n,'" changed from "').concat(s,'" (').concat(typeof s,")")+' to "'.concat(d,'" (').concat(typeof d,")")}}}},u=this,f=0,p=d;f<p.length;f++){var _=l(p[f]);if("object"==typeof _)return _.value}}},e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var a=void 0,i=0,r=e;i<r.length;i++){var o=r[i];if(this._requestDatesInUtc){var s=o.Modified;s&&(d=new Date(s),(void 0===a||a<d)&&(a=d,n="".concat(s)))}else{var c=o["Modified."];if(c){var d=new Date(c),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-d.getTimezoneOffset():0;l&&d.setTime(d.getTime()+6e4*l),(void 0===a||a<d)&&(a=d,n=d.toISOString())}}}return n},e.prototype._getListColumns=function(e){var t=[],n=e(Object(K.e)({schema:p.o},this._itemSetKey)).schema,a=n&&n.columnKeys;if(a)for(var i=0,r=a;i<r.length;i++){var o=r[i],s=e(Object(K.e)({internalName:j.Ee,fieldType:j.me,mappedFieldType:j.$e},o)),c=s.internalName,d=s.fieldType,l=s.mappedFieldType;void 0!==c&&void 0!==d&&void 0!==l&&l!==ne.t.Title&&t.push({internalName:c,fieldType:d,mappedFieldType:l})}return t},e}(),he=n(237),be=n(273),ge=n(56),ve=n(24),ye=n(19),Se=n(217),De=n(230),Ie=n(184),xe=n(3738),Ce=function(){function e(e){this._connectionCallbacks={},this._notificationCallback=void 0,this._notificationId=void 0,this._siteId=e.siteId,this._listId=e.listId,this._isConnected=!1,this._client=e.dataSyncClient}return e.prototype.isConnected=function(){return this._isConnected},e.prototype.getSocketIoSubscription=function(){},e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t},e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]},e.prototype.setupNotificationHandler=function(e,t){return this._notificationCallback=t,!0},e.prototype.disconnect=function(){this._notificationCallback=void 0,this._connectionCallbacks={},this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId),this._isConnected=!1},e.prototype.refreshSubscription=function(){return Object(d.__awaiter)(this,void 0,void 0,function(){return Object(d.__generator)(this,function(e){return[2,!0]})})},e.prototype.connect=function(e,t){return Object(d.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,r;return Object(d.__generator)(this,function(o){switch(o.label){case 0:return t=(e=this)._client,n=e._siteId,a=e._listId,i={siteId:n,listId:a},[4,t.isListDataSyncEnabledAsync(i)];case 1:return o.sent()?(r=this,[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})]):[3,3];case 2:return r._notificationId=o.sent(),[2,!0];case 3:return[2,!1]}})})},e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===xe.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===xe.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}},e.prototype._notifyConnectionHandlers=function(e){for(var t in this._isConnected=e,this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)},e}(),Oe=n(220),we={ODB:860},Ee={ODB:818},Ae=new ve.e("itemAutoRefreshHelper",{itemsScopeItemKey:ye.e,spPageContextKey:ye.e}),Le=Object(be.e)(function(e){return{}});function ke(e){var t=e.spPageContextKey,n=e.pageContext,a=e.listId,i=e.webAbsoluteUrl,r=e.listFullUrl,o=e.isTAB,s=e.itemKey,c=e.driveUrl,d=e.itemsScopeItemKey,l=e.getDataSyncClient;return function(f){var p=f(Le),m=Ae.serialize({itemsScopeItemKey:d,spPageContextKey:t}),_=p[m];if(!_){var h,b=void 0,v=void 0,y=!n||!Object(g.a)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(l&&e.pushChannelService&&(y||e.subscriptionService))b=e.pushChannelService,v=e.subscriptionService;else{if(n){var S=f(E.e).dataRequestor;v=new k({listId:a,webAbsoluteUrl:i},{dataRequestor:S})}else v=new ce({dispatch:f,webAbsoluteUrl:i,listFullUrl:r,listId:a});b=new H({disableWebSockets:!0},{subscriptionService:v})}h=new _e({pushChannelService:b,subscriptionService:v,webAbsoluteUrl:i,listFullUrl:r,itemSetKey:s}),_=p[m]=new w({id:m,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:c,dispatch:f,template:h,itemsScopeItemKey:d,pushChannelService:b,logQoS:function(e){var t=f(Object(u.e)(e));return function(e){return f(t(e))}},onUnsubscribe:function(e){0===e&&delete p[m]}})}return _}}function Me(e){var t=Object(he.t)();return l.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,a=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(d.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(d.__generator)(this,function(s){switch(s.label){case 0:return t=void 0,r=void 0,(o=i&&n&&a&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:a,siteId:n.siteId})]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return o?(t=new Ce({listId:a,siteId:n.siteId,dataSyncClient:i}),r=void 0,[2,ke(Object(d.__assign)(Object(d.__assign)({},e),{subscriptionService:r,pushChannelService:t}))]):[2,ke(e)]}})})}):Promise.resolve(ke(e))})(e).then(function(e){var a=t(e);n(a.subscribe())})});return function(){n.then(function(e){return e()})}}return t(ke(e)).subscribe()},[]),null}function Pe(e){var t=Object(he.t)(),n=e.pageContext&&!Object(g.a)(e.pageContext).isActivated("ef32179a-abf3-45a4-83c0-aea05f141dff","10/06/2022","Checking if data sync enabled");return l.useLayoutEffect(function(){if(n){var a=t(function(e){var t=this,n=e.spPageContextKey,a=e.webAbsoluteUrl,i=e.listFullUrl,r=e.listId,o=e.isTAB,s=e.driveUrl,c=e.endpoint,l=e.itemsScopeItemKey,f=e.pageContext,p=e.getDataSyncClient;return function(e){var m=!1,_=Object(d.__awaiter)(t,void 0,void 0,function(){var t,_,h,b,g,v,y,S=this;return Object(d.__generator)(this,function(D){switch(D.label){case 0:return t=e(Le),_=Ae.serialize({itemsScopeItemKey:l,spPageContextKey:n}),(h=t[_])?[3,4]:(b=void 0,g=void 0,v=e(E.e).dataRequestor,g=new ee({dataRequestor:v,rootItemKey:V.e.serialize({webAbsoluteUrl:a,listFullUrl:i,rootFolder:""})}),p?[4,p]:[3,3]);case 1:return(y=D.sent())&&r&&f&&f.siteId?[4,y.isListDataSyncEnabledAsync({listId:r,siteId:f.siteId})]:[3,3];case 2:D.sent()&&!m&&(b=new Ce({listId:r,siteId:f.siteId,dataSyncClient:y})),D.label=3;case 3:b||(b=new H({disableWebSockets:!0},{subscriptionService:new k({},{dataRequestor:v}),sessionTokenFetcher:function(){return Object(d.__awaiter)(S,void 0,void 0,function(){var t,n,a;return Object(d.__generator)(this,function(i){switch(i.label){case 0:return(n=c)?[4,e(Object(A.getSessionToken)({endpoint:c,driveUrl:s}))]:[3,2];case 1:n=i.sent(),i.label=2;case 2:if(!(a=(t=n)&&t.accessToken))throw new $.e({code:"authFailure"});return[2,{accessToken:a,tokenUrl:s}]}})})}})),h=t[_]=new w({id:_,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:s,dispatch:e,itemsScopeItemKey:l,template:g,pushChannelService:b,logQoS:function(t){var n=e(Object(u.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){m=!0,0===e&&delete t[_]}}),D.label=4;case 4:return[2,h.subscribe()]}})});return function(){_.then(function(e){return e()})}}}(e));return function(){a()}}var i=t(function(e){var t=this,n=e.spPageContextKey,a=e.webAbsoluteUrl,i=e.listFullUrl,r=e.isTAB,o=e.driveUrl,s=e.endpoint,c=e.itemsScopeItemKey;return function(e){var l=e(Le),f=Ae.serialize({itemsScopeItemKey:c,spPageContextKey:n}),p=l[f];if(!p){var m,_,h=e(E.e).dataRequestor;_=new ee({dataRequestor:h,rootItemKey:V.e.serialize({webAbsoluteUrl:a,listFullUrl:i,rootFolder:""})}),m=new H({disableWebSockets:!0},{subscriptionService:new k({},{dataRequestor:h}),sessionTokenFetcher:function(){return Object(d.__awaiter)(t,void 0,void 0,function(){var t,n,a;return Object(d.__generator)(this,function(i){switch(i.label){case 0:return(n=s)?[4,e(Object(A.getSessionToken)({endpoint:s,driveUrl:o}))]:[3,2];case 1:n=i.sent(),i.label=2;case 2:if(!(a=(t=n)&&t.accessToken))throw new $.e({code:"authFailure"});return[2,{accessToken:a,tokenUrl:o}]}})})}}),p=l[f]=new w({id:f,isTestMode:r,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:c,template:_,pushChannelService:m,logQoS:function(t){var n=e(Object(u.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete l[f]}})}return p}}(e));return i.subscribe()},[]),null}function Te(e,t){var n,a=t.itemKey,i=t.itemSubscriber;if(!a)return{};var r=e.demandItem({key:s.e},a).key;if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var o=r.webAbsoluteUrl,c=r.listFullUrl,d=z.e.serialize({webAbsoluteUrl:o,listFullUrl:c}),u=e.demandItemFacet(j.Dn,d);if(!Object(B.e)(e,{feature:we,pageContext:u})||!Object(B.e)(e,{feature:Ee,pageContext:u}))return{};var p=G.e.serialize({webAbsoluteUrl:o,listFullUrl:c}),m=e.demandItem({listFacets:j.We,listMediaTransformSchema:N.n},p),_=m.listFacets,h=m.listMediaTransformSchema;if(!_||void 0===_.id||void 0===_.templateType)return{};var b=_.isDocumentLibrary,g=R.r(_.templateType);if(!b&&!g)return{};var y,S=Object(f.e)(e,{isTAB:L.A}).isTAB,D=h&&h[".driveUrl"],I=D&&Object(v.e)(D),x=I&&I.endpoint,C=Object(ge.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(b&&!D)return{};var O=Object(Oe._)(function(t){return Object(B.e)(e,{feature:t})},Oe.e.SharePointList)?null===(n=e.demandItemFacet(j.tn,Ie.e))||void 0===n?void 0:n.dataSyncClient:void 0,w=Object(Se.e)(e,{itemsScopeItemKey:C});if(w&&w.id===De.e.id)return{};if(b){if(!h)return{};if(!D)return{};if(S){var E=h[".driveAccessToken"];y=E&&E.replace("access_token=","")}if(!I)return{};var A=I.driveId;return x&&A?{itemSubscriber:l.createElement(l.Fragment,null,l.createElement(Pe,{spPageContextKey:d,driveUrl:D,isTAB:S,listFullUrl:c,listId:_.id,endpoint:x,driveAccessToken:y,webAbsoluteUrl:o,pageContext:u,itemsScopeItemKey:C,getDataSyncClient:O}),i)}:{}}return{itemSubscriber:l.createElement(l.Fragment,null,l.createElement(Me,{spPageContextKey:d,isTAB:S,itemKey:a,listFullUrl:c,webAbsoluteUrl:o,listId:_.id,pageContext:u,driveUrl:D,itemsScopeItemKey:C,getDataSyncClient:O}),i)}}var Ue=Object(r.t)(function(){return function(e){e(Object(o.e)(s.e,c.e)(Te))}})}],Array(18),[function(e,t,n){"use strict";n.r(t),n.d(t,"ReactRightPane",function(){return q});var a=n(0),i=n(65),r=n(181),o=n(114),s=n("react-lib"),c=n(1580),d=n(1674),l=n(466),u=n(204),f="mousemove",p="mouseup",m=function(e){function t(t){var n=e.call(this,t)||this;return n._start=0,n._onMouseDown=function(e){n._start=e.clientX,n._events.on(window,f,n._onMouseMove,!0),n._events.on(window,p,n._onMouseUp,!0)},n._events=new u.t(n),n}return Object(a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._events.dispose()},t.prototype.render=function(){return s.createElement("div",{className:"od-Resize",onMouseDown:this._onMouseDown},s.createElement("div",{className:"od-Resize-hitTarget"}))},t.prototype._onMouseUp=function(e){this._events.off(window,f,this._onMouseMove,!0),this._events.off(window,p,this._onMouseUp,!0),this._reportNewWidth(this._start,e.clientX,this.props.onDragEnd)},t.prototype._onMouseMove=function(e){e.stopPropagation(),e.preventDefault(),this._reportNewWidth(this._start,e.clientX,this.props.onDrag)},t.prototype._reportNewWidth=function(e,t,n){var a=(t-e)*(l.t.isRightToLeft?-1:1);a&&n&&n(a)},t}(s.PureComponent);function _(e){var t=e.isBeforeEdgeDraggable,n=void 0!==t&&t,i=e.isAfterEdgeDraggable,r=void 0!==i&&i,o=e.children,c=e.initialWidth,d=e.minWidth,l=void 0===d?0:d,f=e.maxWidth,p=void 0===f?Number.MAX_SAFE_INTEGER:f,_=e.onDrag,g=e.onDragEnd,v=e.className,y=e.setContainerStyle,S=s.useState(c),D=S[0],I=S[1],x=s.useState(c),C=x[0],O=x[1],w=function(e){e=Math.min(Math.max(e,l),p),D!==e&&I(e),_&&_(e)},E=function(e){e=Math.min(Math.max(e,l),p),C!==e&&O(e),u.t.raise(document.body,"resize",void 0,!0),g&&g(e)},A={onDrag:h(C,w),onDragEnd:h(C,E)},L={onDrag:b(C,w),onDragEnd:b(C,E)},k=y?y(D):{width:"".concat(D,"px")};return s.createElement("div",{className:v,style:k},n?s.createElement(m,Object(a.__assign)({},A)):null,o,r?s.createElement(m,Object(a.__assign)({},L)):null)}function h(e,t){return function(n){return t(e-n)}}function b(e,t){return function(n){return t(e+n)}}var g=n(1012),v=n(4908),y=n(320),S=n(871),D=n(330),I=n(1675),x=n(53),C=n(10),O=n(136),w=new C.t({name:"ReactColumnCustomizationPane.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e(619)]).then(n.bind(null,6012)).then(function(e){return e.reactResourceKey})})}),E=new C.t({name:"DetailsPaneWrapper.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(779)]).then(n.bind(null,5051)).then(function(e){return e.typeResourceKey})})}),A=new C.t({name:"ReactFiltersPane.key",loader:new O.t(function(){return Promise.all([n.e("odsp.react.lib"),n.e("ondemand.resx-ondemand"),n.e(792)]).then(n.bind(null,3328)).then(function(e){return e.typeResourceKey})})}),L=n(506),k=n(234),M=n(931);function P(e,t){var n=s.useMemo(function(){return{barrier:e.consumeAsync(k.e)}},[e]);return Object(M.e)(e,t,n)}var T=n(4422),U=n(4784),F=n(702),H=n(237);function R(e){var t=Object(x.n)(),n=e.paneControls,i=n.isRightPaneExpanded,r=n.isInfoPaneExpanded,o=n.isFiltersPaneExpanded,c=n.isColumnCustomizationPaneExpanded,d=Object(H.i)(function(e){return!Object(F.e)(e)},[]),l=Object(T.e)(t,d,!0).childResource,f=P(l,E),p=P(l,A),m=P(l,w),_=s.useMemo(function(){var e=function(){return s.createElement(s.Fragment,null)},t={};return i&&(r?e=f:o?e=p:c&&(e=m,t={onDismiss:function(){u.t.raise(document.body,"resize",void 0,!0);var e=l.consume(L.e.columnCustomizationPane.isColumnCustomizationPaneExpanded);e(!0),e(!1)},viewTypeLayoutMapping:U.n})),s.createElement("div",{className:"Files-rightPaneContent"},s.createElement(x.e,{resources:l},s.createElement(e,Object(a.__assign)({},t))))},[i,r,o,c]);return s.createElement(s.Fragment,null,_)}var N=n(118),B=n(228),j=n(755),V="isFiltersPaneExpanded",z="isInfoPaneExpanded",G="rightPaneWidth",K=320,W=function(e){function t(t){var n=e.call(this,t)||this;n._onDragEnd=function(e){n._userSettingsStore.setValue(G,e)},n._resources=t.resources,n._scope=new g.e,n._userSettingsStore=n._resources.consume(S.n);var a=n._userSettingsStore.getValue(G);return n._initialWidth=Math.max(a,K)||K,n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return this._scope.trackPromise(i.n.resolve(this._resources.consumeAsync(I.e))).then(function(t){e._observables=e._scope.attach(new t({owner:e})),Object(N.n)()||(e._initializeShowPropertiesPaneForDocumentSetItems(),e._resources.consume(r.e).isIE||e._initializeAndSubscribeRightPaneVisibility())}),[2]})})},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t.prototype.render=function(){var e=this.props,t=(e.responsiveUIMetrics,Object(a.__rest)(e,["responsiveUIMetrics"])),n=t.paneControls.isColumnCustomizationPaneExpanded?K:0,i=document.getElementsByClassName("Files-rightPaneInteractionContainer"),r=i&&i.length>0?i[0].getBoundingClientRect().width:window.innerWidth,o={className:"Files-rightPane",isBeforeEdgeDraggable:!0,initialWidth:this._initialWidth,minWidth:n,maxWidth:r,setContainerStyle:this._getRightPaneStyle.bind(this),onDragEnd:this._onDragEnd.bind(this)};return s.createElement(_,Object(a.__assign)({},o),s.createElement(R,Object(a.__assign)({},t)))},t.prototype._getRightPaneStyle=function(e,t){void 0===t&&(t=this.props);var n=t.responsiveUIMetrics.formFactorSize,a=t.paneControls,i=a.isRightPaneExpanded,r=a.isColumnCustomizationPaneExpanded,o="";if(i)if("Small"===n)o="100%";else{var s=r?K:0;e=Math.max(e,s),o="".concat(e,"px")}return{width:o,display:i?"block":"none"}},t.prototype._initializeShowPropertiesPaneForDocumentSetItems=function(){var e=this,t=this._resources.consume(y.o),a=this._observables.pureCompute(function(){return!!t&&!!t().isDocSet}),i=this._resources.consume(y.e);Promise.resolve().then(n.bind(null,1002)).then(function(t){var n;e._observables.backgroundCompute(function(){e._teachingBubbleCampaign=t;var r=e._teachingBubbleCampaign.DOCSET_PROPERTIES_PANE;a()?(n||(n=new(e._resources.injected(i.ShowPropertiesAction))({useToggleBehavior:!1})),n.isAvailable.peek()?(n.execute(null),e._resources.consumeAsync(v.e.optional).then(function(t){e._coachmarkProvider=t,n.execute(null).then(function(){t&&t.currentCampaign.peek()!==r&&t.setCampaign(r)})})):n.isAvailable()):e._coachmarkProvider&&e._coachmarkProvider.currentCampaign.peek()===r&&e._coachmarkProvider.hideCampaign()})})},t.prototype._initializeAndSubscribeRightPaneVisibility=function(){var e=this._observables,t=this._resources,n=this._scope,a=this._userSettingsStore;i.n.all({isDetailsPaneExpanded:t.consumeAsync(c.e),isFiltersPaneExpanded:t.consumeAsync(d.e)}).then(function(t){var i=t.isDetailsPaneExpanded,r=t.isFiltersPaneExpanded;n.isDisposed||(a.getValue(V)&&r(!0),e.subscribe(r,function(e){a.setValue(V,e)})),!a.getValue("NoAutoInfoPane",o.e.session)&&i&&(a.getValue(z)&&i(!0),e.subscribe(i,function(e){a.setValue(z,e)}))})},t}(s.PureComponent),q=Object(D.n)([D.e.paneControls,D.e.responsiveUIMetrics])(Object(x.i)()(Object(B.n)(j.e)(W)));t.default=q},,function(e,t,n){"use strict";n.d(t,"e",function(){return K});var a,i=n(895),r=n(425),o=n(1857),s=n(71),c=n(149),d=n(419),l=n(558),u=Object(c.t)(function(){return Object(r.e)({"0%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"78.57%":{transform:"translate(0, 0)",animationTimingFunction:"cubic-bezier(0.62, 0, 0.56, 1)"},"82.14%":{transform:"translate(0, -5px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0, 1)"},"84.88%":{transform:"translate(0, 9px)",animationTimingFunction:"cubic-bezier(1, 0, 0.56, 1)"},"88.1%":{transform:"translate(0, -2px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0.67, 1)"},"90.12%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"100%":{transform:"translate(0, 0)"}})}),f=Object(c.t)(function(){return Object(r.e)({"0%":{transform:" scale(0)",animationTimingFunction:"linear"},"14.29%":{transform:"scale(0)",animationTimingFunction:"cubic-bezier(0.84, 0, 0.52, 0.99)"},"16.67%":{transform:"scale(1.15)",animationTimingFunction:"cubic-bezier(0.48, -0.01, 0.52, 1.01)"},"19.05%":{transform:"scale(0.95)",animationTimingFunction:"cubic-bezier(0.48, 0.02, 0.52, 0.98)"},"21.43%":{transform:"scale(1)",animationTimingFunction:"linear"},"42.86%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"45.71%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"50%":{transform:"scale(1)",animationTimingFunction:"linear"},"90.12%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"92.98%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"97.26%":{transform:"scale(1)",animationTimingFunction:"linear"},"100%":{transform:"scale(1)"}})}),p=Object(c.t)(function(){return Object(r.e)({"0%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"83.33%":{transform:" rotate(0deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"83.93%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"84.52%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.12%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.71%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"86.31%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"100%":{transform:"rotate(0deg)"}})}),m=n(4),_=n("react-lib"),h=n(494),b=n(134),g=n(128),v=n(630),y=n(193),S=n(671),D=n(1353),I=n(1227),x=n(251),C=n(427),O=n(102),w=n(2136),E=n(1196),A=n(360),L=Object(c.t)(function(){var e;return Object(E.t)({root:[{position:"absolute",boxSizing:"border-box",border:"1px solid ${}",selectors:(e={},e[s.e]={border:"1px solid WindowText"},e)},Object(A.e)()],container:{position:"relative"},main:{backgroundColor:"#ffffff",overflowX:"hidden",overflowY:"hidden",position:"relative"},overFlowYHidden:{overflowY:"hidden"}})}),k=n(1894),M=n(164),P=n(195),T=n(123),U=n(1882),F=n(835),H={opacity:0},R=((a={})[O.t.top]="slideUpIn20",a[O.t.bottom]="slideDownIn20",a[O.t.left]="slideLeftIn20",a[O.t.right]="slideRightIn20",a),N=function(e){function t(t){var n=e.call(this,t)||this;return n._positionedHost=_.createRef(),n._contentHost=_.createRef(),n.dismiss=function(e){n.onResize(e)},n.onResize=function(e){var t=n.props.onDismiss;t?t(e):n._updateAsyncPosition()},n._setInitialFocus=function(){n._contentHost.current&&n.props.setInitialFocus&&!n._didSetInitialFocus&&n.state.positions&&(n._didSetInitialFocus=!0,Object(g.n)(n._contentHost.current))},n._onComponentDidMount=function(){n._async.setTimeout(function(){n._events.on(n._targetWindow,"scroll",n._async.throttle(n._dismissOnScroll,10),!0),n._events.on(n._targetWindow,"resize",n._async.throttle(n.onResize,10),!0),n._events.on(n._targetWindow.document.body,"focus",n._dismissOnLostFocus,!0),n._events.on(n._targetWindow.document.body,"click",n._dismissOnLostFocus,!0)},0),n.props.onLayerMounted&&n.props.onLayerMounted(),n._updateAsyncPosition(),n._setHeightOffsetEveryFrame()},Object(S.e)(n),n._async=new v.e(n),n._events=new y.e(n),n._didSetInitialFocus=!1,n.state={positions:void 0,heightOffset:0},n._positionAttempts=0,n}return Object(m.a)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._setTargetWindowAndElement(this._getTarget())},t.prototype.componentDidMount=function(){this._onComponentDidMount()},t.prototype.componentDidUpdate=function(){this._setInitialFocus(),this._updateAsyncPosition()},t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this._getTarget(e);(t!==this._getTarget()||"string"==typeof t||t instanceof String)&&(this._maxHeight=void 0,this._setTargetWindowAndElement(t)),e.offsetFromTarget!==this.props.offsetFromTarget&&(this._maxHeight=void 0),e.finalHeight!==this.props.finalHeight&&this._setHeightOffsetEveryFrame()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){if(!this._targetWindow)return null;var e=this.props,t=e.className,n=e.positioningContainerWidth,a=e.positioningContainerMaxHeight,i=e.children,r=this.state.positions,o=L(),s=r&&r.targetEdge?U.e[R[r.targetEdge]]:"",c=this._getMaxHeight()+this.state.heightOffset,d=a&&a>c?c:a,l=_.createElement("div",{ref:this._positionedHost,className:Object(P.e)("ms-PositioningContainer",o.container)},_.createElement("div",{className:Object(F.t)("ms-PositioningContainer-layerHost",o.root,t,s,!!n&&{width:n}),style:r?r.elementPosition:H,tabIndex:-1,ref:this._contentHost},i,d));return this.props.doNotLayer?l:_.createElement(k.e,null,l)},t.prototype._dismissOnScroll=function(e){var t=this.props.preventDismissOnScroll;this.state.positions&&!t&&this._dismissOnLostFocus(e)},t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._positionedHost.current&&!Object(C.e)(this._positionedHost.current,t);(!this._target&&n||e.target!==this._targetWindow&&n&&(this._target.stopPropagation||!this._target||t!==this._target&&!Object(C.e)(this._target,t)))&&this.onResize(e)},t.prototype._updateAsyncPosition=function(){var e=this;this._async.requestAnimationFrame(function(){return e._updatePosition()})},t.prototype._updatePosition=function(){var e=this.state.positions,t=this.props,n=t.offsetFromTarget,a=t.onPositioned,i=this._positionedHost.current,r=this._contentHost.current;if(i&&r){var o=Object(m.e)({},this.props);if(o.bounds=this._getBounds(),o.target=this._target,document.body.contains(o.target)){o.gapSpace=n;var s=Object(w.r)(o,i,r);!e&&s||e&&s&&!this._arePositionsEqual(e,s)&&this._positionAttempts<5?(this._positionAttempts++,this.setState({positions:s},function(){a&&a(s)})):(this._positionAttempts=0,a&&a(s))}else void 0!==e&&this.setState({positions:void 0})}},t.prototype._getBounds=function(){if(!this._positioningBounds){var e=this.props.bounds;e||(e={top:0+this.props.minPagePadding,left:0+this.props.minPagePadding,right:this._targetWindow.innerWidth-this.props.minPagePadding,bottom:this._targetWindow.innerHeight-this.props.minPagePadding,width:this._targetWindow.innerWidth-2*this.props.minPagePadding,height:this._targetWindow.innerHeight-2*this.props.minPagePadding}),this._positioningBounds=e}return this._positioningBounds},t.prototype._getMaxHeight=function(){var e=this.props,t=e.directionalHintFixed,n=e.offsetFromTarget,a=e.directionalHint;if(!this._maxHeight)if(t&&this._target){var i=n||0;this._maxHeight=Object(w.t)(this._target,a,i,this._getBounds())}else this._maxHeight=this._getBounds().height-2;return this._maxHeight},t.prototype._arePositionsEqual=function(e,t){return this._comparePositions(e.elementPosition,t.elementPosition)},t.prototype._comparePositions=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var a=e[n],i=t[n];if(a&&i&&a.toFixed(2)!==i.toFixed(2))return!1}return!0},t.prototype._setTargetWindowAndElement=function(e){var t=this._positionedHost.current;if(e)if("string"==typeof e){var n=Object(x.e)();this._target=n?n.querySelector(e):null,this._targetWindow=Object(T.e)(t)}else if(e.stopPropagation)this._targetWindow=Object(T.e)(e.target),this._target=e;else if(void 0===e.left&&void 0===e.x||void 0===e.top&&void 0===e.y){var a=e;this._targetWindow=Object(T.e)(a),this._target=e}else this._targetWindow=Object(T.e)(t),this._target=e;else this._targetWindow=Object(T.e)(t)},t.prototype._setHeightOffsetEveryFrame=function(){var e=this;this._contentHost&&this.props.finalHeight&&(this._setHeightOffsetTimer=this._async.requestAnimationFrame(function(){if(e._contentHost.current){var t=e._contentHost.current.lastChild,n=t.scrollHeight-t.offsetHeight;e.setState({heightOffset:e.state.heightOffset+n}),t.offsetHeight<e.props.finalHeight?e._setHeightOffsetEveryFrame():e._async.cancelAnimationFrame(e._setHeightOffsetTimer)}}))},t.prototype._getTarget=function(e){return void 0===e&&(e=this.props),e.target},t.defaultProps={preventDismissOnScroll:!1,offsetFromTarget:0,minPagePadding:8,directionalHint:M.e.bottomAutoEdge},t}(_.Component);function B(e){var t;return{root:[{position:"absolute",boxShadow:"inherit",border:"none",boxSizing:"border-box",transform:e.transform,width:e.width,height:e.height,left:e.left,top:e.top,right:e.right,bottom:e.bottom}],beak:{fill:e.color,display:"block",selectors:(t={},t[s.e]={fill:"windowtext"},t)}}}var j=function(e){function t(t){var n=e.call(this,t)||this;return Object(S.e)(n),n}return Object(m.a)(t,e),t.prototype.render=function(){var e,t,n,a,i,r,o=this.props,s=o.left,c=o.top,d=o.bottom,l=o.right,u=o.color,f=o.direction,p=void 0===f?O.t.top:f;switch(p===O.t.top||p===O.t.bottom?(e=10,t=18):(e=18,t=10),p){case O.t.top:default:n="9, 0",a="18, 10",i="0, 10",r="translateY(-100%)";break;case O.t.right:n="0, 0",a="10, 10",i="0, 18",r="translateX(100%)";break;case O.t.bottom:n="0, 0",a="18, 0",i="9, 10",r="translateY(100%)";break;case O.t.left:n="10, 0",a="0, 10",i="10, 18",r="translateX(-100%)"}var m=Object(h.e)()(B,{left:s,top:c,bottom:d,right:l,height:e+"px",width:t+"px",transform:r,color:u});return _.createElement("div",{className:m.root,role:"presentation"},_.createElement("svg",{height:e,width:t,className:m.beak},_.createElement("polygon",{points:n+" "+a+" "+i})))},t}(_.Component),V=n(2158),z=Object(h.e)(),G=function(e){function t(t){var n=e.call(this,t)||this;return n._entityHost=_.createRef(),n._entityInnerHostElement=_.createRef(),n._translateAnimationContainer=_.createRef(),n._ariaAlertContainer=_.createRef(),n._childrenContainer=_.createRef(),n._positioningContainer=_.createRef(),n.dismiss=function(e){var t=n.props.onDismiss;t&&t(e)},n._onKeyDown=function(e){(e.altKey&&e.which===b.e.c||e.which===b.e.enter&&n._translateAnimationContainer.current&&n._translateAnimationContainer.current.contains(e.target))&&n._onFocusHandler()},n._onFocusHandler=function(){n.state.isCollapsed&&n._openCoachmark()},n._onPositioned=function(e){n._async.requestAnimationFrame(function(){n.setState({targetAlignment:e.alignmentEdge,targetPosition:e.targetEdge})})},n._setBeakPosition=function(){var e,t,a,i,r,o,s=n.state.targetAlignment,c="3px";switch(n._beakDirection){case O.t.top:case O.t.bottom:s?s===O.t.left?(e="7px",r="left"):(a="7px",r="right"):(e="calc(50% - 9px)",r="center"),n._beakDirection===O.t.top?(t=c,o="top"):(i=c,o="bottom");break;case O.t.left:case O.t.right:s?s===O.t.top?(t="7px",o="top"):(i="7px",o="bottom"):(t="calc(50% - 9px)",o="center"),n._beakDirection===O.t.left?(Object(d.e)(n.props.theme)?a=c:e=c,r="left"):(Object(d.e)(n.props.theme)?e=c:a=c,r="right")}n.setState({beakLeft:e,beakRight:a,beakBottom:i,beakTop:t,transformOrigin:r+" "+o})},n._openCoachmark=function(){n.setState({isCollapsed:!1}),n.props.onAnimationOpenStart&&n.props.onAnimationOpenStart(),n._entityInnerHostElement.current&&n._entityInnerHostElement.current.addEventListener("transitionend",function(){n._async.setTimeout(function(){n._entityInnerHostElement.current&&Object(g.n)(n._entityInnerHostElement.current)},1e3),n.props.onAnimationOpenEnd&&n.props.onAnimationOpenEnd()})},n._async=new v.e(n),n._events=new y.e(n),Object(S.e)(n),Object(D.e)("Coachmark",t,{teachingBubbleRef:void 0,collapsed:"isCollapsed",beakWidth:void 0,beakHeight:void 0,width:void 0,height:void 0}),n.state={isCollapsed:t.isCollapsed,isBeaconAnimating:!0,isMeasuring:!0,entityInnerHostRect:{width:0,height:0},isMouseInProximity:!1,isMeasured:!1},n}return Object(m.a)(t,e),Object.defineProperty(t.prototype,"_beakDirection",{get:function(){var e=this.state.targetPosition;return void 0===e?O.t.bottom:Object(w.n)(e)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.beaconColorOne,n=e.beaconColorTwo,a=e.children,i=e.target,r=e.color,o=e.positioningContainerProps,s=e.ariaDescribedBy,c=e.ariaDescribedByText,d=e.ariaLabelledBy,l=e.ariaLabelledByText,u=e.ariaAlertText,f=e.delayBeforeCoachmarkAnimation,p=e.styles,h=e.theme,b=e.className,g=e.persistentBeak,v=this.state,y=v.beakLeft,S=v.beakTop,D=v.beakRight,I=v.beakBottom,x=v.isCollapsed,C=v.isBeaconAnimating,O=v.isMeasuring,w=v.entityInnerHostRect,E=v.transformOrigin,A=v.alertText,L=v.isMeasured,k=r;!k&&h&&(k=h.semanticColors.primaryButtonBackground);var M=z(p,{theme:h,beaconColorOne:t,beaconColorTwo:n,className:b,isCollapsed:x,isBeaconAnimating:C,isMeasuring:O,color:k,transformOrigin:E,isMeasured:L,entityHostHeight:w.height+"px",entityHostWidth:w.width+"px",width:"32px",height:"32px",delayBeforeCoachmarkAnimation:f+"ms"}),P=x?32:w.height;return _.createElement(N,Object(m.e)({target:i,offsetFromTarget:10,componentRef:this._positioningContainer,finalHeight:P,onPositioned:this._onPositioned,bounds:this._getBounds()},o),_.createElement("div",{className:M.root},u&&_.createElement("div",{className:M.ariaContainer,role:"alert",ref:this._ariaAlertContainer,"aria-hidden":!x},A),_.createElement("div",{className:M.pulsingBeacon}),_.createElement("div",{className:M.translateAnimationContainer,ref:this._translateAnimationContainer},_.createElement("div",{className:M.scaleAnimationLayer},_.createElement("div",{className:M.rotateAnimationLayer},this._positioningContainer.current&&(x||g)&&_.createElement(j,{left:y,top:S,right:D,bottom:I,direction:this._beakDirection,color:k}),_.createElement("div",{className:M.entityHost,ref:this._entityHost,tabIndex:-1,"data-is-focusable":!0,role:"dialog","aria-labelledby":d,"aria-describedby":s},x&&[d&&_.createElement("p",{id:d,key:0,className:M.ariaContainer},l),s&&_.createElement("p",{id:s,key:1,className:M.ariaContainer},c)],_.createElement(V.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},_.createElement("div",{className:M.entityInnerHost,ref:this._entityInnerHostElement},_.createElement("div",{className:M.childrenContainer,ref:this._childrenContainer,"aria-hidden":x},a)))))))))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isCollapsed&&!e.isCollapsed&&this._openCoachmark()},t.prototype.shouldComponentUpdate=function(e,t){return!Object(I.n)(e,this.props)||!Object(I.n)(t,this.state)},t.prototype.componentDidUpdate=function(e,t){t.targetAlignment===this.state.targetAlignment&&t.targetPosition===this.state.targetPosition||this._setBeakPosition(),e.preventDismissOnLostFocus!==this.props.preventDismissOnLostFocus&&this._addListeners()},t.prototype.componentDidMount=function(){var e=this;this._async.requestAnimationFrame(function(){e._entityInnerHostElement.current&&e.state.entityInnerHostRect.width+e.state.entityInnerHostRect.width===0&&(e.setState({isMeasuring:!1,entityInnerHostRect:{width:e._entityInnerHostElement.current.offsetWidth,height:e._entityInnerHostElement.current.offsetHeight},isMeasured:!0}),e._setBeakPosition(),e.forceUpdate()),e._addListeners(),e._async.setTimeout(function(){e._addProximityHandler(e.props.mouseProximityOffset)},e.props.delayBeforeMouseOpen),e.props.ariaAlertText&&e._async.setTimeout(function(){e.props.ariaAlertText&&e._ariaAlertContainer.current&&e.setState({alertText:e.props.ariaAlertText})},0),e.props.preventFocusOnMount||e._async.setTimeout(function(){e._entityHost.current&&e._entityHost.current.focus()},1e3)})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype._addListeners=function(){var e=this.props.preventDismissOnLostFocus,t=Object(x.e)();this._events.off(),t&&(this._events.on(t,"keydown",this._onKeyDown,!0),e||(this._events.on(t,"click",this._dismissOnLostFocus,!0),this._events.on(t,"focus",this._dismissOnLostFocus,!0)))},t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._translateAnimationContainer.current&&!Object(C.e)(this._translateAnimationContainer.current,t),a=this.props.target;n&&t!==a&&!Object(C.e)(a,t)&&this.dismiss(e)},t.prototype._getBounds=function(){var e=this.props,t=e.isPositionForced,n=e.positioningContainerProps;return t?!n||n.directionalHint!==M.e.topAutoEdge&&n.directionalHint!==M.e.bottomAutoEdge?{left:-1/0,top:-1/0,bottom:1/0,right:1/0,width:1/0,height:1/0}:{left:0,top:-1/0,bottom:1/0,right:window.innerWidth,width:window.innerWidth,height:1/0}:void 0},t.prototype._addProximityHandler=function(e){var t=this;void 0===e&&(e=0);var n=[];this._async.setTimeout(function(){t._setTargetElementRect(),t._events.on(window,"resize",function(){n.forEach(function(e){clearInterval(e)}),n.push(t._async.setTimeout(function(){t._setTargetElementRect()},100))})},10),this._events.on(document,"mousemove",function(n){if(t.state.isCollapsed){var a=n.clientY,i=n.clientX;t._setTargetElementRect(),t._isInsideElement(i,a,e)!==t.state.isMouseInProximity&&t._openCoachmark()}t.props.onMouseMove&&t.props.onMouseMove(n)})},t.prototype._setTargetElementRect=function(){this._translateAnimationContainer&&this._translateAnimationContainer.current&&(this._targetElementRect=this._translateAnimationContainer.current.getBoundingClientRect())},t.prototype._isInsideElement=function(e,t,n){return void 0===n&&(n=0),e>this._targetElementRect.left-n&&e<this._targetElementRect.left+this._targetElementRect.width+n&&t>this._targetElementRect.top-n&&t<this._targetElementRect.top+this._targetElementRect.height+n},t.defaultProps={isCollapsed:!0,mouseProximityOffset:10,delayBeforeMouseOpen:3600,delayBeforeCoachmarkAnimation:0,isPositionForced:!0,positioningContainerProps:{directionalHint:M.e.bottomAutoEdge}},t}(_.Component),K=Object(i.e)(G,function(e){var t,n=e.theme,a=e.className,i=e.color,r=e.beaconColorOne,c=e.beaconColorTwo,m=e.delayBeforeCoachmarkAnimation,_=e.isCollapsed,h=e.isBeaconAnimating,b=e.isMeasuring,g=e.isMeasured,v=e.entityHostHeight,y=e.entityHostWidth,S=e.transformOrigin;if(!n)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var D=o.e.continuousPulseAnimationDouble(r||n.palette.themePrimary,c||n.palette.themeTertiary,"35px","150px","10px"),I=o.e.createDefaultAnimation(D,m);return{root:[n.fonts.medium,{position:"relative"},a],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:Object(d.e)(n)?"translate(50%, -50%)":"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:"0"},_&&h&&I],translateAnimationContainer:[{width:"100%",height:"100%"},_&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:u(),transition:"opacity 0.5s ease-in-out"},!_&&{opacity:"1"}],scaleAnimationLayer:[{width:"100%",height:"100%"},_&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:f()}],rotateAnimationLayer:[{width:"100%",height:"100%"},_&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:p()},!_&&{opacity:"1"}],entityHost:[{position:"relative",outline:"none",overflow:"hidden",backgroundColor:i,borderRadius:32,transition:"border-radius 250ms, width 500ms, height 500ms cubic-bezier(0.5, 0, 0, 1)",visibility:"hidden",selectors:(t={},t[s.e]={backgroundColor:"Window",border:"2px solid WindowText"},t["."+l.e+" &:focus"]={outline:"1px solid "+n.palette.themeTertiary},t)},!b&&{width:32,height:32,visibility:"visible"},!_&&{borderRadius:"1px",opacity:"1",width:y,height:v}],entityInnerHost:[{transition:"transform 500ms cubic-bezier(0.5, 0, 0, 1)",transformOrigin:S,transform:"scale(0)"},!_&&{width:y,height:v,transform:"scale(1)"},!b&&{visibility:"visible"}],childrenContainer:[{display:g&&_?"none":"block"}],ariaContainer:{position:"fixed",opacity:0,height:0,width:0,pointerEvents:"none"}}},void 0,{scope:"Coachmark"})}],Array(35),[function(e,t,n){"use strict";n.r(t),n.d(t,"ListStateButton",function(){return H});var a,i=n(0),r=n("react-lib"),o=n(195),s=n(496),c=n(57),d=n(14),l=n(3738),u=n(118),f=n(43),p=n(13),m=n(4858),_=n(4859),h=n(3635),b=n(402),g=n(5252),v=n(12),y=n(186),S=n(220),D=v.e.isActivated("a1e27a11-c66b-4075-8a25-97a3cf4c98eb","09/21/2021"),I=v.e.isActivated("551a010b-a9f6-4ade-b579-ce0acf4a7040","07/01/2022"),x=D?void 0:Object(p.n)()(Object(c.t)(function(e,t){var n=e.demandItemFacet(m.e,t.itemKey);return m.e.evaluate(n)(e,{itemKey:t.itemKey}).action})),C=Object(c.t)(function(e,t){var n=e.demandItemFacet(_.e,t.itemKey);return _.e.evaluate(n)(e,{itemKey:t.itemKey}).action}),O=((a={})[l.e.InSync]={iconProps:{toolTip:g.i,icon:"Completed"}},a[l.e.ChangesSaved]={iconProps:{toolTip:g.t,icon:"SavedOffline"}},a[l.e.Syncing]={iconProps:{toolTip:g.c,icon:"SyncStatus"}},a[l.e.Attention]={iconProps:{toolTip:g.e,icon:"Error"},action:Object(y.t)(S.a)?C:void 0},a[l.e.SyncConflict]={iconProps:{toolTip:g.s,icon:"CriticalErrorSolid",alertMessage:g.n},action:D?void 0:x},a[l.e.SettingUp]={iconProps:{toolTip:g.r,icon:"SyncStatus"}},a[l.e.Unsupported]={iconProps:{toolTip:g.d,icon:"UnavailableOffline"}},a),w=n(184),E=n(1),A=n(211),L=v.e.isActivated("aef6aeca-7688-47e7-abdc-e62a9db1c764","10/28/2021");function k(e){var t=e.getDataSyncClient,n=e.listId,a=e.siteId,i=e.locale,o=Object(r.useState)(),s=o[0],c=o[1];return Object(r.useEffect)(function(){var e=!1,r=t.then(function(t){if(t){var r=function(){var r=t.addListStatusCallbackAsync(function(t){if(!e&&t&&t.length>0){var n={syncStatus:t[0],locale:i};c(n)}},{listId:n,siteId:a});return function(){return r.then(function(e){return t.removeListStatusCallback(e)})}};return L?t.isListDataSyncEnabledAsync({listId:n,siteId:a}).then(function(e){if(e)return r()}):r()}});return function(){e=!0,r.then(function(e){e&&e()})}},[t,e,n,a]),Object(A.t)(e.children,s)}var M=Object(p.n)()(Object(c.t)(function(e,t){var n,a=Object(f.e)(e,t.itemKey);if(!a||a.listBaseType!==d.e.GenericList||!a.listId||!a.siteId)return null;var i=null===(n=e.demandItemFacet(E.tn,w.e))||void 0===n?void 0:n.dataSyncClient;return i?r.createElement(k,{getDataSyncClient:i,listId:a.listId,siteId:a.siteId,itemKey:t.itemKey,locale:null==a?void 0:a.currentCultureName},t.children):null})),P=n(21),T=n(2147),U=n(15);function F(e){var t,n;(null===(t=e.statusAndLocale)||void 0===t?void 0:t.syncStatus)&&(n=e.statusAndLocale.syncStatus.state);var a=Object(T.e)(n);if(!e.statusAndLocale||!e.statusAndLocale.syncStatus)return null;var i=function(e,t,n){if(e){var a=O[e.state];if(!I&&e.state===l.e.InSync&&t&&n){var i=new Date(1e3*t),r=Object(b.n)(i,n);a.iconProps.toolTip=h.e.format(g.a,r)}else Object(y.t)(S.a)&&e.state===l.e.Attention&&e.userCredentialsNeeded&&(a.iconProps.toolTip=g.o);return a}}(e.statusAndLocale.syncStatus,e.statusAndLocale.syncStatus.lastSyncTime,e.statusAndLocale.locale);if(!i)return null;var c=!U.t.isActivated("1306a639-3a80-4073-859c-728214fa6c55","12/15/2021")&&a&&a!==e.statusAndLocale.syncStatus.state&&e.statusAndLocale.syncStatus.state===l.e.SyncConflict,d=i.iconProps,u=function(t){return r.createElement("div",{className:Object(o.e)("od-ListState-button",{insideBreadcrumb:!!e.insideBreadcrumb,isSPList:!e.isWebViewHostedList,isErrorStatus:!!t})},r.createElement(s.e,{id:"LIST_STATE_BUTTON",className:Object(o.e)("od-ListState-icon",{isListHome:e.isWebViewHostedList,hasAction:!!t}),iconName:d.icon,"data-automationid":"od-ListState-icon",onClick:t?function(){return t()}:void 0,title:i.iconProps.toolTip}),c&&r.createElement("div",{role:"alert","aria-live":"assertive","aria-label":d.alertMessage}))};return i.action?r.createElement(P.n,{action:i.action},function(e){var t=e.execute;return u(t)}):u()}var H=Object(c.t)(function(e,t){var n=Object(f.e)(e,t.itemKey);return(null==n?void 0:n.listBaseType)===d.e.GenericList?r.createElement(M,null,function(e){return r.createElement(F,Object(i.__assign)({},t,{statusAndLocale:e,isWebViewHostedList:Object(u.i)(n)}))}):null})},,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return I});var a=n(181),i=n(10),r=(n(2852),n(1321)),o=n(922),s=n(14),c=n(38),d=n(1973),l=n(146),u=n(204),f=n(170),p=n(136),m=n(4903),_=new i.t({name:"FloodgateDataSource.key",loader:new p.t(function(){return Promise.resolve().then(n.bind(null,5955)).then(function(e){return e.resourceKey})})}),h=n(2626),b=n(100),g=n(4543),v=n(1217),y=n(5239),S=n(90),D=n(118),I=new i.t({name:"BaseDeferredSetupTasks",factory:new i.e({loadDeferredResources:function(e){!function(e){var t=e.consume(h.resourceKey);t.ensureListContextUpdateSignal().getPromise().then(function(){t.hasPowerAppsForm(!1).then(function(e){e&&t.ensurePowerAppSdkPreloaded()})})}(e),function(e){if(!Object(S.c)()&&!Object(S.s)()){var t=2144,n=e.consume(c.f);Object(D.i)(n)&&(t=2454),e.expose(g.e,t),e.exposeFactory(b._,new p.e(_)),e.consumeAsync(b._).then(function(t){var n=e.consume(l.e);t.processViewParams(n.viewParams)})}}(e)},setupDeferredComponents:function(e,t){if(function(e,t){var n=new u.e({});t.attach(n),n.on(document.body,"keyup",function(t){m.e.isOpenDebugWindowEvent(t)?m.e.init(e):m.e.isOpenSimplePerfDashboardEvent(t)&&m.e.initSimplePerfDashboard(e)}),m.e.enableAutoOpen(e)}(e,t),function(e){var t=e.consume(c.f),n=Object(s.i)(t.listBaseTemplate),a=Object(s.r)(t.listBaseTemplate);return n||a}(e)){var n=e.consume(a.e);Object(r.e)(n)}!function(e){e.consume(c.f).isSiteAdmin&&e.consume(y.resourceKey).autoOpenPanelBaseOnQueryParams()}(e),function(e){var t="shareddeviceuid",n=e.consume(b.S).getIdentity();if("localStorage"in window&&n.id&&n.type!==d.e.anonymous){var a=localStorage.getItem(t),i=Object(v.e)(n.id).toString();localStorage.setItem(t,i),a&&i!==a&&f.e.logData({name:"SharedDevice.UserChanged",isIntentional:!0})}}(e),Object(o.e)(e)}})})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyHosts",function(){return G}),n.d(t,"typeResourceKey",function(){return K});var a=n(0),i=(n(3394),n(10)),r=n(195),o=n("react-lib"),s=n(4852),c=n(91),d=n(53),l=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(621).then(n.bind(null,5751))];case 1:return[2,e.sent().PowerAppHostLoaderAsyncHost]}})})}),u=Object(d.i)()(function(e){var t=e.resources,n=o.useMemo(function(){return t.consume(s.t)},[t]),a=o.useState(!1),i=a[0],r=a[1];return o.useEffect(function(){if(n.isPowerAppsSupportedScenario()){if(!n.mayHavePowerAppsForm())return;n.ensurePowerAppSdkPreloaded(),r(!0)}},[]),i?o.createElement(l,null):o.createElement(o.Fragment,null)}),f=n(1684),p=n(330),m=n(1214),_=n(23),h=n(293),b=n(3838),g=n(2890),v=n(3799),y=n(146),S=n(428),D=n(4221),I=n(5114),x=n(9),C=n(37),O=n(547),w={resources:i.r,navigation:y.e,observablesFactoryType:m.observablesFactoryTypeResourceKey},E=new i.t({name:"SPListSearchSettings",factory:{dependencies:w,create:function(e){var t=e.resources,n=e.navigation,a=e.observablesFactoryType,i=new S.e,r=i.attach(new a);return{instance:{submitAction:function(e){var a,i=e.searchText.peek();if(i){t.consume(O.e).logData({name:"InPage.Search.Click",isIntentional:!0}),n.updateViewParams(((a={})[x.n.queryTypeParamKey]=C.e.Search,a[x.n.queryParamKey]=i,a)),e.hideResultsUntilChange(!0);var r="alertInPageSearchResults",o=document.getElementById(r);o&&o.parentElement&&o.parentElement.removeChild(o),(o=document.createElement("div")).id=r,o.className="ms-accessible",o.innerText=D.a,o.setAttribute("role","alert"),document.body.appendChild(o)}else Object(I.e)(n)},searchText:r.create(n.viewParams[x.n.queryParamKey]||""),submitPlaceholder:r.create(D.r)},disposable:i}}}}),A=n(1956),L=n(38),k=n(2219),M=n(4202),P=n(228),T=n(755),U=function(e){function t(t){var n=e.call(this,t)||this,a=t.resources,i=t.responsiveUIMetrics,r=a.consume(k.t),o=a.consume(L.f);n._searchParams=a.consume(E),n._scope=new h.e;var s=a.consume(m.observablesFactoryTypeResourceKey),c=n._scope.attach(new s);return n._hasBack=c.create(r.compareSize(i.formFactorSize,"Small")<=0),!n._searchParams.placeholder&&Object(M.e)(o)&&(n._placeholder=c.create(_.format(A.e,o.listTitle))),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=Object(b.e)(v.resourceKey,Object(a.__assign)(Object(a.__assign)({},this._searchParams),{hasBack:this._hasBack,placeholder:this._placeholder}));return o.createElement(g.e,{specification:e,resources:this.props.resources})},t.prototype.componentWillUnmount=function(){this._scope.dispose()},t}(o.PureComponent),F=Object(P.n)(T.e)(Object(d.i)()(Object(p.n)([p.e.responsiveUIMetrics])(U))),H=n(4909),R=n(15),N=n(237),B=n(702),j=R.e.isActivated("7838eae8-70a5-4187-a899-128dce836ba7","2022/2/17","apply noSuiteNav style to panel overlay"),V=R.e.isActivated("E75FD3EC-1ECF-444B-87FB-B81B02F4E416","02/03/2022","Start the PowerApps host loader via React"),z=Object(c.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(613)]).then(n.bind(null,5919))];case 1:return[2,e.sent().KnockoutOverlayContent]}})})}),G=Object(p.n)([p.e.paneControls])(Object(d.i)()(function(e){var t=e.paneControls,n=t.isO365FlexPaneVisible,a=t.isTipsNTricksPaneVisible,i=t.needsOverlayContent,s=e.resources,c=e.onAddOverlay,d=e.onRemoveOverlay,l=!Object(N.i)(function(e){return!Object(B.e)(e)},[]);return o.createElement(o.Fragment,null,l?V?o.createElement(T.e,null,o.createElement(g.e,{specification:Object(b.e)(H.e,{}),resources:s})):o.createElement(u,null):null,o.createElement("div",{className:Object(r.e)("Files-hostContainer",{"od--hasFlexPane":n||a,"od-BasePage--noSuiteNav":e.isSuiteNavHidden&&!j})},i?o.createElement(z,{onAddOverlay:c,onRemoveOverlay:d}):null),f.t(f.e.LEGACY_SEARCH_BOX,F))})),K=new i.t({name:"LegacyHosts",factory:new i.e(G)})}],Array(24),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(5180),i=n(4),r=n("react-lib"),o=n(4415),s=n(98),c=Object(a.e)(function(e){if(0===r.Children.count(e.children))return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,a=(e.variant,e.nowrap,Object(i.r)(e,["block","className","as","variant","nowrap"])),c=Object(o.t)(e,{root:n});return Object(o.n)(c.root,Object(i.e)({},Object(s.s)(a,s.c)))},{displayName:"Text",styles:function(e,t){var n=e.as,a=e.className,i=e.block,r=e.nowrap,o=e.variant,s=t.fonts[o||"medium"];return{root:[t.fonts.medium,{display:i?"td"===n?"table-cell":"block":"inline",fontFamily:s.fontFamily,fontSize:s.fontSize,fontWeight:s.fontWeight,color:s.color,mozOsxFontSmoothing:s.MozOsxFontSmoothing,webkitFontSmoothing:s.WebkitFontSmoothing},r&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},a]}}})},,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"FloodgateDataSource",function(){return W}),n.d(t,"resourceKey",function(){return q});var a={};n.r(a),n.d(a,"NPSCampaignProd",function(){return h}),n.d(a,"NPSCampaignDogfood",function(){return b}),n.d(a,"NPSCampaignForceNomination",function(){return g}),n.d(a,"NPSCampaignDebugForSPO",function(){return v}),n.d(a,"NPSCampaignForSPO",function(){return y}),n.d(a,"NPSCampaignForLists",function(){return D}),n.d(a,"NPSCampaignForListsDebug",function(){return I}),n.d(a,"NPSSuiteSurvey",function(){return x}),n.d(a,"AllPhotosFPSSurvey",function(){return C}),n.d(a,"ODBMoveFPSSurvey",function(){return O}),n.d(a,"ODBCopyFPSSurvey",function(){return w}),n.d(a,"ODCMoveFPSSurvey",function(){return E}),n.d(a,"CreateListFromTemplateFPS",function(){return A}),n.d(a,"ODCCopyFPSSurvey",function(){return L}),n.d(a,"NlqsSurveyForBigLangs",function(){return k}),n.d(a,"NlqsSurveyForMediumLangs",function(){return M}),n.d(a,"SearchNPSCampaigns",function(){return P}),n.d(a,"NlqsSurveyForSmallLangs",function(){return T});var i=n(0),r=n(138),o=n(83),s=n(547),c=n(435),d=n(181),l=n(4543),u=n(1367),f=n(5361),p=n(1576),m={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.H,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.r}}},_={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SPListAction",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.N,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.o}}},h={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:m},b={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},g={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},v={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:_},y={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:_},S={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:p.e,Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:f.b,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.R,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.s}}},D={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:S},I={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:S},x={CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-21T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.h,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.S,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.y}}}},C={CampaignId:"f603ed6a-6f11-4e88-8f4d-7050fda6a676",StartTimeUtc:"2019-10-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EnteredAllPhotosView",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:f.e,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.t,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.i}}}},O={CampaignId:"e9808919-b9be-44a7-85fa-2a11dbf35d41",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.x,Question:f.C,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.I,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.D}}}},w={CampaignId:"bf829135-ea3a-43e7-8592-6d62259a0a92",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.l,Question:f.u,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.d,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.c}}}},E={CampaignId:"54eeb279-6ab7-4f26-880c-0643d3d60e53",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.x,Question:f.C,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.I,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.D}}}},A={CampaignId:"20e51938-5a9e-4760-b14f-cd6491d1864e",StartTimeUtc:"2021-08-06T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1},CooldownPeriod:{Type:0,IntervalSeconds:1}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CreateListFromTemplate",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f._,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.f,RatingValuesAscending:[f.p,"2","3","4",f.m]},Question:{Question:f.o}}}},L={CampaignId:"ffd1b867-3ee8-4ca9-a04c-2467930dfc54",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.l,Question:f.u,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.d,RatingValuesAscending:[f.n,"2","3","4",f.a]},Question:{Question:f.c}}}},k={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"de"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-MX"},{Type:0,Value:"fr"},{Type:0,Value:"ja"},{Type:0,Value:"nl"},{Type:0,Value:"pt-BR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},M={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"ar"},{Type:0,Value:"es"},{Type:0,Value:"fil-PH"},{Type:0,Value:"id"},{Type:0,Value:"it"},{Type:0,Value:"ko"},{Type:0,Value:"ms"},{Type:0,Value:"pl"},{Type:0,Value:"pt-PT"},{Type:0,Value:"ru"},{Type:0,Value:"sv"},{Type:0,Value:"th"},{Type:0,Value:"tr"},{Type:0,Value:"vi"},{Type:0,Value:"zh-TW"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},P={CampaignId:"78e6a7ce-b772-40d2-9d08-39a9f5703919",StartTimeUtc:"2022-03-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SyntexModelsGeneralFeedback",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.g,Question:f.v,YesLabel:f.z,NoLabel:f.B},Rating:{Question:f.r,RatingValuesAscending:[f.j,"2","3","4",f.V]},Question:{Question:f.r}}}},T={CampaignId:"a0be9dbb-0be9-429c-a632-c8de3a4d08b8",StartTimeUtc:"2021-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Languages:[{Type:0,Value:"af"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be"},{Type:0,Value:"bg"},{Type:0,Value:"bn-BD"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"cs"},{Type:0,Value:"da"},{Type:0,Value:"el"},{Type:0,Value:"et"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fi"},{Type:0,Value:"fr-CA"},{Type:0,Value:"he"},{Type:0,Value:"hi"},{Type:0,Value:"hr"},{Type:0,Value:"hu"},{Type:0,Value:"ka"},{Type:0,Value:"kk"},{Type:0,Value:"km-KH"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lv"},{Type:0,Value:"mt-MT"},{Type:0,Value:"nb-NO"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"pa-Arab-PK"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro"},{Type:0,Value:"sk"},{Type:0,Value:"sl"},{Type:0,Value:"sq"},{Type:0,Value:"uk"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"yo-NG"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageTime",Count:300,IsAggregate:!0},{Type:0,Activity:"AppResume",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:f.E,Question:f.w,YesLabel:f.A,NoLabel:f.O},Rating:{Question:f.k,RatingValuesAscending:[f.M,f.P,f.T,f.U,f.F]},Question:{Question:f.L}}}},U=n(1581),F=n(3),H=n(466),R=n(136),N=n(38),B=n(51),j=n(3582),V=n(14),z=n(15),G=n(204),K=z.t.isActivated("560845a6-74b3-47bd-99f6-f8657c1fe45d","10/18/22","Skip setSurveyStatus SPO"),W=function(){function e(e,t){void 0===e&&(e={});var n=this;if(this._eventGroup=new G.t(this),this._engagement=t.engagement,this._userInfoProvider=t.userInfoProvider,this._platformDetection=t.platformDetection,this._sessionId=B.e.generate(),this._appId=t.appId,this._pageContext=t.pageContext,this._isItemsScopeEnabledInAllPhotosPivotResource=t.isItemsScopeEnabledInAllPhotosPivotResource,this._onSurveyActivated=function(e){var t=e.survey.surveyInfo.data.backEndIdentifier,a=n._pageContext&&n._pageContext.isSPO;n._userInfoProvider.getSurveyStatusUserFact(t,a,!0).then(function(i){if(i.activated){for(var r=!1,o=0,s=n._campaignDefinitions;o<s.length;o++){var c=s[o];if(c.CampaignId===t){var d=1e3*c.NominationScheme.CooldownPeriod.IntervalSeconds;r=(new Date).getTime()>i.dateLastModified.getTime()+d}}if(!r)return void n._engagement.logData({name:"Floodgate.SurveyBlockedByUserFact",extraData:{id:t},isIntentional:!0})}n._ratingComponent=e.survey&&e.survey.getRatingComponent&&e.survey.getRatingComponent(),e.launch();var l={activated:!0,dateLastModified:new Date};!z.t.isActivated("069E3BF0-5DF9-4305-A165-C4280E18F2DE","10/26/20","Skip setSurveyStatus SPO")&&a?n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t},isIntentional:!0}):n._userInfoProvider.setSurveyStatusUserFact(t,l).then(function(e){n._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t,userFactUpdated:e},isIntentional:!0})})})},this._onSurveyDismissed=function(e,t){var a=new r.e({name:"Floodgate.SurveyCompleted"});if(t){var i=n._getEngine();if(i){var s=i.launchedSurveys,c=-1;for(var d in s)s[d].surveyInfo.data.backEndIdentifier===e&&(c=s[d].rating.selectedIndex+1);a.end({extraMetrics:{surveyResponse:c,sessionId:n._sessionId},resultType:o.e.Success}),n._engagement.logData({name:"Floodgate.SurveySubmitted",extraData:{id:e,response:c,sessionId:n._sessionId},isIntentional:!0})}if(n._pageContext&&n._pageContext.isSPO&&n._ratingComponent&&n._ratingComponent.getSelectedRating){var l=n._ratingComponent.getSelectedRating();-1!==l.indexOf("5")?n._engagement.logData({name:"SharePointNPSPromoter",extraData:{rating:l}}):-1===l.indexOf("1")&&-1===l.indexOf("2")&&-1===l.indexOf("3")||n._engagement.logData({name:"SharePointNPSDetractor",extraData:{rating:l}})}}else a.end({resultCode:"SurveyClosed",resultType:o.e.ExpectedFailure}),n._engagement.logData({name:"Floodgate.SurveyClosed",isIntentional:!0})},this._campaignDefinitions=[],e.customCampaignDefinitions)this._campaignDefinitions=e.customCampaignDefinitions;else{this._campaignDefinitions=[];var a=this._getActiveOneDriveNpsCampaign();a&&this._campaignDefinitions.push(a),this._pageContext&&this._pageContext.isSPO&&(this._pageContext.farmName&&this._pageContext.farmName.indexOf("MSIT_SPDF")>-1?(this._campaignDefinitions.push(v),this._campaignDefinitions.push(I)):(this._campaignDefinitions.push(y),this._campaignDefinitions.push(D)),Object(F.co)(F.K)&&this._campaignDefinitions.push(A)),Object(F.co)(F.l)&&this._campaignDefinitions.push(C),Object(F.co)(F.Pt)&&(this._campaignDefinitions.push(O),this._campaignDefinitions.push(w),this._campaignDefinitions.push(E),this._campaignDefinitions.push(L)),Object(F.co)(F.Vn)&&(this._campaignDefinitions.push(k),this._campaignDefinitions.push(M),this._campaignDefinitions.push(T)),Object(F.co)(F.I)&&this._campaignDefinitions.push(P),this._userInfoProvider.getIsPremium(!1).then(function(e){n._isPremium=e,e&&Object(F.co)(F.Wn)&&n._campaignDefinitions.push(x)})}}return e.prototype.dispose=function(){this._eventGroup.dispose()},e.prototype.recordUserAction=function(e,t){var n,a=this;"true"===(null===(n=window.sessionStorage)||void 0===n?void 0:n.getItem("_isRunningTABTest"))&&!K||this.waitForFloodgateInit().then(function(){var t=a._getEngine();t&&t.getActivityListener().logActivity(e)})},e.prototype.waitForFloodgateInit=function(){var e;return"true"!==(null===(e=window.sessionStorage)||void 0===e?void 0:e.getItem("_isRunningTABTest"))||K?this._initPromise||(this._initPromise=this._initFloodgate()):this._initPromise=Promise.resolve(),this._initPromise},e.prototype.processViewParams=function(e){e[p.t]&&this._resetAllSurveyStatuses();var t=e[p.n];t&&this._resetSurveyStatusByCampaignId(t);var n=e.origin;"createList"===n?this.recordUserAction(p.e):Object(F.co)(F.K)&&"createListFromTemplate"===n&&this.recordUserAction("CreateListFromTemplate")},e.prototype._initFloodgate=function(){var e=this;return n.e(5).then(n.t.bind(null,5804,7)).then(function(){var t=new r.e({name:"Floodgate.Initialized"});if(!window.OfficeBrowserFeedback||!window.OfficeBrowserFeedback.floodgate)return t.end({resultCode:"FloodgateNotLoaded",resultType:o.e.ExpectedFailure,extraData:{error:"Floodgate SDK not loaded."}}),e._engagement.logData({name:"Floodgate.SdkNotLoaded",extraData:{error:"Floodgate SDK not loaded."}}),Promise.resolve();try{localStorage.setItem("test","test"),localStorage.removeItem("test")}catch(n){return t.end({resultCode:"LocalStorageDisabled",resultType:o.e.ExpectedFailure,extraData:{error:"Local storage not enabled."}}),e._engagement.logData({name:"Floodgate.LocalStorageNotEnabled",extraData:{error:"Local storage not enabled."}}),Promise.resolve()}window.OfficeBrowserFeedback.initOptions={appId:e._appId,stylesUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.css"),intlUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/intl")+"/",environment:e._computeCurrentEnvironment(),sessionId:e._sessionId,locale:H.t.language,primaryColour:j.themeOffice.themePrimary,secondaryColour:j.themeOffice.themeSecondary,build:e._computeBuildVersion(),telemetrySink:{sendTelemetryEvent:function(t,n){e._engagement.logData({name:"Floodgate.SendTelemetryEventFallback"})}}};var n={newAllPhotosExperience:e._isItemsScopeEnabledInAllPhotosPivotResource,isPremium:e._isPremium},a=Object(U.t)();a&&(n=Object(i.__assign)(Object(i.__assign)({},n),{lastActionBeforeNPSSurvey:Object(U.e)(a.actionName),extension:a.extension,objectType:a.objectType,currentPage:a.currentPage})),window.OfficeBrowserFeedback.initOptions.applicationGroup={appData:JSON.stringify(n)};var s=window.FilesConfig&&window.FilesConfig.df;return e._pageContext&&e._pageContext.isSPO&&(s=e._pageContext.farmName.indexOf("MSIT_SPDF")>-1),window.OfficeBrowserFeedback.initOptions.telemetryGroup={audienceGroup:s?"Dogfood":"Production",officeUILang:e._computeLanguage(),loggableUserId:e._getUserId()},e._pageContext&&e._pageContext.isSPO&&e._pageContext.aadTenantId?window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId=e._pageContext.aadTenantId:window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId="00000000-0000-0000-0000-000000000000",e._pageContext&&e._pageContext.isSPO&&void 0!==e._pageContext.listBaseType&&(Object(V.a)(e._pageContext.listBaseType)?window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="Libraries":window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="List"),e._platformDetection&&(window.OfficeBrowserFeedback.initOptions.telemetryGroup.platform=e._platformDetection.osName,window.OfficeBrowserFeedback.initOptions.webGroup={browser:e._platformDetection.browserName}),window.OfficeBrowserFeedback.initOptions.telemetryGroup.channel="CC",window.OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:e._campaignDefinitions,onDismiss:e._onSurveyDismissed,onSurveyActivatedCallback:{onSurveyActivated:e._onSurveyActivated}},window.OfficeBrowserFeedback.floodgate.initialize().then(function(){return window.OfficeBrowserFeedback.floodgate.start().then(function(){var n=e._getEngine();if(!n)throw"Floodgate engine initialization failed silently.";var a=n.getActivityListener();a.logActivityStartTime("AppUsageTime"),a.logActivity("AppResume"),e._setupEventListeners(),t.end({resultType:o.e.Success}),e._engagement.logData({name:"Floodgate.Initialized"})})}).catch(function(n){t.end({resultCode:"FloodgateInitializationFailure",resultType:o.e.Failure}),e._engagement.logData({name:"Floodgate.FailedToInitialize",extraData:{error:n}})})})},e.prototype._getActiveOneDriveNpsCampaign=function(){return Object(F.co)(F.Gn)?g:Object(F.co)(F.zn)?b:h},e.prototype._getEngine=function(){if(window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate)return window.OfficeBrowserFeedback.floodgate.getEngine()},e.prototype._computeCurrentEnvironment=function(){return 0},e.prototype._computeBuildVersion=function(){var e=z.t.isActivated("92557910-4C5C-4204-8F39-A11BF1AD085E","10/26/20","STS regex"),t=window._spModuleLink&&window._spModuleLink.buildNumber||window.Flight&&window.Flight.version;if(t){var n=e?t.match(/\d{4}-\d{2}-\d{2}(-sts)?_\d{8}\.\d{3}/):t.match(/\d{4}-\d{2}-\d{2}_\d{8}\.\d{3}/);if(n)return n[0].replace(/-/g,"").replace("_",".")}},e.prototype._computeLanguage=function(){if(this._pageContext){if(this._pageContext.currentCultureLCID)return this._pageContext.currentCultureLCID;if(this._pageContext.currentLanguage)return this._pageContext.currentLanguage}else if($Config&&$Config.langPref)return $Config.langPref},e.prototype._getUserId=function(){if(!z.t.isActivated("FAB40378-F3AE-4D14-88B8-E7EE827CCA3B","03/15/2022","Return userId"))return this._pageContext&&this._pageContext.aadUserId?this._pageContext.aadUserId:$Config&&$Config.hcid?$Config.hcid:B.e.Empty},e.prototype._setupEventListeners=function(){var e=this,t=this._getEngine();this._eventGroup.on(window,"blur",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"unload",function(){t&&(t.getActivityListener().logActivityStopTime("AppUsageTime"),window.OfficeBrowserFeedback.floodgate.stop())}),this._eventGroup.on(window,"focus",function(){window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&window.OfficeBrowserFeedback.floodgate.start().then(function(){var e=window.OfficeBrowserFeedback.floodgate.getEngine().getActivityListener();e.logActivityStartTime("AppUsageTime"),e.logActivity("AppResume")}).catch(function(t){e._engagement.logData({name:"Floodgate.FailedToReinitialize",extraData:{error:t}})})})},e.prototype._resetSurveyStatusByCampaignId=function(e){this._userInfoProvider.setSurveyStatusUserFact(e,{activated:!1,dateLastModified:new Date}).then(function(t){t&&console.log("UserFact successfully reset: "+e)})},e.prototype._resetAllSurveyStatuses=function(){var e=new Set;for(var t in a){var n=a[t];e.has(n.CampaignId)||(e.add(n.CampaignId),this._resetSurveyStatusByCampaignId(n.CampaignId))}},e.dependencies={engagement:s.e,userInfoProvider:c.x,platformDetection:d.e,appId:l.e,pageContext:N.f.optional,isItemsScopeEnabledInAllPhotosPivotResource:u.n},e}(),q=Object(R.r)("FloodgateDataSource",W)}],Array(23),[function(e,t,n){"use strict";n.r(t),n.d(t,"ProcessingMessage",function(){return A});var a=n(0),i=n("react-lib"),r=n(240),o=n(97),s=n(5078),c=n(3461),d=n(1895),l=n(2837),u=n(53),f=n(5243),p=n(57),m=n(428),_=n(3287),h=n(270),b=n(5),g=n(116),v=n(3584),y=n(14),S=n(265),D=n(481),I=n(69),x=n(38),C=n(228),O=n(755),w=n(3),E=function(e){function t(t){var n=e.call(this,t)||this,a=n.props,i=a.listId,o=a.webAbsoluteUrl,s=a.resources;return n._listId=i,n._webAbsoluteUrl=o,n._resources=s,n._scope=new m.e,n._async=new r.e,n._isMounted=!1,n._listAIModelDataSource=n._resources.consume(l.t),n._uploadedItem=n._resources.consume(_.e),n._itemCacheStore=n._resources.consume(h.e),n._pageContext=n._resources.consume(x.f),n.state={showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this._isMounted=!0,this._scope.attach(this._uploadedItem.subscribe(function(t){var n=e.props,a=n.listId,i=n.webAbsoluteUrl,r=n.listTemplateType,s=n.isMachineTeachingModelApplied,c=n.isPredictionModelApplied,d=n.isMachineLearningCaptureEnabled,l=n.isAIBuilderEnabled,u=n.isSyntexPAYGEnabled;if(a&&i&&(s||c&&l))if(d||u){if(void 0!==t.progressItemKey){var f=e._itemCacheStore.dispatch(Object(g.e)(function(e){return e.demandItemFacet(v.t,t.progressItemKey)}));if(f){var p=e._itemCacheStore.dispatch(Object(g.e)(function(e){return e.demandItemFacet(b.m,f.sourceEntryKey)}));if(!p||!p.extension)return}}else{var m=t;if(!m||m.type!==S.e.File)return;if(m&&m.eTag)return}!s||c?e.getListAIModelState(i,a).then(function(t){if(e._isMounted){var n=(d||u)&&t.machineTeachingModelPublished&&r!==y.n.contentCenterSampleLibrary,a=l&&t.formProcessingModelPublished;(a||n)&&e.setState({showMachineTeachingModelMessage:n,showFormProcessingModelMessage:a,showNoSynctexLicenseMessage:!1})}}).catch(function(e){o.e.log("Failed to fetching list AI model state"+e.message.value)}):e.setState({showMachineTeachingModelMessage:!0,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1})}else e.setState({showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:Number(e._pageContext.webTemplate)!==I.t.contentCenter})}))},t.prototype.componentDidUpdate=function(){var e=this;(this.state.showFormProcessingModelMessage||this.state.showMachineTeachingModelMessage||this.state.showNoSynctexLicenseMessage)&&(this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer),this._autoDismissTimer=this._async.setTimeout(function(){e._isMounted&&e.setState({showMachineTeachingModelMessage:!1,showFormProcessingModelMessage:!1,showNoSynctexLicenseMessage:!1})},t.AutoDismissTimeOut))},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._scope.dispose(),this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer)},t.prototype.render=function(){var e=this,t=this.state,n=t.showMachineTeachingModelMessage,a=t.showFormProcessingModelMessage,r=t.showNoSynctexLicenseMessage,o=this.props,l=o.listId,u=o.webAbsoluteUrl;l===this._listId&&u===this._webAbsoluteUrl||(this._listId=l,this._webAbsoluteUrl=u,n=!1,a=!1,r=!1);var p="",m="";return n&&a?(p=f.n,m="https://go.microsoft.com/fwlink/?linkid=2127686"):!n&&a?(p=f.e,m="https://go.microsoft.com/fwlink/?linkid=2128021"):n&&!a?(p=f.a,m="https://go.microsoft.com/fwlink/?linkid=2128023"):r&&(p=Object(w.co)(w.ki)?f.r:f.i,m=""),p?i.createElement("div",{className:"messageBarContainer"},i.createElement(s.e,{messageBarType:r?c.e.warning:c.e.info,onDismiss:function(){return e.setState({showFormProcessingModelMessage:!1,showMachineTeachingModelMessage:!1,showNoSynctexLicenseMessage:!1})},dismissButtonAriaLabel:"Close"},p,!!m&&i.createElement(d.e,{href:m,target:"_blank"},f.t))):i.createElement("div",null)},t.prototype.getListAIModelState=function(e,n){var a=t.AIModelStateCache[n],i=new Date;return a&&a.expirationTime.getTime()>i.getTime()?Promise.resolve(a.modelState):this._listAIModelDataSource.getListAIModel(e,n).then(function(e){var a={formProcessingModelPublished:!(!e.predictionModel||!e.predictionModel.id||e.predictionModel.state&&e.predictionModel.state!==l.e.Online),machineTeachingModelPublished:!!e.machineTeachingModel&&!!e.machineTeachingModel.driveId},i=new Date;return i.setSeconds(i.getSeconds()+5),t.AIModelStateCache[n]={modelState:a,expirationTime:i},a}).catch(function(e){return Promise.reject(e)})},t.AIModelStateCache={},t.AutoDismissTimeOut=4e4,t}(i.PureComponent),A=Object(C.n)(O.e)(Object(p.e)(D.e)(Object(u.i)()(E)))},function(e,t,n){"use strict";n.r(t),n.d(t,"ModelPublishedBanner",function(){return h});var a=n(0),i=n("react-lib"),r=n(5078),o=n(3461),s=n(5942),c=n(57),d=n(16),l=n(4874),u=n(240),f=n(4873),p=n(5244),m="Text_dde26d97",_=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissBanner=function(){n.setState({isBannerVisible:!1}),n.props.showModelPublishBanner("")},n._async=new u.e,n._isMounted=!1,n.state={isBannerVisible:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentDidUpdate=function(e){var n=this,a=this.props.modelName;e.modelName!==a&&a&&this.setState({isBannerVisible:!0},function(){a&&(n._autoDismissTimer&&n._async.clearTimeout(n._autoDismissTimer),n._autoDismissTimer=n._async.setTimeout(function(){n._isMounted&&n._dismissBanner()},t.AutoDismissTimeOut))})},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this._autoDismissTimer&&this._async.clearTimeout(this._autoDismissTimer)},t.prototype.render=function(){var e=this.props,t=e.modelName,n=e.isModelPublished;return this.state.isBannerVisible?n?i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.success,isMultiline:!1},p.e," ",i.createElement(s.e,{className:m},t),"",p.t," ",p.n," ",i.createElement(s.e,{className:m},p.a),""):i.createElement(r.e,{onDismiss:this._dismissBanner,messageBarType:o.e.success,isMultiline:!1},i.createElement(s.e,{className:m},t),"",p.i):null},t.AutoDismissTimeOut=2e4,t}(i.Component);t.default=_;var h=Object(c.e)(function(e){var t=e.demandItemFacet(l.e,d.c);return{modelName:null==t?void 0:t.modelName,isModelPublished:null==t?void 0:t.isPublished}},function(e){return{showModelPublishBanner:function(t){e(Object(f.e)({modelPublishDetails:{modelName:t,isPublished:!1}}))}}})(_)},,,function(e,t,n){"use strict";n.r(t),n.d(t,"graphDriveFollowedAddon",function(){return S});var a=n(0),i=n(11),r=n(264),o=n(652),s=n(189),c=n(343),d=n(5),l=n(813),u=n(116),f=n(221),p=n(619),m=n(1019),_=n(7),h=n(34),b=n(184),g=n(147),v=n(99),y=Object(i.n)()(function e(t){var n=this,i=(t.keyType,t.items);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,y,S,D,I,x,C,O,w,E,A,L,k,M,P;return Object(a.__generator)(this,function(T){switch(T.label){case 0:return[4,t(Object(u.e)(function(e){return e.demandItemFacet(h.I,b.e)}))];case 1:if(!(null==(n=T.sent())?void 0:n()))return[2];if(r=Object.keys(i),o=r[0],s=m.e.deserialize(o),!(c=s.driveItem.endpoint))throw new Error("No endpoint to determine followed items.");return y=p.e.serialize({driveItemKey:{endpoint:c},sortBy:"",isAscending:!0}),[4,t(Object(l.e)(function(e){return e.demandItemFacet(_.e,y)}))];case 2:for(S=T.sent(),D=S&&S.itemKeys||[],I=new f.e({publisher:e}),x={},C=0,O=D;C<O.length;C++)w=O[C],x[w]=!0;for(E=0,A=r;E<A.length;E++)L=A[E],k=m.e.deserialize(L).driveItem,M=!!x[v.e.serialize(k)],I.resolveItems({items:(P={},P[L]=Object(a.__assign)(Object(a.__assign)({},d.S.pack(M||void 0)),Object(g.e)().forFacet(d.S).thenInvalidate(y,_.e).pack()),P)});return t(I.execute()),[2]}})})}}),S=Object(i.t)(function(){return function(e){e(Object(s.t)({keyFacet:m.e,facets:[d.S]})),e(Object(r.a)(m.e,c.e)(y)),e(Object(r.a)(m.e,o.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(21).then(n.bind(null,5754))];case 1:return[2,e.sent().driveItemFollowItemOperationHandler]}})})})))}})},,function(e,t,n){"use strict";n.r(t),n.d(t,"IS_CONSTRAIN_LIBRARIES_DROPDOWN_SIZE_KILLSWITCH_ACTIVATED",function(){return A}),n.d(t,"IS_FIX_FOCUS_KILLSWITCH_ACTIVATED",function(){return L}),n.d(t,"ItemLibrariesDropdown",function(){return U}),n.d(t,"LibrariesDropdown",function(){return F});var a=n(0),i=n("react-lib"),r=n(164),o=n(5216),s=n(165),c=n(88),d=n(120),l=n(370),u=n(195),f=n(7),p=n(5),m=n(28),_=n(1),h=n(496),b=n(124),g=n(14),v=n(224),y=n(26),S=n(569),D=n(13),I=n(1659),x=n(148),C=n(170),O=n(228),w=n(91),E=n(15),A=E.t.isActivated("511cf8c4-478d-4428-be23-88fdb3dc803a","03/28/2022",'Constrain the size of the libraries dropdown so that very very long library names don"t break it'),L=E.t.isActivated("32E14D10-7F57-4A91-BF35-B6FB88FAD6F1","05/12/2022","Fix the focus style of the dropdown in all endpoints."),k=Object(w.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred"),n.e(723)]).then(n.bind(null,2082))];case 1:return[2,e.sent().ActionContextMenu]}})})}),M="LibrariesDropdown;",P={component:M},T=Object(x.t)({withContext:P}),U=Object(O.n)(T)(function(e){var t,n=i.useRef(null),a=i.useState(!1),D=a[0],O=a[1],w=Object(b.e)(function(){return O(!1)}),E=Object(u.e)("librariesDropdown_5d61535c",e.className,D?"librariesDropdownOpen_5d61535c":"librariesDropdownNotOpen_5d61535c",((t={}).librariesDropdownWithFocus_5d61535c=!L,t));return i.createElement(s.e,null,function(t){var a,s=t.itemCache,b=(t.dispatch,null===(a=Object(x.n)(s))||void 0===a?void 0:a.telemetry),L=e.itemKey,P=s.demandItemFacet(m.e,L),T=s.demandItemFacet(c.e,L),U=Object(S.e)(s);if(P||T){var F=Object(y.e)(s,{enableLibrariesDropdown:_.B}).enableLibrariesDropdown,H=void 0,R=void 0,N=void 0;if(P)H=P.webAbsoluteUrl,R=P.rootFolder,N=d.e.serialize(P);else{if(!T)return null;H=T.webAbsoluteUrl,R=T.rootFolder,N=d.e.serialize(T)}var B=s.demandItemFacet(_.We,N),j=!(U||!F||!B||B.templateType!==g.n.documentLibrary||""!==R),V=s.demandItemFacet(I.e,L);if(!I.e.evaluate(V)(s,{itemKey:L,isAvailable:j}).isAvailable)return null;var z=[],G=null;if(D){var K=s.demandItemFacet(f.e,l.e.serialize({webAbsoluteUrl:H}));K&&K.itemKeys&&K.itemKeys.length&&(G=function(){b&&b(C.e).logData({name:"LibrariesDropdown.Load",component:M,objectType:"Libraries",extraData:{numberOfLibraries:K.itemKeys.length},isIntentional:!0})},z=K.itemKeys.map(function(e){return{key:e,name:s.demandItemFacet(p.f,e)||"",action:i.createElement(v.e,{itemKey:e})}}))}return i.createElement(i.Fragment,null,i.createElement("button",{className:E,onClick:D?w:function(){b&&b(C.e).logData({name:"LibrariesDropdown.OpenDropdown",component:M,isIntentional:!0}),O(!0)},ref:n,"aria-label":o.e,"aria-haspopup":"menu","aria-expanded":D?"true":"false",title:o.e},i.createElement(h.e,{iconName:"Library",className:Object(u.e)("librariesDropdownIcon_5d61535c")}),i.createElement(h.e,{iconName:"ChevronDown",className:Object(u.e)("librariesDropdownChevron_5d61535c")})),D?i.createElement(k,{commands:z,target:n.current,directionalHint:r.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:w,isOpen:!0,onMenuOpened:G||void 0,calloutProps:A?{}:{calloutMaxHeight:500,calloutMaxWidth:300}}):null)}return null})}),F=Object(D.e)()(U)},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return q});var a=n(0),i=n(136),r=n(1214),o=n(320),s=n(100),c=n(4213),d=n(2370),l=n(38),u=n(2135),f=n(1017),p=n(770),m=n(4851),_=n(3187),h=n(40),b=n(1),g=n(88),v=n(120),y=n(318),S=n(351),D=n(39),I=n(517),x=n(132),C=n(399),O=n(2653),w=n(2626),E=n(51),A=n(86),L=n(371),k=n(156),M=n(201),P=n(60),T=n(2502),U=n(4227),F=n(77),H=n(2862),R=n(3020),N=n(14),B=n(996),j=n(553),V=n(378),z=n(4821),G=[],K=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._computeShouldUpdateKnockoutData=function(e){var t=a._useItemsScope(),n=Object(F.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey}),i=H.n.serialize({itemKey:n});return t&&e.isItemFacetResolved(H.e,i)},a._computeFileHandlerData=function(e){var t=Object(D.e)(e,a._itemsScopeItemKey),n=e.demandItemFacet(g.e,t);if(n){var i=n.webAbsoluteUrl,r=new P.e(i).authority+"/_api/v2.0",o=M.t.serialize({endpoint:r});return e.demandItemFacet(k.s,o)}},a._computeSelectedKOItemKeys=function(e){var t=a._itemsScopeItemKey;return Object(x.e)(e,{itemsScopeItemKey:t}).map(function(t){var n=e.demandItemFacet(H.t,t);return n&&n.key})},a._computeContentTypes=function(e){var t=Object(D.e)(e,a._itemsScopeItemKey),n=e.demandItemFacet(g.e,t)||{},i=n.webAbsoluteUrl,r=void 0===i?void 0:i,o=n.listFullUrl,s=void 0===o?void 0:o,c=r&&s&&v.e.serialize({webAbsoluteUrl:r,listFullUrl:s});return(e.demandItemFacet(b.b,c)||G).map(function(t){return e.demandItemFacet(b.yn,t)})},a._computeFolderContentTypes=function(e){var t=Object(F.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey});return(e.demandItemFacet(b.b,t)||G).map(function(t){return e.demandItemFacet(b.cn,t)})},a._computeCurrentItemData=function(e){var t=Object(I.e)(e,{itemsScopeItemKey:a._itemsScopeItemKey}),n=t.currentItemSetKey,i=t.currentItemKey,r=e.demandItemFacet(g.e,n);if(r){var o=r.webAbsoluteUrl,s=r.listFullUrl,c=e.demandItemFacet(j.t,i),d=v.e.serialize({webAbsoluteUrl:o,listFullUrl:s}),l=y.e.serialize({webAbsoluteUrl:o,listFullUrl:s}),u=e.demandItemFacet(b.Dn,l),f=e.demandItemFacet(b.ge,n),p=e.demandItemFacet(A.l,d),m=a._getCurrentViewKey(e,n),_=e.demandItemFacet(b.g,m);return{pageContextKey:l,pageContext:u,getItemResponse:f,spClientSideFrameworkContext:p,storeKey:c&&c.key,listKey:d,currentDerivedView:_,dispatch:e.dispatch}}},a._computeOnUpdateCurrentItemData=function(){if(a._shouldUpdateKnockoutData()){var e=a._currentItemData();if(e){var t=e.pageContextKey,n=e.pageContext,i=e.getItemResponse,r=e.spClientSideFrameworkContext,o=e.storeKey,s=e.listKey,c=e.currentDerivedView,d=e.dispatch;i&&u.e.updateListContext(i,a._listContext);var l=a.resources.consume(w.resourceKey);l&&l.ensureListContextUpdateSignal().complete();var f=a._onePageContext;if(f){d(Object(z.e)(a._pageContext,n,t,a._listContext));var p=a.resources.consume(_.e.optional);p&&(p.clearCachedPromise(),p.updateWorkloadSettingsLinks&&p.updateWorkloadSettingsLinks()),r&&a._updateSpfxContext(s,r),f.onePageNavigationDataFetch(!0),f.onePageNavigationDataFetch(!1),a._bootOptions.onEUPL&&a._bootOptions.onEUPL()}if(c&&a._currentView&&a._currentView(c.clone()),i){var b=new a._itemTaskObserverType,g=i.ListSchema,v=a._listItemResultProcessor.processResponse({response:i,pageContext:n,requestKey:o,observer:b}).listRootItemKey;if(g&&!Object(h.isFeatureEnabled)(h.SkipSettingMicroserviceBaseInfo)){var y={data:g,allowCookies:!1};a._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(v).setBaseInfo(y),a._microServiceDataSource.setBaseInfo(y)}if(a.resources.consumeAsync(m.e).then(function(e){e.trackListToken(o)}),i&&i.ListSchema){var S={},D=Object(R.t)({listSchema:i.ListSchema,resources:a._resources,groupSchema:S,hasFixedSchema:a._listContext.listTemplateType===N.t.mySiteDocumentLibrary,listContext:a._listContext,getItemContext:void 0,sortFallback:{sortField:i.ListData.SortField,sortDirection:i.ListData.SortDir}});i.ListSchema.group1&&(a._listContext.groupSchema=S),a.koItemSet().schema(D)}b.flush()}}}},a._listItemResultProcessor=n.listItemResultProcessor,a._itemTaskObserverType=n.itemTaskObserverType,a._fileHandlerCacheDataSource=n.fileHandlerCacheDataSource,a._resources=n.resources,a._listContext=n.listContext,a._pageContext=n.pageContext,a._microServiceDataSource=n.microServiceDataSource,a._microServiceDataSourceStore=n.microServiceDataSourceStore,a._onePageContext=n.onePageContext,a._useItemsScope=n.useItemsScope,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemCacheDataManager=n.itemCacheDataManager,a._itemsScopeItemKey=n.itemsScopeItemKey,a._bootOptions=n.bootOptions;var i=n.itemCacheObservablesFactory;a._currentKOItem=n.currentKOItem,a._currentKOItemSet=n.currentKOItemSet,a.koItem=a._itemCacheDataManager.currentItem,a.koItemSet=a._itemCacheDataManager.currentItemSet,a._shouldUpdateKnockoutData=a.addDisposable(i.pureCompute(a._computeShouldUpdateKnockoutData)),a._shouldUpdateKnockoutData.equalityComparer=B.n,a.selectedKOItemKeys=a.addDisposable(i.pureCompute(a._computeSelectedKOItemKeys)),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItem();try{a._currentKOItem(e)}catch(e){}}}),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItemSet();try{a._currentKOItemSet(e)}catch(e){}}}),a._currentView=a.resources.consume(o.l.optional),a._contentTypes=a.addDisposable(i.pureCompute(a._computeContentTypes)),a._contentTypes.equalityComparer=B.e,a._folderContentTypes=a.addDisposable(i.pureCompute(a._computeFolderContentTypes)),a._folderContentTypes.equalityComparer=B.e;var r=a.resources.consume(l.n.optional);return r&&a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a._contentTypes();r(e)}}),a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a.koItemSet();if(e.contentTypes){var t=a._folderContentTypes();e.contentTypes(t)}}}),a._fileHandlerCacheDataSource&&(a._fileHandlerData=a.addDisposable(i.pureCompute(a._computeFileHandlerData)),a._fileHandlerData.equalityComparer=B.n,a.observables.backgroundCompute(function(){if(a._shouldUpdateKnockoutData()){var e=a._fileHandlerData();a._fileHandlerCacheDataSource.setFileHandlerData(e)}})),a._currentItemData=a.addDisposable(i.pureCompute(a._computeCurrentItemData)),a._currentItemData.equalityComparer=B.t,a.observables.backgroundCompute(a._computeOnUpdateCurrentItemData),a}return Object(a.__extends)(t,e),t.prototype._updateSpfxContext=function(e,t){var n,a,i;if(this._listContext&&e&&this._clientSideExtensionHelper)try{var r=this._clientSideExtensionHelper.getApplication();if(r&&"function"==typeof r.navigateToPreloadedData&&t){var o=null===(i=null===(a=null===(n=null==r?void 0:r.context)||void 0===n?void 0:n.pageContext)||void 0===a?void 0:a.list)||void 0===i?void 0:i.id.toString();E.e.normalizeLower(o)!==E.e.normalizeLower(this._listContext.listId)&&r.navigateToPreloadedData(JSON.parse(t))}}catch(e){console.log("Error updating SpfxContext, error "+e)}},t.prototype._getCurrentViewKey=function(e,t){var n=this._itemsScopeItemKey,a=t||Object(D.e)(e,n),i=e.demandItemFacet(g.e,a);return i&&i.viewKey&&S.e.serialize(i.viewKey)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.default.dependencies),{listItemResultProcessor:c.e,currentKOItem:o.o,currentKOItemSet:o.s,itemTaskObserverType:d.resourceKey,listContext:l.o,microServiceDataSource:f.e,microServiceDataSourceStore:p.e,pageContext:l.f,onePageContext:l.u.optional,itemsScopeItemKey:C.e,useItemsScope:O.e,clientSideExtensionHelper:L.e.optional,fileHandlerCacheDataSource:s.m.optional,itemCacheObservablesFactory:T.e,itemCacheDataManager:U.t,bootOptions:V.e}),t}(r.default),W=K,q=Object(i.r)("ItemCacheToKOStoreDataSource.new",K);t.default=W}],Array(25),[function(e,t,n){"use strict";n.r(t),n.d(t,"DropTargetHook",function(){return g}),n.d(t,"DragSourceHook",function(){return v}),n.d(t,"DragDropHook",function(){return I});var a=n(0),i=n("react-lib"),r=n(1571),o=n(1462),s=n(1040),c=n(1723),d=n(2174),l=n(2175),u=n(211),f=n(1569);function p(e){var t=e.dragDropKey,n=e.dragType,a=e.acceptType,r=e.showDefaultDragPreview,c=e.hookCallback,p=e.handlers,m=!!p.canDragHandler,_=Object(s.a)({dragSourceKey:t,type:n,handlers:p,collectDragAvailability:!1}),h=Object(d.e)(_),b=h[0],g=h[1],v=h[2];Object(i.useEffect)(function(){m&&v&&!r&&v(Object(f.e)(),{captureDraggingState:!0})},[m,v,r]);var y=Object(o.a)({acceptType:a,dropTargetKey:t,handlers:p}),S=Object(l.e)(y),D=S[0],I=S[1];return Object(i.useEffect)(function(){c({collectedDragProps:b,collectedDropProps:D,connectDragSource:g,connectDropTarget:I})},[b,D,g,v,I]),Object(u.t)(e.children,{collectedDragProps:b,collectedDropProps:D,connectDragSource:g,connectDropTarget:I})}var m=n(834),_=n(75),h=n(124),b=n(1658),g=function(e){return i.createElement(r.e,null,i.createElement(o.e,Object(a.__assign)({},e)))},v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),c=o[0],d=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t),d(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(r.e,null,i.createElement(s.t,Object(a.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!c?null:i.createElement(s.e,{dragSourceKey:t,type:n},function(e){return i.createElement(D,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function y(e){var t=e.resolve,n=Object(a.__rest)(e,["resolve"]);return i.useEffect(function(){return function(){t()}},[]),i.createElement(c.e,Object(a.__assign)({},n))}function S(e){var t=e.draggedItem,n=e.resolve;return i.createElement(r.e,null,i.createElement(s.e,{dragSourceKey:null==t?void 0:t.dragSourceKey,type:null==t?void 0:t.type,as:b.e,getItemStyles:b.n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:n})}))}function D(e){var t=Object(m.i)({scope:"global"});return i.useEffect(function(){if(e.draggedItem&&t){var n=new _.e,a=n.reject,r=n.resolve,o=n.promise,s=i.createElement(S,{draggedItem:e.draggedItem,reject:a,resolve:r});t.enqueue({content:s,promise:o,scope:"global"})}},[e.draggedItem]),null}var I=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),c=o[0],d=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t),d(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(r.e,null,i.createElement(p,Object(a.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!c?null:i.createElement(s.e,{dragSourceKey:t,type:n},function(e){return i.createElement(D,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})},,,function(e,t,n){"use strict";n.r(t);var a=n(0),i=n("knockout-lib"),r=n(1214),o=n(100),s=n(2269),c=n(5066),d=n(1956),l=n(320),u=n(3091),f=n(3141),p=n(2229),m=n(10),_=n(136),h=new m.t({name:"ItemUpdator.key",loader:new _.t(function(){return n.e(467).then(n.bind(null,5789)).then(function(e){return e.resourceKey})})}),b=n(1367),g="new",v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.key="PostUpload",t}return Object(a.__extends)(t,e),t.prototype.projectItemSet=function(e,t,n){var a=this;if(e){var r=t.content.peek().items,c=t.content.peek().groupings,m=[],_=n.group;if(c&&c.length&&c[0].itemGroups&&c[0].itemGroups.length&&!_){var v=c[0].itemGroups[0];v.groupingId===g?_=v:(_={groupingType:v.groupingType,groupingId:g,name:d.b,fieldSchema:v.fieldSchema,startIndex:0,count:0,state:i.observable({isCollapsed:!1}),level:0},c[0].itemGroups=[_].concat(c[0].itemGroups))}var y=[],S=this.resources.consume(s.t);n.uploadedItems.forEach(function(e){if(4!==e.peek().state.upload.status&&3!==e.peek().state.upload.status){var t=S.getItem(e.peek().key);if(t&&t.peek().state.removing&&(e.peek().state.removing=!0),(e=S.setItem(e.peek())).peek().isPlaceholder?m.push(e):e().state.upload.status=2,_&&_.groupingId!==g){var n=r[_.startIndex];if(n&&n.peek())for(var a=_;a&&a.fieldSchema;){var i=a.fieldSchema.Name;e.peek().properties[i]=n.peek().properties[i],a=Object(f.e)(u.default.getParent(a,c[0].itemGroups))}}y.push(e)}});var D=this._calculateNewChildren(r,c,y,_);e.sortField=t.sortField,e.isAscending=t.isAscending,e.schema=t.schema,e.contentTypes=t.contentTypes,e.content({items:D,groupings:c}),e.isPlaceholder=t.isPlaceholder,e.isExpired=t.isExpired,e.version=t.version;var I=this.resources.consume(p.resourceKey),x=this.resources.consume(o.ue);if(m.length>0){var C=m.map(function(e){var t=e.peek();return t.properties.ID||t.properties.uniqueId}),O=x.getCurrentItemKey();I.getSpecifiedItems({parentKey:O,itemKeys:C,recurseInFolders:!1,needToClearParentSmartFiltersInfo:!0}).then(function(e){var t;if(e.children.forEach(function(e){for(var n=0;n<m.length;n++){var a=m[n];if(e.properties.ID===a.peek().properties.ID){e.state.upload.status=2,a(e),e.hasMissingMetadata&&(t||(t=[]),t.push(a));break}}}),t){var n=a.resources.consume(l.e);new(a.managed(n.SelectAction))({showProperties:!0,selectItems:t}).execute(null),a.resources.consume(b.f)&&a.resources.consumeAsync(h).then(function(e){var n=t.map(function(e){return a.observables.peekUnwrap(e)});e.selectItems(n.map(function(e){return e.properties.ID}))})}})}}},t.prototype._calculateNewChildren=function(e,t,n,a){var r=[],o=null,s=t&&t.length&&t[0].itemGroups&&t[0].itemGroups.length,l={},f=s&&t[0].itemGroups;if((!a||a.groupingId===g&&0===a.count)&&(r=n),a){var p=n.length;l[a.groupingId]=p;for(var m=u.default.getParent(a,f);m;)l[m.groupingId]=p,m=u.default.getParent(m,f);if(a.children&&a.children.length>0){var _={groupingType:a.groupingType,groupingId:a.groupingId+"-"+g,name:d.b,fieldSchema:a.children[0].fieldSchema,startIndex:a.startIndex,count:p,state:i.observable({isCollapsed:!1}),level:a.level+1,parentKey:a.groupingId};a.children.unshift(_),a=_}}for(var h=0;h<e.length;h++){var b=e[h],v=c.e.getGroup(t,h);if(a&&v&&v!==o&&(v===a&&(r=r.concat(n)),o=v),b&&b.peek().state.removing&&v){l[v.groupingId]||(l[v.groupingId]=0),l[v.groupingId]-=1;for(var y=u.default.getParent(v,f);y;)l[y.groupingId]||(l[y.groupingId]=0),l[y.groupingId]-=1,y=u.default.getParent(y,f);b.peek().state.removing=!1}else r.push(b)}return s&&(t[0].itemGroups=this._calculateNewGroups(f,l)),r},t.prototype._calculateNewGroups=function(e,t,n){for(var a=[],i=0,r=0;r<e.length;r++){var o=e[r];if(t&&t[o.groupingId]){var s=t[o.groupingId];o.count+=s,s>0&&o.state.peek().isCollapsed&&o.state({isCollapsed:!1})}if(o.count>0){if(0===i)o.startIndex=n?n.startIndex:0;else{var c=a[i-1];o.startIndex=c.startIndex+c.count}o.children&&(o.children=this._calculateNewGroups(o.children,t,o)),a[i++]=o}}return a},t}(r.default);t.default=v}])]);