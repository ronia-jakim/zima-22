(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[360],{1858:function(e,t,n){"use strict";n.r(t),n.d(t,"openInTeamsFileViewerExecutor",function(){return _});var a=n(0),i=n(106),r=n(206),o=n(33),s=n(12),c=n(116),d=n(3),l=n(410),u=n(554),f=n(331),p=n(16),m=s.e.isActivated("3a9f413a-01d4-4243-86f0-6feb6e76abef","10/1/2022","open aspx in browser tab");function _(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M;return Object(a.__generator)(this,function(P){if(t=e.fileInfo,_=e.teamsSDK,h=e.editFile,b=e.fileOpenPreference,g=e.currentItemKey,v=e.evaluationContext,t.fileName){if((T=t.openUrl)&&(T.startsWith("https://forms.office.com")||T.startsWith("https://forms.officeppe.com"))||".aspx"===t.fileName.extension&&!m)return window.open(t.openUrl),[2];y=t.fileName.name+t.fileName.extension,S=t.oneNote?"one":t.fileName.extension.substr(1),D=t.isNewFile,I=t.parentItemKey,!(x=t.canonicalUrl)&&I&&(C=I.rootFolder||new r.e(I.listFullUrl).path,O=new i.t({context:{webAbsoluteUrl:I.webAbsoluteUrl,listUrl:I.listFullUrl}}),w=O.getUrlParts({path:C}),x="".concat(w.fullItemUrl,"/").concat(y)),E=void 0,Object(d.co)(d.Ei)?(A=n(Object(c.e)(function(e){var t=e.demandItemFacet(f.e,p.c),n=f.e.evaluate(t)(e,{itemKey:g,viewParams:{}}).storeKey;if(n)return Object(a.__assign)(Object(a.__assign)({},Object(l.e)(n.key)),n.viewParams)},{evaluationContext:v})),E=A?{viewParams:Object(u.e)(A)}:void 0):E=I&&I.rootFolder!==_.channelRelativeUrl?{web:I.webAbsoluteUrl,list:I.listFullUrl,folder:I.rootFolder}:void 0,L=E?encodeURIComponent(JSON.stringify(E)):void 0,k=s.e.isActivated("9FC2F773-D8A0-42E7-A015-C3E287F8A166","07/06/2022","Pass baseUrl to openFilePreview sdk api")||null===(M=t.spItemKey)||void 0===M?void 0:M.webAbsoluteUrl,x&&_.openFilePreview({baseUrl:k,entityId:t.uniqueId||"",subEntityId:L,title:y,type:S,objectUrl:x,editFile:h||D,fileOpenPreference:b,viewerAction:D?o.ViewerActionTypes.editNew:h?o.ViewerActionTypes.edit:o.ViewerActionTypes.view,conversationId:_.channelId})}var T;return[2]})})}}}}]);